[{"title":"Swiftå®è·µæŒ‡å—","url":"http://hchong.net/2017/12/11/Swiftå®è·µæŒ‡å—/","content":"","categories":[],"tags":[]},{"title":"HTTPè¯·æ±‚ä¸­çš„GETä¸POST","url":"http://hchong.net/2017/12/11/HTTPè¯·æ±‚ä¸­çš„GETä¸POST/","content":"","categories":[],"tags":[]},{"title":"RunLoopç”¨æ³•ä¸åˆ†æ","url":"http://hchong.net/2017/12/11/RunLoopç”¨æ³•ä¸åˆ†æ/","content":"","categories":[],"tags":[]},{"title":"Runtimeç”¨æ³•ä¸åˆ†æ","url":"http://hchong.net/2017/12/11/Runtimeç”¨æ³•ä¸åˆ†æ/","content":"","categories":[],"tags":[]},{"title":"RNå®è·µæŒ‡å—","url":"http://hchong.net/2017/12/01/RNå®è·µæŒ‡å—/","content":"<h1 id=\"RNå®è·µæŒ‡å—\"><a href=\"#RNå®è·µæŒ‡å—\" class=\"headerlink\" title=\"RNå®è·µæŒ‡å—\"></a>RNå®è·µæŒ‡å—</h1><p>RNå®è·µè¿‡ç¨‹ä¸­, æ–°æ‰‹ä¸Šè·¯</p>\n<h2 id=\"å¸ƒå±€\"><a href=\"#å¸ƒå±€\" class=\"headerlink\" title=\"å¸ƒå±€\"></a>å¸ƒå±€</h2><h2 id=\"ç»„ä»¶é—´é€šä¿¡\"><a href=\"#ç»„ä»¶é—´é€šä¿¡\" class=\"headerlink\" title=\"ç»„ä»¶é—´é€šä¿¡\"></a>ç»„ä»¶é—´é€šä¿¡</h2><h2 id=\"çŠ¶æ€ç»‘å®š\"><a href=\"#çŠ¶æ€ç»‘å®š\" class=\"headerlink\" title=\"çŠ¶æ€ç»‘å®š\"></a>çŠ¶æ€ç»‘å®š</h2>","categories":["åŸºç¡€çŸ¥è¯†","RN"],"tags":["åŸºç¡€çŸ¥è¯†","RN"]},{"title":"iOSå¤šçº¿ç¨‹","url":"http://hchong.net/2017/11/21/iOSå¤šçº¿ç¨‹/","content":"<h1 id=\"iOSå¼€å‘å¤šçº¿ç¨‹\"><a href=\"#iOSå¼€å‘å¤šçº¿ç¨‹\" class=\"headerlink\" title=\"iOSå¼€å‘å¤šçº¿ç¨‹\"></a>iOSå¼€å‘å¤šçº¿ç¨‹</h1><p>é¦–å…ˆæˆ‘ä»¬æ¥ææ¸…æ¥šå‡ ä¸ªæ¦‚å¿µå’Œä»–ä»¬ä¹‹é—´çš„è”ç³»å’ŒåŒºåˆ«: </p>\n<h2 id=\"å¤šçº¿ç¨‹å¼€å‘å¸¸ç”¨æ¦‚å¿µ\"><a href=\"#å¤šçº¿ç¨‹å¼€å‘å¸¸ç”¨æ¦‚å¿µ\" class=\"headerlink\" title=\"å¤šçº¿ç¨‹å¼€å‘å¸¸ç”¨æ¦‚å¿µ\"></a>å¤šçº¿ç¨‹å¼€å‘å¸¸ç”¨æ¦‚å¿µ</h2><ol>\n<li><p>è¿›ç¨‹å’Œçº¿ç¨‹</p>\n<p>è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºå…³äºæŸä¸ªæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨, è¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½.<br>â€‹<br>çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“, æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾(èµ„æºåˆ†é…)çš„åŸºæœ¬å•ä½, å®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½. çº¿ç¨‹è‡ªå·±åŸºæœ¬ä¸Šä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æº, åªæ‹¥æœ‰ä¸€ç‚¹åœ¨è¿è¡Œä¸­å¿…ä¸å¯å°‘çš„èµ„æº(å¦‚ç¨‹åºè®¡æ•°å™¨, ä¸€ç»„å¯„å­˜å™¨å’Œæ ˆ), ä½†æ˜¯å®ƒå¯ä¸åŒå±ä¸€ä¸ªè¿›ç¨‹çš„å…¶ä»–çš„çº¿ç¨‹å…±äº«è¿›ç¨‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æº. </p>\n<p>ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åˆ›å»ºå’Œæ’¤é”€å¦ä¸€ä¸ªçº¿ç¨‹; åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹ä¹‹é—´å¯ä»¥å¹¶å‘æ‰§è¡Œ. </p>\n<p>è¿›ç¨‹å’Œçº¿ç¨‹çš„ä¸»è¦å·®åˆ«åœ¨äºå®ƒä»¬æ˜¯ä¸åŒçš„æ“ä½œç³»ç»Ÿèµ„æºç®¡ç†æ–¹å¼. è¿›ç¨‹æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´, ä¸€ä¸ªè¿›ç¨‹å´©æºƒå, åœ¨ä¿æŠ¤æ¨¡å¼ä¸‹ä¸ä¼šå¯¹å…¶å®ƒè¿›ç¨‹äº§ç”Ÿå½±å“. è€Œçº¿ç¨‹åªæ˜¯ä¸€ä¸ªè¿›ç¨‹ä¸­çš„ä¸åŒæ‰§è¡Œè·¯å¾„. çº¿ç¨‹æœ‰è‡ªå·±çš„å †æ ˆå’Œå±€éƒ¨å˜é‡, ä½†çº¿ç¨‹ä¹‹é—´æ²¡æœ‰å•ç‹¬çš„åœ°å€ç©ºé—´, ä¸€ä¸ªçº¿ç¨‹æ­»æ‰å°±ç­‰äºæ•´ä¸ªè¿›ç¨‹æ­»æ‰, æ‰€ä»¥å¤šè¿›ç¨‹çš„ç¨‹åºè¦æ¯”å¤šçº¿ç¨‹çš„ç¨‹åºå¥å£®, ä½†åœ¨è¿›ç¨‹åˆ‡æ¢æ—¶, è€—è´¹èµ„æºè¾ƒå¤§, æ•ˆç‡è¦å·®ä¸€äº›. ä½†å¯¹äºä¸€äº›è¦æ±‚åŒæ—¶è¿›è¡Œå¹¶ä¸”åˆè¦å…±äº«æŸäº›å˜é‡çš„å¹¶å‘æ“ä½œ, åªèƒ½ç”¨çº¿ç¨‹, ä¸èƒ½ç”¨è¿›ç¨‹. </p>\n<ol>\n<li>ç®€è€Œè¨€ä¹‹, ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹, ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹.<ol>\n<li>çº¿ç¨‹çš„åˆ’åˆ†å°ºåº¦å°äºè¿›ç¨‹, ä½¿å¾—å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘æ€§é«˜. </li>\n<li>å¦å¤–, è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒ, è€Œå¤šä¸ªçº¿ç¨‹å…±äº«å†…å­˜, ä»è€Œæå¤§åœ°æé«˜äº†ç¨‹åºçš„è¿è¡Œæ•ˆç‡. </li>\n<li>çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸è¿›ç¨‹è¿˜æ˜¯æœ‰åŒºåˆ«çš„. æ¯ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æœ‰ä¸€ä¸ªç¨‹åºè¿è¡Œçš„å…¥å£, é¡ºåºæ‰§è¡Œåºåˆ—å’Œç¨‹åºçš„å‡ºå£. ä½†æ˜¯çº¿ç¨‹ä¸èƒ½å¤Ÿç‹¬ç«‹æ‰§è¡Œ, å¿…é¡»ä¾å­˜åœ¨åº”ç”¨ç¨‹åºä¸­, ç”±åº”ç”¨ç¨‹åºæä¾›å¤šä¸ªçº¿ç¨‹æ‰§è¡Œæ§åˆ¶. </li>\n<li>ä»é€»è¾‘è§’åº¦æ¥çœ‹, å¤šçº¿ç¨‹çš„æ„ä¹‰åœ¨äºä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­, æœ‰å¤šä¸ªæ‰§è¡Œéƒ¨åˆ†å¯ä»¥åŒæ—¶æ‰§è¡Œ. ä½†æ“ä½œç³»ç»Ÿå¹¶æ²¡æœ‰å°†å¤šä¸ªçº¿ç¨‹çœ‹åšå¤šä¸ªç‹¬ç«‹çš„åº”ç”¨, æ¥å®ç°è¿›ç¨‹çš„è°ƒåº¦å’Œç®¡ç†ä»¥åŠèµ„æºåˆ†é…. è¿™å°±æ˜¯è¿›ç¨‹å’Œçº¿ç¨‹çš„é‡è¦åŒºåˆ«.</li>\n</ol>\n</li>\n</ol>\n<p>æ‰“ä¸ªæ¯”æ–¹, å¤šè¿›ç¨‹å°±å¥½æ¯”åŒæ—¶æ‰§è¡Œå¤šä¸ªç¨‹åº. æ¯”å¦‚åŒæ—¶è¿è¡ŒQQ, éŸ³ä¹æ’­æ”¾å™¨, ä»¥åŠæµè§ˆå™¨. å¤šçº¿ç¨‹å°±æ˜¯åŒä¸€æ—¶åˆ»æ‰§è¡Œå¤šä¸ªçº¿ç¨‹, ç”¨æµè§ˆå™¨ä¸€è¾¹ä¸‹è½½, ä¸€è¾¹å¬æ­Œ, ä¸€è¾¹çœ‹è§†é¢‘, ä¸€è¾¹çœ‹ç½‘é¡µ. æµè§ˆå™¨è¿™ä¸ªè¿›ç¨‹ä¸‹æœ‰å¤šä¸ªçº¿ç¨‹, è¿™äº›çº¿ç¨‹å…±äº«ç³»ç»Ÿåˆ†é…ç»™æµè§ˆå™¨è¿™ä¸ªè¿›ç¨‹çš„èµ„æº, æ‰€ä»¥å„ä¸ªçº¿ç¨‹ä¹‹é—´å¯å¾ˆæ–¹ä¾¿çš„é€šä¿¡, ä¸€ä¸ªçº¿ç¨‹æ­»äº†, ä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹çš„è¿è¡Œ. å¦‚æœæµè§ˆå™¨è¿™ä¸ªè¿›ç¨‹æ­»äº†, é‚£ä¹ˆä»–ä¸‹é¢çš„æ‰€æœ‰çº¿ç¨‹å°±éƒ½ç”¨ä¸äº†äº†. æˆ‘ä»¬å¯ä»¥é€šè¿‡æµè§ˆå™¨æ‰“å¼€QQè¿™é‡Œå°±æ˜¯è¿›ç¨‹é—´é€šä¿¡, ç”±äºä¸åŒçš„è¿›ç¨‹ç³»ç»Ÿèµ„æºä¸åŒ, æ‰€ä»¥è¿›ç¨‹é—´çš„é€šä¿¡ä¸æ˜¯å¾ˆå®¹æ˜“å®ç°. å¹¶ä¸”åˆ‡æ¢è¿›ç¨‹ä¼šæœ‰æ€§èƒ½é—®é¢˜.</p>\n</li>\n<li><p>å¹¶å‘å’Œå¹¶è¡Œ</p>\n<p> å¹¶å‘æŒ‡èƒ½å¤Ÿè®©å¤šä¸ªä»»åŠ¡åœ¨é€»è¾‘ä¸Šäº¤ç»‡æ‰§è¡Œçš„ç¨‹åºè®¾è®¡, ä½†å¹¶å‘äº‹ä»¶ä¹‹é—´ä¸ä¸€å®šè¦åŒä¸€æ—¶åˆ»å‘ç”Ÿ. å¹¶è¡ŒæŒ‡çš„æ˜¯ç¨‹åºè¿è¡Œæ—¶çš„çŠ¶æ€æ˜¯ç‰©ç†ä¸ŠåŒæ—¶æ‰§è¡Œ, æ˜¯æŒ‡åŒæ—¶å‘ç”Ÿçš„ä¸¤ä¸ªå¹¶å‘äº‹ä»¶, å…·æœ‰å¹¶å‘çš„å«ä¹‰, è€Œå¹¶å‘åˆ™ä¸ä¸€å®šå¹¶è¡Œ. </p>\n<p> å¹¶å‘æ˜¯ä¸€ç§ç°è±¡, é¢å¯¹è¿™ä¸€ç°è±¡, æˆ‘ä»¬é¦–å…ˆåˆ›å»ºå¤šä¸ªçº¿ç¨‹. çœŸæ­£åŠ å¿«ç¨‹åºè¿è¡Œé€Ÿåº¦çš„, æ˜¯å¹¶è¡ŒæŠ€æœ¯. ä¹Ÿå°±æ˜¯è®©å¤šä¸ªCPUåŒæ—¶å·¥ä½œ. è€Œå¤šçº¿ç¨‹, æ˜¯ä¸ºäº†è®©å¤šä¸ªCPUåŒæ—¶å·¥ä½œæˆä¸ºå¯èƒ½. å¹¶å‘è®¾è®¡è®©å¹¶å‘æ‰§è¡Œæˆä¸ºå¯èƒ½, è€Œå¹¶è¡Œæ˜¯å¹¶å‘æ‰§è¡Œçš„ä¸€ç§æ¨¡å¼.</p>\n<p> å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«å°±æ˜¯ä¸€ä¸ªäººåŒæ—¶åƒä¸‰ä¸ªé¦’å¤´å’Œä¸‰ä¸ªäººåŒæ—¶åƒä¸‰ä¸ªé¦’å¤´. ä¸€ä¸ªäººåŒæ—¶åƒä¸‰ä¸ªé¦’å¤´ä½†æ˜¯åŒä¸€æ—¶é—´åªèƒ½å•ƒä¸€ä¸ªé¦’å¤´, ä¸‰ä¸ªäººåŒæ—¶åƒä¸‰ä¸ªé¦’å¤´, ä¸‰ä¸ªé¦’å¤´åŒä¸€æ—¶é—´éƒ½ä¼šè¢«å•ƒ.</p>\n<p> ä¸‹å›¾åæ˜ äº†ä¸€ä¸ªåŒ…å«8ä¸ªæ“ä½œçš„ä»»åŠ¡åœ¨ä¸€ä¸ªæœ‰ä¸¤æ ¸å¿ƒçš„CPUä¸­åˆ›å»ºå››ä¸ªçº¿ç¨‹è¿è¡Œçš„æƒ…å†µ. å‡è®¾æ¯ä¸ªæ ¸å¿ƒæœ‰ä¸¤ä¸ªçº¿ç¨‹, é‚£ä¹ˆæ¯ä¸ªCPUä¸­ä¸¤ä¸ªçº¿ç¨‹ä¼šäº¤æ›¿å¹¶å‘, ä¸¤ä¸ªCPUä¹‹é—´çš„æ“ä½œä¼šå¹¶è¡Œè¿ç®—. å°±CPU1è€Œè¨€è™½ç„¶å®ç°äº†å¹¶å‘ä½†æ˜¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªä»»åŠ¡åœ¨è¿›è¡Œ, CPUåªæ˜¯å¿«é€Ÿçš„åœ¨ä»»åŠ¡ä¹‹é—´åˆ‡æ¢, CPU1å’ŒCPU2æ•´ä½“æ¥çœ‹æ˜¯å¹¶è¡Œå…ƒç®—, åŒä¸€æ—¶é—´æ˜¯æœ‰å¤šä¸ªä»»åŠ¡åœ¨è¿›è¡Œ. å•å°±ä¸€ä¸ªCPUè€Œè¨€ä¸¤ä¸ªçº¿ç¨‹å¯ä»¥è§£å†³çº¿ç¨‹é˜»å¡é€ æˆçš„ä¸æµç•…é—®é¢˜, å…¶æœ¬èº«è¿è¡Œæ•ˆç‡å¹¶æ²¡æœ‰æé«˜. å¤šCPUçš„å¹¶è¡Œè¿ç®—æ‰çœŸæ­£è§£å†³äº†è¿è¡Œæ•ˆç‡é—®é¢˜, è¿™ä¹Ÿæ­£æ˜¯å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«. </p>\n<p> <img src=\"http://img.souche.com/f2e/5d7717afde012bbfc557f26bc5eaffea.png\" alt=\"å¹¶å‘å’Œå¹¶è¡Œ\"></p>\n<p> æ³¨æ„: å¹¶è¡Œå’Œä¸²è¡Œæ˜¯ç›¸å¯¹åº”çš„. ä¸²è¡Œåœ¨ç‰©ç†å±‚é¢ä¸ŠåŒä¸€æ—¶åˆ»åªä¼šæœ‰ä¸€ä¸ªä»»åŠ¡åœ¨è¿›è¡Œ.</p>\n</li>\n<li><p>åŒæ­¥å’Œå¼‚æ­¥</p>\n<p> åŒæ­¥åœ¨å‘å‡ºä¸€ä¸ªåŒæ­¥è°ƒç”¨æ—¶, åœ¨æ²¡æœ‰å¾—åˆ°ç»“æœä¹‹å‰, è¯¥è°ƒç”¨å°±ä¸è¿”å›. å¤šä¸ªä»»åŠ¡æƒ…å†µä¸‹, ä¸€ä¸ªä»»åŠ¡Aæ‰§è¡Œç»“æŸ, æ‰å¯ä»¥æ‰§è¡Œå¦ä¸€ä¸ªä»»åŠ¡B. åªå­˜åœ¨ä¸€ä¸ªçº¿ç¨‹. å¼‚æ­¥åœ¨å‘å‡ºä¸€ä¸ªå¼‚æ­¥è°ƒç”¨å, è°ƒç”¨è€…ä¸ä¼šç«‹åˆ»å¾—åˆ°ç»“æœ, è¯¥è°ƒç”¨å°±è¿”å›äº†. å¤šä¸ªä»»åŠ¡æƒ…å†µä¸‹, ä¸€ä¸ªä»»åŠ¡Aæ­£åœ¨æ‰§è¡Œ, åŒæ—¶å¯ä»¥æ‰§è¡Œå¦ä¸€ä¸ªä»»åŠ¡B. ä»»åŠ¡Bä¸ç”¨ç­‰å¾…ä»»åŠ¡Aç»“æŸæ‰æ‰§è¡Œ. å­˜åœ¨å¤šæ¡çº¿ç¨‹. </p>\n</li>\n</ol>\n<h2 id=\"å¤šçº¿ç¨‹å®ç°æ–¹æ¡ˆ\"><a href=\"#å¤šçº¿ç¨‹å®ç°æ–¹æ¡ˆ\" class=\"headerlink\" title=\"å¤šçº¿ç¨‹å®ç°æ–¹æ¡ˆ\"></a>å¤šçº¿ç¨‹å®ç°æ–¹æ¡ˆ</h2><p>åœ¨iOSå¼€å‘ä¸­å¸¸è§çš„å¤šçº¿ç¨‹æ–¹æ¡ˆä¸€å…±æœ‰4å¥—, åˆ†åˆ«æ˜¯<code>Pthreads</code>, <code>NSThread</code>, <code>GCD</code>, <code>NSOperation &amp; NSOperationQueue</code>. å‰ä¸¤ç§ä¸æ€ä¹ˆå¸¸ç”¨, è¿™é‡Œå°±ç®€å•çš„ä»‹ç»ä¸€ä¸‹, ç€é‡ä»‹ç»åä¸¤ç§. </p>\n<h3 id=\"Pthresds\"><a href=\"#Pthresds\" class=\"headerlink\" title=\"Pthresds\"></a>Pthresds</h3><p>POSIXçº¿ç¨‹(POSIX threads), ç®€ç§°Pthreads, æ˜¯çº¿ç¨‹çš„POSIXæ ‡å‡†. è¯¥æ ‡å‡†å®šä¹‰äº†åˆ›å»ºå’Œæ“çºµçº¿ç¨‹çš„ä¸€æ•´å¥—API, åœ¨ç±»Unixæ“ä½œç³»ç»Ÿ(Unixã€Linuxã€Mac OSXç­‰)ä¸­, éƒ½ä½¿ç”¨Pthreadsä½œä¸ºæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹. é‚£ä¹Ÿå°±æ„å‘³ç€å¯ä»¥è·¨å¹³å°ä½¿ç”¨, ä½†æ˜¯ä½¿ç”¨èµ·æ¥ç‰¹åˆ«é…¸çˆ½. ğŸ™‚</p>\n<pre><code>#import &lt;pthread.h&gt;\n\n- (void)pthreadsDoTask {\n    /*\n     pthread_tï¼šçº¿ç¨‹æŒ‡é’ˆ\n     pthread_attr_tï¼šçº¿ç¨‹å±æ€§\n     pthread_mutex_tï¼šäº’æ–¥å¯¹è±¡\n     pthread_mutexattr_tï¼šäº’æ–¥å±æ€§å¯¹è±¡\n     pthread_cond_tï¼šæ¡ä»¶å˜é‡\n     pthread_condattr_tï¼šæ¡ä»¶å±æ€§å¯¹è±¡\n     pthread_key_tï¼šçº¿ç¨‹æ•°æ®é”®\n     pthread_rwlock_tï¼šè¯»å†™é”\n     //\n     pthread_create()ï¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹\n     pthread_exit()ï¼šç»ˆæ­¢å½“å‰çº¿ç¨‹\n     pthread_cancel()ï¼šä¸­æ–­å¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„è¿è¡Œ\n     pthread_join()ï¼šé˜»å¡å½“å‰çš„çº¿ç¨‹, ç›´åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹è¿è¡Œç»“æŸ\n     pthread_attr_init()ï¼šåˆå§‹åŒ–çº¿ç¨‹çš„å±æ€§\n     pthread_attr_setdetachstate()ï¼šè®¾ç½®è„±ç¦»çŠ¶æ€çš„å±æ€§ï¼ˆå†³å®šè¿™ä¸ªçº¿ç¨‹åœ¨ç»ˆæ­¢æ—¶æ˜¯å¦å¯ä»¥è¢«ç»“åˆï¼‰\n     pthread_attr_getdetachstate()ï¼šè·å–è„±ç¦»çŠ¶æ€çš„å±æ€§\n     pthread_attr_destroy()ï¼šåˆ é™¤çº¿ç¨‹çš„å±æ€§\n     pthread_kill()ï¼šå‘çº¿ç¨‹å‘é€ä¸€ä¸ªä¿¡å·\n     pthread_equal(): å¯¹ä¸¤ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ ‡è¯†å·è¿›è¡Œæ¯”è¾ƒ\n     pthread_detach(): åˆ†ç¦»çº¿ç¨‹\n     pthread_self(): æŸ¥è¯¢çº¿ç¨‹è‡ªèº«çº¿ç¨‹æ ‡è¯†å·\n     //\n     *åˆ›å»ºçº¿ç¨‹\n     int pthread_create(pthread_t _Nullable * _Nonnull __restrict, //æŒ‡å‘æ–°å»ºçº¿ç¨‹æ ‡è¯†ç¬¦çš„æŒ‡é’ˆ\n     const pthread_attr_t * _Nullable __restrict,  //è®¾ç½®çº¿ç¨‹å±æ€§. é»˜è®¤å€¼NULL. \n     void * _Nullable (* _Nonnull)(void * _Nullable),  //è¯¥çº¿ç¨‹è¿è¡Œå‡½æ•°çš„åœ°å€\n     void * _Nullable __restrict);  //è¿è¡Œå‡½æ•°æ‰€éœ€çš„å‚æ•°\n     *è¿”å›å€¼ï¼š\n     *è‹¥çº¿ç¨‹åˆ›å»ºæˆåŠŸ, åˆ™è¿”å›0\n     *è‹¥çº¿ç¨‹åˆ›å»ºå¤±è´¥, åˆ™è¿”å›å‡ºé”™ç¼–å·\n     */\n\n    //\n    pthread_t thread = NULL;\n    NSString *params = @&quot;Hello World&quot;;\n    int result = pthread_create(&amp;thread, NULL, threadTask, (__bridge void *)(params));\n    result == 0 ? NSLog(@&quot;creat thread success&quot;) : NSLog(@&quot;creat thread failure&quot;);\n    //è®¾ç½®å­çº¿ç¨‹çš„çŠ¶æ€è®¾ç½®ä¸ºdetached,åˆ™è¯¥çº¿ç¨‹è¿è¡Œç»“æŸåä¼šè‡ªåŠ¨é‡Šæ”¾æ‰€æœ‰èµ„æº\n    pthread_detach(thread);\n}\n\nvoid *threadTask(void *params) {\n    NSLog(@&quot;%@ - %@&quot;, [NSThread currentThread], (__bridge NSString *)(params));\n    return NULL;\n}\n</code></pre><p>çœ‹ä¸‹è¿™äº›APIè®¾è®¡å¯ä»¥è¯´æ˜¯ç›¸å½“ä¸å‹å¥½, å¹¶ä¸”éœ€è¦æ‰‹åŠ¨ç®¡ç†çº¿ç¨‹çš„å„ä¸ªçŠ¶æ€çš„è½¬æ¢å’Œç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†.</p>\n<h3 id=\"NSThread\"><a href=\"#NSThread\" class=\"headerlink\" title=\"NSThread\"></a>NSThread</h3><p><code>NSThread</code>çš„APIè®¾è®¡å¤§è‡´å¦‚ä¸‹: </p>\n<pre><code>@interface NSThread : NSObject\n//å½“å‰çº¿ç¨‹\n@property (class, readonly, strong) NSThread *currentThread;\n//ä½¿ç”¨ç±»æ–¹æ³•åˆ›å»ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡\n+ (void)detachNewThreadWithBlock:(void (^)(void))block API_AVAILABLE(macosx(10.12), ios(10.0), watchos(3.0), tvos(10.0));\n+ (void)detachNewThreadSelector:(SEL)selector toTarget:(id)target withObject:(nullable id)argument;\n//åˆ¤æ–­å½“å‰æ˜¯å¦ä¸ºå¤šçº¿ç¨‹\n+ (BOOL)isMultiThreaded;\n//æŒ‡å®šçº¿ç¨‹çš„çº¿ç¨‹å‚æ•°, ä¾‹å¦‚è®¾ç½®å½“å‰çº¿ç¨‹çš„æ–­è¨€å¤„ç†å™¨. \n@property (readonly, retain) NSMutableDictionary *threadDictionary;\n//å½“å‰çº¿ç¨‹æš‚åœåˆ°æŸä¸ªæ—¶é—´\n+ (void)sleepUntilDate:(NSDate *)date;\n//å½“å‰çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´\n+ (void)sleepForTimeInterval:(NSTimeInterval)ti;\n//é€€å‡ºå½“å‰çº¿ç¨‹\n+ (void)exit;\n//å½“å‰çº¿ç¨‹ä¼˜å…ˆçº§\n+ (double)threadPriority;\n//è®¾ç½®å½“å‰çº¿ç¨‹ä¼˜å…ˆçº§\n+ (BOOL)setThreadPriority:(double)p;\n//æŒ‡å®šçº¿ç¨‹å¯¹è±¡ä¼˜å…ˆçº§ 0.0ï½1.0, é»˜è®¤å€¼ä¸º0.5\n@property double threadPriority NS_AVAILABLE(10_6, 4_0);\n//æœåŠ¡è´¨é‡\n@property NSQualityOfService qualityOfService NS_AVAILABLE(10_10, 8_0);\n//çº¿ç¨‹åç§°\n@property (nullable, copy) NSString *name NS_AVAILABLE(10_5, 2_0);\n//æ ˆåŒºå¤§å°\n@property NSUInteger stackSize NS_AVAILABLE(10_5, 2_0);\n//æ˜¯å¦ä¸ºä¸»çº¿ç¨‹\n@property (class, readonly) BOOL isMainThread NS_AVAILABLE(10_5, 2_0);\n//è·å–ä¸»çº¿ç¨‹\n@property (class, readonly, strong) NSThread *mainThread NS_AVAILABLE(10_5, 2_0);\n//åˆå§‹åŒ–\n- (instancetype)init NS_AVAILABLE(10_5, 2_0) NS_DESIGNATED_INITIALIZER;\n//å®ä¾‹æ–¹æ³•åˆå§‹åŒ–, éœ€è¦å†è°ƒç”¨startæ–¹æ³•\n- (instancetype)initWithTarget:(id)target selector:(SEL)selector object:(nullable id)argument NS_AVAILABLE(10_5, 2_0);\n- (instancetype)initWithBlock:(void (^)(void))block API_AVAILABLE(macosx(10.12), ios(10.0), watchos(3.0), tvos(10.0));\n//çº¿ç¨‹çŠ¶æ€, æ­£åœ¨æ‰§è¡Œ\n@property (readonly, getter=isExecuting) BOOL executing NS_AVAILABLE(10_5, 2_0);\n//çº¿ç¨‹çŠ¶æ€, æ­£åœ¨å®Œæˆ\n@property (readonly, getter=isFinished) BOOL finished NS_AVAILABLE(10_5, 2_0);\n//çº¿ç¨‹çŠ¶æ€, å·²ç»å–æ¶ˆ\n@property (readonly, getter=isCancelled) BOOL cancelled NS_AVAILABLE(10_5, 2_0);\n//å–æ¶ˆ, ä»…ä»…æ”¹å˜çº¿ç¨‹çŠ¶æ€, å¹¶ä¸èƒ½åƒexistä¸€æ ·çœŸæ­£çš„ç»ˆæ­¢çº¿ç¨‹\n- (void)cancel NS_AVAILABLE(10_5, 2_0);\n//å¼€å§‹\n- (void)start NS_AVAILABLE(10_5, 2_0);\n//çº¿ç¨‹éœ€è¦æ‰§è¡Œçš„ä»£ç , ä¸€èˆ¬å†™å­ç±»çš„æ—¶å€™ä¼šç”¨åˆ°\n- (void)main NS_AVAILABLE(10_5, 2_0);\n@end\n\nè¿˜æœ‰ä¸€ä¸ªNSObjectçš„åˆ†ç±»\n@interface NSObject (NSThreadPerformAdditions)\n//éšå¼çš„åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹, å¹¶åœ¨æŒ‡å®šçš„çº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹æˆ–å­çº¿ç¨‹ï¼‰ä¸Šæ‰§è¡Œæ–¹æ³•. \n- (void)performSelectorOnMainThread:(SEL)aSelector withObject:(nullable id)arg waitUntilDone:(BOOL)wait modes:(nullable NSArray&lt;NSString *&gt; *)array;\n- (void)performSelectorOnMainThread:(SEL)aSelector withObject:(nullable id)arg waitUntilDone:(BOOL)wait;\n- (void)performSelector:(SEL)aSelector onThread:(NSThread *)thr withObject:(nullable id)arg waitUntilDone:(BOOL)wait modes:(nullable NSArray&lt;NSString *&gt; *)array NS_AVAILABLE(10_5, 2_0);\n- (void)performSelector:(SEL)aSelector onThread:(NSThread *)thr withObject:(nullable id)arg waitUntilDone:(BOOL)wait NS_AVAILABLE(10_5, 2_0);\n- (void)performSelectorInBackground:(SEL)aSelector withObject:(nullable id)arg NS_AVAILABLE(10_5, 2_0);\n@end\n</code></pre><p>å¸¸è§çš„ç”¨æ³•æœ‰ä»¥ä¸‹å‡ ç§: </p>\n<pre><code>- (void) startThread {\n\n    //åˆ›å»ºå¹¶ä¸”æ‰‹åŠ¨å¯åŠ¨\n    NSThread *thread = [[NSThread alloc] initWithTarget:self selector:@selector(run) object:nil];\n    [thread start];\n\n    //ç±»æ–¹æ³•åˆ›å»ºå¹¶ä¸”è‡ªåŠ¨å¯åŠ¨\n    [NSThread detachNewThreadSelector:@selector(run) toTarget:self withObject:nil];\n\n    //é€šè¿‡NSObjectçš„æ–¹æ³•è‡ªåŠ¨å¯åŠ¨\n    [self performSelectorInBackground:@selector(run) withObject:nil];\n}    \n\n- (void)run {\n    NSLog(@&quot;%@&quot;, [NSThread currentThread]);\n}\n</code></pre><h3 id=\"GCD\"><a href=\"#GCD\" class=\"headerlink\" title=\"GCD\"></a>GCD</h3><p>Grand Central Dispatch, å®ƒæ˜¯è‹¹æœä¸ºå¤šæ ¸çš„å¹¶è¡Œè¿ç®—æå‡ºçš„è§£å†³æ–¹æ¡ˆ, ä¼šè‡ªåŠ¨åˆç†åœ°åˆ©ç”¨æ›´å¤šçš„CPUå†…æ ¸(æ¯”å¦‚åŒæ ¸ã€å››æ ¸), æœ€é‡è¦çš„æ˜¯å®ƒä¼šè‡ªåŠ¨ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ(åˆ›å»ºçº¿ç¨‹ã€è°ƒåº¦ä»»åŠ¡ã€é”€æ¯çº¿ç¨‹), å®Œå…¨ä¸éœ€è¦æˆ‘ä»¬ç®¡ç†, æˆ‘ä»¬åªéœ€è¦å‘Šè¯‰å¹²ä»€ä¹ˆå°±è¡Œ. åŒæ—¶å®ƒä½¿ç”¨çš„ä¹Ÿæ˜¯Cè¯­è¨€, ä¸è¿‡ç”±äºä½¿ç”¨äº†Block(Swifté‡Œå«åšé—­åŒ…), ä½¿å¾—ä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿, è€Œä¸”çµæ´».</p>\n<p>äº†è§£GCDæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸¤ä¸ªæ¦‚å¿µ, <strong><code>é˜Ÿåˆ—</code></strong>å’Œ<strong><code>ä»»åŠ¡</code></strong>.</p>\n<ol>\n<li><p>ä»»åŠ¡</p>\n<p> è¦æ‰§è¡Œçš„æ“ä½œæˆ–æ–¹æ³•å‡½æ•°. åœ¨GCDä¸­æŒ‡çš„å°±æ˜¯blockå—, åœ¨NSThreadä¸­æŒ‡çš„æ˜¯<code>performSelector:</code>ä¸­çš„æ–¹æ³•. åŠ å…¥ä»»åŠ¡æ—¶æœ‰ä¸¤ç§å½¢å¼: <code>åŒæ­¥ä»»åŠ¡(dispatch_sync)</code>å’Œ<code>å¼‚æ­¥ä»»åŠ¡(dispatch_async)</code>.</p>\n<ol>\n<li>åŒæ­¥ä»»åŠ¡: ä¸ä¼šå¼€å¯æ–°çš„çº¿ç¨‹, ä¼šé˜»å¡å½“å‰çº¿ç¨‹. å®Œæˆéœ€è¦åšçš„ä»»åŠ¡åæ‰ä¼šè¿”å›, è¿›è¡Œä¸‹ä¸€ä»»åŠ¡. åˆ›å»ºæ–¹å¼ä¸º:<pre><code>  //æŠŠå³è¾¹çš„å‚æ•°(ä»»åŠ¡)æäº¤ç»™å·¦è¾¹çš„å‚æ•°(é˜Ÿåˆ—)è¿›è¡Œæ‰§è¡Œ\n  dispatch_sync(dispatch_queue_t queue, dispatch_block_t block);\n</code></pre></li>\n<li><p>å¼‚æ­¥ä»»åŠ¡: ä¸ä¼šç­‰å¾…ä»»åŠ¡å®Œæˆæ‰è¿”å›, ä¼šç«‹å³è¿”å›. å¼‚æ­¥æ˜¯å¤šçº¿ç¨‹çš„ä»£åè¯, å› ä¸ºå¿…å®šä¼šå¼€å¯æ–°çš„çº¿ç¨‹, çº¿ç¨‹çš„ç”³è¯·æ˜¯ç”±å¼‚æ­¥è´Ÿè´£, èµ·åˆ°å¼€åˆ†æ”¯çš„ä½œç”¨. åˆ›å»ºæ–¹å¼ä¸º:</p>\n<pre><code>  //æŠŠå³è¾¹çš„å‚æ•°(ä»»åŠ¡)æäº¤ç»™å·¦è¾¹çš„å‚æ•°(é˜Ÿåˆ—)è¿›è¡Œæ‰§è¡Œ\n  dispatch_async(dispatch_queue_t queue, dispatch_block_t block);\n</code></pre></li>\n</ol>\n</li>\n<li><p>é˜Ÿåˆ—</p>\n<p> å­˜æ”¾ä»»åŠ¡çš„é›†åˆ, æˆ‘ä»¬è¦åšçš„å°±æ˜¯å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ç„¶åæ‰§è¡Œ, GCDä¼šè‡ªåŠ¨å°†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æŒ‰å…ˆè¿›å…ˆå‡ºçš„æ–¹å¼å–å‡º. é˜Ÿåˆ—ä¸»è¦æœ‰çš„æœ‰<code>ä¸²è¡Œé˜Ÿåˆ—(Serial Dispatch Queue)</code>, <code>å¹¶è¡Œé˜Ÿåˆ—(Concurrent Dispatch Queue)</code>, <code>å…¨å±€é˜Ÿåˆ—(Global Queue)</code>å’Œ<code>ä¸»é˜Ÿåˆ—(Main Queue)</code>.</p>\n<ol>\n<li><p>ä¸²è¡Œé˜Ÿåˆ—: ä»»åŠ¡ä¾æ¬¡æ‰§è¡Œ, åŒä¸€æ—¶é—´é˜Ÿåˆ—ä¸­åªæœ‰ä¸€ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œ, æ¯ä¸ªä»»åŠ¡åªæœ‰åœ¨å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåæ‰èƒ½å¼€å§‹æ‰§è¡Œ. ä½ ä¸çŸ¥é“åœ¨ä¸€ä¸ªBlock(ä»»åŠ¡)æ‰§è¡Œç»“æŸåˆ°ä¸‹ä¸€ä¸ªBlock(ä»»åŠ¡)å¼€å§‹æ‰§è¡Œä¹‹é—´çš„è¿™æ®µæ—¶é—´æ—¶é—´æ˜¯å¤šé•¿, è¿™éƒ¨åˆ†æ˜¯ç”±GCDæ§åˆ¶. åˆ›å»ºæ–¹å¼ä¸º:</p>\n<pre><code>  //åˆ›å»ºä¸€ä¸ªåä¸ºqueueçš„ä¸²è¡Œé˜Ÿåˆ—\n  //ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºé˜Ÿåˆ—åç§°\n  //ç¬¬äºŒä¸ªå‚æ•°ä¸ºé˜Ÿåˆ—ç±»å‹, DISPATCH_QUEUE_SERIALå’ŒNULLè¡¨ç¤ºä¸²è¡Œé˜Ÿåˆ—\n  dispatch_queue_t queue = dispatch_queue_create(&quot;com.private.SerialQueue&quot;, DISPATCH_QUEUE_SERIAL);\n</code></pre></li>\n<li><p>å¹¶è¡Œé˜Ÿåˆ—: ä»»åŠ¡å¹¶å‘æ‰§è¡Œ, å”¯ä¸€èƒ½ä¿è¯çš„æ˜¯, è¿™äº›ä»»åŠ¡ä¼šæŒ‰ç…§è¢«æ·»åŠ çš„é¡ºåºå¼€å§‹æ‰§è¡Œ. ä½†æ˜¯ä»»åŠ¡å¯ä»¥ä»¥ä»»ä½•é¡ºåºå®Œæˆ, ä½ ä¸çŸ¥é“åœ¨æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡æ˜¯ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹, æˆ–è€…è¯´ä»»æ„æ—¶åˆ»æœ‰å¤šä¸ªBlock(ä»»åŠ¡)è¿è¡Œ, è¿™ä¸ªå®Œå…¨æ˜¯å–å†³äºGCD. GCDé»˜è®¤å·²ç»æä¾›äº†å…¨å±€çš„å¹¶å‘é˜Ÿåˆ—, ä¾›æ•´ä¸ªåº”ç”¨ä½¿ç”¨, ä¸€èˆ¬ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»ºåˆ›å»ºæ–¹å¼ä¸º:</p>\n<pre><code>  //åˆ›å»ºä¸€ä¸ªåä¸ºqueueçš„å¹¶è¡Œé˜Ÿåˆ—\n  //ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºé˜Ÿåˆ—åç§°\n  //ç¬¬äºŒä¸ªå‚æ•°ä¸ºé˜Ÿåˆ—ç±»å‹, DISPATCH_QUEUE_CONCURRENTè¡¨ç¤ºå¹¶è¡Œé˜Ÿåˆ—\n  dispatch_queue_t queue = dispatch_queue_create(&quot;com.private.ConcurrentQueue&quot;,DISPATCH_QUEUE_CONCURRENT);\n</code></pre></li>\n<li><p>å…¨å±€é˜Ÿåˆ—: <strong>éš¶å±äºå¹¶è¡Œé˜Ÿåˆ—</strong>, ä¸è¦ä¸ barrier æ …æ æ–¹æ³•æ­é…ä½¿ç”¨, barrier åªæœ‰ä¸è‡ªå®šä¹‰çš„å¹¶è¡Œé˜Ÿåˆ—ä¸€èµ·ä½¿ç”¨, æ‰èƒ½è®© barrier è¾¾åˆ°æˆ‘ä»¬æ‰€æœŸæœ›çš„æ …æ åŠŸèƒ½. ä¸ä¸²è¡Œé˜Ÿåˆ—æˆ–è€…globalé˜Ÿåˆ— ä¸€èµ·ä½¿ç”¨, barrierçš„è¡¨ç°ä¼šå’Œdispatch_syncæ–¹æ³•ä¸€æ ·. åˆ›å»ºæ–¹å¼ä¸º:</p>\n<pre><code>  //è·å–ç³»ç»Ÿå…¨å±€é˜Ÿåˆ—, å¹¶èµ‹å€¼ç»™é˜Ÿåˆ—queue\n  //ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºä¼˜å…ˆçº§, è¿™é‡Œæ˜¯æ–°è€ä¼˜å…ˆçº§çš„å¯¹ç…§Map\n*  - DISPATCH_QUEUE_PRIORITY_HIGH:         QOS_CLASS_USER_INITIATED//é«˜\n*  - DISPATCH_QUEUE_PRIORITY_DEFAULT:      QOS_CLASS_DEFAULT//é»˜è®¤\n*  - DISPATCH_QUEUE_PRIORITY_LOW:          QOS_CLASS_UTILITY//ä½\n*  - DISPATCH_QUEUE_PRIORITY_BACKGROUND:   QOS_CLASS_BACKGROUND//åå°\n\n//ç¬¬äºŒä¸ªå‚æ•°æ˜¯é¢„ç•™å‚æ•°, ä¼ 0å°±å¥½\ndispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n</code></pre></li>\n<li><p>ä¸»é˜Ÿåˆ—: <strong>éš¶å±äºä¸²è¡Œé˜Ÿåˆ—</strong>, ä¸èƒ½ä¸syncåŒæ­¥æ–¹æ³•æ­é…ä½¿ç”¨, ä¼šé€ æˆæ­»å¾ªç¯. ä¸»é˜Ÿåˆ—æ˜¯GCDè‡ªå¸¦çš„ä¸€ç§ç‰¹æ®Šçš„ä¸²è¡Œé˜Ÿåˆ—, æ”¾åœ¨ä¸»é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡, éƒ½ä¼šæ”¾åˆ°ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ. åˆ›å»ºæ–¹å¼ä¸º:</p>\n<pre><code>  //è·å–ç³»ç»Ÿä¸»é˜Ÿåˆ—, å¹¶èµ‹å€¼ç»™é˜Ÿåˆ—queue\n  dispatch_queue_t queue = dispatch_get_main_queue();\n</code></pre></li>\n</ol>\n</li>\n</ol>\n<p>ä¸ç®¡æ˜¯ä¸²è¡Œé˜Ÿåˆ—(SerialQueue)è¿˜æ˜¯å¹¶è¡Œé˜Ÿåˆ—(ConcurrencyQueue), éƒ½æ˜¯FIFOé˜Ÿåˆ—. ä¹Ÿå°±æ„å‘³ç€, ä»»åŠ¡ä¸€å®šæ˜¯ä¸€ä¸ªä¸€ä¸ªåœ°, æŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„é¡ºåºæ¥æ‰§è¡Œ.</p>\n<h3 id=\"NSOperation-amp-NSOperationQueue\"><a href=\"#NSOperation-amp-NSOperationQueue\" class=\"headerlink\" title=\"NSOperation &amp; NSOperationQueue\"></a>NSOperation &amp; NSOperationQueue</h3><p><code>NSOperation</code> æ˜¯è‹¹æœå…¬å¸å¯¹<code>GCD</code>çš„å°è£…, å®Œå…¨é¢å‘å¯¹è±¡, æ‰€ä»¥ä½¿ç”¨èµ·æ¥æ›´å¥½ç†è§£. å¤§å®¶å¯ä»¥çœ‹åˆ° <code>NSOperation</code>å’Œ<code>NSOperationQueue</code>åˆ†åˆ«å¯¹åº”<code>GCD</code>çš„<strong>ä»»åŠ¡</strong>å’Œ<strong>é˜Ÿåˆ—</strong>. æ‰€ä»¥ä»–çš„æ“ä½œæ­¥éª¤å’Œ<code>GCD</code>ç±»ä¼¼: é¦–å…ˆå°†è¦æ‰§è¡Œçš„ä»»åŠ¡å°è£…åˆ°ä¸€ä¸ª<code>NSOperation</code>å¯¹è±¡ä¸­. ç„¶åå°†æ­¤ä»»åŠ¡æ·»åŠ åˆ°ä¸€ä¸ª<code>NSOperationQueue</code>å¯¹è±¡ä¸­, ç„¶åç³»ç»Ÿå°±ä¼šè‡ªåŠ¨åœ¨æ‰§è¡Œä»»åŠ¡.</p>\n<ol>\n<li><p><code>NSOperation</code>ä¸»è¦æœ‰ä¸€ä¸‹è¿™äº›å±æ€§å’Œæ–¹æ³•. </p>\n<pre><code>  â€‹```\n @interface NSOperation : NSObject {\n @private\n     id _private;\n     int32_t _private1;\n #if __LP64__\n     int32_t _private1b;\n #endif\n }\n\n - (void)start;//å¯åŠ¨ä»»åŠ¡ é»˜è®¤åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œ\n - (void)main;//è‡ªå®šä¹‰NSOperationï¼Œå†™ä¸€ä¸ªå­ç±»ï¼Œé‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢æ·»åŠ éœ€è¦æ‰§è¡Œçš„æ“ä½œã€‚\n\n @property (readonly, getter=isCancelled) BOOL cancelled;//æ˜¯å¦å·²ç»å–æ¶ˆï¼Œåªè¯»\n - (void)cancel;//å–æ¶ˆä»»åŠ¡\n\n @property (readonly, getter=isExecuting) BOOL executing;//æ­£åœ¨æ‰§è¡Œï¼Œåªè¯»\n @property (readonly, getter=isFinished) BOOL finished;//æ‰§è¡Œç»“æŸï¼Œåªè¯»\n @property (readonly, getter=isConcurrent) BOOL concurrent; // To be deprecated; use and override &#39;asynchronous&#39; below\n @property (readonly, getter=isAsynchronous) BOOL asynchronous NS_AVAILABLE(10_8, 7_0);//æ˜¯å¦å¹¶å‘ï¼Œåªè¯»\n @property (readonly, getter=isReady) BOOL ready;//å‡†å¤‡æ‰§è¡Œ\n\n - (void)addDependency:(NSOperation *)op;//æ·»åŠ ä¾èµ–\n - (void)removeDependency:(NSOperation *)op;//ç§»é™¤ä¾èµ–\n\n @property (readonly, copy) NSArray&lt;NSOperation *&gt; *dependencies;//æ‰€æœ‰ä¾èµ–å…³ç³»ï¼Œåªè¯»\n\n typedef NS_ENUM(NSInteger, NSOperationQueuePriority) {\n     NSOperationQueuePriorityVeryLow = -8L,\n     NSOperationQueuePriorityLow = -4L,\n     NSOperationQueuePriorityNormal = 0,\n     NSOperationQueuePriorityHigh = 4,\n     NSOperationQueuePriorityVeryHigh = 8\n };//ç³»ç»Ÿæä¾›çš„ä¼˜å…ˆçº§å…³ç³»æšä¸¾\n\n @property NSOperationQueuePriority queuePriority;//æ‰§è¡Œä¼˜å…ˆçº§\n\n @property (nullable, copy) void (^completionBlock)(void) NS_AVAILABLE(10_6, 4_0);//ä»»åŠ¡æ‰§è¡Œå®Œæˆä¹‹åçš„å›è°ƒ\n\n - (void)waitUntilFinished NS_AVAILABLE(10_6, 4_0);//é˜»å¡å½“å‰çº¿ç¨‹ï¼Œç­‰åˆ°æŸä¸ªoperationæ‰§è¡Œå®Œæ¯•ã€‚\n\n @property double threadPriority NS_DEPRECATED(10_6, 10_10, 4_0, 8_0);//å·²åºŸå¼ƒï¼Œç”¨qualityOfServiceæ›¿ä»£ã€‚\n\n @property NSQualityOfService qualityOfService NS_AVAILABLE(10_10, 8_0);//æœåŠ¡è´¨é‡ï¼Œä¸€ä¸ªé«˜è´¨é‡çš„æœåŠ¡å°±æ„å‘³ç€æ›´å¤šçš„èµ„æºå¾—ä»¥æä¾›æ¥æ›´å¿«çš„å®Œæˆæ“ä½œã€‚\n\n @property (nullable, copy) NSString *name NS_AVAILABLE(10_10, 8_0);//ä»»åŠ¡åç§°\n\n @end\n â€‹```\n</code></pre><p> ç”±äº<code>NSOperation</code>æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±», ä¸èƒ½ç›´æ¥ä½¿ç”¨, åœ¨è¿™é‡Œæˆ‘ä¹ˆä½ ä¸€èˆ¬ä½¿ç”¨<code>NSOperation</code>çš„ä¸¤ä¸ªå­ç±»<code>NSInvocationOperation</code>å’Œ<code>NSBlockOperation</code>, æˆ–è€…<code>NSOperationçš„è‡ªå®šä¹‰å­ç±»</code>:</p>\n<pre><code> 1. `NSInvocationOperation`åŸºäºåº”ç”¨çš„ä¸€ä¸ªtargetå¯¹è±¡å’Œselectoræ¥åˆ›å»ºoperation object. å¦‚æœä½ å·²ç»æœ‰ç°æœ‰çš„æ–¹æ³•æ¥æ‰§è¡Œéœ€è¦çš„ä»»åŠ¡, å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªç±». ä½¿ç”¨æ–¹å¼å¤§è‡´å¦‚ä¸‹: \n\n ```\n - (void)NSInvocationOperationRun {\n     NSInvocationOperation *invocationOper = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(invocationOperSel) object:nil];\n     [invocationOper start];\n }\n - (void)invocationOperSel {\n     NSLog(@&quot;NSInvocationOperationRun_%@&quot;, [NSThread currentThread]);\n }\n ```\n</code></pre><p> ä»æ‰“å°ç»“æœå¯ä»¥çœ‹å‡º, è¯¥å®ç°æ–¹å¼æ˜¯åŒæ­¥é¡ºåºæ‰§è¡Œ.</p>\n<pre><code> 2.  `NSBlockOperation`ç”¨æ¥å¹¶å‘åœ°æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªblockå¯¹è±¡. operation objectä½¿ç”¨**ç»„**çš„è¯­ä¹‰æ¥æ‰§è¡Œå¤šä¸ªblockå¯¹è±¡ï¼Œæ‰€æœ‰ç›¸å…³çš„ block éƒ½æ‰§è¡Œå®Œæˆä¹‹å, operation objectæ‰ç®—å®Œæˆ. ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹\n\n      ```\n      //ç³»ç»Ÿæä¾›çš„API\n      @interface NSBlockOperation : NSOperation {\n      @private\n          id _private2;\n          void *_reserved2;\n      }\n\n     + (instancetype)blockOperationWithBlock:(void (^)(void))block;//åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œ\n\n     - (void)addExecutionBlock:(void (^)(void))block;//æ–°å¼€çº¿ç¨‹æ‰§è¡Œ\n     @property (readonly, copy) NSArray&lt;void (^)(void)&gt; *executionBlocks;\n\n     @end\n      ```\n\n ä½¿ç”¨`NSBlockOperation`ç±»æ–¹æ³•åˆ›å»ºä»»åŠ¡, ä»æ‰“å°ç»“æœå¯ä»¥çœ‹å‡ºæ¥è¯¥ä»»åŠ¡æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„\n\n     ```\n     - (void)NSBlockOperationRun {\n         NSBlockOperation *blockOper = [NSBlockOperation blockOperationWithBlock:^{\n             NSLog(@&quot;NSBlockOperationRun_%@_%@&quot;, [NSOperationQueue currentQueue], [NSThread currentThread]);\n         }];\n         [blockOper start];\n     }\n     ```\n\n ä½¿ç”¨`NBlockOperation`çš„å®ä¾‹æ–¹æ³•åˆ›å»ºä»»åŠ¡, ä»æ‰“å°ç»“æœå¯ä»¥çœ‹å‡ºæ¥, ç¬¬ä¸€ä¸ªä»»åŠ¡æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ, å…¶ä»–ä»»åŠ¡å‡æ˜¯æ–°å¼€çš„çº¿ç¨‹, æ‰€æœ‰çš„ä»»åŠ¡æ˜¯ä»¥å¼‚æ­¥å¹¶å‘çš„å½¢å¼æ‰§è¡Œ. \n\n     ```\n     - (void)NSBlockOperationRun {\n         NSBlockOperation *blockOper = [NSBlockOperation blockOperationWithBlock:^{\n             NSLog(@&quot;NSBlockOperationRun_1_%@&quot;, [NSThread currentThread]);\n         }];\n         [blockOper addExecutionBlock:^{\n             NSLog(@&quot;NSBlockOperationRun_2_%@&quot;, [NSThread currentThread]);\n         }];\n         [blockOper addExecutionBlock:^{\n             NSLog(@&quot;NSBlockOperationRun_3_%@&quot;, [NSThread currentThread]);\n         }];\n         [blockOper addExecutionBlock:^{\n             NSLog(@&quot;NSBlockOperationRun_4_%@&quot;, [NSThread currentThread]);\n         }];\n         [blockOper start];\n     }\n     ```\n\n 3. `NSOperationçš„è‡ªå®šä¹‰å­ç±»`. \n\n     ```        \n     åœ¨å­ç±»ä¸­é‡å†™çˆ¶ç±»çš„`-(void)main`å‡½æ•°, åœ¨é‡Œé¢å®ç°ä¸»è¦é€»è¾‘\n     ```\n</code></pre><p>  <code>NSBlockOperation</code>, <code>NSBlockOperationRun</code>æˆ–è€…<code>NSOperationçš„è‡ªå®šä¹‰å­ç±»</code>åˆ›å»ºçš„operation objectéƒ½å¯ä»¥ä½¿ç”¨<code>NSOperation</code>çš„æ‰€æœ‰å±æ€§, æ„å‘³ç€ä»–ä»¬å…·æœ‰ä»¥ä¸‹ä¸»è¦ç‰¹æ€§: </p>\n<ol>\n<li>å¤šä¸ªä»»åŠ¡ä¹‹é—´å¯ä»¥ä½¿ç”¨æœ‰ä¾èµ–å…³ç³»</li>\n<li>å¯ä»¥è·å¾—Operation objectä»»åŠ¡æ‰§è¡Œå®Œæˆä¹‹åçš„å›è°ƒ</li>\n<li>æ”¯æŒåº”ç”¨ä½¿ç”¨ KVO é€šçŸ¥æ¥ç›‘æ§ operation çš„æ‰§è¡ŒçŠ¶æ€</li>\n<li>å¯ä»¥é€šè¿‡operationä¼˜å…ˆçº§, ä»è€Œå½±å“ç›¸å¯¹çš„æ‰§è¡Œé¡ºåº</li>\n<li>å¯ä»¥ç»ˆæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡</li>\n</ol>\n</li>\n<li><p><code>NSOperationQueue</code></p>\n<p> ç±»ä¼¼äºGCDä¸­çš„é˜Ÿåˆ—, åªéœ€è¦å§ä»»åŠ¡åŠ å…¥åˆ°<code>NSOperationQueue</code>ä¸­, å°±ä¼šè‡ªåŠ¨è¿è¡Œ, ç”±ç³»ç»Ÿé€šè¿‡æœ€å¤§å¹¶å‘æ•°æ¥æ§åˆ¶æ˜¯å¹¶è¡Œè¿˜æ˜¯ä¸²è¡Œ, å®˜æ–¹æä¾›çš„APIå¦‚ä¸‹:</p>\n<pre><code> static const NSInteger NSOperationQueueDefaultMaxConcurrentOperationCount = -1;\n\n NS_CLASS_AVAILABLE(10_5, 2_0)\n @interface NSOperationQueue : NSObject {\n @private\n     id _private;\n     void *_reserved;\n }\n\n - (void)addOperation:(NSOperation *)op;//å‘é˜Ÿåˆ—ä¸­æ·»åŠ ä»»åŠ¡\n - (void)addOperations:(NSArray&lt;NSOperation *&gt; *)ops waitUntilFinished:(BOOL)wait API_AVAILABLE(macos(10.6), ios(4.0), watchos(2.0), tvos(9.0));//æ·»åŠ ä¸€ç»„ä»»åŠ¡\n\n - (void)addOperationWithBlock:(void (^)(void))block API_AVAILABLE(macos(10.6), ios(4.0), watchos(2.0), tvos(9.0));//æ·»åŠ ä¸€ä¸ªblockå½¢å¼çš„ä»»åŠ¡\n\n @property (readonly, copy) NSArray&lt;__kindof NSOperation *&gt; *operations;//é˜Ÿåˆ—ä¸­æ‰€æœ‰ä»»åŠ¡çš„æ•°ç»„\n @property (readonly) NSUInteger operationCount API_AVAILABLE(macos(10.6), ios(4.0), watchos(2.0), tvos(9.0));//é˜Ÿåˆ—ä¸­æ‰€æœ‰ä»»åŠ¡æ•°\n\n @property NSInteger maxConcurrentOperationCount;//æœ€å¤§å¹¶å‘æ•°\n\n @property (getter=isSuspended) BOOL suspended;//æš‚åœ\n\n @property (nullable, copy) NSString *name API_AVAILABLE(macos(10.6), ios(4.0), watchos(2.0), tvos(9.0));//åç§°\n\n @property NSQualityOfService qualityOfService API_AVAILABLE(macos(10.10), ios(8.0), watchos(2.0), tvos(9.0));//æœåŠ¡è´¨é‡, ç³»ç»Ÿä¼šä¸ºæƒé‡é«˜çš„æœåŠ¡åˆ†é…æ›´å¤šçš„èµ„æº\n\n @property (nullable, assign /* actually retain */) dispatch_queue_t underlyingQueue API_AVAILABLE(macos(10.10), ios(8.0), watchos(2.0), tvos(9.0));\n\n - (void)cancelAllOperations;//å–æ¶ˆé˜Ÿåˆ—ä¸­æ‰€æœ‰çš„ä»»åŠ¡\n\n - (void)waitUntilAllOperationsAreFinished;//é˜»å¡å½“å‰çº¿ç¨‹, ç­‰åˆ°é˜Ÿåˆ—ä¸­çš„å…¨éƒ¨ä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œæ¯•\n\n @property (class, readonly, strong, nullable) NSOperationQueue *currentQueue API_AVAILABLE(macos(10.6), ios(4.0), watchos(2.0), tvos(9.0));//è·å–å½“å‰é˜Ÿåˆ—\n @property (class, readonly, strong) NSOperationQueue *mainQueue API_AVAILABLE(macos(10.6), ios(4.0), watchos(2.0), tvos(9.0));//è·å–ä¸»é˜Ÿåˆ—\n\n @end\n</code></pre><p> ä½¿ç”¨æ–¹å¼å¦‚ä¸‹:</p>\n<pre><code> //ä»¥ä¸‰ç§æ–¹å¼ä¸ºé˜Ÿåˆ—æ·»åŠ äº†ä¸‰ä¸ªä»»åŠ¡, \n - (void)NSOperationQueueRun {\n     NSOperationQueue *queue = [[NSOperationQueue alloc] init];\n     NSInvocationOperation *invocationOper = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(invocationOperSel) object:nil];\n     [queue addOperation:invocationOper];\n     NSBlockOperation *blockOper = [NSBlockOperation blockOperationWithBlock:^{\n         NSLog(@&quot;NSBlockOperationRun_%@&quot;, [NSThread currentThread]);\n     }];\n     [queue addOperation:blockOper];\n     [queue addOperationWithBlock:^{\n         NSLog(@&quot;QUEUEBlockOperationRun_%@&quot;, [NSThread currentThread]);\n     }];\n }\n\n - (void)invocationOperSel {\n     NSLog(@&quot;NSInvocationOperationRun_%@&quot;, [NSThread currentThread]);\n }\n</code></pre><p> ä¸€èˆ¬æƒ…å†µä¸‹, <code>NSOperationQueue</code>ä¼šæŒ‰ç…§ä»»åŠ¡æ·»åŠ çš„é¡ºåºæ¥æ‰§è¡Œä»»åŠ¡, ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ä¼˜å…ˆçº§å’Œä¾èµ–å…³ç³»æ¥æ”¹å˜æ‰§è¡Œé¡ºåº. å¹¶å‘æ•°å¤§äºä»»åŠ¡æ•°, æ²¡æœ‰è®¾ç½®ä¾èµ–å…³ç³», å¹¶ä¸”åœ¨åŒä¸€é˜Ÿåˆ—.</p>\n</li>\n</ol>\n<h2 id=\"å¸¸è§çš„ä½¿ç”¨æ–¹å¼\"><a href=\"#å¸¸è§çš„ä½¿ç”¨æ–¹å¼\" class=\"headerlink\" title=\"å¸¸è§çš„ä½¿ç”¨æ–¹å¼\"></a>å¸¸è§çš„ä½¿ç”¨æ–¹å¼</h2><h3 id=\"GCDå‘å¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\"><a href=\"#GCDå‘å¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\" class=\"headerlink\" title=\"GCDå‘å¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\"></a>GCDå‘å¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡</h3><p>è¯¥è¿‡ç¨‹ä¸€å…±åˆ†ä¸ºä¸¤æ­¥, ç¬¬ä¸€æ­¥è·å–ç³»ç»Ÿæä¾›çš„å…¨å±€å¹¶è¡Œé˜Ÿåˆ—, ç¬¬äºŒæ­¥å‘å¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡. ä»»åŠ¡ä¼šéµå®ˆFIFOåŸåˆ™æ¥æ‰§è¡Œ, ä½†æ˜¯æ¯ä¸ªä»»åŠ¡ä½•æ—¶æ‰§è¡Œå®Œæˆ‘ä»¬å´å¹¶ä¸çŸ¥é“. ä½†æ˜¯ç³»ç»Ÿä¼šæ–°å¼€çº¿ç¨‹æ¥æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡, ä¸‰ä¸ªå¼‚æ­¥ä»»åŠ¡ä¼šåˆ†åˆ«åœ¨ä¸‰ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ, å„ä¸ªä»»åŠ¡çš„æ‰§è¡Œé¡ºåºæ— æ³•ç¡®å®š.</p>\n<pre><code>- (void)test1 {\n    //è·å–ç³»ç»Ÿæä¾›çš„å…¨å±€é˜Ÿåˆ—\n    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_async(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡1----%@&quot;, [NSThread currentThread]);\n        sleep(5);\n    });\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_async(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡2----%@&quot;, [NSThread currentThread]);\n    });\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_async(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡3----%@&quot;, [NSThread currentThread]);\n    });\n}\n</code></pre><h3 id=\"GCDå‘ä¸²è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\"><a href=\"#GCDå‘ä¸²è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\" class=\"headerlink\" title=\"GCDå‘ä¸²è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\"></a>GCDå‘ä¸²è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡</h3><p>è¯¥è¿‡ç¨‹ä¸€å…±åˆ†ä¸ºä¸¤æ­¥, ç¬¬ä¸€æ­¥åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—, ç¬¬äºŒæ­¥å‘å¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡. ä»»åŠ¡ä¼šéµå®ˆFIFOåŸåˆ™æ¥æ‰§è¡Œ, æ¯ä¸ªä»»åŠ¡ä½•æ—¶æ‰§è¡Œå®Œæˆ‘ä»¬å´å¹¶ä¸çŸ¥é“. ä½†æ˜¯ç”±äºæˆ‘ä»¬æ˜¯åœ¨ä¸²è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ çš„ä»»åŠ¡, ä¸ä¼šæ–°å¼€çº¿ç¨‹, æ‰€æœ‰çš„å¼‚æ­¥ä»»åŠ¡ä¼šæŒ‰ç…§é¡ºåºå‰ä¸€ä¸ªæ‰§è¡Œå®Œæ¯•å†æ‰§è¡Œåä¸€ä¸ª.</p>\n<pre><code> - (void)test2 {\n    //åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¸²è¡Œé˜Ÿåˆ—çš„åç§°, ç¬¬äºŒä¸ªå‚æ•°ä¸ºé˜Ÿåˆ—çš„å±æ€§, NULLæˆ–è€…DISPATCH_QUEUE_SERIALè¡¨ç¤ºæ˜¯ä¸²è¡Œé˜Ÿåˆ—\n    dispatch_queue_t queue = dispatch_queue_create(&quot;test2&quot;, NULL);\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_async(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡1----%@&quot;, [NSThread currentThread]);\n        sleep(5);\n    });\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_async(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡2----%@&quot;, [NSThread currentThread]);\n    });\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_async(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡3----%@&quot;, [NSThread currentThread]);\n    });\n}\n</code></pre><h3 id=\"GCDå‘å¹¶è¡Œé˜Ÿåˆ—æ·»åŠ åŒæ­¥ä»»åŠ¡\"><a href=\"#GCDå‘å¹¶è¡Œé˜Ÿåˆ—æ·»åŠ åŒæ­¥ä»»åŠ¡\" class=\"headerlink\" title=\"GCDå‘å¹¶è¡Œé˜Ÿåˆ—æ·»åŠ åŒæ­¥ä»»åŠ¡\"></a>GCDå‘å¹¶è¡Œé˜Ÿåˆ—æ·»åŠ åŒæ­¥ä»»åŠ¡</h3><p>è¯¥è¿‡ç¨‹ä¸€å…±åˆ†ä¸ºä¸¤æ­¥, ç¬¬ä¸€æ­¥è·å–ç³»ç»Ÿæä¾›çš„å…¨å±€å¹¶è¡Œé˜Ÿåˆ—, ç¬¬äºŒæ­¥å‘å¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ åŒæ­¥ä»»åŠ¡. ä»»åŠ¡ä¼šéµå®ˆFIFOåŸåˆ™æ¥æ‰§è¡Œ, æ¯ä¸ªä»»åŠ¡ä½•æ—¶æ‰§è¡Œå®Œæˆ‘ä»¬å´å¹¶ä¸çŸ¥é“. è™½ç„¶æ˜¯å¹¶è¡Œé˜Ÿåˆ—, å•ç”±äºæ·»åŠ çš„æ˜¯åŒæ­¥ä»»åŠ¡, ä¸ä¼šæ–°å¼€çº¿ç¨‹, å…¨éƒ½åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œ, æ‰€ä»¥ä¸‰ä¸ªä»»åŠ¡ä¼šé¡ºåºæ‰§è¡Œ, å¹¶è¡Œé˜Ÿåˆ—å¤±å»äº†å¹¶è¡Œçš„èƒ½åŠ›. </p>\n<pre><code>//å¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ åŒæ­¥ä»»åŠ¡\n- (void)test3 {\n    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_sync(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡1----%@&quot;, [NSThread currentThread]);\n        sleep(5);\n    });\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_sync(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡2----%@&quot;, [NSThread currentThread]);\n    });\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_sync(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡3----%@&quot;, [NSThread currentThread]);\n    });\n}\n</code></pre><h3 id=\"GCD-å‘ä¸²è¡Œé˜Ÿåˆ—æ·»åŠ å¼‚æ­¥ä»»åŠ¡\"><a href=\"#GCD-å‘ä¸²è¡Œé˜Ÿåˆ—æ·»åŠ å¼‚æ­¥ä»»åŠ¡\" class=\"headerlink\" title=\"GCD å‘ä¸²è¡Œé˜Ÿåˆ—æ·»åŠ å¼‚æ­¥ä»»åŠ¡\"></a>GCD å‘ä¸²è¡Œé˜Ÿåˆ—æ·»åŠ å¼‚æ­¥ä»»åŠ¡</h3><p>è¯¥è¿‡ç¨‹ä¸€å…±åˆ†ä¸ºä¸¤æ­¥, ç¬¬ä¸€æ­¥åˆ›å»ºè‡ªå®šä¹‰ä¸²è¡Œé˜Ÿåˆ—, ç¬¬äºŒæ­¥å‘å¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡. è™½ç„¶å¼‚æ­¥ä»»åŠ¡ä¼šæ–°å¼€çº¿ç¨‹, ä½†æ˜¯ç”±äºæ˜¯åœ¨ä¸²è¡Œé˜Ÿåˆ—ä¸­æ‰§è¡Œ, æ‰€ä»¥ä¸æ–°å¼€çº¿ç¨‹, æ‰€æœ‰ä»»åŠ¡å‰ä¸€ä¸ªæ‰§è¡Œå®Œæ¯•å†æ‰§è¡Œä¸‹ä¸€ä¸ª.</p>\n<pre><code>- (void)test4 {\n    dispatch_queue_t queue = dispatch_queue_create(&quot;test4&quot;, NULL);\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_async(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡1----%@&quot;, [NSThread currentThread]);\n        sleep(5);\n    });\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_async(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡2----%@&quot;, [NSThread currentThread]);\n    });\n\n    //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å¼‚æ­¥ä»»åŠ¡\n    dispatch_async(queue, ^{\n        NSLog(@&quot;ä¸‹è½½å›¾ç‰‡3----%@&quot;, [NSThread currentThread]);\n    });\n}\n</code></pre><h3 id=\"GCDç›‘å¬å¹¶è¡Œé˜Ÿåˆ—ä¸­å¤šä¸ªå¼‚æ­¥ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆ-Dispatch-Group\"><a href=\"#GCDç›‘å¬å¹¶è¡Œé˜Ÿåˆ—ä¸­å¤šä¸ªå¼‚æ­¥ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆ-Dispatch-Group\" class=\"headerlink\" title=\"GCDç›‘å¬å¹¶è¡Œé˜Ÿåˆ—ä¸­å¤šä¸ªå¼‚æ­¥ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆ(Dispatch Group)\"></a>GCDç›‘å¬å¹¶è¡Œé˜Ÿåˆ—ä¸­å¤šä¸ªå¼‚æ­¥ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆ(Dispatch Group)</h3><p>åˆ†ç»„æ¨¡å¼ <code>dispatch_group_notify</code>. å¯ä»¥å¼‚æ­¥æ‰§è¡Œå¤šä¸ªè€—æ—¶æ“ä½œ. ç­‰è€—æ—¶æ“ä½œéƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åä¼šå›åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œæ“ä½œ, ä¸»è¦ç”¨äºç›‘å¬ä»»åŠ¡æ˜¯å¦å®Œæˆ. ä¸»è¦æœ‰ä¸¤ç§ç”¨æ³•: </p>\n<p>ç¬¬ä¸€ç§ç”¨æ³•æ˜¯é€šè¿‡<code>dispatch_group_async</code>, é¦–å…ˆåˆ›å»ºä¸€ä¸ªå…¨å±€å¹¶è¡Œé˜Ÿåˆ—å’Œä¸€ä¸ªgroupé˜Ÿåˆ—ç»„, å†æ¬¡åˆ›å»ºå¼‚æ­¥groupä»»åŠ¡åŠ å…¥åˆ°å‰é¢åˆ›å»ºçš„groupé˜Ÿåˆ—ä¸­å». å½“æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡å®Œæˆå, ä¼šé€šè¿‡<code>dispatch_group_notify</code>å›åˆ°ä¸»çº¿ç¨‹.</p>\n<pre><code>- (void)groupTest1 {\n    //è·å–å…¨å±€é˜Ÿåˆ—\n    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n    //åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ç»„\n    dispatch_group_t group = dispatch_group_create();\n\n    dispatch_group_async(group, queue, ^{\n        NSLog(@&quot;--- 1 å¼€å§‹--- %@&quot;, [NSThread currentThread]);\n        //å»¶æ—¶5ç§’ æ¨¡ä»¿å µå¡å­çº¿ç¨‹\n        [NSThread sleepForTimeInterval:5];\n        NSLog(@&quot;--- 1 --- å®Œæˆ %@&quot;, [NSThread currentThread]);\n    });\n\n    dispatch_group_async(group, queue, ^{\n        NSLog(@&quot;--- 2 å¼€å§‹--- %@&quot;, [NSThread currentThread]);\n        //å»¶æ—¶5ç§’ æ¨¡ä»¿å µå¡å­çº¿ç¨‹\n        [NSThread sleepForTimeInterval:5];\n        NSLog(@&quot;--- 2 --- å®Œæˆ %@&quot;, [NSThread currentThread]);\n    });\n\n    //åœ¨è¿™ä¸ªé˜Ÿåˆ—ç»„é‡Œé¢ï¼Œä¼šç­‰groupä¸­çš„å…¨éƒ¨ä»£ç æ‰§è¡Œå®Œæ¯•å†å»æ‰§è¡Œå…¶å®ƒçš„æ“ä½œ\n    dispatch_group_notify(group, dispatch_get_main_queue(), ^{\n        // ç­‰å‰é¢çš„å¼‚æ­¥æ“ä½œéƒ½æ‰§è¡Œå®Œæ¯•åï¼Œå›åˆ°ä¸»çº¿ç¨‹...\n        NSLog(@&quot;å…¨éƒ¨å®Œæˆ&quot;);\n    });\n}\n</code></pre><p>ç¬¬äºŒç§ç”¨æ³•æ˜¯é€šè¿‡ä¿¡å·é‡<code>dispatch_group_enter</code> å’Œ <code>dispatch_group_leave</code>. åˆ›å»ºä¸€ä¸ªå¹¶è¡Œçº¿ç¨‹å’Œå¤šä¸ªå¼‚æ­¥ä»»åŠ¡, å°†å¼‚æ­¥ä»»åŠ¡æ·»åŠ åˆ°å¹¶è¡Œçº¿ç¨‹ä¸­åŒº. é€šè¿‡<code>dispatch_group_enter</code>æ¥å‘ŠçŸ¥<code>group</code>ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å¼€å§‹,  æœªæ‰§è¡Œå®Œæ¯•ä»»åŠ¡æ•°åŠ 1. åœ¨å¼‚æ­¥çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ—¶, é€šè¿‡<code>dispatch_group_leave</code>å‘ŠçŸ¥group, ä¸€ä¸ªä»»åŠ¡ç»“æŸ, æœªæ‰§è¡Œå®Œæ¯•ä»»åŠ¡æ•°å‡1. å½“æœªæ‰§è¡Œå®Œæ¯•ä»»åŠ¡æ•°ä¸º0çš„æ—¶å€™, è¿™æ—¶groupæ‰è®¤ä¸ºç»„å†…ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæ¯•äº†(è¿™ä¸ªå’ŒGCDçš„ä¿¡å·é‡çš„æœºåˆ¶æœ‰äº›ç›¸ä¼¼), è¿™æ—¶å€™æ‰ä¼šå›è°ƒ<code>dispatch_group_notify</code>ä¸­çš„block. æ­¤å¤„éœ€è¦æ³¨æ„, <code>dispatch_group_enter</code>å’Œ<code>dispatch_group_leave</code>çš„æ•°é‡ä¸€å®šè¦ä¸€è‡´. </p>\n<pre><code>- (void)groupTest2 {\n    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n    dispatch_group_t group = dispatch_group_create();\n\n    dispatch_group_enter(group);\n    dispatch_async(queue, ^{\n        sleep(2); //è¿™é‡Œçº¿ç¨‹ç¡çœ 1ç§’é’Ÿï¼Œæ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚\n        NSLog(@&quot;%@ one finish&quot;, [NSThread currentThread]);\n        dispatch_group_leave(group);\n    });\n\n    dispatch_group_enter(group);\n    dispatch_async(queue, ^{\n        sleep(2); //è¿™é‡Œçº¿ç¨‹ç¡çœ 1ç§’é’Ÿï¼Œæ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚\n        NSLog(@&quot;%@ two finish&quot;, [NSThread currentThread]);\n        dispatch_group_leave(group);\n    });\n\n    dispatch_group_notify(group, queue, ^{\n        NSLog(@&quot;group finished&quot;);\n    });\n}\n</code></pre><h3 id=\"GCDå»¶æ—¶æ“ä½œ-dispatch-after\"><a href=\"#GCDå»¶æ—¶æ“ä½œ-dispatch-after\" class=\"headerlink\" title=\"GCDå»¶æ—¶æ“ä½œ(dispatch_after)\"></a>GCDå»¶æ—¶æ“ä½œ(dispatch_after)</h3><p>ä½¿ç”¨å¾ˆç®€å•, ä¸¤ä¸ªæ ¸å¿ƒçš„å¯¹è±¡<code>dispatch_time_t</code>å’Œ<code>dispatch_after</code>. å¤§å®¶éƒ½ç»å¸¸ä½¿ç”¨, ä¸ç”¨å¤šè¯´. ä¸‹é¢çš„ä»£ç å’Œåœ¨3å¦™æ‰‹ç”¨<code>dispatch_async</code>å‡½æ•°è¿½åŠ blockåˆ°ä¸»çº¿ç¨‹çš„æ“ä½œæ˜¯ç›¸åŒçš„</p>\n<pre><code>- (void)afterTest {\n    double delayInSeconds = 2.0;\n    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t) (delayInSeconds * NSEC_PER_SEC));\n    //ç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨æ—¶é—´, ç¬¬äºŒå„å‚æ•°ä»£è¡¨è¦åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œæ¥ä¸‹æ¥çš„ä»»åŠ¡, ç¬¬ä¸‰ä¸ªå‚æ•°å°±æ˜¯ä»»åŠ¡block\n    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){\n        NSLog(@&quot;%@&quot;, [NSThread currentThread]);\n    });\n}\n</code></pre><h3 id=\"GCDå•ä¾‹-dispatch-once\"><a href=\"#GCDå•ä¾‹-dispatch-once\" class=\"headerlink\" title=\"GCDå•ä¾‹(dispatch_once)\"></a>GCDå•ä¾‹(dispatch_once)</h3><p>è¿™ä¸ªæ›´æ˜¯ä¸ç”¨å¤šè¯´, ç›´æ¥è´´ä¸Šä»£ç .</p>\n<pre><code>@interface Tool : NSObject\n+ (instancetype)sharedTool;\n@end\n\n@implementation Tool\nstatic id _instance;\n+ (instancetype)sharedTool {\n    static dispatch_once_t onceToken;\n    dispatch_once(&amp;onceToken, ^{\n        _instance = [[Tool alloc] init];\n    });\n    return _instance;\n}\n@end\n</code></pre><h3 id=\"GCD-çº¿ç¨‹é—´çš„é€šè®¯\"><a href=\"#GCD-çº¿ç¨‹é—´çš„é€šè®¯\" class=\"headerlink\" title=\"GCD çº¿ç¨‹é—´çš„é€šè®¯\"></a>GCD çº¿ç¨‹é—´çš„é€šè®¯</h3><p>å¸¸ç”¨çš„æ–¹å¼å°±æ˜¯åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œé•¿æ—¶é—´ä»»åŠ¡, å¤„ç†ç»“æŸæ—¶, ä¸»çº¿ç¨‹ä½¿ç”¨è¯¥å¤„ç†ç»“æœ. ä»£ç å¦‚ä¸‹: </p>\n<pre><code>- (void)threadTest {\n    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n    dispatch_async(queue, ^{\n        //åœ¨è¿™é‡Œæ‰§è¡Œè€—æ—¶çš„æ“ä½œ\n        dispatch_async(dispatch_get_main_queue(), ^{\n            //åœ¨ä¸»çº¿ç¨‹ä½¿ç”¨ä¸Šé¢æ“ä½œçš„ç»“æœ\n        });\n    });\n}\n</code></pre><h3 id=\"GCDé‡å¤æ‰§è¡ŒåŒä¸€ä¸ªä»»åŠ¡-dispatch-apply\"><a href=\"#GCDé‡å¤æ‰§è¡ŒåŒä¸€ä¸ªä»»åŠ¡-dispatch-apply\" class=\"headerlink\" title=\"GCDé‡å¤æ‰§è¡ŒåŒä¸€ä¸ªä»»åŠ¡(dispatch_apply)\"></a>GCDé‡å¤æ‰§è¡ŒåŒä¸€ä¸ªä»»åŠ¡(dispatch_apply)</h3><p><code>disaptch_apply</code>å‡½æ•°æ˜¯<code>dispatch_sync</code>å‡½æ•°å’Œ<code>Dispatch Group</code>çš„å…³è”API, è¯¥å‡½æ•°æŒ‰ç…§æŒ‡å®šçš„æ¬¡æ•°å°†æŒ‡å®šçš„Blockè¿½åŠ åˆ°æŒ‡å®šçš„Dispatch Queueä¸­, å¹¶ç­‰å¾…å¤„ç†æ‰§è¡Œç»“æŸ. </p>\n<pre><code>- (void)applyTest {\n    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n    dispatch_apply(10, queue, ^(size_t index) {\n        //å¹¶è¡Œå¤„ç†10æ¬¡ä»»åŠ¡\n        NSLog(@&quot;%zu&quot;, index);\n    });\n}\n</code></pre><p>ä½†æ˜¯ç”±äº<code>dispatch_apply</code>å‡½æ•°ä¸<code>dispatch_sync</code>å‡½æ•°ç›¸åŒ, ä¼šç­‰å¾…ä»»åŠ¡æ‰§è¡Œç»“æŸ, æ‰€ä»¥æˆ‘ä»¬å¼ºçƒˆæ¨èåœ¨<code>dispatch_async</code>å‡½æ•°ä¸­å¼‚æ­¥æ‰§è¡Œ. </p>\n<pre><code>- (void)applyTest {\n    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n\n    //åœ¨å…¨å±€å¹¶è¡Œé˜Ÿåˆ—ä¸­å¼‚æ­¥æ‰§è¡Œ\n    dispatch_async(queue, ^{\n        //ç­‰å¾…å‡½æ•°ä¸­æ“ä½œå…¨éƒ¨æ‰§è¡Œå®Œæ¯•\n        dispatch_apply(10, queue, ^(size_t index) {\n            //å¹¶è¡Œå¤„ç†10æ¬¡ä»»åŠ¡\n            sleep(2);\n            NSLog(@&quot;%zu&quot;, index);\n        });\n\n        //dispatch_applyä¸­çš„å¤„ç†å…¨éƒ¨ç»“æŸ, åœ¨ä¸»çº¿ç¨‹å¼‚æ­¥æ‰§è¡Œ\n        dispatch_async(dispatch_get_main_queue(), ^{\n            NSLog(@&quot;Done&quot;);\n        });\n    });\n}\n</code></pre><h3 id=\"GCDè®¾ç½®ä¼˜å…ˆçº§-dispatch-set-target-queue\"><a href=\"#GCDè®¾ç½®ä¼˜å…ˆçº§-dispatch-set-target-queue\" class=\"headerlink\" title=\"GCDè®¾ç½®ä¼˜å…ˆçº§(dispatch_set_target_queue)\"></a>GCDè®¾ç½®ä¼˜å…ˆçº§(dispatch_set_target_queue)</h3><p>å°†queueçš„ä¼˜å…ˆçº§é€šè¿‡<code>dispatch_set_target_queue</code>å˜æ›´çš„å’Œqueue1çš„ä¼˜å…ˆçº§ä¸€è‡´, ä»£ç å¦‚ä¸‹. </p>\n<pre><code>- (void)targetQueeuTest {\n    dispatch_queue_t queue = dispatch_queue_create(&quot;test&quot;, NULL);\n    dispatch_queue_t queue1 = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n    //æŠŠç¬¬ä¸€ä¸ªå‚æ•°çš„æ‰§è¡Œä¼˜å…ˆçº§è®¾ç½®çš„å’Œç¬¬äºŒä¸ªå‚æ•°çš„ä¼˜å…ˆçº§ä¸€è‡´.\n    dispatch_set_target_queue(queue, queue1);\n}\n</code></pre><h3 id=\"GCDæ …æ -dispatch-barrier-async\"><a href=\"#GCDæ …æ -dispatch-barrier-async\" class=\"headerlink\" title=\"GCDæ …æ (dispatch_barrier_async)\"></a>GCDæ …æ (dispatch_barrier_async)</h3><p>ä»¥ä¸‹é¢çš„ä»£ç ä¸ºä¾‹, å‡è®¾ä¸€ä¸ªå¹¶è¡Œé˜Ÿåˆ—ä¸­æ·»åŠ äº†äº”ä¸ªå¼‚æ­¥ä»»åŠ¡, è™½ç„¶éµå¾ªFIFOçš„åŸåˆ™, è¿™äº”ä¸ªä»»åŠ¡çš„æ‰§è¡Œå¿…å®šæ˜¯æ— åºçš„. å½“æˆ‘ä»¬åœ¨ç¬¬ä¸‰ä¸ªä»»åŠ¡ä¹‹ååŠ å…¥<code>dispatch_barrier_async</code>ä»»åŠ¡, é‚£ä¹ˆè¿™äº”ä¸ªä»»åŠ¡å°±è¢«åˆ†å‰²æˆä¸¤éƒ¨åˆ†, å‰ä¸‰æ¬¡æ— åºæ‰§è¡Œ, ç„¶åæ‰§è¡Œ<code>dispatch_barrier_async</code>ä»»åŠ¡, ç„¶åå†æ— åºæ‰§è¡Œåä¸¤æ¬¡ä»»åŠ¡. æ³¨æ„<strong>æ­¤å¤„çš„é˜Ÿåˆ—åªèƒ½ä½¿ç”¨è‡ªå®šä¹‰çš„å¹¶è¡Œé˜Ÿåˆ—, ç³»ç»Ÿæä¾›çš„å…¨å±€é˜Ÿåˆ—ä¸è¡Œ</strong></p>\n<pre><code>- (void)barrierTest {\n\n    //æ­¤å¤„çš„é˜Ÿåˆ—åªèƒ½ä½¿ç”¨è‡ªå®šä¹‰çš„å¹¶è¡Œé˜Ÿåˆ—, ç³»ç»Ÿæä¾›çš„å…¨å±€é˜Ÿåˆ—ä¸è¡Œ\n    dispatch_queue_t queue = dispatch_queue_create(&quot;barrierTest&quot;, DISPATCH_QUEUE_CONCURRENT);\n\n    dispatch_async(queue, ^{\n        NSLog(@&quot;1&quot;);\n    });\n    dispatch_async(queue, ^{\n        NSLog(@&quot;2&quot;);\n    });\n    dispatch_async(queue, ^{\n        NSLog(@&quot;3&quot;);\n    });\n    dispatch_barrier_async(queue, ^{\n        sleep(3);\n        NSLog(@&quot;æ’å…¥æ‰§è¡Œ&quot;);\n    });\n    dispatch_async(queue, ^{\n        NSLog(@&quot;4&quot;);\n    });\n    dispatch_async(queue, ^{\n        NSLog(@&quot;5&quot;);\n    });\n}\n</code></pre><h3 id=\"GCDä¿¡å·é‡-dispatch-semaphore-t\"><a href=\"#GCDä¿¡å·é‡-dispatch-semaphore-t\" class=\"headerlink\" title=\"GCDä¿¡å·é‡(dispatch_semaphore_t)\"></a>GCDä¿¡å·é‡(dispatch_semaphore_t)</h3><p>æˆ‘ä»¬ä»¥è¿™ä¸ªä½¿ç”¨åœºæ™¯ä¸ºä¾‹, æ¥è¯´æ˜ä¸€ä¸‹, ä¸è€ƒè™‘é¡ºåº å°†æ‰€æœ‰çš„æ•°æ®æ·»åŠ åˆ°ç©ºæ•°ç»„ä¸­å», æˆ‘ä»¬å¯èƒ½ä¼šè¿™ä¹ˆå®ç°:</p>\n<pre><code>- (void)dispatchSemaphoreDemo {\n    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n    NSMutableArray *array = [NSMutableArray array];\n    for (int i = 0; i &lt; 100000; i++) {\n        dispatch_async(queue, ^{\n            NSLog(@&quot;%@&quot;, [NSThread currentThread]);\n            [array addObject:@(i)];\n        });\n    }\n}\n</code></pre><p>å› ä¸ºæ˜¯å¹¶è¡Œé˜Ÿåˆ—, å¼‚æ­¥ä»»åŠ¡, æ‰€ä»¥ä¼šå¼€å¤§é‡çš„çº¿ç¨‹, å¹¶ä¸”è¿™äº›çº¿ç¨‹ä¼šä¿å­˜åœ¨å†…å­˜ä¸­,ç›¸å½“è€—è´¹èµ„æº, æœ€ç»ˆè¿è¡Œçš„ç»“æœå°±æ˜¯å´©æºƒ. é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦é€šè¿‡ä¿¡å·é‡æ¥æ§åˆ¶ä»»åŠ¡çš„æ‰§è¡Œ. <code>dispatch_semaphore_t</code>ç±»ä¼¼äºå•ä¸ªé˜Ÿåˆ—çš„æœ€å¤§å¹¶å‘æ•°æ§åˆ¶æœºåˆ¶, æé«˜å¹¶è¡Œæ•ˆç‡çš„åŒæ—¶, ä¹Ÿå¯ä»¥é˜²æ­¢å¤ªå¤šçº¿ç¨‹çš„å¼€è¾Ÿå¯¹ç³»ç»Ÿé€ æˆå¤ªå¤§çš„è´Ÿæ‹…. æ”¹é€ ååº”è¯¥æ˜¯è¿™æ ·çš„: </p>\n<pre><code>- (void)dispatchSemaphoreDemo {\n    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\n    NSMutableArray *array = [NSMutableArray array];\n\n    //è®¾ç½®ä¿¡å·é‡åˆå§‹å€¼, å½“ä¿¡å·é‡ä¸º0æ—¶, æ‰€æœ‰ä»»åŠ¡ç­‰å¾…, ä¿¡å·é‡è¶Šå¤§, å…è®¸å¯å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡æ•°é‡è¶Šå¤š. å¹¶å‘çš„çº¿ç¨‹ç”±ç³»ç»Ÿè°ƒé…, ä¸ä¸€å®šä¸€ç›´æ˜¯åŒæ ·çš„ä¸¤æ¡, ä½†æ˜¯æœ€å¤šåªèƒ½åŒæ—¶å­˜åœ¨ä¸¤æ¡.\n    dispatch_semaphore_t semaphore = dispatch_semaphore_create(2);\n    for (int i = 0; i &lt; 100; i++) {\n\n        //å½“ä¿¡å·é‡å¤§äºç­‰äºè®¾å®šçš„åˆå§‹å€¼æ—¶å°±ç»§ç»­æ‰§è¡Œ, å¦åˆ™ä¸€ç›´ç­‰å¾…\n        dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);\n        dispatch_async(queue, ^{\n            //æ‰§è¡Œåˆ°è¿™é‡Œå°±ä»£è¡¨ä¿¡å·é‡å¤§äºç­‰äºè®¾å®šçš„åˆå§‹å€¼, æ‰€ä»¥åœ¨è¿™é‡Œä¿¡å·é‡è¦å‡1\n            NSLog(@&quot;%d+++++%@&quot;, i, [NSThread currentThread]);\n            [array addObject:@(i)];\n            //åˆ°è¿™é‡Œçš„æ—¶å€™, å› ä¸ºå¼‚æ­¥ä»»åŠ¡å·²ç»å°†è¦ç»“æŸ, è¦å°†ä¿¡å·é‡åŠ 1. å¦‚æœå‰é¢æœ‰ç­‰å¾…çš„çº¿ç¨‹, æœ€å…ˆç­‰å¾…çš„çº¿ç¨‹å…ˆæ‰§è¡Œ\n            dispatch_semaphore_signal(semaphore);\n        });\n    }\n}\n</code></pre><h3 id=\"GCDå®šæ—¶å™¨\"><a href=\"#GCDå®šæ—¶å™¨\" class=\"headerlink\" title=\"GCDå®šæ—¶å™¨\"></a>GCDå®šæ—¶å™¨</h3><p>GCDå®ç°å®šæ—¶å™¨ä¸»è¦ç”¨åˆ°<code>dispatch_source_t</code>å‡½æ•°, è¯¥å‡½æ•°å®é™…æœ‰å¤šç§Type, <code>DISPATCH_SOURCE_TYPE_TIMER</code>æ˜¯å®šæ—¶å™¨ç›¸å…³çš„ä»»åŠ¡, è¿˜æœ‰å…¶ä»–ç±»å‹çš„å¤„ç†äº‹ä»¶ç±»å‹. </p>\n<pre><code>- (void)timerDemo {\n    NSLog(@&quot;%@&quot;, [NSThread currentThread]);\n    //æŒ‡å®šDISPATCH_SOURCE_TYPE_TIMERç±»å‹, ä½œæˆDispatch Source\n\n    //åœ¨å®šæ—¶å™¨ç»è¿‡æŒ‡å®šæ—¶é—´, æŠŠä»»åŠ¡è¿½åŠ åˆ°main queue\n    dispatch_source_t timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0, dispatch_get_main_queue());\n\n    //å®šæ—¶å™¨çš„ç›¸å…³è®¾ç½®, å°†å®šæ—¶å™¨è®¾ç½®ä¸º5så, ä¸æŒ‡å®šä¸ºé‡å¤, å…è®¸å»¶è¿Ÿ1s\n    dispatch_source_set_timer(timer, dispatch_time(DISPATCH_TIME_NOW, 5ull * NSEC_PER_SEC), DISPATCH_TIME_FOREVER, 1ull * NSEC_PER_SEC);\n\n    //æŒ‡å®šå®šæ—¶å™¨æŒ‡å®šæ—¶é—´å†…æ‰§è¡Œçš„å¤„ç†\n    dispatch_source_set_event_handler(timer, ^{\n        NSLog(@&quot;wake up&quot;);\n        dispatch_source_cancel(timer);\n    });\n\n    //å–æ¶ˆå®šæ—¶å™¨æ—¶çš„å¤„ç†\n    dispatch_source_set_cancel_handler(timer, ^{\n        NSLog(@&quot;canceled&quot;);\n    });\n\n    //å®šæ—¶å™¨å¯åŠ¨\n    dispatch_resume(timer);\n}\n</code></pre><h3 id=\"NSOperationçš„ä¼˜å…ˆçº§\"><a href=\"#NSOperationçš„ä¼˜å…ˆçº§\" class=\"headerlink\" title=\"NSOperationçš„ä¼˜å…ˆçº§\"></a>NSOperationçš„ä¼˜å…ˆçº§</h3><p>NSOperationQueueä¸­NSOperationå¯¹è±¡çš„æ‰§è¡Œæ–¹å¼æ˜¯æŒ‰ç…§FIFOçš„åŸåˆ™é¡ºåºæ‰§è¡Œ, ä½†æ˜¯å¦‚æœæˆ‘ä»¬è®¾ç½®äº†ä»»åŠ¡çš„ä¼˜å…ˆçº§, é‚£ä¹ˆç³»ç»Ÿå°±ä¼šç»™ä¼˜å…ˆçº§é«˜çš„ä¼˜å…ˆåˆ†é…èµ„æº. </p>\n<p>ä¼˜å…ˆçº§ä¸€å…±æœ‰è¿™å‡ ç§, ä»é«˜åˆ°ä½ä¾æ¬¡æ’åˆ—. </p>\n<pre><code>typedef NS_ENUM(NSInteger, NSOperationQueuePriority) {\n    NSOperationQueuePriorityVeryLow = -8L,\n    NSOperationQueuePriorityLow = -4L,\n    NSOperationQueuePriorityNormal = 0,\n    NSOperationQueuePriorityHigh = 4,\n    NSOperationQueuePriorityVeryHigh = 8\n};\n</code></pre><p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹, ä¸‰ä¸ªä»»åŠ¡è¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­å», è¿™ä¸‰ä¸ªä»»åŠ¡åˆ†åˆ«åœ¨ä¸‰ä¸ªçº¿ç¨‹, äº’ä¸å¹²æ‰°, ç±»ä¼¼äºGCDçš„å¼‚æ­¥å¹¶è¡Œæ¨¡å¼, å¦‚æœæˆ‘ä»¬è®¾ç½®<code>invocationOper.queuePriority = NSOperationQueuePriorityVeryLow</code>ç†è®ºä¸Š, <code>invocationOper</code>ä»»åŠ¡ä¼šåœ¨æœ€åæ‰§è¡Œ, ä½†æ˜¯æˆ‘ä»¬å‘ç°å¹¶æ²¡æœ‰, é‚£æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰è®¾ç½®æœ€å¤§å¹¶å‘æ•°çš„åŸå› , æˆ‘çŒœæµ‹ç³»ç»Ÿå¯èƒ½æ˜¯åšäº†æŸäº›é™åˆ¶, è™½ç„¶æ˜¯æ–°å¼€äº†çº¿ç¨‹, ä½†æ˜¯ç”±äºæœ€å¤§å¹¶å‘æ•°å°äºç­‰äº1å®é™…è¿˜æ˜¯æŒ‰ç…§FIFOé¡ºåºæ‰§è¡Œ, <strong>æ‰€ä»¥æ³¨æ„ä¸€å®šè¦è®¾ç½®æœ€å¤§å¹¶å‘æ•°</strong>.</p>\n<pre><code>//æŠŠæ³¨é‡Šæ‰“å¼€å°±å¯ä»¥çœ‹åˆ°æƒ³è¦çš„æ•ˆæœ\n- (void)NSOperationQueueRun {\n    NSOperationQueue *queue = [[NSOperationQueue alloc] init];\n    //queue.maxConcurrentOperationCount = 3;\n    NSInvocationOperation *invocationOper = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(invocationOperSel) object:nil];\n    //invocationOper.queuePriority = NSOperationQueuePriorityVeryLow;\n    [queue addOperation:invocationOper];\n    NSBlockOperation *blockOper = [NSBlockOperation blockOperationWithBlock:^{\n        NSLog(@&quot;NSBlockOperationRun_%@&quot;, [NSThread currentThread]);\n    }];\n    [queue addOperation:blockOper];\n    [queue addOperationWithBlock:^{\n        NSLog(@&quot;QUEUEBlockOperationRun_%@&quot;, [NSThread currentThread]);\n    }];\n}\n\n- (void)invocationOperSel {\n    NSLog(@&quot;NSInvocationOperationRun_%@&quot;, [NSThread currentThread]);\n}\n</code></pre><h3 id=\"NSOperationçš„ä¾èµ–å…³ç³»\"><a href=\"#NSOperationçš„ä¾èµ–å…³ç³»\" class=\"headerlink\" title=\"NSOperationçš„ä¾èµ–å…³ç³»\"></a>NSOperationçš„ä¾èµ–å…³ç³»</h3><p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—, åˆ†åˆ«åˆ›å»ºè¦æ‰§è¡Œçš„ä»»åŠ¡, <strong>åœ¨æŠŠè¦æ‰§è¡Œçš„ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­å»ä¹‹å‰, é€šè¿‡<code>addDependency</code>æ¥å»ºç«‹ä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»</strong>. å¦‚æœæˆ‘ä»¬æ²¡æœ‰è®¾ç½®ä¾èµ–çš„è¯, å¦‚æœè®¾ç½®çš„å¹¶å‘æ•°å¤§äº1,  é‚£ä¹ˆ<code>blockOper_1</code>å’Œ<code>`blockOper_2</code>çš„æ‰§è¡Œé¡ºåºæ˜¯éšæœºçš„. å¯æ˜¯å½“æˆ‘ä»¬æ‰§è¡Œ<code>[blockOper_1 addDependency:blockOper_2]</code>æ—¶, å°±ç»™ä¸¤ä¸ªä»»åŠ¡æ·»åŠ äº†ä¾èµ–å…³ç³», <code>blockOper_1</code>æ°¸è¿œåªä¼šåœ¨<code>blockOper_2</code>åæ‰§è¡Œ. å³ä½¿æˆ‘ä»¬ç»™<code>blockOper_1</code>è®¾ç½®äº†æœ€é«˜çš„ä¼˜å…ˆçº§, å› ä¸º<strong>ä¾èµ–çš„ä¼˜å…ˆçº§è¦é«˜äº<code>queuePriority</code></strong>. </p>\n<pre><code>- (void)NSOperationQueueRun2 {\n    NSOperationQueue *queue = [[NSOperationQueue alloc] init];\n//    queue.maxConcurrentOperationCount = 2;\n    NSBlockOperation *blockOper_1 = [NSBlockOperation blockOperationWithBlock:^{\n        NSLog(@&quot;blockOper_1_%@_%@&quot;,@(1),[NSThread currentThread]);\n    }];\n\n    NSBlockOperation *blockOper_2 = [NSBlockOperation blockOperationWithBlock:^{\n        NSLog(@&quot;blockOper_2_%@_%@&quot;,@(2),[NSThread currentThread]);\n    }];\n\n//    blockOper_1.queuePriority = NSOperationQueuePriorityVeryHigh;\n    [blockOper_1 addDependency:blockOper_2];\n    [queue addOperation:blockOper_1];\n    [queue addOperation:blockOper_2];\n}\n</code></pre><h2 id=\"å¸¸è§ä½¿ç”¨æ¡ˆåˆ—åˆ†æ\"><a href=\"#å¸¸è§ä½¿ç”¨æ¡ˆåˆ—åˆ†æ\" class=\"headerlink\" title=\"å¸¸è§ä½¿ç”¨æ¡ˆåˆ—åˆ†æ\"></a>å¸¸è§ä½¿ç”¨æ¡ˆåˆ—åˆ†æ</h2><h3 id=\"æ¡ˆä¾‹ä¸€\"><a href=\"#æ¡ˆä¾‹ä¸€\" class=\"headerlink\" title=\"æ¡ˆä¾‹ä¸€\"></a>æ¡ˆä¾‹ä¸€</h3><pre><code>- (void)case1 {\n    NSLog(@&quot;ä»»åŠ¡ä¸€ - %@&quot;, [NSThread currentThread]);\n    dispatch_sync(dispatch_get_main_queue(), ^{\n        NSLog(@&quot;åŒæ­¥ä»»åŠ¡ - %@&quot;,[NSThread currentThread]);\n    });\n    NSLog(@&quot;ä»»åŠ¡äºŒ - %@&quot;, [NSThread currentThread]);\n}\n</code></pre><p>ä»¥ä¸Š<code>- (void)case1</code>é»˜è®¤åœ¨å½“å‰çº¿ç¨‹(ä¸»çº¿ç¨‹)æ‰§è¡Œ,  é¦–å…ˆæ‰§è¡Œâ€ä»»åŠ¡ä¸€â€. ç„¶å<code>dispatch_sync</code>é˜»å¡å½“å‰çº¿ç¨‹(ä¸»çº¿ç¨‹), ç”±äºä¸»é˜Ÿåˆ—æ˜¯ä¸²è¡Œé˜Ÿåˆ—, ä»»åŠ¡ä¸èƒ½å¹¶å‘æ‰§è¡Œ, åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œ. åˆå› ä¸º<strong>â€œåŒæ­¥ä»»åŠ¡â€åå…¥åˆ—, æŒ‰ç…§FIFOåŸåˆ™, å¿…é¡»ç­‰åˆ°<code>- (void)case1</code>æ‰§è¡Œå®Œæ¯•æ‰èƒ½æ‰§è¡Œ</strong>, ä½†æ˜¯<code>- (void)case1</code>ä¸­çš„â€ä»»åŠ¡äºŒâ€åˆåœ¨ç­‰ç€â€åŒæ­¥ä»»åŠ¡â€æ‰§è¡Œå®Œæ¯•æ‰èƒ½æ‰§è¡Œ, è¿™æ ·å°±é€ æˆåŒä¸€é˜Ÿåˆ—ä¸­çš„ä¸¤ä¸ªä»»åŠ¡ç›¸äº’ç­‰å¾…, é€ æˆæ­»é”. </p>\n<p><img src=\"http://img.souche.com/f2e/5b1729532683ad164c061958d5248a66.png\" alt=\"æ¡ˆä¾‹1\"></p>\n<p>æœ‰ä¸¤ç§è§£å†³æ€è·¯, ä¸€æ˜¯ä¸ºå½“å‰é˜Ÿåˆ—æ‰©å®¹, è®©å®ƒå˜æˆå¹¶è¡Œé˜Ÿåˆ—, å°±ä¸ä¼šé€ æˆé˜»å¡. ç¬¬äºŒç§è§£å†³æ€è·¯æ˜¯æŠŠåŒæ­¥ä»»åŠ¡æ·»åŠ åˆ°ä¸€ä¸ªæ–°çš„è‡ªå®šä¹‰ä¸²è¡Œé˜Ÿåˆ—ä¸­å», ä¸¤ä¸ªé˜Ÿåˆ—ä¹‹é—´ä¸å­˜åœ¨é˜»å¡å°±é¿å…äº†æ­»é”é—®é¢˜. </p>\n<h3 id=\"æ¡ˆä¾‹äºŒ\"><a href=\"#æ¡ˆä¾‹äºŒ\" class=\"headerlink\" title=\"æ¡ˆä¾‹äºŒ\"></a>æ¡ˆä¾‹äºŒ</h3><pre><code>- (void)case2 {\n    NSLog(@&quot;1&quot;);\n    //3ä¼šç­‰2ï¼Œå› ä¸º2åœ¨å…¨å±€å¹¶è¡Œé˜Ÿåˆ—é‡Œï¼Œä¸éœ€è¦ç­‰å¾…3ï¼Œè¿™æ ·2æ‰§è¡Œå®Œå›åˆ°ä¸»é˜Ÿåˆ—ï¼Œ3å°±å¼€å§‹æ‰§è¡Œ\n    dispatch_sync(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{\n        NSLog(@&quot;2&quot;);\n    });\n    NSLog(@&quot;3&quot;);\n}\n</code></pre><p>æ‰“å°é¡ºåºä¸€å®šä¸º1, 2, 3. 2æ–°å¼€é˜Ÿåˆ—, ä¸ä¼šé€ æˆæ­»é”. <code>case2</code>å’Œæ–°å¼€çš„blockä»»åŠ¡ä¹‹é—´æ²¡æœ‰é˜Ÿåˆ—çš„çº¦æŸ, ä½†æ˜¯ç”±äºæ˜¯åŒæ­¥ä»»åŠ¡,é˜»å¡çº¿ç¨‹, æ‰€ä»¥blockå…ˆæ‰§è¡Œ, æ‰§è¡Œå®Œæ¯•åå†å›åˆ°<code>case2</code>, æ¥ç€æ‰§è¡Œ.</p>\n<p><img src=\"http://img.souche.com/f2e/27086c860f921209238d3f60c2f8722c.png\" alt=\"æ¡ˆä¾‹2\"></p>\n<h3 id=\"æ¡ˆä¾‹ä¸‰\"><a href=\"#æ¡ˆä¾‹ä¸‰\" class=\"headerlink\" title=\"æ¡ˆä¾‹ä¸‰\"></a>æ¡ˆä¾‹ä¸‰</h3><pre><code>- (void)case3 {\n    dispatch_queue_t queue = dispatch_queue_create(&quot;com.demo.serialQueue&quot;, DISPATCH_QUEUE_SERIAL);\n    NSLog(@&quot;1&quot;); // ä»»åŠ¡1\n    dispatch_async(queue, ^{\n        NSLog(@&quot;2&quot;); // ä»»åŠ¡2\n        dispatch_sync(queue, ^{\n            NSLog(@&quot;3&quot;); // ä»»åŠ¡3\n        });\n        NSLog(@&quot;4&quot;); // ä»»åŠ¡4\n    });\n    NSLog(@&quot;5&quot;); // ä»»åŠ¡5\n}\n</code></pre><p>æ§åˆ¶å°è¾“å‡º1, 5, 2. (5, 2çš„é¡ºåºä¸ä¸€å®š). å¯ä»¥è‚¯å®š, ä½¿ç”¨çš„æ˜¯è‡ªå®šä¹‰ä¸²è¡Œé˜Ÿåˆ—. é¦–å…ˆæ‰§è¡Œä»»åŠ¡1, æ¥ä¸‹æ¥æœ‰ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡, æ–°å¼€è¾Ÿçº¿ç¨‹(å°†ä»»åŠ¡2, åŒæ­¥çº¿ç¨‹, ä»»åŠ¡4åŠ å…¥æ–°çº¿ç¨‹). å› ä¸ºæ˜¯å¼‚æ­¥çº¿ç¨‹, ä¸»çº¿ç¨‹ä¸­çš„ä»»åŠ¡5ä¸ç”¨ç­‰å¾…, æ‰€ä»¥ 2 å’Œ 5 çš„è¾“å‡ºé¡ºåºä¸å®š. ä»»åŠ¡2æ‰§è¡Œå®Œå, é‡åˆ°åŒæ­¥ä»»åŠ¡, å› ä¸ºæ˜¯åœ¨ä¸²è¡Œé˜Ÿåˆ—, æ‰€ä»¥ä¼šé˜»å¡å½“å‰çº¿ç¨‹, ä»»åŠ¡3æ‰§è¡Œå®Œåæ‰èƒ½æ‰§è¡Œä»»åŠ¡4. ä½†æ˜¯ä»»åŠ¡4æ¯”ä»»åŠ¡3æ—©åŠ å…¥é˜Ÿåˆ—, æ ¹æ®FIFOåŸåˆ™, ä»»åŠ¡3è¦ç­‰å¾…ä»»åŠ¡4æ‰§è¡Œå®Œåæ‰èƒ½æ‰§è¡Œ. ä»»åŠ¡3å’Œä»»åŠ¡4ç›¸äº’ç­‰å¾…é€ æˆæ­»é”. </p>\n<p><img src=\"http://img.souche.com/f2e/9c13eaeac28f7fe7105af2feb878d5ef.png\" alt=\"æ¡ˆä¾‹ä¸‰å›¾ç‰‡\"></p>\n<h3 id=\"æ¡ˆä¾‹å››\"><a href=\"#æ¡ˆä¾‹å››\" class=\"headerlink\" title=\"æ¡ˆä¾‹å››\"></a>æ¡ˆä¾‹å››</h3><pre><code>- (void)case4 {\n    NSLog(@&quot;1&quot;); // ä»»åŠ¡1\n    dispatch_async(dispatch_get_global_queue(0, 0), ^{\n        NSLog(@&quot;2&quot;); // ä»»åŠ¡2\n        dispatch_sync(dispatch_get_main_queue(), ^{\n            NSLog(@&quot;3&quot;); // ä»»åŠ¡3\n        });\n        NSLog(@&quot;4&quot;); // ä»»åŠ¡4\n    });\n    NSLog(@&quot;5&quot;); // ä»»åŠ¡5\n}\n</code></pre><p>æ‰“å°ç»“æœæ˜¯: 1, 5, 2, 3, 4.(2, 5çš„é¡ºåºä¸å®š). é¦–å…ˆåœ¨ä¸»çº¿ç¨‹ä¸­æœ‰ä¸‰ä¸ªä»»åŠ¡, åˆ†åˆ«æ˜¯ä»»åŠ¡1, å¹¶è¡Œé˜Ÿåˆ—çš„å¼‚æ­¥ä»»åŠ¡, ä»»åŠ¡5. å¹¶è¡Œé˜Ÿåˆ—çš„å¼‚æ­¥ä»»åŠ¡ä¸­åˆæœ‰ä¸‰ä¸ªä»»åŠ¡, åˆ†åˆ«æ˜¯ä»»åŠ¡2, å¼‚æ­¥ä»»åŠ¡, ä»»åŠ¡4.  </p>\n<p>æ‰€ä»¥å…ˆæ‰“å°1, ç„¶åæŠŠå¼‚æ­¥ä»»åŠ¡åŠ å…¥å…¨éƒ¨å¹¶è¡Œé˜Ÿåˆ—, ç”±äºæ˜¯å¼‚æ­¥ä»»åŠ¡æ–°å¼€è¾Ÿçº¿ç¨‹, ä¸é˜»å¡ä¸»çº¿ç¨‹, 5ä¸ç”¨ç­‰å¾…. æ‰€ä»¥2, 5é¡ºåºä¸å®š. ç„¶åå†åˆ†æå¹¶è¡Œé˜Ÿåˆ—ä¸­çš„å¼‚æ­¥ä»»åŠ¡, ä»»åŠ¡2æ‰§è¡Œåé‡åˆ°åŒæ­¥ä»»åŠ¡, åŒæ­¥ä»»åŠ¡è¢«åŠ å…¥åˆ°ä¸»çº¿ç¨‹(å› ä¸ºå‰é¢å·²ç»è¢«åŠ è¿‡3ä¸ªä»»åŠ¡, æ‰€ä»¥è¯¥ä»»åŠ¡åœ¨ä»»åŠ¡5åé¢). å› ä¸ºæ˜¯åŒæ­¥, é˜»å¡ä¸»çº¿ç¨‹, æ‰€ä»¥4ä¸€å®šåœ¨3åé¢. </p>\n<p><img src=\"http://img.souche.com/f2e/43a48f9de1c0bb336215543157ad875b.png\" alt=\"æ¡ˆä¾‹å››\"></p>\n<h3 id=\"æ¡ˆä¾‹äº”\"><a href=\"#æ¡ˆä¾‹äº”\" class=\"headerlink\" title=\"æ¡ˆä¾‹äº”\"></a>æ¡ˆä¾‹äº”</h3><pre><code>- (void)case5 {\n    dispatch_async(dispatch_get_global_queue(0, 0), ^{\n        NSLog(@&quot;1&quot;); // ä»»åŠ¡1\n        dispatch_sync(dispatch_get_main_queue(), ^{\n            NSLog(@&quot;2&quot;); // ä»»åŠ¡2\n        });\n        NSLog(@&quot;3&quot;); // ä»»åŠ¡3\n    });\n    NSLog(@&quot;4&quot;); // ä»»åŠ¡4\n    while (1) {\n    }\n    NSLog(@&quot;5&quot;); // ä»»åŠ¡5\n}\n</code></pre><p>æ‰“å°ç»“æœæ˜¯: 1, 4(é¡ºåºä¸å®š). é¦–å…ˆä¸»çº¿ç¨‹ä¸­æœ‰å››ä¸ªä»»åŠ¡, åˆ†åˆ«æ˜¯å…¨å±€å¹¶è¡Œé˜Ÿåˆ—çš„å¼‚æ­¥ä»»åŠ¡, ä»»åŠ¡4, æ­»å¾ªç¯, ä»»åŠ¡5. å…¨å±€å¹¶è¡Œé˜Ÿåˆ—çš„å¼‚æ­¥ä»»åŠ¡ä¸­åˆæœ‰ä¸‰ä¸ªä»»åŠ¡, åˆ†åˆ«æ˜¯ä»»åŠ¡1, ä¸»çº¿ç¨‹çš„åŒæ­¥ä»»åŠ¡(ä»»åŠ¡2), ä»»åŠ¡3. </p>\n<p>ç”±äºæ˜¯å¼‚æ­¥ä»»åŠ¡, ä¸é˜»å¡ä¸»çº¿ç¨‹, æ‰€ä»¥å…¨å±€å¹¶è¡Œé˜Ÿåˆ—çš„å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œé¡ºåºå’Œä»»åŠ¡4ä¸å®š, å…¨å±€å¹¶è¡Œé˜Ÿåˆ—çš„å¼‚æ­¥ä»»åŠ¡åˆæ˜¯å…ˆæ‰§è¡Œä»»åŠ¡1, æ‰€ä»¥ä»»åŠ¡1å’Œä»»åŠ¡4çš„é¡ºåºä¸å®š. å½“ä»»åŠ¡4æ‰§è¡Œå®Œå, è¿›å…¥æ­»å¾ªç¯, ä¸»çº¿ç¨‹è¢«é˜»å¡. ç”±äºåŒæ­¥ä»»åŠ¡(ä»»åŠ¡2)æ˜¯è¢«åŠ åœ¨ä¸»çº¿ç¨‹ä¸­, ä½†æ˜¯æ­¤æ—¶ä¸»çº¿ç¨‹å·²è¢«é˜»å¡, æ‰€ä»¥2ä¸ä¼šè¢«æ‰§è¡Œ. ä»»åŠ¡3åˆæ˜¯åœ¨ä»»åŠ¡2åè¢«åŠ å…¥é˜Ÿåˆ—, ä»»åŠ¡2æ˜¯åŒæ­¥ä»»åŠ¡, æ‰€ä»¥ä»»åŠ¡3è¦ç­‰å¾…ä»»åŠ¡2å®Œæˆæ‰æ‰§è¡Œ. æ‰€ä»¥ä»»åŠ¡2, ä»»åŠ¡3éƒ½ä¸ä¼šæ‰§è¡Œ. ä»»åŠ¡5åœ¨æ­»å¾ªç¯åæ‰§è¡Œ, æ‰€ä»¥ä»»åŠ¡5æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œ. å¦‚æœæ²¡æœ‰æ­»å¾ªç¯, ä»»åŠ¡2è‚¯å®šåœ¨ä»»åŠ¡ååé¢, ä»»åŠ¡3è‚¯å®šåœ¨ä»»åŠ¡2åé¢. </p>\n<p><img src=\"http://img.souche.com/f2e/0d108cba7a737b62e2f5e1be402bc5d0.png\" alt=\"æ¡ˆä¾‹äº”\"></p>\n<hr>\n<p>å‚è€ƒèµ„æ–™:</p>\n<p>1.<a href=\"http://www.cocoachina.com/ios/20150731/12819.html\" target=\"_blank\" rel=\"noopener\">å…³äºiOSå¤šçº¿ç¨‹, ä½ çœ‹æˆ‘å°±å¤Ÿäº†</a></p>\n<p>2.<a href=\"https://bestswifter.com/multithreadconclusion/\" target=\"_blank\" rel=\"noopener\">iOSå¤šçº¿ç¨‹ç¼–ç¨‹æ€»ç»“</a></p>\n<p>3.<a href=\"http://www.jianshu.com/p/51fd1362249e\" target=\"_blank\" rel=\"noopener\">å…³äºiOSå¤šçº¿ç¨‹, æˆ‘è¯´, ä½ å¬, æ²¡å‡†ä½ å°±æ‡‚äº†</a></p>\n<p>4.<a href=\"http://www.jianshu.com/p/06a18323d9d2\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç†è§£ GCD</a></p>\n<p>5.<a href=\"http://www.jianshu.com/p/6a6722f12fe3\" target=\"_blank\" rel=\"noopener\">å…³äº iOS å¤šçº¿ç¨‹, éƒ½åœ¨è¿™é‡Œäº†</a></p>\n<p>6.<a href=\"http://blog.csdn.net/mxsgoden/article/details/8821936\" target=\"_blank\" rel=\"noopener\">è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«</a></p>\n<p>7.<a href=\"https://laike9m.com/blog/huan-zai-yi-huo-bing-fa-he-bing-xing,61/\" target=\"_blank\" rel=\"noopener\">å¹¶å‘å’Œå¹¶è¡Œ</a></p>\n","categories":["åŸºç¡€çŸ¥è¯†"],"tags":["åŸºç¡€çŸ¥è¯†"]},{"title":"JavaScriptç¬¬äºŒå¼¹","url":"http://hchong.net/2017/08/22/JavaScriptç¬¬äºŒå¼¹/","content":"<h1 id=\"JavaScriptç¬¬äºŒå¼¹\"><a href=\"#JavaScriptç¬¬äºŒå¼¹\" class=\"headerlink\" title=\"JavaScriptç¬¬äºŒå¼¹\"></a>JavaScriptç¬¬äºŒå¼¹</h1><p>ç¬¬ä¸€å¼¹ä¸»è¦æ˜¯ä¸€äº›åŸºæœ¬è¯­æ³•, æ•°æ®ç±»å‹å’Œå˜é‡. è¿™ä¸€å¼¹æ¥è¯´ä¸€ä¸‹å­—ç¬¦ä¸², æ•°ç»„å’Œå¯¹è±¡. </p>\n<blockquote>\n<p>åœ¨ <code>JavaScript</code>ä¸­ï¼Œå¯¹è±¡çš„å®šä¹‰æ˜¯æ‹¥æœ‰å±æ€§å’Œæ–¹æ³•çš„æ•°æ®.<br>ä¸¥æ ¼æ¥è®², <code>JavaScript</code>ä¸­çš„æ‰€æœ‰äº‹ç‰©éƒ½æ˜¯å¯¹è±¡ï¼šå­—ç¬¦ä¸², æ•°å­—, æ•°ç»„, æ—¥æœŸï¼Œç­‰ç­‰.</p>\n</blockquote>\n<h2 id=\"å­—ç¬¦ä¸²\"><a href=\"#å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²\"></a>å­—ç¬¦ä¸²</h2><p>å’ŒOCçš„æ²¡ä»€ä¹ˆå¤ªå¤§çš„åŒºåˆ«, è¿™é‡Œåªè¯´å‡ ç‚¹æ¯”è¾ƒç‰¹æ®Šçš„.</p>\n<ul>\n<li>å¯ä»¥ä½¿ç”¨åå¼•å·` <code>...</code> `æ¥æ ‡è®°ä¸€ä¸²å¸¦ç¬¦å·çš„æ–‡æœ¬, ä¾‹å¦‚</li>\n</ul>\n<pre><code>alert(`ä½ å¥½, \nå“ˆå“ˆ`);\n</code></pre><p>ä¸­é—´çš„æ‰€æœ‰ç¬¦å·éƒ½ä¼šè¢«ä¿ç•™ä¸‹æ¥, </p>\n<ul>\n<li>è¿˜å¯ä»¥åœ¨åœ¨` <code>ä½ å¥½ + ${string}</code> `æ¥æ‹¼æ¥å­—ç¬¦ä¸², å…¶ä¸­<code>${String}</code>ä»£è¡¨ä¸€ä¸ªå«åš<code>String</code>çš„å˜é‡</li>\n</ul>\n<h2 id=\"æ•°ç»„\"><a href=\"#æ•°ç»„\" class=\"headerlink\" title=\"æ•°ç»„\"></a>æ•°ç»„</h2><p>åŒºåˆ«äºOCçš„æ•°ç»„, <code>JavaScript</code>çš„<code>Array</code>å¯ä»¥åŒ…å«ä»»æ„çš„æ•°æ®ç±»å‹, é€šè¿‡ç´¢å¼•æ¥è®¿é—®æ¯ä¸ªå…ƒç´ .</p>\n<p>Arrayå±æ€§:</p>\n<blockquote>\n<p>constructor è¿”å›å¯¹åˆ›å»ºæ­¤å¯¹è±¡çš„æ•°ç»„å‡½æ•°çš„å¼•ç”¨.<br>length è®¾ç½®æˆ–è¿”å›æ•°ç»„ä¸­å…ƒç´ çš„æ•°ç›®.<br>prototype ä½¿æ‚¨æœ‰èƒ½åŠ›å‘å¯¹è±¡æ·»åŠ å±æ€§å’Œæ–¹æ³•.</p>\n</blockquote>\n<p>Array å¯¹è±¡æ–¹æ³•:</p>\n<blockquote>\n<p>indexOf() æœç´¢ä¸€ä¸ªæŒ‡å®šçš„å…ƒç´ çš„ä½ç½®.<br>concat() è¿æ¥ä¸¤ä¸ªæˆ–æ›´å¤šçš„æ•°ç»„ï¼Œå¹¶è¿”å›ç»“æœ.<br>join() æŠŠæ•°ç»„çš„æ‰€æœ‰å…ƒç´ æ”¾å…¥ä¸€ä¸ªå­—ç¬¦ä¸².å…ƒç´ é€šè¿‡æŒ‡å®šçš„åˆ†éš”ç¬¦è¿›è¡Œåˆ†éš”.<br>pop() åˆ é™¤å¹¶è¿”å›æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ <br>push() å‘æ•°ç»„çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªæˆ–æ›´å¤šå…ƒç´ ï¼Œå¹¶è¿”å›æ–°çš„é•¿åº¦.<br>shift() åˆ é™¤å¹¶è¿”å›æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ .<br>unshift() å‘æ•°ç»„çš„å¼€å¤´æ·»åŠ ä¸€ä¸ªæˆ–æ›´å¤šå…ƒç´ ï¼Œå¹¶è¿”å›æ–°çš„é•¿åº¦.<br>reverse() é¢ å€’æ•°ç»„ä¸­å…ƒç´ çš„é¡ºåº.<br>slice() ä»æŸä¸ªå·²æœ‰çš„æ•°ç»„è¿”å›é€‰å®šçš„å…ƒç´ .<br>sort() å¯¹æ•°ç»„çš„å…ƒç´ è¿›è¡Œæ’åº.<br>splice(loc, len, newElement, â€¦) åˆ é™¤å…ƒç´ ï¼Œå¹¶å‘æ•°ç»„æ·»åŠ æ–°å…ƒç´ .<br>toSource() è¿”å›è¯¥å¯¹è±¡çš„æºä»£ç .<br>toString() æŠŠæ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ç»“æœ.<br>toLocaleString() æŠŠæ•°ç»„è½¬æ¢ä¸ºæœ¬åœ°æ•°ç»„ï¼Œå¹¶è¿”å›ç»“æœ.<br>valueOf() è¿”å›æ•°ç»„å¯¹è±¡çš„åŸå§‹å€¼.</p>\n</blockquote>\n<p>åœ¨è¿™é‡Œéœ€è¦æ³¨æ„, ç›´æ¥ä½¿ç”¨<code>arr.length</code>æ˜¯ä¼šæ”¹å˜åŸ<code>arr</code>çš„é•¿åº¦çš„, æ²¡æœ‰è¢«èµ‹å€¼çš„å…ƒç´ å°±ä¼šå˜ä¸º<code>undefined</code>, ç›´æ¥é€šè¿‡ç´¢å¼•èµ‹å€¼, ä¹Ÿä¼šå‡ºç°è¿™ä¸ªé—®é¢˜. ä¾‹å¦‚:</p>\n<pre><code>var arr1 = [1, 2, 3];\narr1.length; // 3\narr1.length = 6;\narr1; // arr1å˜ä¸º[1, 2, 3, undefined, undefined, undefined]\narr1.length = 2;\narr1; // arr1å˜ä¸º[1, 2]\n\nvar arr2 = [1, 2, 3];\narr2[5] = &#39;x&#39;;\narr2; // arr2å˜ä¸º[1, 2, 3, undefined, undefined, &#39;x&#39;]\n</code></pre><p>å¤§å¤šæ•°å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸å…è®¸ç›´æ¥æ”¹å˜æ•°ç»„çš„å¤§å°ï¼Œè¶Šç•Œè®¿é—®ç´¢å¼•ä¼šæŠ¥é”™ã€‚ç„¶è€Œï¼ŒJavaScriptçš„Arrayå´ä¸ä¼šæœ‰ä»»ä½•é”™è¯¯ã€‚åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œä¸å»ºè®®ç›´æ¥ä¿®æ”¹Arrayçš„å¤§å°ï¼Œè®¿é—®ç´¢å¼•æ—¶è¦ç¡®ä¿ç´¢å¼•ä¸ä¼šè¶Šç•Œ.</p>\n","categories":["JavaScript"],"tags":["åŸºç¡€çŸ¥è¯†","JavaScript"]},{"title":"JavaScriptç¬¬ä¸€å¼¹","url":"http://hchong.net/2017/08/18/JavaScriptç¬¬ä¸€å¼¹/","content":"<h1 id=\"JavaScriptç¬¬ä¸€å¼¹\"><a href=\"#JavaScriptç¬¬ä¸€å¼¹\" class=\"headerlink\" title=\"JavaScriptç¬¬ä¸€å¼¹\"></a>JavaScriptç¬¬ä¸€å¼¹</h1><p>ä¸»è¦æ˜¯ä¸€äº›JavaScriptçš„ä¸€äº›åŸºç¡€çŸ¥è¯†, å’ŒOCçš„ä¸€äº›åŒºåˆ«</p>\n<h2 id=\"å…¥é—¨\"><a href=\"#å…¥é—¨\" class=\"headerlink\" title=\"å…¥é—¨\"></a>å…¥é—¨</h2><p>JavaScriptå¯ä»¥åµŒåœ¨ç½‘é¡µçš„ä»»æ„åœ°æ–¹, ä¸è¿‡é€šå¸¸æœ‰ä¸¤ç§å†™æ³•:</p>\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n  &lt;script&gt;\n        JavaScriptä»£ç \n  &lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  ...\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><p>æˆ–è€…æŠŠJavaScriptä»£ç æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„<code>.js</code>æ–‡ä»¶ä¸­, ç„¶ååœ¨HTMLä¸­å¼•ç”¨</p>\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n  &lt;script src=&quot;.jsæ–‡ä»¶çš„è·¯å¾„&quot;&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  ...\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><p>æŠŠJavaScriptä»£ç æ”¾å…¥ä¸€ä¸ªå•ç‹¬çš„<code>.js</code>æ–‡ä»¶ä¸­æ›´åˆ©äºç»´æŠ¤ä»£ç ï¼Œå¹¶ä¸”å¤šä¸ªé¡µé¢å¯ä»¥å„è‡ªå¼•ç”¨åŒä¸€ä»½<code>.js</code>æ–‡ä»¶ã€‚</p>\n<p>å¯ä»¥åœ¨åŒä¸€ä¸ªé¡µé¢ä¸­å¼•å…¥å¤šä¸ª<code>.js</code>æ–‡ä»¶ï¼Œè¿˜å¯ä»¥åœ¨é¡µé¢ä¸­å¤šæ¬¡ç¼–å†™<code>&lt;script&gt; jsä»£ç ... &lt;/script&gt;</code>ï¼Œæµè§ˆå™¨æŒ‰ç…§é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚</p>\n<h2 id=\"æ•°æ®ç±»å‹\"><a href=\"#æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"æ•°æ®ç±»å‹\"></a>æ•°æ®ç±»å‹</h2><p>JavaScript æ‹¥æœ‰åŠ¨æ€ç±»å‹ã€‚è¿™æ„å‘³ç€ç›¸åŒçš„å˜é‡å¯ç”¨ä½œä¸åŒçš„ç±»å‹, è¿™ä¸€ç‚¹å’ŒOCæ˜¯æœ‰åŒºåˆ«çš„.</p>\n<h3 id=\"å­—ç¬¦ä¸²\"><a href=\"#å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²\"></a>å­—ç¬¦ä¸²</h3><p>å­—ç¬¦ä¸²æ˜¯ä»¥<code>å•å¼•å·&#39;</code>æˆ–<code>åŒå¼•å·&quot;</code>æ‹¬èµ·æ¥çš„ä»»æ„æ–‡æœ¬, è¿™å’ŒOCçš„ç•¥æœ‰ä¸åŒ. å’ŒOCçš„å­—ç¬¦ä¸²åˆå§‹åŒ–ä¸åŒçš„æ˜¯, JSåªéœ€ç”¨å¼•å·æ‹¬èµ·æ¥å°±ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ä¸²äº†.</p>\n<h3 id=\"æ¯”è¾ƒè¿ç®—ç¬¦\"><a href=\"#æ¯”è¾ƒè¿ç®—ç¬¦\" class=\"headerlink\" title=\"æ¯”è¾ƒè¿ç®—ç¬¦\"></a>æ¯”è¾ƒè¿ç®—ç¬¦</h3><p>JavaScriptå…è®¸å¯¹ä»»æ„æ•°æ®ç±»å‹åšæ¯”è¾ƒ. è¦ç‰¹åˆ«æ³¨æ„ç›¸ç­‰è¿ç®—ç¬¦<code>==</code>ã€‚JavaScriptåœ¨è®¾è®¡æ—¶ï¼Œæœ‰ä¸¤ç§æ¯”è¾ƒè¿ç®—ç¬¦ï¼š</p>\n<ul>\n<li>ç¬¬ä¸€ç§æ˜¯<code>==</code>æ¯”è¾ƒï¼Œå®ƒä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹å†æ¯”è¾ƒï¼Œå¾ˆå¤šæ—¶å€™ï¼Œä¼šå¾—åˆ°éå¸¸è¯¡å¼‚çš„ç»“æœï¼›</li>\n<li>ç¬¬äºŒç§æ˜¯<code>===</code>æ¯”è¾ƒï¼Œå®ƒä¸ä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹ï¼Œå¦‚æœæ•°æ®ç±»å‹ä¸ä¸€è‡´ï¼Œè¿”å›falseï¼Œå¦‚æœä¸€è‡´ï¼Œå†æ¯”è¾ƒã€‚</li>\n</ul>\n<p>ç”±äºJavaScriptè¿™ä¸ªè®¾è®¡ç¼ºé™·ï¼Œä¸è¦ä½¿ç”¨==æ¯”è¾ƒï¼Œå§‹ç»ˆåšæŒä½¿ç”¨<code>===</code>æ¯”è¾ƒã€‚</p>\n<p>è¿™ä¸ªå’Œ<code>OC</code>ç±»ä¼¼, å¦‚æœä½¿ç”¨<code>===</code>æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªåŸºæœ¬æ•°æ®ç±»å‹, åªè¦å€¼ç›¸ç­‰å°±ä½<code>true</code>. ä½†æ˜¯å¦‚æœæ˜¯æ•°ç»„, å­—å…¸, å¯¹è±¡ç­‰å…¶ä»–ç±»å‹, é‚£æ¯”è¾ƒçš„å°±æ˜¯å†…å­˜åœ°å€, è€Œä¸æ˜¯å…ƒç´ .</p>\n<pre><code>var arr1 = [1,2,3];\nvar arr2 = [1,2,3];\nalert(arr1 === arr2)//false\n\nvar str1 = &#39;123&#39;;\nvar str2 = &#39;123&#39;;\nalert(str1 === str2);//true\n</code></pre><p>å…³äºæ•°ç»„å…ƒç´ çš„æ¯”è¾ƒ, å¦‚æœæ˜¯OCçš„è¯, å¯ä»¥ä½¿ç”¨<code>-(BOOL)isEquleToArray:(NSArray *)array;</code>æ¥æ¯”è¾ƒæ•°ç»„ä¸­çš„å…ƒç´ , ç„¶è€ŒJSæ²¡æœ‰è¿™ç§æ–¹æ³•, å¸¸è§çš„åšæ³•æ˜¯å…ˆæ’åº, å†è½¬æˆString, å†æ¯”è¾ƒStringæ˜¯å¦ç›¸ç­‰. å‚è€ƒ<a href=\"https://gist.github.com/smallnewer/6535788\" target=\"_blank\" rel=\"noopener\">equalArray.js</a></p>\n<p><code>NaN</code>è¿™ä¸ªå€¼é€šè¿‡<code>===</code>æ¥æ¯”è¾ƒå¤§å°æ°¸è¿œä¸º<code>false</code>, åŒ…æ‹¬ä¸è‡ªèº«æ¯”è¾ƒ. å”¯ä¸€çš„åˆ¤æ–­æ–¹æ³•å°±æ˜¯é€šè¿‡<code>isNaN()</code>å‡½æ•°.</p>\n<h3 id=\"nullå’Œundefined\"><a href=\"#nullå’Œundefined\" class=\"headerlink\" title=\"nullå’Œundefined\"></a>nullå’Œundefined</h3><p><code>null</code>è¡¨ç¤ºä¸€ä¸ªâ€œç©ºâ€çš„å€¼ç±»ä¼¼äºOCçš„<code>nil</code>ï¼Œå®ƒå’Œ0ä»¥åŠç©ºå­—ç¬¦ä¸²â€™â€™ä¸åŒï¼Œ0æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œâ€™â€™è¡¨ç¤ºé•¿åº¦ä¸º0çš„å­—ç¬¦ä¸²ï¼Œè€Œnullè¡¨ç¤ºâ€œç©ºâ€.</p>\n<p>è¿˜æœ‰ä¸€ä¸ªå’Œnullç±»ä¼¼çš„undefinedï¼Œå®ƒè¡¨ç¤ºâ€œæœªå®šä¹‰â€. JavaScriptçš„è®¾è®¡è€…å¸Œæœ›ç”¨nullè¡¨ç¤ºä¸€ä¸ªç©ºçš„å€¼ï¼Œè€Œundefinedè¡¨ç¤ºå€¼æœªå®šä¹‰.</p>\n<ul>\n<li>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½åº”è¯¥ç”¨null.</li>\n<li>undefinedä»…ä»…åœ¨åˆ¤æ–­å‡½æ•°å‚æ•°æ˜¯å¦ä¼ é€’çš„æƒ…å†µä¸‹æœ‰ç”¨, æœªä½¿ç”¨å€¼æ¥å£°æ˜çš„å˜é‡ï¼Œå…¶å€¼å®é™…ä¸Šæ˜¯ undefined.</li>\n</ul>\n<h2 id=\"å˜é‡\"><a href=\"#å˜é‡\" class=\"headerlink\" title=\"å˜é‡\"></a>å˜é‡</h2><p>å˜é‡å’ŒOCçš„å˜é‡æ˜¯ä¸€æ ·çš„, ä½†æ˜¯å‘½åè§„åˆ™æœ‰æ‰€ä¸åŒ. å˜é‡åæ˜¯å¤§å°å†™, æ•°å­—, <code>$</code>, å’Œ<code>_</code>ç»„åˆ, ä¸”ä¸èƒ½ç”¨æ•°å­—å¼€å¤´. </p>\n<p>å’ŒOCä¸€æ ·, ä½¿ç”¨<code>=</code>å¯¹å˜é‡è¿›è¡Œèµ‹å€¼, ç”±äºJSæ˜¯ä¸€é—¨åŠ¨æ€è¯­è¨€, åœ¨åˆå§‹åŒ–å˜é‡æ—¶å¯ä»¥ä¸æŒ‡å®šå˜é‡ç±»å‹, è¿™ä¸OCç•¥æœ‰ä¸åŒ.</p>\n<p>ä»…ä»…å£°æ˜ä½†æ˜¯æ²¡æœ‰èµ‹å€¼çš„å˜é‡, å…¶å€¼å®é™…ä¸Šæ˜¯<code>undefined</code>.</p>\n<pre><code>var carname;\nconsole.log(carname);\n</code></pre><hr>\n<p>1.<a href=\"http://www.bootcss.com/p/underscore/\" target=\"_blank\" rel=\"noopener\">Underscore - ä¸€ä¸ªJavaScript å·¥å…·åº“</a>.<br>2.<a href=\"https://halfrost.com/lost_in_javascript/\" target=\"_blank\" rel=\"noopener\">JavaScript æ–°æ‰‹çš„è¸©å‘æ—¥è®°</a>.</p>\n","categories":["JavaScript"],"tags":["åŸºç¡€çŸ¥è¯†","JavaScript"]},{"title":"UIViewç³»åˆ—ä¹‹---iOSçš„åŠ¨æ€é«˜åº¦","url":"http://hchong.net/2017/07/24/UIViewç³»åˆ—ä¹‹---iOSçš„åŠ¨æ€é«˜åº¦/","content":"<h1 id=\"UIViewç³»åˆ—ä¹‹â€”iOSçš„åŠ¨æ€é«˜åº¦\"><a href=\"#UIViewç³»åˆ—ä¹‹â€”iOSçš„åŠ¨æ€é«˜åº¦\" class=\"headerlink\" title=\"UIViewç³»åˆ—ä¹‹â€”iOSçš„åŠ¨æ€é«˜åº¦\"></a>UIViewç³»åˆ—ä¹‹â€”iOSçš„åŠ¨æ€é«˜åº¦</h1><p><a href=\"http://hchong.net/2017/08/30/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---UIView%E5%92%8CCALayer/\">UIViewç³»åˆ—ä¹‹â€”UIViewå’ŒCALayer</a><br><a href=\"http://hchong.net/2017/09/21/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---UIView%E7%9A%84%E5%B8%B8%E8%A7%81layout%E6%96%B9%E6%B3%95/\">UIViewç³»åˆ—ä¹‹â€”UIViewçš„å¸¸è§layoutæ–¹æ³•</a><br><a href=\"http://hchong.net/2017/09/24/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---iOS%E7%9A%84%E5%8A%A8%E6%80%81%E9%AB%98%E5%BA%A6/\">UIViewç³»åˆ—ä¹‹â€”iOSçš„åŠ¨æ€é«˜åº¦</a><br><a href=\"http://hchong.net/2017/09/21/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---%E5%A6%82%E4%BD%95%E5%86%99%E4%B8%80%E4%B8%AA%E8%87%AA%E5%AE%9A%E4%B9%89View/\">UIViewç³»åˆ—ä¹‹â€”å¦‚ä½•å†™ä¸€ä¸ªè‡ªå®šä¹‰View</a></p>\n<p>ä¸è®ºæ˜¯UITableViewCellçš„é«˜åº¦ä¹Ÿå¥½, æˆ–è€…æ˜¯ä¸€ä¸ªè¾“å…¥æ¡†ä¹Ÿå¥½, éƒ½ä¼šç”¨åˆ°åŠ¨æ€å¸ƒå±€. å®é™…ä¸Šå°±æ˜¯å¯¹ä¸€äº›æ˜¾ç¤ºæ–‡æœ¬å†…å®¹çš„æ§ä»¶è¿›è¡Œé«˜åº¦è®¡ç®—, ç„¶åæ ¹æ®å­è§†å›¾çš„çº¦æŸ, å¸ƒå±€æ¥å¾—åˆ°çˆ¶è§†å›¾çš„é«˜åº¦å¹¶ä¸”æ”¹å˜ä»–. </p>\n<h2 id=\"iOSå¸ƒå±€æœºåˆ¶å¤§æ¦‚åˆ†è¿™ä¹ˆå‡ ç§å¸¸è§çš„æ–¹å¼\"><a href=\"#iOSå¸ƒå±€æœºåˆ¶å¤§æ¦‚åˆ†è¿™ä¹ˆå‡ ç§å¸¸è§çš„æ–¹å¼\" class=\"headerlink\" title=\"iOSå¸ƒå±€æœºåˆ¶å¤§æ¦‚åˆ†è¿™ä¹ˆå‡ ç§å¸¸è§çš„æ–¹å¼:\"></a>iOSå¸ƒå±€æœºåˆ¶å¤§æ¦‚åˆ†è¿™ä¹ˆå‡ ç§å¸¸è§çš„æ–¹å¼:</h2><ul>\n<li><p>frame layout. frame layoutæœ€ç®€å•ç›´æ¥, å³é€šè¿‡è®¾ç½®viewçš„frameå±æ€§å€¼è¿›è€Œæ§åˆ¶viewçš„ä½ç½®(ç›¸å¯¹äºsuperviewçš„ä½ç½®)å’Œå¤§å°. </p>\n</li>\n<li><p>autoresizing. autoresizingå’Œframe layoutä¸€æ ·, ä»ä¸€å¼€å§‹å­˜åœ¨, å®ƒç®—æ˜¯å¯¹frame layoutçš„çš„è¡¥å……,, åŸºäºautoresizingæœºåˆ¶, èƒ½å¤Ÿè®©subviewå’Œsuperviewç»´æŒä¸€å®šçš„å¸ƒå±€å…³ç³», è­¬å¦‚è®©subviewçš„å¤§å°é€‚åº”superviewçš„å¤§å°,, éšç€åè€…çš„æ”¹å˜è€Œæ”¹å˜. </p>\n<p>  ç«™åœ¨ä»£ç æ¥å£çš„è§’åº¦æ¥çœ‹, autoresizingä¸»è¦ä½“ç°åœ¨å‡ ä¸ªå±æ€§ä¸Š, åŒ…æ‹¬(ä½†ä¸é™äº):</p>\n<ul>\n<li><p><code>translatesAutoresizingMaskIntoConstraints</code>. æ ‡è¯†viewæ˜¯å¦æ„¿æ„è¢«autoresize;</p>\n</li>\n<li><p><code>autoresizingMask</code>. æ˜¯ä¸€ä¸ªæšä¸¾å€¼, å†³å®šäº†å½“superviewçš„sizeæ”¹å˜æ—¶, subviewåº”è¯¥åšå‡ºä»€ä¹ˆæ ·çš„è°ƒæ•´;</p>\n<p>autoresizingå­˜åœ¨çš„ä¸è¶³æ˜¯éå¸¸æ˜¾è‘—çš„, é€šè¿‡autoresizingMaskçš„å¯é€‰æšä¸¾å€¼å¯ä»¥çœ‹å‡º: åŸºäºautoresizingæœºåˆ¶, æˆ‘ä»¬åªèƒ½è®©viewåœ¨superviewçš„å¤§å°æ”¹å˜æ—¶åšäº›è°ƒæ•´; è€Œæ— æ³•å¤„ç†å…„å¼Ÿviewä¹‹é—´çš„å…³ç³», è­¬å¦‚å¤„ç†ä¸å…„å¼Ÿviewçš„é—´éš”; æ›´æ— æ³•åå‘å¤„ç†, è­¬å¦‚è®©superviewä¾æ®subviewçš„å¤§å°è¿›è¡Œè°ƒæ•´. </p>\n</li>\n</ul>\n</li>\n<li><p>Auto layout. Auto Layoutæ˜¯éšç€iOS 6æ¨å‡ºæ¥çš„, å®ƒæ˜¯ä¸€ç§åŸºäºçº¦æŸçš„å¸ƒå±€ç³»ç»Ÿ, å¯ä»¥æ ¹æ®ä½ åœ¨å…ƒç´ (å¯¹è±¡)ä¸Šè®¾ç½®çš„çº¦æŸè‡ªåŠ¨è°ƒæ•´å…ƒç´ (å¯¹è±¡)çš„ä½ç½®å’Œå¤§å°å¯¹äºæŸä¸ªviewçš„å¸ƒå±€æ–¹å¼. </p>\n<blockquote>\n<p>Auto Layout is a system that lets you lay out your appâ€™s user interface by creating a mathematical description of the relationships between the elements. You define these relationships in terms of constraints either on individual elements, or between sets of elements. Using Auto Layout, you can create a dynamic and versatile interface that responds appropriately to changes in screen size, device orientation, and localization.</p>\n</blockquote>\n</li>\n</ul>\n<p>autoresizingå’Œauto layoutåªèƒ½äºŒé€‰ä¸€, ç®€å•æ¥è¯´, è‹¥è¦å¯¹æŸä¸ªviewé‡‡ç”¨auto layoutå¸ƒå±€, åˆ™éœ€è¦è®¾ç½®å…¶<code>translatesAutoresizingMaskIntoConstraints</code>å±æ€§å€¼ä¸ºNO.</p>\n<h2 id=\"å¸¸è§Auto-Layoutåœºæ™¯ä¸‹çš„è¿ç”¨\"><a href=\"#å¸¸è§Auto-Layoutåœºæ™¯ä¸‹çš„è¿ç”¨\" class=\"headerlink\" title=\"å¸¸è§Auto Layoutåœºæ™¯ä¸‹çš„è¿ç”¨\"></a>å¸¸è§Auto Layoutåœºæ™¯ä¸‹çš„è¿ç”¨</h2><p>ä¸‹é¢ä¸»è¦å°±å‡ ç§å¸¸è§åœºæ™¯ä¸‹, Auto Layoutçš„è¿ç”¨æ¥è¯´æ˜ä¸€ä¸‹ç”¨æ³•. åœ¨è¿™é‡Œå…ˆè¯´æ˜ä¸€ä¸ªæ¦‚å¿µ <em>Leaf-level views</em>, Leaf-level viewsæŒ‡çš„æ˜¯ä¸åŒ…å«ä»»ä½•subviewçš„view, è­¬å¦‚UILabel, UIButtonç­‰. ä½†æ˜¯æœ‰äº›viewä¸åŒ…å«content, è­¬å¦‚UIView, è¿™ç§viewè¢«è®¤ä¸ºã€Œhas no intrinsic sizeã€, å®ƒä»¬çš„intrinsicContentSizeè¿”å›çš„å€¼æ˜¯(-1, -1). </p>\n<h3 id=\"Leaf-level-viewsé«˜åº¦è®¡ç®—\"><a href=\"#Leaf-level-viewsé«˜åº¦è®¡ç®—\" class=\"headerlink\" title=\"Leaf-level viewsé«˜åº¦è®¡ç®—\"></a>Leaf-level viewsé«˜åº¦è®¡ç®—</h3><p>è¿™ç±»çš„viewå¾€å¾€èƒ½å¤Ÿç›´æ¥è®¡ç®—å‡ºcontent(è­¬å¦‚UILabelçš„text, UIButtonçš„title, UIImageViewçš„image)çš„å¤§å°. ä»¥UILabelä¸ºä¾‹:</p>\n<p>å‡è®¾æˆ‘ä»¬å·²ç»è®¾ç½®äº†UILabelçš„x, yå€¼çº¦æŸ, æ²¡æœ‰è®¾ç½®ä¸sizeæœ‰å…³çš„çº¦æŸ. å¦‚æœæˆ‘ä»¬è¦æ ¹æ®UILabelçš„æ–‡æœ¬å†…å®¹æ¥è®¡ç®—æœ€åˆé€‚çš„size, æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªCustom Label, ç»§æ‰¿äºUILabel, åœ¨Custom Labelä¸­é‡å†™<code>- (CGSize)intrinsicContentSize</code>æ–¹æ³•. è¿”å›æˆ‘ä»¬å¸Œæœ›è¿”å›çš„size. åœ¨éœ€è¦ä½¿ç”¨UILabelçš„åœ°æ–¹æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä½¿ç”¨Custom Labelæ¥å®ç°æå¾—çš„æ­£ç¡®è®¡ç®—. </p>\n<p>å…³äº<code>intrinsicContentSize</code>æ–¹æ³•çš„ç†è§£æ˜¯, Auto Layout Systemåœ¨layoutæ—¶, ä¸çŸ¥é“è¯¥ä¸ºviewåˆ†é…å¤šå¤§çš„size, å› æ­¤å›è°ƒviewçš„<code>intrinsicContentSize</code>æ–¹æ³•, è¯¥æ–¹æ³•ä¼šç»™auto layout systemä¸€ä¸ªåˆé€‚çš„size, systemæ ¹æ®æ­¤sizeå¯¹viewçš„å¤§å°è¿›è¡Œè®¾ç½®; </p>\n<pre><code>@interface CustomLabel : UILabel\n\n@end\n\n@implementation CustomLabel\n\n- (CGSize)intrinsicContentSize {\n    CGSize size = [super intrinsicContentSize];\n    size.width  += 20;\n    size.height += 20;\n    return size;\n}\n\n@end\n</code></pre><p>ä»¥ä¸Šå¦‚æœæ˜¯å•è¡Œlabelçš„è¯, å®ç°èµ·æ¥æ²¡é—®é¢˜. ä½†æ˜¯å¦‚æœlabelä¸€è¡Œæ˜¾ç¤ºä¸ä¸‹éœ€è¦æ¢è¡Œçš„è¯, é‚£äº‹æƒ…å°±æ²¡è¿™ä¹ˆç®€å•äº†. ä½†æ˜¯æ€ä¹ˆè®¡ç®—å¤šè¡Œlabelçš„é«˜åº¦å‘¢? æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•: </p>\n<p>ä¸‹é¢å‡ ç§æ–¹æ³•éƒ½éœ€è¦æˆ‘ä»¬é¦–å…ˆè®¾ç½®<code>preferredMaxLayoutWidth</code>, ä¹Ÿå°±æ˜¯UILabelçš„Widthæœ€å¤§å€¼, labelä¼šæ ¹æ®è¿™ä¸ªæœ€å¤§å€¼æ¥æ¢è¡Œ. å†è®¾ç½®<code>numberOfLines = 0</code>, æ¥å®ç°æ¢è¡Œ. ==æ³¨æ„:== <code>preferredMaxLayoutWidth</code>é€‚ç”¨äºæ²¡æœ‰æŒ‡å®šUILabelçš„Widthçš„æƒ…å†µ, å¦‚æœè®¾ç½®äº†Widthçš„çº¦æŸ, åˆè®¾ç½®äº†<code>preferredMaxLayoutWidth</code>. é‚£ä¹ˆè®¡ç®—sizeä¼šä»¥<code>preferredMaxLayoutWidth</code>ä¸ºå‡†, æ˜¾ç¤ºåˆ™ä»¥Widthçš„çº¦æŸä¸ºå‡†.</p>\n<ol>\n<li><p><code>boundingRectWithSize:options:attributes:context:</code></p>\n<p> <code>boundingRectWithSize:options:attributes:context:</code>æ˜¯NSStringçš„æ–¹æ³•. ç†è§£èµ·æ¥ä¹Ÿéå¸¸ç®€å•, æ ¹æ®ä¸€äº›ç»˜åˆ¶å­—ç¬¦çš„é€‰é¡¹å’Œå­—ç¬¦å±æ€§(å­—ä½“, å­—å·, å­—ä½“é¢œè‰²)ç­‰ä¿¡æ¯è¿”å›ä¸€ä¸ªå¯ä»¥å®¹çº³å­—ç¬¦ä¸²å†…å®¹çš„CGRect. å®ƒåŒæ ·ä¹Ÿéœ€è¦ä¸€ä¸ªCGSizeæ¥ç¡®å®šç»˜åˆ¶åŒºåŸŸ.<br> size: é€šå¸¸ä½ å¯ä»¥ä¼ ä¸€ä¸ªä»»æ„çš„Size, å®ƒä¼šè¿”å›ä¸€ä¸ªå®ƒè®¤ä¸ºæœ€åˆé€‚çš„CGSizeç»™ä½ . ä¸è¿‡å¦‚æœè¦æƒ³æŠŠè§†å›¾çš„å†…å®¹æ˜¾ç¤ºå®Œå…¨(çºµå‘), æœ€å¥½æ˜¯å°†è§†å›¾çš„å®é™…å®½åº¦å’Œæœ€å¤§é«˜åº¦<code>CGFLOAT_MAX</code>ä½œä¸ºå‚æ•°ä¼ é€’. è¿™æ ·è¿”å›çš„æ‰æ˜¯å®Œå…¨æ˜¾ç¤ºå†…å®¹çš„Size.<br> options: é»˜è®¤æƒ…å†µä¸‹è¿™ä¸ªæ–¹æ³•ä¸ä¼šç»˜åˆ¶å¤šè¡Œ, å¦‚æœè¦ç»˜åˆ¶å¤šè¡Œå­—ç¬¦, é‚£ä¹ˆoptionså‚æ•°å¿…é¡»ä¸º: <code>NSStringDrawingUsesLineFragmentOrigin</code>.<br> attributes: å­—ç¬¦å±æ€§ä¿¡æ¯ä¹Ÿéå¸¸é‡è¦. å¦‚æœè¦æ˜¾ç¤ºUILabelçš„å…¨éƒ¨å†…å®¹, å¿…é¡»ä¼ é€’è¿™ä¸ªå‚æ•°. ä»¥ç¡®ä¿ç»˜åˆ¶çš„å­—ä½“å¤§å°å’ŒUILabelçš„å­—ä½“å¤§å°ä¸€è‡´, </p>\n<p> æœ€åä¸€ä¸ªå…³é”®ç‚¹æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›çš„CGRectä¸­Sizeçš„widthå’Œheightéƒ½æ˜¯å°æ•°ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨ceilå‡½æ•°æ‰èƒ½ç¡®ä¿ç»“æœçš„å‡†ç¡®æ€§ã€‚</p>\n</li>\n<li><p><span id=\"sizeThatFits\">sizeThatFits:</span></p>\n<blockquote>\n<p>Asks the view to calculate and return the size that best fits the specified size.</p>\n<p>Return Value<br>A new size that fits the receiverâ€™s subviews.</p>\n<p>Discussion<br>The default implementation of this method returns the existing size of the view. Subclasses can override this method to return a custom value based on the desired layout of any subviews. For example, a UISwitch object returns a fixed size value that represents the standard size of a switch view, and a UIImageView object returns the size of the image it is currently displaying.</p>\n</blockquote>\n<p> sizeThatFits: æ–¹æ³•æ„å‘³ç€ã€Œæ ¹æ®æ–‡æœ¬è®¡ç®—æœ€é€‚åˆçš„sizeã€, ä½†æ˜¯å¹¶ä¸æ”¹å˜è°ƒç”¨è€…çš„size. å®ƒéœ€è¦ä¼ å…¥ä¸€ä¸ªCGSizeå‚æ•°è¿™ä¸ªå‚æ•°å’Œ<code>boundingRectWithSize:options:attributes:context:</code>ä¸­sizeçš„ä½œç”¨å’Œæ„ä¹‰æ˜¯ä¸€æ ·çš„. </p>\n</li>\n<li><p><span id=\"sizeToFit\">sizeToFit:</span></p>\n<blockquote>\n<p>calls sizeThatFits: with current view bounds and changes bounds size. </p>\n</blockquote>\n<p> <code>sizeToFit</code>å†…éƒ¨ä¼šè°ƒç”¨<code>sizeThatFits:</code>æ–¹æ³•, ç„¶åæ”¹å˜è°ƒç”¨è€…çš„size. sizeToFitçš„ä¼ªä»£ç å¤§è‡´å¦‚ä¸‹ï¼š</p>\n<pre><code>// calls sizeThatFits\nCGSize size = [self sizeThatFits:self.bounds.size];\n// change bounds size\nCGRect bounds = self.bounds;\nbounds.size.width = size.width;\nbounds.size.height = size.width;\nself.bounds = bounds;\n</code></pre></li>\n<li><p><span id=\"systemLayoutSizeFittingSize\">systemLayoutSizeFittingSize</span> </p>\n<p> <code>systemLayoutSizeFittingSize</code>, å®ƒä¹Ÿæ˜¯UIViewçš„æ–¹æ³•, æ˜¯AutoLayoutè¯ç”Ÿåçš„äº§ç‰©. æ‰€ä»¥ä½¿ç”¨å®ƒçš„å‰ææ˜¯éœ€è¦å±•ç¤ºå†…å®¹çš„æ§ä»¶(è¿™é‡ŒæŒ‡çš„å°±æ˜¯UILabel)å¿…é¡»çº¦æŸå®Œç¾. ä¸ç„¶å°±ä¸ä¼šèµ·ä½œç”¨ã€‚è€Œä¸”å¿…é¡»è¦è®¾ç½®UILabelçš„<code>preferredMaxLayoutWidth</code>å±æ€§.<br> è¿™ä¸ªå±æ€§éå¸¸é‡è¦, å®ƒå½±å“ç€layout. å¦‚æœè®¾ç½®äº†<code>preferredMaxLayoutWidth</code>, å½“å†…å®¹è¶…è¿‡çº¦æŸåŒºåŸŸ, å°±ä¼šè‡ªåŠ¨æ¢è¡Œå¹¶ä¸”æ›´æ–°çº¦æŸ. åœ¨è‰¯å¥½çº¦æŸçš„å‰æä¸‹, <code>systemLayoutSizeFittingSize</code>åŒæ ·æ¥å—ä¸€ä¸ªCGSize, ä¸åŒçš„æ˜¯è¿™æ¬¡ä¸ç”¨è®¡ç®—äº†, ç›´æ¥ä½¿ç”¨ç³»ç»Ÿæä¾›çš„Fitting Sizeå³å¯:</p>\n<pre><code>const CGSize UILayoutFittingCompressedSize; //åœ¨ä¿è¯é€‚å½“å°ºå¯¸çš„å‰æä¸‹å°½é‡å‹ç¼©CGSizeçš„å¤§å°\nconst CGSize UILayoutFittingExpandedSize; //åœ¨ä¿è¯é€‚å½“å°ºå¯¸çš„å‰æä¸‹å°½é‡æ‰©å……CGSizeçš„å¤§å°\n</code></pre><p> æ‰€ä»¥ä¸ºäº†åˆšå¥½å°†UILabelçš„å†…å®¹æ˜¾ç¤ºå®Œå…¨ï¼Œåº”è¯¥ä½¿ç”¨UILayoutFittingCompressedSizeã€‚ä»£ç å¦‚ä¸‹ï¼š</p>\n<p> ```</p>\n</li>\n</ol>\n<ul>\n<li><p>(void)layoutSubviews {<br>  [super layoutSubviews];<br>  self.label.preferredMaxLayoutWidth = CGRectGetWidth(self.label.bounds);<br>  CGSize size = [self.label systemLayoutSizeFittingSize:UILayoutFittingCompressedSize];<br>  self.labelConstraintHeight.constant = size.height + (2 * MARGIN);<br>}<br>  ```</p>\n<p>  éœ€è¦æ³¨æ„çš„æ˜¯: çº¦æŸçš„ä¸Šä¸‹å·¦å³ä¸€å®šè¦å†™å¥½, ä½†æ˜¯ä¸èƒ½çº¦æŸUILabelçš„é«˜åº¦. å¦åˆ™å¯èƒ½ä¼šå¯¼è‡´è¿”å›çš„CGRectä¸å‡†ç¡®. <code>numberOfLines = 0</code> è®©Labelå¯ä»¥æ˜¾ç¤ºå¤šè¡Œå†…å®¹. è®¾ç½®<code>preferredMaxLayoutWidth</code>å±æ€§, ä½¿UILabelèƒ½è‡ªé€‚åº”å¤šè¡Œå†…å®¹. <code>UILayoutFittingCompressedSize</code> ä½¿ç”¨è¿™ä¸ªå‚æ•°ä¼šè¿”å›ç¬¦åˆæ¡ä»¶æœ€åˆé€‚çš„Size. æœ€åä¹Ÿè¦åŠ ä¸Šè¾¹è·, ä¸»è¦æ˜¯å› ä¸ºè¿™é‡Œæˆ‘ä»¬åœ¨å†…éƒ¨è®¡ç®—UILabelçš„Size, è€Œå¦‚æœåœ¨å¤–éƒ¨å¯¹Viewè°ƒç”¨<code>systemLayoutSizeFittingSize</code>æ–¹æ³•, å°±ä¼šå¾—åˆ°æ•´ä¸ªViewè§†å›¾çš„Size. </p>\n</li>\n</ul>\n<p><code>sizeThatFits:</code>å’Œ<code>boundingRectWithSize:options:attributes:context:</code>è¿™ä¸¤ä¸ªAPIä¹Ÿå¯ä»¥åœ¨ä¼ ç»Ÿå¸ƒå±€(åŸºäºFrame)çš„æƒ…å†µä¸‹ä½¿ç”¨. </p>\n<h3 id=\"éLeaf-level-viewsé«˜åº¦è®¡ç®—\"><a href=\"#éLeaf-level-viewsé«˜åº¦è®¡ç®—\" class=\"headerlink\" title=\"éLeaf-level viewsé«˜åº¦è®¡ç®—\"></a>éLeaf-level viewsé«˜åº¦è®¡ç®—</h3><p>ä»¥UITextViewæ˜¾ç¤ºæ–‡æœ¬ä¸ºä¾‹, è®©å…¶èƒ½å¤Ÿè‡ªé€‚åº”æ–‡æœ¬, å³æ ¹æ®æ–‡æœ¬è‡ªåŠ¨è°ƒæ•´å…¶å¤§å°; ç”±äº<code>intrinsicContentSize</code>çš„ç‰¹æ€§, å½“å…¶å†…éƒ¨å«æœ‰subViewæ—¶è¿”å›å€¼æ˜¯(-1, -1), æ— æ³•å‘auto layout systemä¼ é€’æˆ‘ä»¬æƒ³è¦ä¼ è¾¾çš„å€¼, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<a href=\"#sizeThatFits\">sizeThatFits</a>æˆ–è€…<a href=\"#sizeToFit\">sizeToFit</a>æ¥è®¡ç®—æˆ–è€…æ”¹å˜UITextViewçš„å¤§å°. </p>\n<p>==è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯:== å½“è°ƒç”¨<code>sizeThatFits:</code>çš„size=(width, height)ï¼Œå½“width/heightçš„å€¼ä¸º0æ—¶ï¼Œwidth/heightå°±è¢«è®¤ä¸ºæ˜¯æ— ç©·å¤§, sizeå°±ä¸èƒ½è¢«æ­£å¸¸çš„æ˜¾ç¤º. æ‰€ä»¥åŒºåˆ«äºUILabel, æˆ‘ä»¬çš„çº¦æŸä¸€å®šè¦è®¾ç½®å¥½Widthå’Œheight, å¦åˆ™ä½¿ç”¨<code>sizeToFit</code>ä¹Ÿä¸èƒ½æ­£ç¡®è®¡ç®—å‡º. </p>\n<h3 id=\"Leaf-level-viewså’ŒéLeaf-level-viewsæ··åˆä½¿ç”¨ä¸‹é«˜åº¦è®¡ç®—\"><a href=\"#Leaf-level-viewså’ŒéLeaf-level-viewsæ··åˆä½¿ç”¨ä¸‹é«˜åº¦è®¡ç®—\" class=\"headerlink\" title=\"Leaf-level viewså’ŒéLeaf-level viewsæ··åˆä½¿ç”¨ä¸‹é«˜åº¦è®¡ç®—\"></a>Leaf-level viewså’ŒéLeaf-level viewsæ··åˆä½¿ç”¨ä¸‹é«˜åº¦è®¡ç®—</h3><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦è®¡ç®—çš„æ˜¯æ ¹æ®subViewæ¥ç¡®å®šsuperViewçš„frame, å¤§è‡´åˆ†ä¸ºä¸€ä¸‹å‡ ç§æƒ…å†µ: </p>\n<ol>\n<li><p>å¤šä¸ªçº¯Leaf-level viewsçš„ç»„åˆä½¿ç”¨</p>\n<p> è¿™ä¸ªè®¡ç®—èµ·æ¥æ¯”è¾ƒç®€å•, æˆ‘ä»¬ä»¥ä¸€ä¸ªUIViewé‡Œé¢æ·»åŠ ä¸¤ä¸ªUILabelä¸ºä¾‹. æˆ‘ä»¬åªéœ€è¦ä»ä¸Šåˆ°ä¸‹, æŠŠsubViewsçš„å­çº¦æŸæ’‘æ»¡superView. éœ€è¦æ³¨æ„, å¦‚æœUILabeléœ€è¦æ¢è¡Œ, é‚£ä¹ˆé«˜åº¦çº¦æŸå°±ä¸èƒ½å†™, å¹¶ä¸”è¦è®¾ç½®<code>numberOfLines = 0</code>. è™½ç„¶æˆ‘ä»¬ä»€ä¹ˆä¹Ÿæ²¡åš, ä½†æ˜¯å­æ§ä»¶ä¼šé€šè¿‡<code>intrinsicContentSize</code>æ–¹æ³•å°†æœ€åˆé€‚çš„sizeå‘Šè¯‰superView. ä½†æ˜¯å¯¹äºsuperView, å› ä¸ºå®ƒæœ¬èº«æ˜¯UIVIew, ä»–çš„<code>intrinsicContentSize</code>è¿”å›æ˜¯(-1, -1), é‚£ä¹ˆå®ƒæ˜¯æ€ä¹ˆå¾—å‡ºæ­£ç¡®çš„ç»“æœå‘¢. auto layout systemåœ¨å¤„ç†æŸä¸ªviewçš„sizeæ—¶ï¼Œ<span id=\"size\">å‚è€ƒå€¼</span>åŒ…æ‹¬:</p>\n<ul>\n<li>è‡ªèº«çš„<code>intrinsicContentSize</code>æ–¹æ³•è¿”å›å€¼;</li>\n<li>subviewsçš„<code>intrinsicContentSize</code>æ–¹æ³•è¿”å›å€¼;</li>\n<li><p>è‡ªèº«å’Œsubviewsçš„constraints;</p>\n<p>ç³»ç»Ÿä¼šå°†superViewçš„sizeå’ŒsubViewsçš„çº¦æŸä»¥åŠ<code>intrinsicContentSize</code>è¿”å›çš„æ­£ç¡®sizeç›¸åŠ , ç„¶åæ¯”è¾ƒä¸¤ä¸ªå€¼çš„å¤§å°, ç„¶åå–æœ€å¤§çš„ä¸€ä¸ª.<br><img src=\"https://ws1.sinaimg.cn/large/006tKfTcgy1fjvnn0tr2lj30ok0ru0st.jpg\" alt=\"çº¦æŸ\"></p>\n<p>size1, size2, size3, åˆ†åˆ«æ˜¯label1, label2, superViewçš„<code>intrinsicContentSize</code>æ–¹æ³•è¿”å›çš„size.<br>width = max{91 + size1.width + 91 + size2.width, size3.width}<br>height = max{60 + size1.height + 36 + size2.height + 58, size3.height}</p>\n</li>\n</ul>\n</li>\n<li><p>å¤šä¸ªçº¯éLeaf-level viewsçš„ç»„åˆä½¿ç”¨</p>\n<p> ä»æ—§ä»¥UITextViewä¸ºä¾‹, å¦‚æœæ²¡æœ‰è®¾å®šUItextViewçš„heightå±æ€§çš„è¯, ç”±äºéLeaf-level viewsçš„<code>intrinsicContentSize</code>è¿”å›å€¼å€¼ä¸º(-1, -1). è®¾ç½®æŸä¸ªViewçš„sizeæœ‰ä¸‰ä¸ª<a href=\"#size\">å‚è€ƒå€¼</a>, åœ¨<code>intrinsicContentSize</code>æ–¹æ³•è¿”å›å€¼å’Œconstraintsä¸­å–æœ€å¤§å€¼ä¸º0, å¯¼è‡´height=0ä¸èƒ½æ­£å¸¸æ˜¾ç¤º. è§£å†³æ–¹æ¡ˆå‚è€ƒ<a href=\"#next\">ä¸‹ä¸€ä¸ª</a>;</p>\n</li>\n<li><p><span id=\"next\">Leaf-level viewså’ŒéLeaf-level viewsæ··åˆä½¿ç”¨</span></p>\n<p> å› ä¸ºæœ‰UItextViewè¿™ç§éLeaf-level viewsçš„å­˜åœ¨, ä¼šå¯¼è‡´superViewçš„sizeä¸èƒ½å¾—åˆ°æ­£å¸¸å€¼. è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§:</p>\n<ol>\n<li><p>è®¾ç½®éLeaf-level viewsçš„height, widthçº¦æŸ, å› ä¸º<code>intrinsicContentSize</code>æ–¹æ³•ä¸èƒ½æ­£å¸¸çš„è¿”å›size, ä½†æ˜¯å¦‚æœæˆ‘ä»¬è®¾ç½®äº†widthå’Œheightçº¦æŸ, constraintså°±ä¸ä¸º0, é‚£ä¹ˆå°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº†. </p>\n</li>\n<li><p>ä½¿ç”¨<code>systemLayoutSizeFittingSize:</code>, å…·ä½“ä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒ<a href=\"#systemLayoutSizeFittingSize\">systemLayoutSizeFittingSize:</a>.</p>\n</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"Cellçš„åŠ¨æ€é«˜åº¦è®¡ç®—\"><a href=\"#Cellçš„åŠ¨æ€é«˜åº¦è®¡ç®—\" class=\"headerlink\" title=\"Cellçš„åŠ¨æ€é«˜åº¦è®¡ç®—\"></a>Cellçš„åŠ¨æ€é«˜åº¦è®¡ç®—</h3><p>å¯¹äºä½¿ç”¨auto layoutæœºåˆ¶å¸ƒå±€çš„view, auto layout systemä¼šåœ¨å¸ƒå±€è¿‡ç¨‹ä¸­ç»¼åˆå„ç§çº¦æŸçš„è€ƒè™‘ä¸ºä¹‹è®¾ç½®ä¸€ä¸ªsize, åœ¨å¸ƒå±€å®Œæˆå, è¯¥sizeçš„å€¼å³ä¸ºview.frame.sizeçš„å€¼; è¿™åŒ…å«çš„å¦å¤–ä¸€å±‚æ„æ€, å³åœ¨å¸ƒå±€å®Œæˆå‰, æˆ‘ä»¬æ˜¯ä¸èƒ½é€šè¿‡view.frame.sizeå‡†ç¡®è·å–viewçš„sizeçš„. ä½†æœ‰æ—¶å€™, æˆ‘ä»¬éœ€è¦åœ¨auto layout systemå¯¹viewå®Œæˆå¸ƒå±€å‰å°±çŸ¥é“å®ƒçš„size, <code>systemLayoutSizeFittingSize:</code>æ–¹æ³•æ­£æ˜¯èƒ½å¤Ÿæ»¡è¶³è¿™ç§è¦æ±‚çš„API. <code>systemLayoutSizeFittingSize:</code>æ–¹æ³•ä¼šæ ¹æ®å…¶constraintsè¿”å›ä¸€ä¸ªåˆé€‚çš„sizeå€¼. </p>\n<p>åœ¨è¿™é‡Œçœ‹ä¸€ä¸‹æ¯”è¾ƒçŸ¥åçš„cellé«˜åº¦è®¡ç®—åº“<a href=\"https://github.com/forkingdog/UITableView-FDTemplateLayoutCell\" target=\"_blank\" rel=\"noopener\">UITableView-FDTemplateLayoutCell</a>çš„æ ¸å¿ƒé«˜åº¦è®¡ç®—æ–¹æ³•, å¤§ä½“ä¸Šå’Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„æ–¹æ³•å·®ä¸å¤š. Auto layout mode using <code>-systemLayoutSizeFittingSize:</code>, Frame layout mode using <code>-sizeThatFits:</code>. </p>\n<pre><code>- (CGFloat)fd_systemFittingHeightForConfiguratedCell:(UITableViewCell *)cell {\n    CGFloat contentViewWidth = CGRectGetWidth(self.frame);\n\n    // If a cell has accessory view or system accessory type, its content view&#39;s width is smaller\n    // than cell&#39;s by some fixed values.\n    if (cell.accessoryView) {\n        contentViewWidth -= 16 + CGRectGetWidth(cell.accessoryView.frame);\n    } else {\n        static const CGFloat systemAccessoryWidths[] = {\n            [UITableViewCellAccessoryNone] = 0,\n            [UITableViewCellAccessoryDisclosureIndicator] = 34,\n            [UITableViewCellAccessoryDetailDisclosureButton] = 68,\n            [UITableViewCellAccessoryCheckmark] = 40,\n            [UITableViewCellAccessoryDetailButton] = 48\n        };\n        contentViewWidth -= systemAccessoryWidths[cell.accessoryType];\n    }\n\n    // If not using auto layout, you have to override &quot;-sizeThatFits:&quot; to provide a fitting size by yourself.\n    // This is the same height calculation passes used in iOS8 self-sizing cell&#39;s implementation.\n    //\n    // 1. Try &quot;- systemLayoutSizeFittingSize:&quot; first. (skip this step if &#39;fd_enforceFrameLayout&#39; set to YES.)\n    // 2. Warning once if step 1 still returns 0 when using AutoLayout\n    // 3. Try &quot;- sizeThatFits:&quot; if step 1 returns 0\n    // 4. Use a valid height or default row height (44) if not exist one\n\n    CGFloat fittingHeight = 0;\n\n    if (!cell.fd_enforceFrameLayout &amp;&amp; contentViewWidth &gt; 0) {\n        // Add a hard width constraint to make dynamic content views (like labels) expand vertically instead\n        // of growing horizontally, in a flow-layout manner.\n        NSLayoutConstraint *widthFenceConstraint = [NSLayoutConstraint constraintWithItem:cell.contentView attribute:NSLayoutAttributeWidth relatedBy:NSLayoutRelationEqual toItem:nil attribute:NSLayoutAttributeNotAnAttribute multiplier:1.0 constant:contentViewWidth];\n        [cell.contentView addConstraint:widthFenceConstraint];\n\n        // Auto layout engine does its math\n        fittingHeight = [cell.contentView systemLayoutSizeFittingSize:UILayoutFittingCompressedSize].height;\n        [cell.contentView removeConstraint:widthFenceConstraint];\n\n        [self fd_debugLog:[NSString stringWithFormat:@&quot;calculate using system fitting size (AutoLayout) - %@&quot;, @(fittingHeight)]];\n    }\n\n    if (fittingHeight == 0) {\n#if DEBUG\n        // Warn if using AutoLayout but get zero height.\n        if (cell.contentView.constraints.count &gt; 0) {\n            if (!objc_getAssociatedObject(self, _cmd)) {\n                NSLog(@&quot;[FDTemplateLayoutCell] Warning once only: Cannot get a proper cell height (now 0) from &#39;- systemFittingSize:&#39;(AutoLayout). You should check how constraints are built in cell, making it into &#39;self-sizing&#39; cell.&quot;);\n                objc_setAssociatedObject(self, _cmd, @YES, OBJC_ASSOCIATION_RETAIN_NONATOMIC);\n            }\n        }\n#endif\n        // Try &#39;- sizeThatFits:&#39; for frame layout.\n        // Note: fitting height should not include separator view.\n        fittingHeight = [cell sizeThatFits:CGSizeMake(contentViewWidth, 0)].height;\n\n        [self fd_debugLog:[NSString stringWithFormat:@&quot;calculate using sizeThatFits - %@&quot;, @(fittingHeight)]];\n    }\n\n    // Still zero height after all above.\n    if (fittingHeight == 0) {\n        // Use default row height.\n        fittingHeight = 44;\n    }\n\n    // Add 1px extra space for separator line if needed, simulating default UITableViewCell.\n    if (self.separatorStyle != UITableViewCellSeparatorStyleNone) {\n        fittingHeight += 1.0 / [UIScreen mainScreen].scale;\n    }\n\n    return fittingHeight;\n}\n</code></pre><p><a href=\"http://www.cocoachina.com/industry/20140604/8668.html\" target=\"_blank\" rel=\"noopener\">è¿™ç¯‡æ–‡ç« </a>ä¹Ÿæœ‰ä¸€äº›å¸¸è§cellå¸ƒå±€çš„é«˜åº¦è®¡ç®—æ–¹æ³•, å¯ä»¥å‚è€ƒä¸‹.</p>\n<hr>\n<p>å‚è€ƒèµ„æ–™:</p>\n<p>1.<a href=\"http://zhangbuhuai.com/beginning-auto-layout-part-1/\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç†è§£Auto Layout</a>.</p>\n<p>2.<a href=\"http://www.cocoachina.com/industry/20140604/8668.html\" target=\"_blank\" rel=\"noopener\">åŠ¨æ€è®¡ç®—UITableViewCellé«˜åº¦</a></p>\n<p>3.<a href=\"http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/\" target=\"_blank\" rel=\"noopener\">ä¼˜åŒ–UITableViewCellé«˜åº¦è®¡ç®—çš„é‚£äº›äº‹</a></p>\n<p>4.<a href=\"http://sylenthwave.github.io/2016/01/02/iOS%E5%8A%A8%E6%80%81%E5%8F%98%E9%AB%98%E6%80%BB%E7%BB%93/\" target=\"_blank\" rel=\"noopener\">iOSåŠ¨æ€å˜é«˜æ€»ç»“</a></p>\n","categories":["é¢è¯•é¢˜"],"tags":["åŸºç¡€çŸ¥è¯†","é¢è¯•é¢˜","UIView"]},{"title":"UIViewç³»åˆ—ä¹‹---å¦‚ä½•å†™ä¸€ä¸ªè‡ªå®šä¹‰View","url":"http://hchong.net/2017/07/15/UIViewç³»åˆ—ä¹‹---å¦‚ä½•å†™ä¸€ä¸ªè‡ªå®šä¹‰View/","content":"<h1 id=\"UIViewç³»åˆ—ä¹‹â€”å¦‚ä½•å†™ä¸€ä¸ªè‡ªå®šä¹‰View\"><a href=\"#UIViewç³»åˆ—ä¹‹â€”å¦‚ä½•å†™ä¸€ä¸ªè‡ªå®šä¹‰View\" class=\"headerlink\" title=\"UIViewç³»åˆ—ä¹‹â€”å¦‚ä½•å†™ä¸€ä¸ªè‡ªå®šä¹‰View\"></a>UIViewç³»åˆ—ä¹‹â€”å¦‚ä½•å†™ä¸€ä¸ªè‡ªå®šä¹‰View</h1><p><a href=\"http://hchong.net/2017/08/30/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---UIView%E5%92%8CCALayer/\">UIViewç³»åˆ—ä¹‹â€”UIViewå’ŒCALayer</a><br><a href=\"http://hchong.net/2017/09/21/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---UIView%E7%9A%84%E5%B8%B8%E8%A7%81layout%E6%96%B9%E6%B3%95/\">UIViewç³»åˆ—ä¹‹â€”UIViewçš„å¸¸è§layoutæ–¹æ³•</a><br><a href=\"http://hchong.net/2017/09/24/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---iOS%E7%9A%84%E5%8A%A8%E6%80%81%E9%AB%98%E5%BA%A6/\">UIViewç³»åˆ—ä¹‹â€”iOSçš„åŠ¨æ€é«˜åº¦</a><br><a href=\"http://hchong.net/2017/09/21/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---%E5%A6%82%E4%BD%95%E5%86%99%E4%B8%80%E4%B8%AA%E8%87%AA%E5%AE%9A%E4%B9%89View/\">UIViewç³»åˆ—ä¹‹â€”å¦‚ä½•å†™ä¸€ä¸ªè‡ªå®šä¹‰View</a></p>\n<p>è¿™ä¸€ç¯‡å’Œå‰é¢çš„å®é™…æ˜¯ä¸€ä¸ªç³»åˆ—, ä½†æ˜¯æœ‰ä¸å¤ªä¸€æ ·, ä¹Ÿç¨å¾®åæ¶æ„å’Œè§„èŒƒä¸€äº›. è¯´ä¸€ä¸‹åœ¨å®é™…ç¼–ç¨‹ä¸­çš„å†™æ³•. </p>\n<h2 id=\"é€šç”¨çš„è‡ªå®šä¹‰ç±»çš„functionå½’çº³\"><a href=\"#é€šç”¨çš„è‡ªå®šä¹‰ç±»çš„functionå½’çº³\" class=\"headerlink\" title=\"é€šç”¨çš„è‡ªå®šä¹‰ç±»çš„functionå½’çº³\"></a>é€šç”¨çš„è‡ªå®šä¹‰ç±»çš„functionå½’çº³</h2><p>ä¸€ä¸ªè‡ªå®šä¹‰ç±»ä¸­çš„ä»£ç é¦–å…ˆæ˜¯æœ‰åºçš„, ä¸ç®¡æ˜¯<code>UIVIewControl</code>, <code>UIVIew</code>, æˆ–è€…<code>NSObject</code>, éƒ½åº”è¯¥æŠŠå…·æœ‰ç›¸åŒä½œç”¨çš„functionå½’çº³ä¸ºä¸€ä¸ªç±», æˆ‘ä¸€èˆ¬æŒ‰ç…§ä¸‹é¢è¿™æ ·æ¥åˆ†å‰²ä»£ç , è¿™æ ·çœ‹ä¸Šå»ä¼šæ¯”è¾ƒæœ‰æ¡ç†: </p>\n<pre><code>#pragma mark - LifeCycle\nè¿™é‡Œé¢æ˜¯ä¸€äº›ç±»çš„ç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•, ä»¥åŠoverWriteçš„çˆ¶ç±»çš„æ–¹æ³•\n#pragma mark - UIConfig\nè¿™é‡Œé¢æ˜¯å’Œå½“å‰ç±»çš„UIç›¸å…³çš„è®¾ç½®ä¿¡æ¯\n#pragma mark - HttpRequest\nå½“å‰ç±»çš„ç½‘ç»œè¯·æ±‚éƒ¨åˆ†\n#pragma mark - XXXDelegate\nå½“å‰ç±»å“åº”çš„ä»£ç†äº‹ä»¶\n#pragma mark - Action\nå½“å‰ç±»çš„EventResponseäº‹ä»¶\n#pragma mark - Private\nå½“å‰ç±»ä¸­æ‰€ç”¨åˆ°çš„ä¸€äº›å·¥å…·function, ä¸è¿‡ä¸€èˆ¬ä¸å»ºè®®å†™åœ¨è¿™é‡Œé¢, æˆ‘ä»¬åº”è¯¥æŒ‰ç…§æ¨¡å—æ–°å»ºä¸€ä¸ªä¸“é—¨çš„å·¥å…·ç±»æ¥ç®¡ç†è¿™äº›function\n#pragma mark - Getter, Setter\nå½“å‰ç±»ä¸­ç”¨åˆ°çš„æ‰€æœ‰å±æ€§çš„Getterå’ŒSetter, å¼ºçƒˆæ¨èè¿™ä¹ˆäº›, è¿™æ ·å¯ä»¥æŠŠå½“å‰ç±»çš„å­æ§ä»¶çš„åˆå§‹åŒ–æ”¾åˆ°Getterä¸­å», ç»´æŠ¤äº†ä»£ç çš„æ•´æ´åº¦.\n</code></pre><p>é™¤æ­¤ä¹‹å¤–, ä¸Šé¢è¿™ä¸ªé¡ºåºä¸€èˆ¬æ˜¯æŒ‰ç…§ä½¿ç”¨è€…å¯¹è¿™ä¸ªç±»ä¸­æ‰€æœ‰functionçš„å…³å¿ƒç¨‹åº¦æ¥æ’åºçš„, ä¾‹å¦‚å¯¹Lifecycleå’ŒUIConfigçš„å…³å¿ƒç¨‹åº¦å°±æ¯”Getterå’ŒSetterçš„ç¨‹åº¦é«˜. å¦‚æœè¿™ä¸ªç±»è¿˜æ˜¯ç‰¹åˆ«é•¿çš„è¯, é‚£å°±å»ºè®®æŠŠä»£ç åœ¨æ‹†åˆ†ä¸ºå„ä¸ªç‹¬ç«‹åŠŸèƒ½çš„category, æˆ–è€…æŠŠå°½é‡å¤šçš„Privateæ–¹æ³•æ‹†åˆ†ä¸ºç‹¬ç«‹çš„å·¥å…·ç±», è¿™æ ·ä¸ç®¡æ˜¯å¯¹å½“å‰ç±»çš„ä»£ç é‡, æˆ–è€…åé¢å¯èƒ½ä¼šä½¿ç”¨åˆ°è¿™äº›PrivateFunctionçš„äººæ¥è¯´éƒ½æ˜¯æ¯”è¾ƒåˆç†çš„åšæ³•. </p>\n<h2 id=\"ç»„åˆä»£æ›¿ç»§æ‰¿\"><a href=\"#ç»„åˆä»£æ›¿ç»§æ‰¿\" class=\"headerlink\" title=\"ç»„åˆä»£æ›¿ç»§æ‰¿\"></a>ç»„åˆä»£æ›¿ç»§æ‰¿</h2><p>é™¤æ­¤ä¹‹å¤–, å¯¹äºå¤æ‚ç±»æ¥è¯´æˆ‘ä»¬è¦å°½é‡<em>ä½¿ç”¨ç»„åˆæ¥ä»£æ›¿ç»§æ‰¿</em>. ä¾‹å¦‚å½“å‰æœ‰ä¸€ä¸ªç±»å®ç°äº†AåŠŸèƒ½, ä¸šåŠ¡å‘å±•æˆ‘ä»¬è¦ä½¿ç”¨A+BåŠŸèƒ½, æˆ‘ä»¬å¯èƒ½ä¼šæƒ³åˆ°å†™ä¸€ä¸ªAçš„å­ç±»Aâ€™, åœ¨é‡Œé¢å†åŠ ä¸ŠBåŠŸèƒ½, å®Œç¾è§£å†³. é‚£ä¹ˆåé¢æˆ‘ä»¬è¦å†ä½¿ç”¨A+B+CåŠŸèƒ½, é‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¼šå†™ä¸€ä¸ªAâ€™çš„å­ç±»Aâ€™â€™, åœ¨é‡Œé¢å®ç°Cçš„åŠŸèƒ½, åˆå®Œç¾å®ç°. é‚£å¦‚æœçªç„¶æœ‰ä¸€å¤©, äº§å“ç»ç†çªç„¶è¯´è¦å®ç°A+CåŠŸèƒ½å‘¢, å‚»çœ¼äº†, ä¸€å¤§å¨ä»£ç æ€ä¹ˆæ‹†åˆ†. æ‰€ä»¥æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯, æˆ‘ä»¬æ–°å»ºä¸‰ä¸ªç±», åˆ†åˆ«ç‹¬ç«‹å®ç°A, B, Cçš„åŠŸèƒ½, ä¸šåŠ¡æ–¹è¦ç”¨å“ªä¸ªå°±è‡ªç”±ç»„åˆ, å‡è®¾åé¢å†æ¥äº†D, E, Fæˆ‘ä»¬ä¹Ÿä¸æ€•, æˆ‘ä»¬åªç”¨åƒæ’ä»¶ä¸€æ ·, ç”¨åˆ°å“ªä¸ªç»„åˆå“ªä¸ªå°±å¥½. </p>\n<h2 id=\"UIViewçš„å†™æ³•\"><a href=\"#UIViewçš„å†™æ³•\" class=\"headerlink\" title=\"UIViewçš„å†™æ³•\"></a>UIViewçš„å†™æ³•</h2><p>UIViewä½œä¸ºç›´æ¥å±•ç¤ºç»™ç”¨æˆ·çœ‹çš„å±‚é¢, æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†. æˆ‘å¼ºçƒˆæ¨èä½¿ç”¨çº¯ä»£ç å¸ƒå±€, ä½¿ç”¨Frameæˆ–è€…Autolayoutéƒ½å¯ä»¥. ä½¿ç”¨Frameçš„è¯, æ¨èä½¿ç”¨<a href=\"https://github.com/casatwy/HandyAutoLayout\" target=\"_blank\" rel=\"noopener\">è¿™ä¸ªé¡¹ç›®</a>. å¦‚æœä½¿ç”¨AutoLayoutçš„è¯, <code>masonry</code>åˆ™æ˜¯å¾ˆä¸é”™çš„é€‰æ‹©. </p>\n<p>objcæ„å»ºä¸€ä¸ªå¯¹è±¡ä½¿ç”¨çš„æ˜¯ä¸¤æ®µå¼, é¦–å…ˆåˆ†é…å†…å­˜<code>alloc</code>ç„¶å<code>init</code>, è¿™æ ·çš„å¥½å¤„å°±æ˜¯å°†å†…å­˜æ“ä½œå’Œåˆå§‹åŒ–æ“ä½œè§£è€¦åˆ, è®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨åˆå§‹åŒ–çš„æ—¶å€™å¯¹å¯¹è±¡åšä¸€äº›å¿…è¦çš„æ“ä½œ. è¿™æ˜¯ä¸ªå¾ˆå¥½çš„æ€è·¯, æˆ‘ä»¬åœ¨åšå¾ˆå¤šäº‹æƒ…çš„æ—¶å€™éƒ½å¯ä»¥ä½¿ç”¨è¿™ç§ä¸¤æ®µå¼çš„æ€è·¯. æ¯”å¦‚å¸ƒå±€ä¸€ä¸ªUIView, æˆ‘ä»¬å¯ä»¥åˆ†æˆä¸¤éƒ¨, <a href=\"#alloc\">åˆå§‹åŒ–å¿…è¦çš„å­viewå’Œå˜é‡</a>, <a href=\"#init\">ç„¶ååœ¨åˆé€‚çš„æ—¶æœºè¿›è¡Œå¸ƒå±€</a>. ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬çš„è‡ªå®šä¹‰ç±»ç»§æ‰¿è‡ªUIView, é¦–å…ˆåœ¨initWithFrame:æ–¹æ³•ä¸­å°†éœ€è¦çš„å­æ§ä»¶åŠ å…¥viewä¸­. æ³¨æ„, è¿™é‡Œåªæ˜¯åŠ å…¥åˆ°viewä¸­, å¹¶æ²¡æœ‰è®¾ç½®å„ä¸ªå­æ§ä»¶çš„å°ºå¯¸.</p>\n<h3 id=\"åˆå§‹åŒ–å¿…è¦çš„å­viewå’Œå˜é‡\"><a href=\"#åˆå§‹åŒ–å¿…è¦çš„å­viewå’Œå˜é‡\" class=\"headerlink\" title=\"åˆå§‹åŒ–å¿…è¦çš„å­viewå’Œå˜é‡\"></a><span id=\"alloc\">åˆå§‹åŒ–å¿…è¦çš„å­viewå’Œå˜é‡</span></h3><p>æ‰€ä»¥ç¬¬ä¸€æ­¥åº”è¯¥æ˜¯: <code>- (id)initWithFrame:(CGRect)aRect</code>, é‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸é€‚ç”¨<code>- (id)init</code>æ¥å®Œæˆåˆå§‹åŒ–å‘¢? å¦‚æœæ˜¯è¿™ç§æƒ…å†µ, é‚£ä¹ˆåœ¨initæ–¹æ³•ä¸­frameæ˜¯ä¸ç¡®å®šçš„, æ­¤æ—¶å¦‚æœåœ¨initWithFrame:æ–¹æ³•ä¸­è®¾ç½®å°ºå¯¸, é‚£ä¹ˆå„ä¸ªå­æ§ä»¶çš„å°ºå¯¸éƒ½ä¼šæ˜¯0, å› ä¸ºè¿™ä¸ªviewçš„frameè¿˜æ²¡æœ‰è®¾ç½®.æ‰€ä»¥æˆ‘ä»¬åº”è¯¥ä¿è¯viewçš„frameè®¾ç½®å®Œæ‰ä¼šè®¾ç½®å®ƒçš„å­æ§ä»¶çš„å°ºå¯¸. </p>\n<p>è¿˜æœ‰å°±æ˜¯è¿™ä¸ªå‡½æ•°æ˜¯æ— è®ºä½ ç”¨ä»€ä¹ˆåˆå§‹åŒ–å‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨çš„ä¸€ä¸ª, æ¯”å¦‚ä½ ç”¨<code>[UIView new]</code>æˆ–è€…<code>[[UIView alloc] init]</code>éƒ½ä¼šè°ƒç”¨initWithFrameè¿™ä¸ªå‡½æ•°(æœ‰äº›UIViewçš„å­ç±»æœ‰ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚UITableViewCell), æ‰€ä»¥ä½ è¦æ˜¯å¯¹ä¸€ä¸ªviewçš„å˜é‡æœ‰åˆå§‹åŒ–çš„æ“ä½œå°½é‡å¾€initWithFrameé‡Œé¢æ”¾è¿˜æ˜¯éå¸¸åˆé€‚çš„.  å¹¶ä¸”è¿™æ ·ä¹Ÿèƒ½å¤Ÿä¿è¯, ä»¥ååœ¨ä½¿ç”¨çš„æ—¶å€™æ‰€æœ‰çš„å˜é‡éƒ½è¢«æ­£ç¡®çš„åˆå§‹åŒ–è¿‡. è€Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨initWithFrameä¸­åšäº›ä»€ä¹ˆå‘¢.</p>\n<ul>\n<li>æ·»åŠ å­View</li>\n<li>åˆå§‹åŒ–å±æ€§å˜é‡</li>\n<li>å…¶ä»–ä¸€äº›å…±ç”¨æ“ä½œ</li>\n</ul>\n<h3 id=\"åœ¨åˆé€‚çš„æ—¶æœºè¿›è¡Œå¸ƒå±€\"><a href=\"#åœ¨åˆé€‚çš„æ—¶æœºè¿›è¡Œå¸ƒå±€\" class=\"headerlink\" title=\"åœ¨åˆé€‚çš„æ—¶æœºè¿›è¡Œå¸ƒå±€\"></a><span id=\"init\">åœ¨åˆé€‚çš„æ—¶æœºè¿›è¡Œå¸ƒå±€</span></h3><p>åˆå§‹åŒ–å‡½æ•°ä¸­æœ‰ä¸€ä¸ªåç§°withFrame, å¤§å®¶å¯èƒ½å°±ä¼šä»¥ä¸ºè¿™ä¸ªå‡½æ•°ä½¿ç”¨å¸ƒå±€ç”¨çš„. ç„¶è€Œåœ¨ä»£ç é€»è¾‘æ¯”è¾ƒæ¸…æ™°çš„å·¥ç¨‹ä¸­ï¼Œå‡ ä¹å¾ˆå°‘çœ‹åˆ°åœ¨è¿™ä¸ªå‡½æ•°ä¸­è¿›è¡Œç•Œé¢å¸ƒå±€çš„å·¥ä½œ, å› ä¸ºUIKitç»™ä½ æä¾›äº†ä¸€ä¸ªä¸“é—¨çš„å‡½æ•°<code>layoutSubViews</code>æ¥å¹²è¿™ä¸ªäº‹æƒ…. è€Œä¸”, åœ¨è¿™ä¸ªå‡½æ•°ä¸­åšçš„ç•Œé¢å¸ƒå±€çš„å·¥ä½œ, æ˜¯ä¸€æ¬¡æ€§ç¼–ç , ç•Œé¢å¸ƒå±€æ²¡æœ‰ä»»ä½•å¤ç”¨æ€§, å¦‚æœçˆ¶Viewçš„å¤§å°å˜äº†ä¹‹å, è¿™ä¸ªViewè¿˜æ˜¯å‚»å‚»çš„ä¿æŒåŸæ¥çš„æ¨¡æ ·. åŒæ—¶ä¹Ÿä¼šé€ æˆ, åˆå§‹åŒ–å‡½æ•°è‡ƒè‚¿, å¯¼è‡´ç»´æŠ¤ä¸Šçš„å›°éš¾. æ‰€ä»¥åœ¨<code>layoutSubViews</code>ä¸­å¯¹å­è§†å›¾è¿›è¡Œå¸ƒå±€æ‰æ˜¯æœ€åˆç†çš„åœ°æ–¹. </p>\n<h2 id=\"å…¶ä»–\"><a href=\"#å…¶ä»–\" class=\"headerlink\" title=\"å…¶ä»–\"></a>å…¶ä»–</h2><p>ä¸€ä¸ªæ§ä»¶æœ‰2ç§åˆ›å»ºæ–¹å¼: </p>\n<ul>\n<li>é€šè¿‡ä»£ç åˆ›å»º</li>\n</ul>\n<p>åˆå§‹åŒ–æ—¶ä¸€å®šä¼šè°ƒç”¨<code>initWithFrame:</code>æ–¹æ³•. </p>\n<ul>\n<li>é€šè¿‡xib\\storyboardåˆ›å»º</li>\n</ul>\n<p>åˆå§‹åŒ–æ—¶ä¸ä¼šè°ƒç”¨<code>initWithFrame:</code>æ–¹æ³•, åªä¼šè°ƒç”¨<code>initWithCoder:</code>æ–¹æ³•, åˆå§‹åŒ–å®Œæ¯•åä¼šè°ƒç”¨<code>awakeFromNib</code>æ–¹æ³•æ³¨æ„è¦åœ¨åœ¨awakeFromNibä¸­åˆå§‹åŒ–å­æ§ä»¶</p>\n<hr>\n<p>å‚è€ƒèµ„æ–™:</p>\n<p>1.<a href=\"https://casatwy.com/iosying-yong-jia-gou-tan-viewceng-de-zu-zhi-he-diao-yong-fang-an.html\" target=\"_blank\" rel=\"noopener\">iOSåº”ç”¨æ¶æ„è°ˆ</a></p>\n<p>2.<a href=\"https://yishuiliunian.gitbooks.io/implementate-tableview-to-understand-ios/content/uikit/1124.html\" target=\"_blank\" rel=\"noopener\">è§†å›¾ç±», å¦‚ä½•å¸ƒå±€</a></p>\n","categories":["é¢è¯•é¢˜"],"tags":["åŸºç¡€çŸ¥è¯†","é¢è¯•é¢˜","UIView"]},{"title":"UIViewç³»åˆ—ä¹‹---UIViewçš„å¸¸è§layoutæ–¹æ³•","url":"http://hchong.net/2017/07/10/UIViewç³»åˆ—ä¹‹---UIViewçš„å¸¸è§layoutæ–¹æ³•/","content":"<h2 id=\"UIViewç³»åˆ—ä¹‹â€”UIViewçš„å¸¸è§layoutæ–¹æ³•\"><a href=\"#UIViewç³»åˆ—ä¹‹â€”UIViewçš„å¸¸è§layoutæ–¹æ³•\" class=\"headerlink\" title=\"UIViewç³»åˆ—ä¹‹â€”UIViewçš„å¸¸è§layoutæ–¹æ³•\"></a>UIViewç³»åˆ—ä¹‹â€”UIViewçš„å¸¸è§layoutæ–¹æ³•</h2><ul>\n<li><p><code>init</code> &amp; <code>initWithFrame</code></p>\n<p>  <code>init</code> å’Œ <code>initWithFrame</code>æ–¹æ³•, å®é™…ä¸Šéƒ½ä¼šè°ƒç”¨<code>initWithFrame</code>æ–¹æ³•æ¥å®Œæˆåˆå§‹åŒ–, ä¸åŒçš„æ˜¯åœ¨<code>init</code>æ–¹æ³•å†…éƒ¨è·å–åˆ°çš„<code>self.frame</code>æ˜¯<code>CGRectZero</code>, åœ¨<code>initWithFrame</code>ä¸­è·å–åˆ°çš„<code>self.frame</code>å°±æ˜¯åˆå§‹åŒ–æ—¶, ä¼ å…¥çš„<code>frame</code>çš„å¤§å°. ä¸è¿‡ä¸€èˆ¬ä¸å»ºè®®åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­è®¾ç½®å­æ§ä»¶çš„<code>frame</code>, å› ä¸ºè¿™æ—¶<code>self.frame</code>æ—¶æœºè¿˜ä¸æ˜¯å›ºå®šçš„.</p>\n</li>\n<li><p>layoutSubviews</p>\n</li>\n</ul>\n<blockquote>\n<p><a href=\"https://developer.apple.com/documentation/uikit/uiview/1622482-layoutsubviews?language=objc\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a><br>Lays out subviews.<br>The default implementation of this method does nothing on iOS 5.1 and earlier. Otherwise, the default implementation uses any constraints you have set to determine the size and position of any subviews.</p>\n<p>Subclasses can override this method as needed to perform more precise layout of their subviews. You should override this method only if the autoresizing and constraint-based behaviors of the subviews do not offer the behavior you want. You can use your implementation to set the frame rectangles of your subviews directly.</p>\n<p>You should not call this method directly. If you want to force a layout update, call the setNeedsLayout method instead to do so prior to the next drawing update. If you want to update the layout of your views immediately, call the layoutIfNeeded method.</p>\n</blockquote>\n<p>ç¿»è¯‘æˆäººè¯å¤§æ¦‚å°±æ˜¯: <code>layoutSubviews</code>æ–¹æ³•ç”¨æ¥å¸ƒå±€å­è§†å›¾. åœ¨<code>layoutSubviews</code>æ–¹æ³•å†…éƒ¨ç›´æ¥ç»™éœ€è¦æ”¹å˜å¸ƒå±€çš„å­è§†å›¾èµ‹å€¼æ–°frameæ¥æ”¹å˜å…¶<code>frame</code>. è¯¥æ–¹æ³•ä¸»è¦åº”ç”¨åœ¨å°è£…çš„è‡ªå®šä¹‰<code>view</code>ä¸­, æˆ‘ä»¬é€šè¿‡é‡å†™è¿™ä¸ªæ–¹æ³•å®Œæˆè‡ªå®šä¹‰<code>view</code>ä¸­å­è§†å›¾çš„å¸ƒå±€. ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥è°ƒç”¨ä»–æ¥æ›´æ–°å­è§†å›¾çš„<code>frame</code>. åªèƒ½é€šè¿‡<a href=\"#layoutIfNeeded\">layoutIfNeeded</a>æˆ–è€…<a href=\"#setNeedsLayout\">setNeedsLayout</a>æ¥è°ƒç”¨, æˆ–è€…ç­‰å¾…ç³»ç»Ÿè§¦å‘. ç³»ç»Ÿè§¦å‘<code>layoutSubviews</code>çš„<a href=\"#layoutSubviews\">æ¡ä»¶</a>.</p>\n<ul>\n<li><span id=\"setNeedsLayout\">setNeedsLayout</span></li>\n</ul>\n<blockquote>\n<p><a href=\"https://developer.apple.com/documentation/uikit/uiview/1622601-setneedslayout?language=objc\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a><br>Invalidates the current layout of the receiver and triggers a layout update during the next update cycle.</p>\n<p>Call this method on your applicationâ€™s main thread when you want to adjust the layout of a viewâ€™s subviews. This method makes a note of the request and returns immediately. Because this method does not force an immediate update, but instead waits for the next update cycle, you can use it to invalidate the layout of multiple views before any of those views are updated. This behavior allows you to consolidate all of your layout updates to one update cycle, which is usually better for performance.</p>\n</blockquote>\n<p>ç¿»è¯‘æˆäººè¯å¤§æ¦‚å°±æ˜¯: å¦‚æœä¸€ä¸ªlayerçš„sublayerå¸ƒå±€å‘ç”Ÿäº†æ”¹å˜éœ€è¦æ›´æ–°å¸ƒå±€, æˆ‘ä»¬é€šè¿‡è°ƒç”¨<code>setNeedsLayout</code>æ–¹æ³•æ¥æ ‡è®°è¿™ä¸ªlayer. æˆ–è€…å½“layerçš„boundså‘ç”Ÿå˜åŒ–æˆ–è€…layerä¸Šè¿›è¡Œäº†addæˆ–è€…remove sublayeræ“ä½œ, ç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨<code>setNeedsLayout</code>æ–¹æ³•. è¿™äº›è¢«æ ‡è®°éœ€è¦æ›´æ–°å¸ƒå±€çš„layerä¼šåœ¨ä¸‹ä¸€ä¸ªè§†å›¾ç»˜åˆ¶å‘¨æœŸ(iOSå±å¹•åˆ·æ–°é¢‘ç‡ä¸º60HZ, å› æ­¤ä¸‹ä¸€ä¸ªè§†å›¾ç»˜åˆ¶å‘¨æœŸæ˜¯1/60så)è§¦å‘layoutSubviewså®Œæˆå­è§†å›¾å¸ƒå±€æ›´æ–°.</p>\n<p>å¦‚æœä½ æƒ³è¦æ›´æ–°ä¸€ä¸ªè§†å›¾çš„å­è§†å›¾å¸ƒå±€, é‚£ä¹ˆå¯ä»¥åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥æ ‡è®°å½“å‰è§†å›¾ä¸ºéœ€è¦æ›´æ–°å­è§†å›¾å¸ƒå±€çš„è§†å›¾. å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ç»™å¤šä¸ªä¸åŒçš„viewæ ‡è®°éœ€è¦æ›´æ–°å­è§†å›¾å¸ƒå±€, ç„¶ååœ¨ä¸‹ä¸€ä¸ªè§†å›¾ç»˜åˆ¶å‘¨æœŸä¸­è¿™äº›viewçš„subviewså°±ä¼šè¢«ä¸€å—æ›´æ–°å¸ƒå±€, è¿™æ ·åšæ˜¯å¯ä»¥å¾ˆå¤§åœ°æé«˜æ€§èƒ½å’Œæ•ˆç‡çš„. </p>\n<ul>\n<li><span id=\"layoutIfNeeded\">layoutIfNeeded</span></li>\n</ul>\n<blockquote>\n<p><a href=\"https://developer.apple.com/documentation/uikit/uiview/1622507-layoutifneeded?language=objc\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a><br>Lays out the subviews immediately.<br>Use this method to force the layout of subviews before drawing. Using the view that receives the message as the root view, this method lays out the view subtree starting at the root.</p>\n</blockquote>\n<p>ç¿»è¯‘æˆäººè¯å¤§æ¦‚å°±æ˜¯: åœ¨ä¸‹ä¸€æ¬¡ç»˜å›¾å‘¨æœŸå¼€å§‹ä¹‹å‰ä½¿ç”¨æ­¤æ–¹æ³•å¼ºåˆ¶è¿›è¡Œå­è§†å›¾çš„å¸ƒå±€æ›´æ–°. æ­¤æ–¹æ³•ä¼šå°†receiverä½œä¸ºæ ¹è§†å›¾, ç„¶åä»æ ¹è§†å›¾å¼€å§‹éå†æ ¹è§†å›¾çš„subviewé“¾, åˆ¤æ–­super layeræ˜¯å¦è¢«æ ‡è®°éœ€è¦æ›´æ–°å¸ƒå±€, ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªsuper layeræ²¡æœ‰æ ‡è®°æ›´æ–°å¸ƒå±€ä¸ºæ­¢, ç„¶åç³»ç»Ÿä¼šå‘æ‰€æœ‰è¿™äº›è¢«æ ‡è®°éœ€è¦æ›´æ–°å¸ƒå±€çš„layerå‘é€<code>layoutSublayers</code>æ¶ˆæ¯. <code>layoutSublayers</code>æ˜¯<code>setNeedsLayout</code>çš„ä¸€ä¸ªè¾…åŠ©æ–¹æ³•, è°ƒç”¨è¯¥æ–¹æ³•å°±æ„å‘³ç€ä¸ä¼šç­‰åˆ°ä¸‹ä¸ªç»˜åˆ¶å‘¨æœŸ, è€Œæ˜¯ç«‹é©¬è§¦å‘<code>layoutSubviews</code>æ–¹æ³•, å®Œæˆå­è§†å›¾çš„å¸ƒå±€. </p>\n<p>ä½†æ˜¯éœ€è¦æ³¨æ„åªæœ‰å½“ç³»ç»Ÿæ£€æµ‹åˆ°æŸä¸ªviewè¢«<code>setNeedsLayout</code>æ ‡è®°ä¹‹åæ‰ä¼šç«‹å³è§¦å‘<code>layoutSubviews</code>, å¦‚æœæ²¡æœ‰æ£€æµ‹åˆ°<code>setNeedsLayout</code>æ ‡è®°å°±ä¸ä¼šè§¦å‘<code>layoutSubviews</code>, æ‰€ä»¥å¦‚æœæƒ³è¦ç«‹å³åˆ·æ–°æŸä¸ªè§†å›¾çš„å­è§†å›¾å¸ƒå±€, éœ€è¦å…ˆè®©è¯¥è§†å›¾è°ƒç”¨<code>setNeedsLayout</code>æ–¹æ³•æ ‡è®°ä¸€ä¸‹, ç„¶åå†è°ƒç”¨<code>layoutIfNeeded</code>. å¦å¤–æ‰€æœ‰çš„è§†å›¾åœ¨ç¬¬ä¸€æ¬¡æ˜¾ç¤ºä¹‹å‰éƒ½æ˜¯é»˜è®¤æœ‰<code>setNeedsLayout</code>æ ‡è®°çš„, æ‰€ä»¥è§†å›¾ç¬¬ä¸€æ¬¡æ˜¾ç¤ºçš„æ—¶å€™å°±å¯ä»¥ç›´æ¥è°ƒç”¨<code>layoutIfNeeded</code>. ä½†æ˜¯å½“ç¬¬ä¸€æ¬¡æ˜¾ç¤ºå®Œæˆå, å¦‚æœè¿˜æƒ³è¦è°ƒç”¨<code>layoutIfNeeded</code>å°±å¿…é¡»å…ˆä½¿ç”¨<code>setNeedsLayout</code>æ ‡è®°ä¸€ä¸‹. </p>\n<ul>\n<li>setNeedsDisplay</li>\n</ul>\n<blockquote>\n<p><a href=\"https://developer.apple.com/documentation/uikit/uiview/1622437-setneedsdisplay?language=objc\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a><br>Marks the receiverâ€™s entire bounds rectangle as needing to be redrawn.<br>You can use this method or the <code>setNeedsDisplayInRect:</code> to notify the system that your viewâ€™s contents need to be redrawn. This method makes a note of the request and returns immediately. The view is not actually redrawn until the next drawing cycle, at which point all invalidated views are updated.</p>\n<p>å…¶ä»–è¯´æ˜:<br>You should only be calling setNeedsDisplay if you override drawRect in a subclass of UIView which is basically a custom view drawing something on the screen, like lines, images, or shapes like a rectangle.</p>\n</blockquote>\n<p>å¦‚æœæˆ‘ä»¬åœ¨è‡ªå®šä¹‰çš„UIViewä¸­, é‡å†™äº†<code>drawRect:</code>æ–¹æ³•åœ¨å±å¹•ä¸Šç»˜åˆ¶ä¸€äº›ä¸œè¥¿, é‚£å°±éœ€è¦åœ¨åˆé€‚çš„åœ°æ–¹è°ƒç”¨<code>setNeedsDisplay</code>æ¥æ ‡è®°å½“å‰è§†å›¾, ç³»ç»Ÿä¼šåœ¨ä¸‹ä¸€ä¸ªç»˜åˆ¶å‘¨æœŸæ—¶è§¦å‘<code>drawRect:</code>æ–¹æ³•. <a href=\"#drawRect\">ç³»ç»Ÿè§¦å‘drawRect:çš„æ¡ä»¶</a>.</p>\n<p>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>setNeedsDisplayInRect:</code>æ–¹æ³•æ¥æ ‡è®°è§†å›¾çš„æŸä¸ªåŒºåŸŸéœ€è¦é‡æ–°ç»˜åˆ¶.</p>\n<ul>\n<li>drawRect</li>\n</ul>\n<blockquote>\n<p><a href=\"https://developer.apple.com/documentation/uikit/uiview/1622529-drawrect\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a><br>Draws the receiverâ€™s image within the passed-in rectangle</p>\n<p>The default implementation of this method does nothing. Subclasses that use technologies such as Core Graphics and UIKit to draw their viewâ€™s content should override this method and implement their drawing code there. You do not need to override this method if your view sets its content in other ways. For example, you do not need to override this method if your view just displays a background color or if your view sets its content directly using the underlying layer object.</p>\n<p>This method is called when a view is first displayed or when an event occurs that invalidates a visible part of the view. You should never call this method directly yourself. To invalidate part of your view, and thus cause that portion to be redrawn, call the <code>setNeedsDisplay</code> or <code>setNeedsDisplayInRect:</code> method instead.</p>\n</blockquote>\n<p>drawRectä½¿ç”¨:</p>\n<p>è¯¥æ–¹æ³•é»˜è®¤æ²¡æœ‰åšä»»ä½•æ“ä½œ, å¦‚æœè§†å›¾ä¸­åŒ…å«æˆ‘ä»¬ç”¨<code>UIKit</code>æˆ–è€…<code>Core Graphics</code>ç»˜åˆ¶çš„å†…å®¹, æˆ‘ä»¬éœ€è¦é‡å†™è¯¥æ–¹æ³•. å½“è§†å›¾ç¬¬ä¸€æ¬¡å‡ºç°, æˆ–è€…æ˜¯æ”¹å˜çº¦æŸæ¡ä»¶è®©è§†å›¾çš„å…¨éƒ¨æˆ–è€…ä¸€éƒ¨åˆ†åœ¨å±å¹•ä¸Šå‘ç”Ÿå˜åŒ–æ—¶, ç³»ç»Ÿéƒ½ä¼šè°ƒç”¨<code>UIView</code>ç±»çš„<code>drawRect</code>æ–¹æ³•. ç„¶åæˆ‘ä»¬åœ¨æ­¤æ–¹æ³•ä¸­èƒ½è¿‡è·å–åˆ°å½“å‰å›¾å½¢ä¸Šä¸‹æ–‡, å®ç°æˆ‘ä»¬çš„ç»˜åˆ¶å†…å®¹, æœ€åç³»ç»Ÿä¼šåœ¨åˆé€‚çš„æ—¶æœºè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•. </p>\n<p><code>drawRect</code>ä¸€èˆ¬è°ƒç”¨æ˜¯åœ¨<code>UIView</code>çš„<code>layoutSubviews</code>æ–¹æ³•æ‰§è¡Œå. ä½†æ˜¯, åœ¨æˆ‘ä»¬çš„è§†å›¾å…¨éƒ¨åˆå§‹åŒ–å,å¦‚æœè§†å›¾åˆå‘ç”Ÿäº†æ”¹å˜, æ­¤æ—¶è§†å›¾å°±éœ€è¦é‡ç»˜, ä½†æ˜¯ç³»ç»Ÿä¸ä¼šå†å¸®æˆ‘ä»¬è‡ªåŠ¨è°ƒç”¨<code>drewRect</code>æ–¹æ³•. è¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è°ƒç”¨<code>UIView</code>ç±»çš„ <code>setNeedsDisplay</code>æˆ–<code>setNeedsDisplayInRect</code>æ–¹æ³•. è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥å‘Šè¯‰ç³»ç»Ÿ, æˆ‘ä»¬çš„è§†å›¾æœ‰äº†æ›´æ–°éœ€è¦å»é‡ç»˜. ç›¸å½“äºæ˜¯ç»™ç³»ç»Ÿåšäº†æ ‡è®°, åœ¨ç³»ç»Ÿ runloop çš„ä¸‹ä¸€ä¸ªå‘¨æœŸè‡ªåŠ¨è°ƒç”¨<code>drawRect</code>æ–¹æ³•.</p>\n<p>ä½¿ç”¨ä¸­è¦æ³¨æ„çš„åœ°æ–¹:</p>\n<ol>\n<li><p>ä¸è¦ç›´æ¥è°ƒç”¨ drawRect æ–¹æ³•,å¦‚æœå¼ºè¡Œè°ƒç”¨æ­¤æ–¹æ³•ä¹Ÿæ˜¯æ— æ•ˆæœçš„.è‹¹æœè¦æ±‚æˆ‘ä»¬è°ƒç”¨ UIView ç±»çš„ setNeedsDisplay æ–¹æ³•,åˆ™ç¨‹åºä¼šè‡ªåŠ¨è°ƒç”¨ drawRect æ–¹æ³•è¿›è¡Œé‡ç»˜.</p>\n</li>\n<li><p>å› ä¸ºåœ¨ç»˜åˆ¶æ—¶è¦æ‹¿åˆ°å›¾å½¢ä¸Šä¸‹æ–‡,å¦‚æœåœ¨ UIView åˆå§‹åŒ–æ—¶æ²¡æœ‰è®¾ç½® rect å¤§å°, drawRect æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨.</p>\n</li>\n<li><p>è°ƒç”¨ sizeThatFits å, æ§ä»¶ frame æ”¹å˜, UIView çš„ layoutSubviews è¢«è°ƒç”¨, ç„¶åå†è°ƒç”¨ drawRect æ–¹æ³•. æ‰€ä»¥å¯ä»¥å…ˆè°ƒç”¨ sizeToFit è®¡ç®—å‡ºsize. ç„¶åç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ drawRect æ–¹æ³•.</p>\n</li>\n<li><p>é€šè¿‡è®¾ç½® contentMode å±æ€§å€¼ä¸º UIViewContentModeRedraw.é‚£ä¹ˆå°†åœ¨æ¯æ¬¡è®¾ç½®æˆ–æ›´æ”¹ bounds çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ drawRect.</p>\n</li>\n<li><p>è‹¥è¦å®æ—¶ç”»å›¾, å¦‚æœä½¿ç”¨ gestureRecognizer æ¥åˆ·æ–°å±å¹•, éœ€è¦åˆ¤æ–­å¹¶è½¬åŒ– point çš„åæ ‡; ä½¿ç”¨ touchbegan ç­‰æ–¹æ³•, åªéœ€è°ƒç”¨ setNeedsDisplay å®æ—¶åˆ·æ–°å±å¹•.</p>\n</li>\n</ol>\n<p>è¿™é‡Œæœ‰ä¸€ç¯‡<a href=\"http://bihongbo.com/2016/01/03/memoryGhostdrawRect/\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨drawRect:å®ç°ç»˜åˆ¶ç”»æ¿åŠŸèƒ½çš„å†…å­˜ä¼˜åŒ–</a>çš„æ–‡ç« .</p>\n<ul>\n<li>sizeToFit</li>\n</ul>\n<blockquote>\n<p><a href=\"https://developer.apple.com/documentation/uikit/uiview/1622630-sizetofit?language=objc\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a><br>Resizes and moves the receiver view so it just encloses its subviews.</p>\n<p>Call this method when you want to resize the current view so that it uses the most appropriate amount of space. Specific UIKit views resize themselves according to their own internal needs. In some cases, if a view does not have a superview, it may size itself to the screen bounds. Thus, if you want a given view to size itself to its parent view, you should add it to the parent view before calling this method.<br>You should not override this method. If you want to change the default sizing information for your view, override the sizeThatFits: instead. That method performs any needed calculations and returns them to this method, which then makes the change.</p>\n</blockquote>\n<p>å½“æˆ‘ä»¬æƒ³è¦resizeå½“å‰Viewä»¥ä¾¿è·å–ä»–åˆé€‚çš„å¤§å°æ—¶, æˆ‘ä»¬éœ€è¦è°ƒç”¨è¯¥æ–¹æ³•. å°¤å…¶æ˜¯<code>UIKit</code>çš„<code>View</code>è§†å›¾æ˜¯æ ¹æ®å†…éƒ¨éœ€è¦è¿›è¡Œå°ºå¯¸è°ƒæ•´æ—¶. åœ¨æŸäº›æƒ…å†µä¸‹, å¦‚æœå½“å‰Viewæ²¡æœ‰çˆ¶è§†å›¾, ä»–ä¼šæ ¹æ®å±å¹•çš„boundsæ¥resizeè‡ªèº«å¤§å°. å¦‚æœä½ æƒ³è®©ä¸€ä¸ªViewæ ¹æ®çˆ¶è§†å›¾æ¥è°ƒæ•´å¤§å°, å¿…é¡»å°†è¯¥Viewæ·»åŠ åˆ°çˆ¶è§†å›¾ä¸­.</p>\n<p>ä¸€èˆ¬æƒ…å†µä¸‹, æˆ‘ä»¬ä¸éœ€è¦é‡å†™è¯¥æ–¹æ³•, å¦‚æœä½ æƒ³æ”¹å˜å½“å‰Viewçš„default size, æˆ‘ä»¬é€šè¿‡é‡å†™<a href=\"#sizeThatFits\">sizeThatFits:</a>æ¥å®ç°. åœ¨<code>sizeThatFits:</code>æ–¹æ³•ä¸­è¿›è¡Œå¿…è¦çš„è®¡ç®—, è¿”å›ç»“æœ, ç„¶åæ”¹å˜ä»–çš„å¤§å°.</p>\n<ul>\n<li><span id=\"sizeThatFits\">sizeThatFits</span></li>\n</ul>\n<blockquote>\n<p><a href=\"https://developer.apple.com/documentation/uikit/uiview/1622625-sizethatfits?language=objc\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a><br>Asks the view to calculate and return the size that best fits the specified size.</p>\n<p>Parameters<br>size<br>The size for which the view should calculate its best-fitting size.</p>\n<p>Return Value<br>A new size that fits the receiverâ€™s subviews.</p>\n<p>Discussion<br>The default implementation of this method returns the existing size of the view. Subclasses can override this method to return a custom value based on the desired layout of any subviews. For example, a UISwitch object returns a fixed size value that represents the standard size of a switch view, and a UIImageView object returns the size of the image it is currently displaying.<br>This method does not resize the receiver.</p>\n</blockquote>\n<p>è¯¥æ–¹æ³•è¦æ±‚Viewè®¡ç®—å¹¶è¿”å›æœ€é€‚åˆæŒ‡å®šå¤§å°çš„å¤§å°. ä¼ å…¥çš„å‚æ•°å°±æ˜¯Viewéœ€è¦æœ€åˆé€‚çš„å¤§å°, è¿”å›å€¼æ˜¯æ ¹æ®ä¼ å…¥çš„å¤§å°, è®¡ç®—å¾—åˆ°çš„ä¸€ä¸ªæœ€é€‚åˆreceiverå­è§†å›¾çš„å°ºå¯¸. </p>\n<p>è¯¥æ–¹æ³•é»˜è®¤è¿”å›è§†å›¾çš„ç°æœ‰å¤§å°, å­ç±»èƒ½å¤Ÿé€šè¿‡é‡å†™è¯¥æ–¹æ³•è·å¾—ä¸€ä¸ªåŸºäºè¯¥å­ç±»æ‰€æœ‰å­è§†å›¾çš„æœŸæœ›å¸ƒå±€çš„è‡ªå®šä¹‰å¤§å°. è°ƒç”¨<code>sizeThatFits:</code>å¹¶ä¸æ”¹å˜viewçš„size, å®ƒåªæ˜¯è®©viewæ ¹æ®å·²æœ‰contentå’Œç»™å®šsizeè®¡ç®—å‡ºæœ€åˆé€‚çš„view.size. </p>\n<h2 id=\"sizeToFit-vs-sizeThatFits\"><a href=\"#sizeToFit-vs-sizeThatFits\" class=\"headerlink\" title=\"sizeToFit vs sizeThatFits:\"></a>sizeToFit vs sizeThatFits:</h2><ol>\n<li>sizeToFitä¼šè‡ªåŠ¨è°ƒç”¨sizeThatFitsæ–¹æ³•ï¼›</li>\n<li>sizeToFitä¸åº”è¯¥åœ¨å­ç±»ä¸­è¢«é‡å†™, åº”è¯¥é‡å†™sizeThatFits</li>\n<li>sizeThatFitsä¼ å…¥çš„å‚æ•°æ˜¯receiverå½“å‰çš„size, è¿”å›ä¸€ä¸ªé€‚åˆsubviewsçš„size</li>\n<li>sizeToFitå¯ä»¥è¢«æ‰‹åŠ¨ç›´æ¥è°ƒç”¨, </li>\n<li>sizeToFitå’ŒsizeThatFitsæ–¹æ³•éƒ½æ²¡æœ‰é€’å½’ï¼Œå¯¹subviewsä¹Ÿä¸è´Ÿè´£ï¼Œåªè´Ÿè´£è‡ªå·±</li>\n<li>è°ƒç”¨ sizeToFit() ä¼šå»è‡ªåŠ¨è°ƒç”¨ sizeThatFits(_ size: CGSize) æ–¹æ³•ã€‚</li>\n<li>sizeThatFits ä¸ä¼šæ”¹å˜ receiver çš„ size, è°ƒç”¨ sizeToFit() ä¼šæ”¹å˜ receiver çš„ size. æ­¤å¤„çš„receiverä¸€èˆ¬æ˜¯æ–¹æ³•çš„è°ƒç”¨è€…. </li>\n</ol>\n<h2 id=\"ç³»ç»Ÿè§¦å‘layoutSubviewsçš„æ¡ä»¶\"><a href=\"#ç³»ç»Ÿè§¦å‘layoutSubviewsçš„æ¡ä»¶\" class=\"headerlink\" title=\"ç³»ç»Ÿè§¦å‘layoutSubviewsçš„æ¡ä»¶\"></a><span id=\"layoutSubviews\">ç³»ç»Ÿè§¦å‘layoutSubviewsçš„æ¡ä»¶</span></h2><ol>\n<li>çˆ¶è§†å›¾ä½¿ç”¨<code>init</code>æ–¹æ³•å®Œæˆåˆå§‹åŒ–æ—¶ä¸ä¼šè§¦å‘<code>layoutSubviews</code>. </li>\n<li>çˆ¶è§†å›¾ç”¨<code>initWithFrame</code>å®Œæˆåˆå§‹åŒ–å¹¶ä¸”å½“frameå‚æ•°ä¸º<code>CGRectZero</code>æ—¶ä¸ä¼šè§¦å‘<code>layoutSubviews</code>. å½“frameå‚æ•°ä¸ä¸º<code>CGRectZero</code>æ—¶åˆ™ä¼šè§¦å‘<code>layoutSubviews</code>.</li>\n<li>çˆ¶è§†å›¾<code>setFrame</code>çš„æ—¶å€™ä¼šè§¦å‘<code>layoutSubviews</code>, å½“ç„¶frameå‰åå€¼å¾—å‘ç”Ÿå˜åŒ–.</li>\n<li>çˆ¶è§†å›¾<code>addSubview</code>æ·»åŠ å­è§†å›¾æ—¶ä¼šè§¦å‘å…¶å†…éƒ¨çš„<code>layoutSubviews</code>.</li>\n<li>å­è§†å›¾ä»çˆ¶è§†å›¾ä¸Š<code>removeFromSuperView</code>çš„æ—¶å€™ä¼šè§¦å‘å…¶å†…éƒ¨çš„<code>layoutSubviews</code>. </li>\n<li>æ»šåŠ¨ScrollViewçš„æ—¶å€™ä¼šè§¦å‘<code>layoutSubviews</code>. </li>\n<li>æ—‹è½¬å±å¹•çš„æ—¶å€™ä¼šè§¦å‘<code>layoutSubviews</code>. </li>\n</ol>\n<h2 id=\"ç³»ç»Ÿå‡ºå‘drawRect-çš„æ¡ä»¶\"><a href=\"#ç³»ç»Ÿå‡ºå‘drawRect-çš„æ¡ä»¶\" class=\"headerlink\" title=\"ç³»ç»Ÿå‡ºå‘drawRect:çš„æ¡ä»¶\"></a><span id=\"drawRect\">ç³»ç»Ÿå‡ºå‘drawRect:çš„æ¡ä»¶</span></h2><ol>\n<li>å¦‚æœåœ¨<code>UIView</code>åˆå§‹åŒ–æ—¶æ²¡æœ‰è®¾ç½®rectå¤§å°, å°†ç›´æ¥å¯¼è‡´<code>drawRect</code>ä¸è¢«è‡ªåŠ¨è°ƒç”¨. <code>drawRect</code>è°ƒç”¨æ˜¯åœ¨Controller-&gt;loadView, Controller-&gt;viewDidLoad ä¸¤æ–¹æ³•ä¹‹åæ‰ç”¨çš„. æ‰€ä»¥ä¸ç”¨æ‹…å¿ƒä¸€è¿›å…¥åˆ°æ§åˆ¶å™¨ä¸­, è¿™äº›Viewçš„drawRectå°±å¼€å§‹ç”»äº†. è¿™æ ·å¯ä»¥åœ¨æ§åˆ¶å™¨ä¸­è®¾ç½®ä¸€äº›å€¼ç»™View(å¦‚æœè¿™äº›View drawçš„æ—¶å€™éœ€è¦ç”¨åˆ°æŸäº›å˜é‡å€¼).</li>\n<li>è¯¥æ–¹æ³•åœ¨è°ƒç”¨<code>sizeToFit</code>åè¢«è°ƒç”¨, æ‰€ä»¥å¯ä»¥å…ˆè°ƒç”¨<code>sizeToFit</code>è®¡ç®—å‡ºsize, ç„¶åç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨drawRect:æ–¹æ³•. </li>\n<li>é€šè¿‡è®¾ç½®<code>contentMode</code>å±æ€§å€¼ä¸º<code>UIViewContentModeRedraw</code>. é‚£ä¹ˆå°†åœ¨æ¯æ¬¡è®¾ç½®æˆ–æ›´æ”¹frameçš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨<code>drawRect:</code>.</li>\n<li>ç›´æ¥è°ƒç”¨<code>setNeedsDisplay</code>æˆ–è€…<code>setNeedsDisplayInRect:</code>è§¦å‘<code>drawRect:</code>. ä½†æ˜¯æœ‰ä¸ªå‰ææ¡ä»¶æ˜¯rectä¸èƒ½ä¸º<code>CGRectZero</code>.<br>ä»¥ä¸Š1, 2æ¨è; è€Œ3, 4ä¸æå€¡. </li>\n</ol>\n<hr>\n<p>å‚è€ƒèµ„æ–™:</p>\n<p>1.<a href=\"http://www.jianshu.com/p/087529c83747\" target=\"_blank\" rel=\"noopener\">Core Animation ä¹‹ CALayer</a></p>\n<p>2.<a href=\"http://www.jianshu.com/p/3282c93c1a61\" target=\"_blank\" rel=\"noopener\">UIViewå‡ ä¸ªlayoutæ–¹æ³•çš„ç†è§£</a></p>\n<p>3.<a href=\"http://www.jianshu.com/p/b3bb9b08e3da\" target=\"_blank\" rel=\"noopener\">UIViewå¸ƒå±€æ·±å…¥ç†è§£</a></p>\n<p>4.<a href=\"http://www.jianshu.com/p/eb2c4bb4e3f1\" target=\"_blank\" rel=\"noopener\">UIViewLayoutçš„å‡ ä¸ªæ–¹æ³•</a></p>\n<p>5.<a href=\"http://zhangbuhuai.com/beginning-auto-layout-part-1/\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç†è§£Auto Layout ç¬¬ä¸€å¼¹</a></p>\n","categories":["é¢è¯•é¢˜"],"tags":["åŸºç¡€çŸ¥è¯†","é¢è¯•é¢˜","UIView"]},{"title":"UIViewç³»åˆ—ä¹‹---UIViewå’ŒCALayer","url":"http://hchong.net/2017/07/07/UIViewç³»åˆ—ä¹‹---UIViewå’ŒCALayer/","content":"<h1 id=\"UIViewç³»åˆ—ä¹‹â€”UIViewå’ŒCALayer\"><a href=\"#UIViewç³»åˆ—ä¹‹â€”UIViewå’ŒCALayer\" class=\"headerlink\" title=\"UIViewç³»åˆ—ä¹‹â€”UIViewå’ŒCALayer\"></a>UIViewç³»åˆ—ä¹‹â€”UIViewå’ŒCALayer</h1><p><a href=\"http://hchong.net/2017/08/30/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---UIView%E5%92%8CCALayer/\">UIViewç³»åˆ—ä¹‹â€”UIViewå’ŒCALayer</a><br><a href=\"http://hchong.net/2017/09/21/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---UIView%E7%9A%84%E5%B8%B8%E8%A7%81layout%E6%96%B9%E6%B3%95/\">UIViewç³»åˆ—ä¹‹â€”UIViewçš„å¸¸è§layoutæ–¹æ³•</a><br><a href=\"http://hchong.net/2017/09/24/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---iOS%E7%9A%84%E5%8A%A8%E6%80%81%E9%AB%98%E5%BA%A6/\">UIViewç³»åˆ—ä¹‹â€”iOSçš„åŠ¨æ€é«˜åº¦</a><br><a href=\"http://hchong.net/2017/09/21/UIView%E7%B3%BB%E5%88%97%E4%B9%8B---%E5%A6%82%E4%BD%95%E5%86%99%E4%B8%80%E4%B8%AA%E8%87%AA%E5%AE%9A%E4%B9%89View/\">UIViewç³»åˆ—ä¹‹â€”å¦‚ä½•å†™ä¸€ä¸ªè‡ªå®šä¹‰View</a></p>\n<h2 id=\"UIViewå’ŒCALayer\"><a href=\"#UIViewå’ŒCALayer\" class=\"headerlink\" title=\"UIViewå’ŒCALayer\"></a>UIViewå’ŒCALayer</h2><ol>\n<li><p><code>UIView</code>ç»§æ‰¿è‡ª<code>UIResponder</code>, å¯ä»¥ç›¸åº”è§¦æ‘¸äº‹ä»¶. è€Œ<code>CALayer</code>ç»§æ‰¿è‡ª<code>NSObject</code>, ä¸èƒ½å“åº”è§¦æ‘¸.</p>\n</li>\n<li><p><code>UIView</code>ä¸»è¦æ˜¯å¯¹æ˜¾ç¤ºå†…å®¹çš„ç®¡ç†, è€Œ<code>CALayer</code>åˆ™ä¸»è¦ä¾§é‡æ˜¾ç¤ºå†…å®¹çš„ç»˜åˆ¶. è®¿é—®<code>UIVIew</code>çš„ä¸ç»˜å›¾å’Œè·Ÿåæ ‡æœ‰å…³çš„å±æ€§, ä¾‹å¦‚<code>frame</code>, <code>bounds</code>ç­‰, å®é™…ä¸Šå†…éƒ¨éƒ½æ˜¯åœ¨è®¿é—®å®ƒæ‰€åŒ…å«çš„CALayerçš„ç›¸å…³å±æ€§. <code>UIView</code>çš„<code>frame</code>å®é™…æ˜¯<code>layer</code>çš„<code>frame</code>, <code>center</code>, <code>bounds</code>å®é™…ä¹Ÿæ˜¯åªæ˜¯å†…éƒ¨<code>layer</code>ç›¸å¯¹åº”å±æ€§çš„<code>get</code>å’Œ<code>set</code>æ–¹æ³•, å½“ä½ æ”¹å˜ä¸€ä¸ª<code>view</code>çš„<code>frame</code>çš„æ—¶å€™, ä½ å…¶å®æ”¹å˜çš„æ˜¯å†…éƒ¨<code>layer</code>çš„<code>frame</code>. CALayerçš„frameç”±<code>anchorPoint</code>, <code>position</code>, <code>bounds</code>, <code>transform</code>å…±åŒå†³å®š. <code>UIView</code>çš„åˆ›å»º, å®é™…ä¸Šæ˜¯ä¸€ç³»åˆ—<code>UILayer</code>åˆ›å»ºçš„è¿‡ç¨‹.</p>\n</li>\n<li><p><code>UIView</code>æœ‰ä¸ªé‡è¦å±æ€§<code>layer</code>. å¯ä»¥è¿”å›å®ƒçš„ä¸»<code>CALayer</code>å®ä¾‹. æ‰€æœ‰ä»UIViewç»§æ‰¿æ¥çš„å¯¹è±¡éƒ½ç»§æ‰¿äº†è¿™ä¸ªå±æ€§. è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨æ‰€æœ‰çš„<code>UIVIew</code>å­ç±»ä¸Šå¢åŠ åŠ¨ç”», æ—‹è½¬, ç¼©æ”¾ç­‰<code>CALayer</code>æ”¯æŒçš„æ“ä½œ. <code>UIView</code>çš„<code>layerClass</code>æ–¹æ³•, å¯ä»¥è¿”å›ä¸»<code>layer</code>æ‰€ä½¿ç”¨çš„ç±», <code>UIView</code>çš„å­ç±»å¯ä»¥é€šè¿‡é‡è½½è¿™ä¸ªæ–¹æ³•, æ¥è®©<code>UIView</code>ä½¿ç”¨ä¸åŒçš„CALayeræ¥æ˜¾ç¤º. ä»£ç ç¤ºä¾‹ï¼š</p>\n<pre><code> - (class)layerClass {\n     return ([CAEAGLLayer class]);\n }\n</code></pre></li>\n<li><p><code>UIView</code>çš„ä¸»<code>CALayer</code>æ˜¯ç±»ä¼¼äº<code>subviews</code>çš„æ ‘å½¢ç»“æ„, æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™ä¸»<code>layer</code>æ·»åŠ å­<code>layer</code>æ¥å®Œæˆç‰¹æ®Šçš„ç»˜åˆ¶æ•ˆæœ.</p>\n<p> åœ¨<code>view</code>ä¸Šæ·»åŠ ä¸€ä¸ªé»‘è‰²é€æ˜<code>layer</code>å±‚çš„ç¤ºä¾‹ä»£ç :</p>\n<pre><code> grayCover = [[CALayer alloc] init];\n grayCover.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:0.2] CGColor];\n [self.layer addSubLayer:grayCover];\n</code></pre></li>\n<li><p><code>UIView</code>çš„å†…éƒ¨, æœ‰ä¸‰ä¸ª<code>layer tree</code>: 1.é€»è¾‘æ ‘, è¿™é‡Œæ˜¯ä»£ç å¯ä»¥æ“çºµçš„. 2.åŠ¨ç”»æ ‘, æ˜¯ä¸€ä¸ªä¸­é—´å±‚, ç³»ç»Ÿå°±åœ¨è¿™ä¸€å±‚ä¸Šé€šè¿‡é€»è¾‘æ ‘æ¥æ›´æ”¹å±æ€§, è¿›è¡Œå„ç§æ¸²æŸ“æ“ä½œ. 3.æ˜¾ç¤ºæ ‘, å…¶å†…å®¹å°±æ˜¯å½“å‰æ­£è¢«æ˜¾ç¤ºåœ¨å±å¹•ä¸Šå¾—å†…å®¹. </p>\n</li>\n<li><p><code>UIView</code>å®é™…ä¸Šæ˜¯<code>CALayer</code>çš„<code>CALayerDelegate</code>, é€šè¿‡å®ç°ä¸€ç³»åˆ—çš„ä»£ç†æ–¹æ³•æ¥æ˜¾ç¤º<code>CALayer</code>ç»˜åˆ¶çš„å†…å®¹.</p>\n</li>\n<li><p>åœ¨åš iOS åŠ¨ç”»çš„æ—¶å€™, ä¿®æ”¹é<code>RootLayer</code>çš„å±æ€§(è­¬å¦‚ä½ç½®, èƒŒæ™¯è‰²ç­‰)ä¼šé»˜è®¤äº§ç”Ÿéšå¼åŠ¨ç”», è€Œä¿®æ”¹<code>UIView</code>åˆ™ä¸ä¼š.</p>\n</li>\n<li><p><code>layer</code>å¯ä»¥è®¾ç½®åœ†è§’æ˜¾ç¤º(cornerRadius), ä¹Ÿå¯ä»¥è®¾ç½®é˜´å½±(shadowColor). ä½†æ˜¯å¦‚æœ<code>layer</code>æ ‘ä¸­æŸä¸ª<code>layer</code>è®¾ç½®äº†åœ†è§’, æ ‘ç§æ‰€æœ‰<code>layer</code>çš„é˜´å½±æ•ˆæœéƒ½å°†ä¸æ˜¾ç¤ºäº†. å› æ­¤è‹¥æ˜¯è¦æœ‰åœ†è§’åˆè¦é˜´å½±, å˜é€šæ–¹æ³•åªèƒ½åšä¸¤ä¸ªé‡å çš„<code>UIView</code>, ä¸€ä¸ªçš„<code>layer</code>æ˜¾ç¤ºåœ†è§’, ä¸€ä¸ª<code>layer</code>æ˜¾ç¤ºé˜´å½±.</p>\n</li>\n<li><p><code>UIView</code> æ˜¯<code>UIKit</code>æ¡†æ¶ä¸‹çš„(åªèƒ½iOSä½¿ç”¨). <code>CALayer</code> æ˜¯<code>QuartzCore</code>çš„(iOS å’ŒmacOSé€šç”¨).</p>\n</li>\n<li><p><code>QuartzCore</code>çš„æ¸²æŸ“èƒ½åŠ›. ä½¿äºŒç»´å›¾åƒå¯ä»¥è¢«è‡ªç”±æ“çºµ, å°±å¥½åƒæ˜¯ä¸‰ç»´çš„. å›¾åƒå¯ä»¥åœ¨ä¸€ä¸ªä¸‰ç»´åæ ‡ç³»ä¸­ä»¥ä»»æ„è§’åº¦è¢«æ—‹è½¬, ç¼©æ”¾å’Œå€¾æ–œ. <code>CATransform3D</code>çš„ä¸€å¥—æ–¹æ³•æä¾›äº†ä¸€äº›é­”æœ¯èˆ¬çš„å˜æ¢æ•ˆæœ. </p>\n</li>\n</ol>\n<hr>\n<p>å‚è€ƒèµ„æ–™:</p>\n<p>1.<a href=\"http://www.jianshu.com/p/079e5cf0f014\" target=\"_blank\" rel=\"noopener\">è¯¦è§£CALayer å’Œ UIViewçš„åŒºåˆ«å’Œè”ç³»</a></p>\n<p>2.<a href=\"http://blog.csdn.net/weiwangchao_/article/details/7771538\" target=\"_blank\" rel=\"noopener\">UIViewå’ŒCALayerçš„åŒºåˆ«</a></p>\n","categories":["é¢è¯•é¢˜"],"tags":["åŸºç¡€çŸ¥è¯†","é¢è¯•é¢˜","UIView"]},{"title":"Blockç”¨æ³•ä¸åŸç†åˆ†æ","url":"http://hchong.net/2017/07/04/Blockç”¨æ³•ä¸åŸç†åˆ†æ/","content":"<h1 id=\"Blockç”¨æ³•åŠåˆ†æ\"><a href=\"#Blockç”¨æ³•åŠåˆ†æ\" class=\"headerlink\" title=\"Blockç”¨æ³•åŠåˆ†æ\"></a>Blockç”¨æ³•åŠåˆ†æ</h1><hr>\n<p>å‚è€ƒèµ„æ–™: </p>\n<p>1.<a href=\"https://halfrost.com/ios_block/\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç ”ç©¶ Block æ•è·å¤–éƒ¨å˜é‡å’Œ __block å®ç°åŸç†</a></p>\n<p>2.<a href=\"http://www.jianshu.com/p/51d04b7639f1\" target=\"_blank\" rel=\"noopener\">BlockæŠ€å·§ä¸åº•å±‚è§£æ</a></p>\n<p>3.<a href=\"https://halfrost.com/ios_block_retain_circle/\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç ”ç©¶Blockç”¨weakSelfã€strongSelfã€@weakifyã€@strongifyè§£å†³å¾ªç¯å¼•ç”¨</a></p>\n","categories":["åŸºç¡€çŸ¥è¯†"],"tags":["Block","åŸºç¡€çŸ¥è¯†"]},{"title":"è‡ªå·±åŠ¨æ‰‹åˆ¶ä½œXcodeæ’ä»¶","url":"http://hchong.net/2017/06/25/è‡ªå·±åŠ¨æ‰‹åˆ¶ä½œXcodeæ’ä»¶/","content":"<h1 id=\"è‡ªå·±åŠ¨æ‰‹åˆ¶ä½œXcodeæ’ä»¶\"><a href=\"#è‡ªå·±åŠ¨æ‰‹åˆ¶ä½œXcodeæ’ä»¶\" class=\"headerlink\" title=\"è‡ªå·±åŠ¨æ‰‹åˆ¶ä½œXcodeæ’ä»¶\"></a>è‡ªå·±åŠ¨æ‰‹åˆ¶ä½œXcodeæ’ä»¶</h1><p>Xcode8ä»¥å, ä»¥å‰çš„æ’ä»¶éƒ½ä¸èƒ½ç”¨äº†. ç½‘ä¸Šè™½ç„¶ä¹Ÿæœ‰æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜, ä½†æ˜¯ç¨æ˜¾å¤æ‚, è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨æ›²çº¿æ•‘å›½çš„æ–¹å¼, ä½¿ç”¨Appleå®˜æ–¹æ¨èçš„æ–¹å¼<em>Xcode Source Editor Extension</em>æ¥è‡ªå·±åˆ¶ä½œæ’ä»¶. Extensionçš„æ–¹å¼å¼€å‘çš„æ’ä»¶, å¯ä»¥ç‹¬ç«‹ä¸Šæ¶AppStore, å¹¶ä¸”æ˜¯ç‹¬ç«‹äºXcodeå·¥ç¨‹ç‹¬ç«‹è¿è¡Œçš„. ä½†æ˜¯æ²¡æœ‰UIäº¤äº’, ä¸èƒ½åœ¨åå°è¿è¡Œå¹¶ä¸”åªèƒ½åœ¨å¼€å‘è€…è°ƒç”¨çš„æ—¶å€™ç›´æ¥ä¿®æ”¹ä»£ç .</p>\n<p>åœ¨å¹³å¸¸çš„å¼€å‘è¿‡ç¨‹ä¸­, æœ‰äº›æ“ä½œæ˜¯ç»å¸¸é‡åˆ°çš„. ä¸‹é¢æˆ‘ä»¬ä»¥<em>æ ¹æ®å±æ€§è‡ªåŠ¨ç”ŸæˆGetteræ–¹æ³•</em>å’Œ<em>æ ¹æ®é€‰ä¸­å†…å®¹å¯¼å…¥å¤´æ–‡ä»¶</em>ä¸¤ç§ç»å¸¸ç¢°åˆ°çš„åœºæ™¯æ¥åˆ¶ä½œXcodeæ’ä»¶.</p>\n<h2 id=\"æ–°å»ºæ’ä»¶åˆ¶ä½œå·¥ç¨‹\"><a href=\"#æ–°å»ºæ’ä»¶åˆ¶ä½œå·¥ç¨‹\" class=\"headerlink\" title=\"æ–°å»ºæ’ä»¶åˆ¶ä½œå·¥ç¨‹\"></a>æ–°å»ºæ’ä»¶åˆ¶ä½œå·¥ç¨‹</h2><ol>\n<li><p>æ‰“å¼€Xcode, <code>command + shift + N</code> é€‰æ‹©macOS -&gt; Cocoa Application, ç‚¹å‡»Nextæ–°å»ºä¸€ä¸ªå·¥ç¨‹. æ­¤å¤„æˆ‘æ–°å»ºçš„å·¥ç¨‹åä¸º<em>AutoImportPlugin</em>.</p>\n</li>\n<li><p>åœ¨Xcodeå·¥å…·æ ä¸­é€‰æ‹©Editor -&gt; Add Target -&gt; MacOS -&gt; Xcode Source Editor Extensionæ¥æ–°å»ºä¸€ä¸ªExtensionæ¥ç¼–å†™æ’ä»¶çš„ä¸»è¦ä»£ç . æ–°å»ºçš„Targetåç§°ä¸èƒ½ä¸å·¥ç¨‹çš„åå­—ä¸€æ ·. æ¥ä¸‹æ¥ä¼šæœ‰ä¸€ä¸ªå¼¹çª—, æç¤ºä½ æ˜¯å¦<em>Activate xxx Scheme</em>, é€‰æ‹©<em>Activate</em>å³å¯, è¿™ä¸€æ­¥éª¤ä¼šå¸®ä½ åˆ›å»ºä¸€ä¸ªå’Œä½ æ–°å»ºTargetå¯¹åº”çš„Scheme. å®Œæˆåä½ çš„é¡µé¢åº”è¯¥æ˜¯è¿™ä¸ªæ ·å­çš„.</p>\n</li>\n</ol>\n<p><img src=\"https://ws1.sinaimg.cn/large/006tKfTcgy1fgyotdiqdbj312w0q03zl.jpg\" alt=\"ä¸»å·¥ç¨‹é¡µé¢\"></p>\n<h2 id=\"å·¥ç¨‹ç¯å¢ƒå’Œå‚æ•°ä»‹ç»\"><a href=\"#å·¥ç¨‹ç¯å¢ƒå’Œå‚æ•°ä»‹ç»\" class=\"headerlink\" title=\"å·¥ç¨‹ç¯å¢ƒå’Œå‚æ•°ä»‹ç»\"></a>å·¥ç¨‹ç¯å¢ƒå’Œå‚æ•°ä»‹ç»</h2><p>è¿™é‡Œæˆ‘ä»¬ä¼šä¸»è¦ç”¨åˆ°AutoImportæ–‡ä»¶å¤¹ä¸‹é¢çš„ä¸¤ä¸ªç±»<code>SourceEditorExtension</code> å’Œ <code>SourceEditorCommand</code>. </p>\n<p><code>SourceEditorExtension.m</code>ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ–¹æ³•:</p>\n<ul>\n<li><code>-(void)extensionDidFinishLaunching{}</code>, æ³¨é‡Šå†…å®¹ä¸º<code>If your extension needs to do any work at launch, implement this optional method.</code>   æŒ‡çš„æ˜¯æŒ‡åˆšåˆšåŠ è½½å¥½æ’ä»¶ä½†è¿˜æœªç‚¹å‡»æ’ä»¶æŒ‰é’®æ—¶ï¼Œå¯ä»¥æ‰§è¡ŒæŸäº›å‡†å¤‡å·¥ä½œ.</li>\n<li><code>- (NSArray &lt;NSDictionary &lt;XCSourceEditorCommandDefinitionKey, id&gt; *&gt; *)commandDefinitions{}</code>. è¿”å›å­—å…¸ç±»å‹çš„æ•°ç»„, å¯ä»¥ä¸ºæ¯ä¸ªæ’ä»¶é‡å†™åå­—ã€æ ‡è¯†ç¬¦å’Œè‡ªå®šä¹‰ç±»åç­‰ä¿¡æ¯ï¼Œå’Œ<code>Info.plist</code>æ–‡ä»¶ä¸­å¯¹åº”çš„<code>XCSourceEditorCommandName</code>ã€<code>XCSourceEditorCommandIdentifier</code>å’Œ<code>XCSourceEditorCommandClassName</code>ç­‰ä¿¡æ¯ä¸€è‡´.</li>\n</ul>\n<p><code>SourceEditorCommand.m</code>ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•:</p>\n<pre><code>- (void)performCommandWithInvocation:(XCSourceEditorCommandInvocation *)invocation completionHandler:(void (^)(NSError * _Nullable nilOrError))completionHandler\n{\n    // Implement your command here, invoking the completion handler when done. Pass it nil on success, and an NSError on failure.\n\n    completionHandler(nil);\n}\n</code></pre><p>å…³äºæ’ä»¶çš„æ ¸å¿ƒé€»è¾‘ä»£ç , å°±æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢å®ç°. <code>XCSourceEditorCommandInvocation</code>ç±»åŒ…å«äº†æ‰€æœ‰çš„ä¿¡æ¯.å¯ä»¥é€šè¿‡ä»–çš„å„ç§å±æ€§æ¥æ‹¿åˆ°åŸå·¥ç¨‹ä¸­çš„å„ç§æ•°æ®, ä¸»è¦ç”¨åˆ°çš„æœ‰:</p>\n<ul>\n<li><code>invocation.buffer.lines</code>æ˜¯ä¸€ä¸ªæ•°ç»„, åŒ…å«äº†ä½¿ç”¨æ’ä»¶çš„å·¥ç¨‹çš„é¡µé¢çš„æ¯ä¸€è¡Œä»£ç , è‰ºæœ¯ç»„çš„å½¢å¼å­˜åœ¨. </li>\n<li><code>invocation.buffer.selections</code>æ˜¯ä¸€ä¸ªæ•°ç»„, æ•°ç»„çš„å†…å®¹æ˜¯<code>XCSourceTextRange</code>. <code>XCSourceTextRange</code>åŒ…å«äº†ä¸¤ä¸ªç»“æ„ä½“, ç”¨äºæ ‡è®°åŸå·¥ç¨‹ä¸­é€‰ä¸­éƒ¨åˆ†çš„ä»£ç çš„ä½ç½®ä¿¡æ¯.<h2 id=\"æ ¸å¿ƒä»£ç \"><a href=\"#æ ¸å¿ƒä»£ç \" class=\"headerlink\" title=\"æ ¸å¿ƒä»£ç \"></a>æ ¸å¿ƒä»£ç </h2></li>\n</ul>\n<p>æ­¤å¤„ä»¥è‡ªåŠ¨å¯¼å…¥å¤´æ–‡ä»¶çš„æ’ä»¶ä¸ºä¾‹. ä¸»è¦æ€è·¯æ˜¯éå†ç±»çš„æ‰€æœ‰è¡Œ, æ‹¿åˆ°é€‰ä¸­çš„å†…å®¹, åˆ¤æ–­æ˜¯å¦è¢«importè¿‡, æ²¡æœ‰çš„è¯, åœ¨åˆé€‚ä½ç½®æ’å…¥<code>#import</code>;</p>\n<pre><code>- (void)performCommandWithInvocation:(XCSourceEditorCommandInvocation *)invocation completionHandler:(void (^)(NSError * _Nullable nilOrError))completionHandler\n{\n    XCSourceTextRange *range = [invocation.buffer.selections firstObject];\n\n    NSString *selectedLines = [invocation.buffer.lines objectAtIndex:range.start.line];\n    NSString *selection = [selectedLines substringWithRange:NSMakeRange(range.start.column, range.end.column - range.start.column)];\n\n    for (NSInteger i = 0; i &lt; invocation.buffer.lines.count - 1; i++) {\n        NSString *importString = [invocation.buffer.lines objectAtIndex:i];\n        if ([importString containsString:@&quot;@interface&quot;]) {\n            self.startLineNumber = i;\n            break;\n        }\n    }\n\n    BOOL isImported = NO;\n    for (NSInteger i = 0; i &lt;= self.startLineNumber ; i++) {\n        NSString *importString = [invocation.buffer.lines objectAtIndex:i];\n        if ([importString containsString:[NSString stringWithFormat:@&quot;%@.h&quot;, selection]]) {\n            isImported = YES;\n            break;\n        }\n    }\n    if (isImported == NO) {\n        [invocation.buffer.lines insertObject:[NSString stringWithFormat:@&quot;#import \\&quot;%@.h\\&quot;&quot;, selection] atIndex:self.startLineNumber - 1];\n    }\n    completionHandler(nil);\n}\n</code></pre><h2 id=\"æ’ä»¶ä½¿ç”¨\"><a href=\"#æ’ä»¶ä½¿ç”¨\" class=\"headerlink\" title=\"æ’ä»¶ä½¿ç”¨\"></a>æ’ä»¶ä½¿ç”¨</h2><h3 id=\"åŸºç¡€ç”¨æ³•\"><a href=\"#åŸºç¡€ç”¨æ³•\" class=\"headerlink\" title=\"åŸºç¡€ç”¨æ³•\"></a>åŸºç¡€ç”¨æ³•</h3><p>æˆ‘ä»¬åœ¨æ’ä»¶å·¥ç¨‹ä¸­é€‰ä¸­AutoImportçš„Scheme(æ–°å»ºçš„é‚£ä¸ª), <code>command + R</code>è¿è¡Œ,è¿™æ—¶ä¼šå‡ºç°ä¸€ä¸ªå¼¹çª—, è®©ä½ é€‰æ‹©è¦è¿è¡Œçš„å·¥ç¨‹. é€‰ä¸­è¦è¿è¡Œçš„å·¥ç¨‹å, æ­£å¸¸æ‰“å¼€. åœ¨Editorçš„æœ€ä¸‹é¢å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¿è¡Œçš„æ’ä»¶å·¥ç¨‹, ç‚¹å‡»å°±å¯ä»¥è¿è¡Œæ’ä»¶äº†. æ‰“æ–­ç‚¹å’Œè°ƒè¯•ä»€ä¹ˆçš„å’Œæ­£å¸¸çš„Xcodeé¡¹ç›®ä¸€æ ·.</p>\n<p><img src=\"https://ws4.sinaimg.cn/large/006tNc79gy1fgz0hh71w6j30ht0ccdgm.jpg\" alt=\"æ’ä»¶è¿è¡Œè°ƒè¯•\"></p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯, æˆ‘ä»¬åœ¨æ’ä»¶å·¥ç¨‹ä¸­ä¸¤ä¸ªTargetçš„Singingä¸€å®šè¦ä¿æŒä¸€è‡´, å¹¶ä¸”ä¸èƒ½ä¸ºç©º. å¦åˆ™åœ¨Xcodeä¸­çœ‹ä¸åˆ°æ’ä»¶.</p>\n<h3 id=\"è¿›é˜¶ç”¨æ³•\"><a href=\"#è¿›é˜¶ç”¨æ³•\" class=\"headerlink\" title=\"è¿›é˜¶ç”¨æ³•\"></a>è¿›é˜¶ç”¨æ³•</h3><p>ä»¥ä¸Šæˆ‘ä»¬å·²ç»å¯ä»¥åœ¨è‡ªå·±ç”µè„‘ä¸Šè°ƒè¯•å’Œä½¿ç”¨Xcodeæ’ä»¶äº†, é‚£ä¹ˆæ€ä¹ˆæ‰èƒ½åœ¨å…¶ä»–ç”µè„‘ä¸Šä¹Ÿä½¿ç”¨æˆ‘ä»¬å¼€å‘çš„æ’ä»¶å‘¢?</p>\n<ol>\n<li><p>æˆ‘ä»¬å¯ä»¥åœ¨æ’ä»¶å·¥ç¨‹ä¸­, æ‰¾åˆ°Productsæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆçš„çš„.appæ–‡ä»¶</p>\n</li>\n<li><p>å³é”®ç‚¹å‡»æ­¤æ–‡ä»¶ -&gt; â€œåœ¨Finderä¸­æ˜¾ç¤ºâ€ -&gt; å°†è¿™ä¸ª.appæ–‡ä»¶æ‹·è´åˆ°ä½ æˆ–è€…å°ä¼™ä¼´ç”µè„‘ä¸Šçš„â€åº”ç”¨ç¨‹åºâ€é‡Œ</p>\n</li>\n<li><p>åœ¨â€œåº”ç”¨ç¨‹åºâ€ä¸­åŒå‡».appæ–‡ä»¶è¿è¡Œã€‚ç„¶åï¼Œæ‰“å¼€â€œç³»ç»Ÿåå¥½è®¾ç½®â€ -&gt; â€œæ‰©å±•â€ -&gt; â€œXcode Source Editorâ€ -&gt; ç¡®è®¤æ’ä»¶åå­—å‰å·²æ‰“é’© -&gt; æ­¤æ—¶Xcodeä¸­èœå•æ Editorä¸‹çš„æ’ä»¶è™½ç„¶æ˜¾ç¤ºï¼Œä½†æ˜¯ä¸ºç°è‰²ï¼Œæ— æ³•ç‚¹æŒ‰ï¼Œæ‰€ä»¥è¦ -&gt; é‡å¯Xcode -&gt; å¤§åŠŸå‘Šæˆï¼</p>\n</li>\n<li><p>æ·»åŠ å¿«æ·é”®: Xcode -&gt; â€œPreferencesâ€ -&gt; â€œKey Bindingsâ€ -&gt; æœç´¢æ’ä»¶åå­— -&gt; æ·»åŠ å¯¹åº”çš„å¿«æ·é”®.</p>\n</li>\n</ol>\n<hr>\n<p>ä¸‹è½½åœ°å€: <a href=\"https://github.com/HChong3210/AutoGetterPlugin\" target=\"_blank\" rel=\"noopener\">AutoPlugin</a></p>\n<hr>\n<p>å‚è€ƒæ–‡ç« :<br>1.<a href=\"http://www.jianshu.com/p/9c9d0fcc62cc\" target=\"_blank\" rel=\"noopener\">è¯¦è§£ä¸€æ­¥æ­¥å®ç°Xcode 8 æ’ä»¶â€”â€”Source Editor Extensions</a></p>\n<p>2.<a href=\"http://www.code4app.com/blog-822721-394.html\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨ Xcode Source Editor Extensionå¼€å‘Xcode 8 æ’ä»¶</a></p>\n","categories":["æ’ä»¶"],"tags":["åŸºç¡€çŸ¥è¯†","Xcode"]},{"title":"è½¦","url":"http://hchong.net/2017/06/20/è½¦/","content":"<h1 id=\"åä¸‡å·¦å³è½åœ°\"><a href=\"#åä¸‡å·¦å³è½åœ°\" class=\"headerlink\" title=\"åä¸‡å·¦å³è½åœ°\"></a>åä¸‡å·¦å³è½åœ°</h1><p>æ•°æ®æ¥è‡ªæ±½è½¦ä¹‹å®¶, è½¦ä¸»æˆäº¤ä»·æ˜¯å„åœ°è½¦ä¸»æˆäº¤çš„çœŸå®ä»·æ ¼, å’Œå»4Såº—å’¨è¯¢çš„ä»·æ ¼å·®ä¸å¤š</p>\n<table><br>   <tr><br>      <td>è½¦ç³»</td><br>      <td>è½¦å‹</td><br>      <td>è½¦å‹è¯¦æƒ…</td><br>      <td>è½¦ä¸»æˆäº¤ä»·</td><br>   </tr><br>   <tr><br>      <td>åˆ«å…‹-è‹±æœ—</td><br>      <td>2017æ¬¾ 15N è‡ªåŠ¨ç²¾è‹±å‹</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/28698/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/28698/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-28698#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-28698#pvareaid=103596</a></td><br>   </tr><br>   <tr><br>      <td>é›ªä½›å…°-ç§‘æ²ƒå…¹</td><br>      <td>2016æ¬¾ 1.5L è‡ªåŠ¨æ¬£æ‚¦ç‰ˆ</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/27573/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/27573/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-27573#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-27573#pvareaid=103596</a></td><br>   </tr><br>   <tr><br>      <td>ç°ä»£-æ‚¦åŠ¨</td><br>      <td>2017æ¬¾ 1.6L è‡ªåŠ¨æ‚¦å€¼ç‰ˆGLS</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/29502/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/29502/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-29502#pvareaid=103597\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-29502#pvareaid=103597</a></td><br>   </tr><br>   <tr><br>      <td>ä¸œé£-æ ‡è‡´</td><br>      <td>2017æ¬¾ 1.6L è‡ªåŠ¨è±ªåç‰ˆ</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/29620/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/29620/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-29620#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-29620#pvareaid=103596</a></td><br>   </tr><br>   <tr><br>      <td>å¤§ä¼—-æœ—é€¸</td><br>      <td>2017æ¬¾ 1.6L è‡ªåŠ¨é£å°šç‰ˆ</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/29362/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/29362/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-29362#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-29362#pvareaid=103596</a></td><br>   </tr><br>   <tr><br>      <td>å¤§ä¼—-æ·è¾¾</td><br>      <td>2017æ¬¾ 1.5L è‡ªåŠ¨èˆ’é€‚å‹</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/28451/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/28451/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-28451#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-28451#pvareaid=103596</a></td><br>   </tr><br>   <tr><br>      <td>ä¸œé£é›ªé“é¾™-çˆ±ä¸½èˆ</td><br>      <td>2017æ¬¾ 1.6L è‡ªåŠ¨èˆ’é€‚å‹</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/29341/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/29341/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/s-98#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/s-98#pvareaid=103596</a></td><br>   </tr><br>   <tr><br>      <td>å‰åˆ©-å¸è±ªGS</td><br>      <td>2016æ¬¾ è¿åŠ¨ç‰ˆ 1.3T è‡ªåŠ¨é¢†å°šå‹</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/26402/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/26402/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-26402#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-26402#pvareaid=103596</a></td><br>   </tr><br>   <tr><br>      <td>å‰åˆ©-å¸è±ªGL</td><br>      <td>2017æ¬¾ 1.3T è‡ªåŠ¨å°Šè´µå‹</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/26596/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/26596/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-26596#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-26596#pvareaid=103596</a></td><br>   </tr><br>   <tr><br>      <td>å‰åˆ©-å¸è±ª</td><br>      <td>2017æ¬¾ ä¸‰å¢ç™¾ä¸‡æ¬¾ 1.5L CVTå‘ä¸Šç‰ˆ</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/28104/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/28104/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-28104#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-28104#pvareaid=103596</a></td><br>   </tr><br>   <tr><br>      <td>å‰åˆ©-å¸è±ª</td><br>      <td>2017æ¬¾ ä¸¤å¢RSç™¾ä¸‡æ¬¾ 1.5L CVTå‘ä¸Šç‰ˆ</td><br>      <td><a href=\"http://www.autohome.com.cn/spec/28133/\" target=\"_blank\" rel=\"noopener\">http://www.autohome.com.cn/spec/28133/</a></td><br>      <td><a href=\"http://jiage.autohome.com.cn/price/carlist/p-28133#pvareaid=103596\" target=\"_blank\" rel=\"noopener\">http://jiage.autohome.com.cn/price/carlist/p-28133#pvareaid=103596</a></td><br>   </tr><br></table>\n\n\n","categories":[],"tags":["ç”Ÿæ´»"]},{"title":"åŸºäºOpenCVçš„äººè„¸è¯†åˆ«","url":"http://hchong.net/2017/06/16/åŸºäºOpenCVçš„äººè„¸è¯†åˆ«/","content":"","categories":[],"tags":[]},{"title":"Pythonçˆ¬è™«å…¥é—¨","url":"http://hchong.net/2017/06/14/Pythonçˆ¬è™«å…¥é—¨/","content":"<h1 id=\"HCModule\"><a href=\"#HCModule\" class=\"headerlink\" title=\"HCModule\"></a>HCModule</h1><p><a href=\"https://travis-ci.org/HChong3210/HCModule\" target=\"_blank\" rel=\"noopener\"><img src=\"http://img.shields.io/travis/HChong3210/HCModule.svg?style=flat\" alt=\"CI Status\"></a><br><a href=\"http://cocoapods.org/pods/HCModule\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/cocoapods/v/HCModule.svg?style=flat\" alt=\"Version\"></a><br><a href=\"http://cocoapods.org/pods/HCModule\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/cocoapods/l/HCModule.svg?style=flat\" alt=\"License\"></a><br><a href=\"http://cocoapods.org/pods/HCModule\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/cocoapods/p/HCModule.svg?style=flat\" alt=\"Platform\"></a></p>\n<h2 id=\"Example\"><a href=\"#Example\" class=\"headerlink\" title=\"Example\"></a>Example</h2><p>To run the example project, clone the repo, and run <code>pod install</code> from the Example directory first.</p>\n<h2 id=\"Requirements\"><a href=\"#Requirements\" class=\"headerlink\" title=\"Requirements\"></a>Requirements</h2><h2 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h2><p>HCModule is available through <a href=\"http://cocoapods.org\" target=\"_blank\" rel=\"noopener\">CocoaPods</a>. To install<br>it, simply add the following line to your Podfile:</p>\n<pre><code class=\"ruby\">pod &#39;HCModule&#39;\n</code></pre>\n<h2 id=\"Author\"><a href=\"#Author\" class=\"headerlink\" title=\"Author\"></a>Author</h2><p>HChong3210, hchong7557@gmail.com</p>\n<h2 id=\"License\"><a href=\"#License\" class=\"headerlink\" title=\"License\"></a>License</h2><p>HCModule is available under the MIT license. See the LICENSE file for more info.</p>\n","categories":["çˆ¬è™«","Python"],"tags":["çˆ¬è™«","Python"]},{"title":"Cocoapodså®è·µ","url":"http://hchong.net/2017/05/24/Cocoapodså®è·µ/","content":"<h1 id=\"Cocoapodså®è·µ\"><a href=\"#Cocoapodså®è·µ\" class=\"headerlink\" title=\"Cocoapodså®è·µ\"></a>Cocoapodså®è·µ</h1><p>Cocoapodsæ˜¯ä¸€ä¸ªåŸºäºRubyçš„åŒ…ç®¡ç†å·¥å…·, ç±»ä¼¼çš„è¿˜æœ‰Carthage. Cocoapodsçš„å®‰è£…åœ¨è¿™é‡Œä¸åœ¨è¯¦è¿°, è¯·è‡ªè¡Œç™¾åº¦, åœ¨è¿™é‡Œç€é‡è®²ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨Cocoapodsåˆ¶ä½œç§æœ‰åŒ…, ä»¥åŠCocoapodsçš„å®ç°åŸç†. </p>\n<h2 id=\"Cocoapodsçš„å®ç°åŸç†\"><a href=\"#Cocoapodsçš„å®ç°åŸç†\" class=\"headerlink\" title=\"Cocoapodsçš„å®ç°åŸç†\"></a>Cocoapodsçš„å®ç°åŸç†</h2><p>cocoapodså®‰è£…æˆåŠŸå, æˆ‘ä»¬æ€ä¹ˆæ¥ä½¿ç”¨å®ƒå‘¢. è¿™é‡Œå°±è¦ç”¨åˆ°cocoapodsçš„æ ¸å¿ƒæ–‡ä»¶ä¹‹ä¸€<code>Podfile</code>. Podfile æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨äºå®šä¹‰é¡¹ç›®æ‰€éœ€è¦ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“ã€‚è¯¥æ–‡ä»¶æ”¯æŒé«˜åº¦è‡ªå®šä¹‰ï¼Œä½ å¯ä»¥æ ¹æ®ä¸ªäººå–œå¥½å¯¹å…¶åšå‡ºå®šåˆ¶ã€‚<a href=\"https://guides.cocoapods.org/syntax/Podfile.html\" target=\"_blank\" rel=\"noopener\">æŸ¥çœ‹æ›´å¤šå®˜æ–¹ä»‹ç»</a>. </p>\n<h3 id=\"Podfile\"><a href=\"#Podfile\" class=\"headerlink\" title=\"Podfile\"></a>Podfile</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªğŸŒ°, æˆ‘ä»¬æ¥æŒ¨ä¸ªåˆ†æä¸‹ä»–ä»¬èƒŒåéƒ½ä»£è¡¨ç€ä»€ä¹ˆ.</p>\n<pre><code class=\"Ruby\">source &#39;http://source.git&#39;\nplatform :ios, &#39;8.0&#39;\n\ntarget &#39;Demo&#39; do\n    pod &#39;AFNetworking&#39;\n    pod &#39;SDWebImage&#39;\n    pod &#39;Masonry&#39;\nend\n</code></pre>\n<p><code>source</code>: Specifies the location of specs. specçš„åœ°å€.</p>\n<p><code>platform</code>: Specifies the platform for which a static library should be built. æŒ‡å®šæ„å»ºé™æ€åº“çš„å¹³å°.</p>\n<p><code>target</code>: Defines a CocoaPods target and scopes dependencies defined within the given block. A target should correspond to an Xcode target. By default the target includes the dependencies defined outside of the block, unless instructed not to inherit them. å®šä¹‰äº†CocoaPodsåœ¨æŒ‡å®štargetçš„ä¾èµ–, æ­¤å¤„çš„Targetåº”è¯¥ä¸Xcodeç›®æ ‡ç›¸å¯¹åº”ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé™¤éè¡¨æ˜ä¸ç»§æ‰¿å®ƒä»¬, å¦åˆ™TargetåŒ…æ‹¬åœ¨å—å¤–éƒ¨å®šä¹‰çš„ä¾èµ–é¡¹.</p>\n<p><code>pod</code>: A dependency requirement is defined by the name of the Pod and optionally a list of version requirements. ä¸€ä¸ªä¾èµ–é¡¹éœ€æ±‚æ˜¯ç”±Podçš„åç§°å’Œå¯é€‰çš„ç‰ˆæœ¬éœ€æ±‚åˆ—è¡¨æ‰€å®šä¹‰çš„.</p>\n<p>å½“ä½ å†™å®Œ<code>Podfile</code>ä¹‹å, å°±éœ€è¦æ‰§è¡ŒPodçš„å‘½ä»¤<code>pod install</code>, æ¥æŒ‰ç…§<code>Podfile</code>ä¸­çš„é…ç½®æ¥é…ç½®æˆ‘ä¹ˆä½ çš„å·¥ç¨‹</p>\n<h3 id=\"pod-install\"><a href=\"#pod-install\" class=\"headerlink\" title=\"pod install\"></a>pod install</h3><p>å½“è¿è¡Œ <code>pod install</code> å‘½ä»¤æ—¶ä¼šå¼•å‘è®¸å¤šæ“ä½œã€‚è¦æƒ³æ·±å…¥äº†è§£è¿™ä¸ªå‘½ä»¤æ‰§è¡Œçš„è¯¦ç»†å†…å®¹ï¼Œå¯ä»¥åœ¨è¿™ä¸ªå‘½ä»¤åé¢åŠ ä¸Š <code>--verbose</code>æ¥æŸ¥çœ‹è¯¦ç»†å†…å®¹ã€‚ç°åœ¨è¿è¡Œè¿™ä¸ªå‘½ä»¤ <code>pod install --verbose</code>ï¼Œå¯ä»¥çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„å†…å®¹:</p>\n<pre><code>  Preparing\n\nAnalyzing dependencies\n\nInspecting targets to integrate\n  Using `ARCHS` setting to build architectures of target `Pods-XXX`: (``)\n\nResolving dependencies of `Podfile`\n\nComparing resolved specification to the sandbox manifest\n  A AFNetworking\n  A Masonry\n  A SDWebImage\n\nDownloading dependencies\n\n-&gt; Installing AFNetworking (3.1.0)\n &gt; Git download\n &gt; Git download\n     $ /usr/bin/git clone https://github.com/AFNetworking/AFNetworking.git\n     /var/folders/qy/tmvltypx4w954cx9hsfz0vn40000gn/T/d20170813-81556-1sx4ds8\n     --template= --single-branch --depth 1 --branch 3.1.0\n     Cloning into &#39;/var/folders/qy/tmvltypx4w954cx9hsfz0vn40000gn/T/d20170813-81556-1sx4ds8&#39;...\n     Note: checking out &#39;88f13053b1d1f20bf657f5c36459b87a5d317ad7&#39;.\n\n     You are in &#39;detached HEAD&#39; state. You can look around, make experimental\n     changes and commit them, and you can discard any commits you make in this\n     state without impacting any branches by performing another checkout.\n\n     If you want to create a new branch to retain commits you create, you may\n     do so (now or later) by using -b with the checkout command again. Example:\n\n       git checkout -b &lt;new-branch-name&gt;\n\n     $ /usr/bin/git -C\n     /var/folders/qy/tmvltypx4w954cx9hsfz0vn40000gn/T/d20170813-81556-1sx4ds8\n     submodule update --init --recursive\n  &gt; Copying AFNetworking from\n  `/Users/hc/Library/Caches/CocoaPods/Pods/Release/AFNetworking/3.1.0-5e0e1` to\n  `Pods/AFNetworking`\n\n-&gt; Installing Masonry (1.0.2)\n  &gt; Copying Masonry from\n  `/Users/hc/Library/Caches/CocoaPods/Pods/Release/Masonry/1.0.2-7c429` to\n  `Pods/Masonry`\n\n-&gt; Installing SDWebImage (4.1.0)\n  &gt; Copying SDWebImage from\n  `/Users/hc/Library/Caches/CocoaPods/Pods/Release/SDWebImage/4.1.0-0e435` to\n  `Pods/SDWebImage`\n  - Running pre install hooks\n\nGenerating Pods project\n  - Creating Pods project\n  - Adding source files to Pods project\n  - Adding frameworks to Pods project\n  - Adding libraries to Pods project\n  - Adding resources to Pods project\n  - Linking headers\n  - Installing targets\n    - Installing target `AFNetworking` iOS 8.0\n      - Generating Info.plist file at `Pods/Target Support\n      Files/AFNetworking/Info.plist`\n      - Generating module map file at `Pods/Target Support\n      Files/AFNetworking/AFNetworking.modulemap`\n      - Generating umbrella header at `Pods/Target Support\n      Files/AFNetworking/AFNetworking-umbrella.h`\n    - Installing target `Masonry` iOS 8.0\n      - Generating Info.plist file at `Pods/Target Support\n      Files/Masonry/Info.plist`\n      - Generating module map file at `Pods/Target Support\n      Files/Masonry/Masonry.modulemap`\n      - Generating umbrella header at `Pods/Target Support\n      Files/Masonry/Masonry-umbrella.h`\n    - Installing target `SDWebImage` iOS 8.0\n      - Generating Info.plist file at `Pods/Target Support\n      Files/SDWebImage/Info.plist`\n      - Generating module map file at `Pods/Target Support\n      Files/SDWebImage/SDWebImage.modulemap`\n      - Generating umbrella header at `Pods/Target Support\n      Files/SDWebImage/SDWebImage-umbrella.h`\n    - Installing target `Pods-CarMall` iOS 8.0\n      - Generating Info.plist file at `Pods/Target Support\n      Files/Pods-CarMall/Info.plist`\n      - Generating module map file at `Pods/Target Support\n      Files/Pods-CarMall/Pods-CarMall.modulemap`\n      - Generating umbrella header at `Pods/Target Support\n      Files/Pods-CarMall/Pods-CarMall-umbrella.h`\n  - Running post install hooks\n  - Writing Xcode project file to `Pods/Pods.xcodeproj`\n    - Generating deterministic UUIDs\n  - Writing Lockfile in `Podfile.lock`\n  - Writing Manifest in `Pods/Manifest.lock`\n\nIntegrating client project\n\n[!] Please close any current Xcode sessions and use `CarMall.xcworkspace` for this project from now on.\n\nIntegrating target `Pods-CarMall` (`CarMall.xcodeproj` project)\n  - Running post install hooks\n    - cocoapods-stats from\n    `/Users/hc/.rvm/gems/ruby-2.4.1/gems/cocoapods-stats-1.0.0/lib/cocoapods_plugin.rb`\n\nSending stats\n      - AFNetworking, 3.1.0\n      - Masonry, 1.0.2\n      - SDWebImage, 4.1.0\n\n-&gt; Pod installation complete! There are 3 dependencies from the Podfile and 3 total pods installed.\n</code></pre><p>å…ˆçœ‹æˆ‘ä»¬å·¥ç¨‹çš„å˜åŒ–, å¯ä»¥å‘ç°å·¥ç¨‹é‡Œé¢å¤šäº†ä¸‰ä¸ªæ–‡ä»¶, ä¸€ä¸ª<code>XXX.xcworkspace</code>æ–‡ä»¶, ä¸€ä¸ª<code>Podfile.lock</code>æ–‡ä»¶, è¿˜æœ‰ä¸€ä¸ª<code>Pods</code>æ–‡ä»¶å¤¹. æˆ‘ä»¬åœ¨é€šè¿‡ç»ˆç«¯è¾“å‡ºçš„å‘½ä»¤æ¥åˆ†æ, ä¸ºä»€ä¹ˆä¼šç”Ÿæˆè¿™å‡ ä¸ªæ–‡ä»¶, ä»¥åŠä»–ä»¬çš„ä½œç”¨.</p>\n<ol>\n<li>Analyzing dependencies. å¼„æ¸…æ¥šå£°æ˜äº†å“ªäº›ç¬¬ä¸‰æ–¹åº“.åœ¨åŠ è½½ <code>podspecs</code> è¿‡ç¨‹ä¸­ï¼Œ<code>CocoaPods</code> å°±å»ºç«‹äº†åŒ…æ‹¬ç‰ˆæœ¬ä¿¡æ¯åœ¨å†…çš„æ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“çš„åˆ—è¡¨ã€‚<code>Podspecs</code> è¢«å­˜å‚¨åœ¨æœ¬åœ°è·¯å¾„ <code>~/.cocoapods</code> ä¸­.</li>\n<li>Inspecting targets to integrate. æ£€æŸ¥ç›®æ ‡é›†æˆ.</li>\n<li>Resolving dependencies of <code>Podfile</code> å’Œ Comparing resolved specification to the sandbox manifest. åˆ†æ<code>Podfile</code>æ–‡ä»¶çš„ä¾èµ–å’Œå°†å·²ç»è§£æçš„Podä¸ç¼“å­˜è¿‡çš„Podè¿›è¡Œæ¯”å¯¹, æ˜¯æ·»åŠ è¿˜æ˜¯åˆ é™¤, è¿˜æ˜¯æ›´æ–°.</li>\n<li>Downloading dependencies. æ ¹æ®ç¬¬ä¸‰éƒ¨çš„åˆ†æç»“æœæ¥ä¸‹è½½ä¾èµ–åˆ°<code>Pods</code>æ–‡ä»¶å¤¹ä¸‹é¢.</li>\n<li>Generating Pods project. ç”ŸæˆPodsçš„å·¥ç¨‹. è¿™ä¸€æ­¥è¿˜åŒ…å«äº†è®¸å¤šå…¶ä»–çš„æ­¥éª¤.<ul>\n<li>Creating Pods project</li>\n<li>Adding source files to Pods project</li>\n<li>Adding frameworks to Pods project</li>\n<li>Adding libraries to Pods project</li>\n<li>Adding resources to Pods project</li>\n<li>Linking headers</li>\n<li>Installing targets</li>\n<li>Running post install hooks</li>\n<li>Writing Xcode project file to <code>Pods/Pods.xcodeproj</code> å¦‚æœæ£€æµ‹åˆ°æ”¹åŠ¨æ—¶ï¼ŒCocoaPods ä¼šåˆ©ç”¨ Xcodeproj gem ç»„ä»¶å¯¹ Pods.xcodeproj è¿›è¡Œæ›´æ–°ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ç”¨é»˜è®¤é…ç½®ç”Ÿæˆã€‚å¦åˆ™ï¼Œä¼šå°†å·²æœ‰çš„é…ç½®é¡¹åŠ è½½è‡³å†…å­˜ä¸­.</li>\n<li>Writing Lockfile in <code>Podfile.lock</code>. è®°å½•å„ä¸ªPodçš„ç‰ˆæœ¬å·å’Œä¹‹å®¶ä½ çš„ä¾èµ–å…³ç³».</li>\n<li>Writing Manifest in <code>Pods/Manifest.lock</code></li>\n</ul>\n</li>\n</ol>\n<h3 id=\"pod-install-vs-pod-update\"><a href=\"#pod-install-vs-pod-update\" class=\"headerlink\" title=\"pod install vs pod update\"></a>pod install vs pod update</h3><p>å¼•ç”¨å®˜æ–¹çš„æ–‡æ¡£<a href=\"https://guides.cocoapods.org/using/pod-install-vs-update.html\" target=\"_blank\" rel=\"noopener\">https://guides.cocoapods.org/using/pod-install-vs-update.html</a>æ¥è¯´æ˜ä¸€ä¸‹äºŒè€…çš„åŒºåˆ«, ä»¥åŠä½¿ç”¨åœºæ™¯.</p>\n<p>You will only use pod update when you want to update the version of a specific pod (or all the pods).</p>\n<ul>\n<li><code>pod install</code>ä¸»è¦ç”¨åœ¨ç¬¬ä¸€æ¬¡å®‰è£…podsæ—¶, å¦‚æœåé¢ä½ æ–°å¢, ä¿®æ”¹, åˆ é™¤ä½ çš„<code>Podfile</code>æ–‡ä»¶æ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤. æ¯æ¬¡æ‰§è¡Œ<code>pod install</code>å‘½ä»¤ä¼šæŠŠæ¯ä¸€ä¸ªå®‰è£…çš„podçš„ç‰ˆæœ¬å†™è¿›<code>Podfile.lock</code>æ–‡ä»¶ä¸­, æ¥è®°å½•å’Œlockè¿™äº›å·²ç»å®‰è£…Podçš„ç‰ˆæœ¬. å½“æ‰§è¡Œ<code>Pod install</code>. å¦‚æœæ˜¯æ–°å¢Pod, é‚£ä¹ˆä¼šæœç´¢ä¸Podfileä¸­æè¿°çš„åŒ¹é…çš„ç‰ˆæœ¬; å¦‚æœå·²ç»å­˜åœ¨, ä»–ä¼šä¸‹è½½<code>Podfile.lock</code>æ–‡ä»¶ä¸­æ˜ç¡®çš„ç‰ˆæœ¬, ä½†ä¸ä¼šå»æ£€æŸ¥æœ‰æ²¡æœ‰å¯ç”¨çš„æœ€æ–°ç‰ˆæœ¬.</li>\n<li><code>pod update</code>ä¼šä¸å…³æ³¨<code>Podfile.lock</code>ä¸­çš„ç‰ˆæœ¬è€Œç›´æ¥æ›´æ–°åˆ°ç¬¦åˆ<code>Podfile</code>ä¸­å®šä¹‰çš„æœ€æ–°ç‰ˆæœ¬.</li>\n</ul>\n<h2 id=\"ä½¿ç”¨CocoaPodsåˆ›å»ºç§æœ‰Pod\"><a href=\"#ä½¿ç”¨CocoaPodsåˆ›å»ºç§æœ‰Pod\" class=\"headerlink\" title=\"ä½¿ç”¨CocoaPodsåˆ›å»ºç§æœ‰Pod\"></a>ä½¿ç”¨CocoaPodsåˆ›å»ºç§æœ‰Pod</h2><p>ä¸Šé¢æˆ‘ä»¬å·²ç»ä»‹ç»è¿‡å¦‚ä½•ä½¿ç”¨CocoaPodsäº†, ä¸‹é¢è¦è®²è§£çš„å°±æ˜¯å¦‚ä½•åˆ›å»ºPodæ¥ä¾›åˆ«äººä½¿ç”¨. åœ¨åˆ›å»ºç§æœ‰Podä¹‹å‰æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªgitåœ°å€:</p>\n<ul>\n<li>ç”¨æ¥ä¿å­˜Spec Repoçš„å†…å®¹çš„Gitåœ°å€</li>\n<li>ç”¨æ¥ä¿å­˜å…·ä½“Podå†…å®¹çš„Gitåœ°å€</li>\n</ul>\n<h3 id=\"åˆ›å»ºä¸€ä¸ªSpec-Repo\"><a href=\"#åˆ›å»ºä¸€ä¸ªSpec-Repo\" class=\"headerlink\" title=\"åˆ›å»ºä¸€ä¸ªSpec Repo\"></a>åˆ›å»ºä¸€ä¸ªSpec Repo</h3><p>åœ¨è¿™ä¸€æ­¥, æˆ‘ä»¬ä¸»è¦åˆ›å»ºç¬¬ä¸€ä¸ªGitåœ°å€, å¹¶ä¸”å…³è”åˆ°æœ¬åœ°.</p>\n<p><code>Spec Repo</code>æ˜¯æ‰€æœ‰çš„Podsçš„ä¸€ä¸ªç´¢å¼•ï¼Œå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œæ‰€æœ‰å…¬å¼€çš„Podséƒ½åœ¨è¿™ä¸ªé‡Œé¢ï¼Œä»–å®é™…æ˜¯ä¸€ä¸ªGitä»“åº“remoteç«¯. åœ¨GitHubä¸Šï¼Œä½†æ˜¯å½“ä½ ä½¿ç”¨äº†Cocoapodsåä»–ä¼šè¢«cloneåˆ°æœ¬åœ°çš„~/.cocoapods/reposç›®å½•ä¸‹ï¼Œå¯ä»¥è¿›å…¥åˆ°è¿™ä¸ªç›®å½•çœ‹åˆ°masteræ–‡ä»¶å¤¹å°±æ˜¯è¿™ä¸ªå®˜æ–¹çš„Spec Repoäº†ã€‚è¿™ä¸ªmasterç›®å½•çš„ç»“æ„æ˜¯è¿™ä¸ªæ ·å­çš„:</p>\n<pre><code>.\nâ”œâ”€â”€ Specs\n    â””â”€â”€ [SPEC_NAME]\n        â””â”€â”€ [VERSION]\n            â””â”€â”€ [SPEC_NAME].podspec\n</code></pre><p>å¦‚æœä½ è¦åˆ›å»ºç§æœ‰Pod, é‚£ä¹ˆä½ çš„<code>Spec Repo</code>çš„è¿œç«¯åœ°å€å°±å¿…é¡»æ˜¯ç§æœ‰çš„. åä¹‹å¦‚æœä½ è¦åˆ›å»ºä¸€ä¸ªå…¬æœ‰çš„Pod, é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨GitHubæ¥æ‰˜ç®¡ä½ çš„ä»£ç . å½“ä½ åˆ›å»ºå¥½è¿œç«¯çš„ä»“åº“ä¹‹å, æ‰§è¡Œ<code>pod repo add [Spec Repoçš„ä»“åº“å] [Spec Repoçš„gitåœ°å€]</code>æ¥æŠŠè¿œç«¯çš„ä»“åº“cloneåˆ°æœ¬åœ°. æ³¨æ„, è¿™é‡Œ<code>[Spec Repoçš„ä»“åº“å]</code>ä¸ä¸€å®šæ˜¯è¿œç«¯Gitä»“åº“çš„åå­—, è€Œæ˜¯cloneåˆ°æœ¬åœ°å, æœ¬åœ°æ–‡ä»¶åŠ çš„åå­—, ä½†æ˜¯è¿™ä¸ªåå­—ä¼šåœ¨åé¢æäº¤<code>PodSpec</code>æ–‡ä»¶æ—¶ç”¨åˆ°.</p>\n<h3 id=\"åˆ›å»ºPodå·¥ç¨‹æ–‡ä»¶\"><a href=\"#åˆ›å»ºPodå·¥ç¨‹æ–‡ä»¶\" class=\"headerlink\" title=\"åˆ›å»ºPodå·¥ç¨‹æ–‡ä»¶\"></a>åˆ›å»ºPodå·¥ç¨‹æ–‡ä»¶</h3><p>æˆ‘ä»¬åœ¨ä½ éœ€è¦åˆ›å»ºPodçš„ç›®å½•ä¸‹ä½¿ç”¨<code>pod lib create [Podåç§°]</code>æ¥åˆ›å»ºå¯¹åº”çš„Podæ¨¡æ¿.  å®é™…ä¸Šè¯¥å‘½ä»¤è¡Œéšè—äº†é»˜è®¤å‚æ•°, å‚æ•°è¡¥å…¨ååº”è¯¥æ˜¯<code>pod lib create ProjectName --template-url=https://github.com/CocoaPods/pod-template.git</code>. </p>\n<p>æ¥ä¸‹æ¥ä¼šé—®ä½ å››ä¸ªé—®é¢˜:</p>\n<ol>\n<li>What language do you want to use?? [ Swift / ObjC ]. ä½¿ç”¨ä»€ä¹ˆè¯­è¨€</li>\n<li>Would you like to include a demo application with your library?. æ˜¯å¦éœ€è¦ä¸€ä¸ªä¾‹å­å·¥ç¨‹, ä¸€èˆ¬é€‰æ‹©YES</li>\n<li>Which testing frameworks will you use? [ Specta / Kiwi / None ]. é€‰æ‹©ä¸€ä¸ªæµ‹è¯•æ¡†æ¶</li>\n<li>Would you like to do view based testing? [ Yes / No ]. æ˜¯å¦åŸºäºViewæµ‹è¯•</li>\n<li>What is your class prefix?. ç±»çš„å‰ç¼€</li>\n</ol>\n<p>æ ¹æ®è‡ªå·±çš„å®é™…éœ€è¦æ¥é€‰æ‹©å, å°±ä¼šè‡ªåŠ¨æ‰§è¡Œ<code>Pod install</code>å‘½ä»¤æ¥åˆ›å»ºé¡¹ç›®å¹¶ä¸”ç”Ÿæˆä¾èµ–. è¿™æ˜¯è¿™ä¸ªPodçš„æ²¡ç›®å½•ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„:</p>\n<pre><code>  MyLib\n  â”œâ”€â”€ .travis.yml\n  â”œâ”€â”€ _Pods.xcproject\n  â”œâ”€â”€ Example\n  â”‚   â”œâ”€â”€ MyLib\n  â”‚   â”œâ”€â”€ MyLib.xcodeproj\n  â”‚   â”œâ”€â”€ MyLib.xcworkspace\n  â”‚   â”œâ”€â”€ Podfile\n  â”‚   â”œâ”€â”€ Podfile.lock\n  â”‚   â”œâ”€â”€ Pods\n  â”‚   â””â”€â”€ Tests\n  â”œâ”€â”€ LICENSE\n  â”œâ”€â”€ MyLib.podspec\n  â”œâ”€â”€ Pod\n  â”‚   â”œâ”€â”€ Assets\n  â”‚   â””â”€â”€ Classes\n  â”‚     â””â”€â”€ RemoveMe.[swift/m]\n  â””â”€â”€ README.md\n</code></pre><p>æ¥ä¸‹æ¥, æˆ‘ä»¬éœ€è¦åˆ›å»ºç¬¬äºŒä¸ªGitåœ°å€, ç”¨æ¥ä¿å­˜Podçš„å®ç°ä»£ç . æˆ‘ä»¬è¿›å…¥åˆ°Podæ–‡ä»¶å¤¹çš„æ ¹ç›®å½•ä¸‹, ä½¿ç”¨å¦‚ä¸‹ä»£ç æ¥å…³è”Podåˆ°è¿œç«¯ä»“åº“:</p>\n<pre><code>$ git add .\n$ git commit -s -m &quot;Initial Commit of Library&quot;\n$ git remote add origin [Podçš„è¿œç«¯åœ°å€]           #æ·»åŠ è¿œç«¯ä»“åº“\n$ git push origin master     #æäº¤åˆ°è¿œç«¯ä»“åº“\n</code></pre><h3 id=\"ç¼–è¾‘Podæ–‡ä»¶\"><a href=\"#ç¼–è¾‘Podæ–‡ä»¶\" class=\"headerlink\" title=\"ç¼–è¾‘Podæ–‡ä»¶\"></a>ç¼–è¾‘Podæ–‡ä»¶</h3><p>Podæ–‡ä»¶å°±æ˜¯è¿™ä¸ªPodè¦å®ç°åŠŸèƒ½çš„å…·ä½“é€»è¾‘, åœ¨ä¸»å·¥ç¨‹æ ¹ç›®å½•ä¸‹é¢æœ‰ä¸€ä¸ªå’ŒPodåŒåçš„æ–‡ä»¶å¤¹, é‡Œé¢æœ‰ä¸¤ä¸ªå­æ–‡ä»¶å¤¹. ä¸€ä¸ªæ˜¯<code>Assets</code>, ä¸€ä¸ªæ˜¯<code>Classes</code>.</p>\n<ul>\n<li>Assetsæ–‡ä»¶ä¸»è¦ç”¨æ¥å­˜æ”¾èµ„æºæ–‡ä»¶, ä¾‹å¦‚å›¾ç‰‡èµ„æºå’ŒXIBæ–‡ä»¶.</li>\n<li>Classesåˆ™å­˜æ”¾ä¸»è¦çš„åŠŸèƒ½ä»£ç , ç±».</li>\n</ul>\n<p>åœ¨è¿™é‡Œéœ€è¦æ³¨æ„ä¸¤ä¸ªåœ°æ–¹:</p>\n<ol>\n<li>å½“æˆ‘ä»¬è¦ä½¿ç”¨<code>Pod</code>ä¸­çš„èµ„æºæ—¶, ä»¥å›¾ç‰‡ä¸ºä¾‹, æˆ‘ä»¬é€šè¿‡<code>[UIImage imageWithName:@&quot;xxx.png&quot;]</code>æ˜¯å–ä¸åˆ°Podä¸­çš„å›¾ç‰‡çš„, å› ä¸º<code>imageWithName:</code>æ–¹æ³•é»˜è®¤æ˜¯ä»<code>mainBundle</code>ä¸­æ¥å–çš„, è€ŒPodä¸å±äº<code>mainBundle</code>çš„èŒƒç•´, æˆ‘ä»¬éœ€è¦å…ˆæ ¹æ®<code>class</code>æ¥æ‹¿åˆ°å½“å‰ç±»æ‰€åœ¨çš„<code>bundle</code>, å†å–è¯¥<code>Bundle</code>ä¸­çš„èµ„æº.</li>\n<li>æ¯æ¬¡åœ¨Podæ–‡ä»¶å¤¹ä¸­æ·»åŠ æ–°çš„æ–‡ä»¶æˆ–è€…èµ„æºæ—¶, éƒ½éœ€è¦åœ¨æ ¹ç›®å½•çš„Exampleç›®å½•ä¸‹æ‰§è¡Œ<code>pod update</code>å‘½ä»¤æ¥é‡æ–°å»ºç«‹ç´¢å¼•.</li>\n</ol>\n<h3 id=\"ç¼–è¾‘Podspecæ–‡ä»¶\"><a href=\"#ç¼–è¾‘Podspecæ–‡ä»¶\" class=\"headerlink\" title=\"ç¼–è¾‘Podspecæ–‡ä»¶\"></a>ç¼–è¾‘Podspecæ–‡ä»¶</h3><p>å…³äº<code>Podspec</code>æ–‡ä»¶<a href=\"http://guides.cocoapods.org/syntax/podspec.html\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹</a>æ˜¯è¿™æ ·æè¿°çš„:</p>\n<blockquote>\n<p>A specification describes a version of Pod library. It includes details about where the source should be fetched from, what files to use, the build settings to apply, and other general metadata such as its name, version, and description.</p>\n</blockquote>\n<p><code>pod lib create XXX</code>åˆ›å»ºå‡ºæ¥çš„Pod, åˆå§‹æ—¶çš„<code>Podspec</code>æ–‡ä»¶åŒ…å«äº†å„ç§ä¿¡æ¯, è¯¦ç»†çš„è¯´æ˜æˆ‘ä»¬å¯ä»¥çœ‹<a href=\"http://guides.cocoapods.org/syntax/podspec.html\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a>, è¿™é‡Œè´´ä¸Šæœ€åŸºç¡€çš„ç”¨æ³•ä»£ç :</p>\n<pre><code>Pod::Spec.new do |s|\n  s.name             = &#39;HCPods&#39;\n  #Podçš„ç‰ˆæœ¬\n  s.version          = &#39;0.1.0&#39;\n  s.summary          = &#39;ä½ åœ¨æœç´¢æ—¶ä¼šå‘ˆç°&#39;\n\n  s.description      = &lt;&lt;-DESC\n    è¿™é‡Œæ˜¯å…³äºä½ PodåŠŸèƒ½çš„æè¿°\n                       DESC\n\n  s.homepage         = &#39;https://github.com/HChong3210/HCPods&#39;\n  s.license          = { :type =&gt; &#39;MIT&#39;, :file =&gt; &#39;LICENSE&#39; }\n  s.author           = { &#39;HChong3210&#39; =&gt; &#39;hchong7557@gmail.com&#39; }\n  #Podçš„è¿œç«¯ä»“åº“åœ°å€\n  s.source           = { :git =&gt; &#39;https://github.com/HChong3210/HCPods.git&#39;, :tag =&gt; s.version.to_s }\n\n    #Podæ”¯æŒçš„æœ€ä½ç‰ˆæœ¬\n  s.ios.deployment_target = &#39;8.0&#39;\n    #Podæºæ–‡ä»¶çš„ä½ç½®\n  s.source_files = &#39;HCPods/Classes/**/*&#39;\n  #Podä¸­èµ„æºæ–‡ä»¶çš„ä½ç½®\n  s.resource_bundles = {\n    &#39;DFCForms&#39; =&gt; [&#39;HCPods/Assets/*.{png,xib,plist}&#39;]\n  }\n  #å¯¹å¤–å…¬å¼€çš„ç±»\n  s.public_header_files = &#39;DFCForms/Classes/**/*.h&#39;\n\n  #Podä¸­ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹åº“\n  s.frameworks = &#39;UIKit&#39;\n  s.dependency &#39;AFNetworking&#39;, &#39;~&gt; 2.3&#39;\n  s.dependency &#39;SDWebImage&#39;\n\nend\n</code></pre><h3 id=\"æäº¤Podæ–‡ä»¶\"><a href=\"#æäº¤Podæ–‡ä»¶\" class=\"headerlink\" title=\"æäº¤Podæ–‡ä»¶\"></a>æäº¤Podæ–‡ä»¶</h3><p>Podæ–‡ä»¶ç¼–è¾‘å¥½å, æˆ‘ä»¬è¦æŠŠä»£ç æäº¤åˆ°è¿œç«¯æœåŠ¡å™¨, æˆ‘ä»¬å°±ä½¿ç”¨æ­£å¸¸çš„æ–¹å¼æ¥æäº¤ä»£ç , å¹¶ä¸”ç»™ä»£ç æ‰“ä¸ŠTag, <em> æ³¨æ„, è¿™é‡Œçš„Tagå¿…é¡»å’Œ<code>Podspec</code>æ–‡ä»¶ä¸­çš„Podç‰ˆæœ¬å·ä¸€è‡´ </em>, å› ä¸ºPodspecä¼šæ ¹æ®Tagä»è¿œç«¯æ¥æ‰¾ç›¸åº”çš„ä»£ç , å¦åˆ™ä¼šå‡ºç°ç‰ˆæœ¬å’Œä»£ç ä¸åŒ¹é…çš„ç°è±¡.</p>\n<p>å¦‚æœä¸ä½¿ç”¨Sourcetreeè¿™æ ·çš„GUIå·¥å…·, å¯ä»¥å‚è€ƒä¸‹é¢çš„Gitä»£ç :</p>\n<pre><code># åœ¨æ ¹ç›®å½•ä¸‹\ngit status\ngit add .\ngit tag -m &#39;å¤‡æ³¨&#39; ç‰ˆæœ¬å·\ngit commit -s -m &#39;å¤‡æ³¨&#39; \ngit push origin master â€”tags\n</code></pre><h3 id=\"æäº¤Podspecæ–‡ä»¶\"><a href=\"#æäº¤Podspecæ–‡ä»¶\" class=\"headerlink\" title=\"æäº¤Podspecæ–‡ä»¶\"></a>æäº¤Podspecæ–‡ä»¶</h3><p>æäº¤å®ŒPodæ–‡ä»¶å, æˆ‘ä»¬åªç”¨æŠŠ<code>Podspec</code>æ–‡ä»¶ä¹Ÿæäº¤ä¸Šå», è¿™æ ·å°±å¯ä»¥åœ¨Cocoapodsä¸­ç®€å†èµ·æ¥ç´¢å¼•, æ‰¾åˆ°è‡ªå·±çš„Podäº†. </p>\n<p>åœ¨æäº¤ä¹‹å‰æˆ‘ä»¬å¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹ä½¿ç”¨<code>pod lib lint</code>å‘½ä»¤æ¥éªŒè¯æ˜¯å¦ç¼–è¯‘é€šè¿‡. ä¹Ÿå¯ä»¥ç›´æ¥æäº¤<code>pod repo push [ä½ cloneåˆ°æœ¬åœ°çš„Spec Repoçš„ä»“åº“å] [Podåç§°].podspec      --use-libraries --allow-warnings --sources=&#39;[Podspecè¿œç«¯åœ°å€],https://github.com/CocoaPods/Specs&#39; --verbose</code></p>\n<h3 id=\"subspecçš„ä½¿ç”¨\"><a href=\"#subspecçš„ä½¿ç”¨\" class=\"headerlink\" title=\"subspecçš„ä½¿ç”¨\"></a>subspecçš„ä½¿ç”¨</h3><p>æœ‰æ—¶ä¸€ä¸ªPodå¤ªå¤§äº†, è€Œæˆ‘ä»¬åˆç”¨ä¸åˆ°å…¨éƒ¨çš„å†…å®¹, è¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨subspecæ¥è§£å†³è¿™ä¸ªé—®é¢˜. æˆ‘ä»¬å¯ä»¥åœ¨Podæ–‡ä»¶å¤¹ä¸­, ä½¿ç”¨æ–‡ä»¶å¤¹æ¥åˆ†å‰²å„ä¸ªå­Pod, ç„¶ååœ¨<code>Podspec</code>æ–‡ä»¶ä¸­è¿™æ ·è®¾ç½®:</p>\n<pre><code>  s.subspec &#39;[å­Podåç§°]&#39; do |pod1|\n      pod1.source_files = &#39;SCCQRCode/Classes/[å­æ–‡ä»¶å¤¹å]/**/*&#39;\n  end\n\n  s.subspec &#39;[å­Podåç§°]&#39; do |pod2|\n            pod2.source_files = &#39;SCCQRCode/Classes/[å­æ–‡ä»¶å¤¹å]/**/*&#39;\n  end\n</code></pre><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å„ä¸ªå­Podä¸­åˆ†åˆ«è®¾ç½®ä»–ä»¬çš„èµ„æºè·¯å¾„, å¯¹å¤–æš´éœ²çš„headerè·¯å¾„, ä»¥åŠdependency.</p>\n<p>æˆ‘ä»¬åœ¨å¤–é¢å¼•ç”¨è¯¥Podçš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨<code>pod [Pod/å­Pod]</code>çš„æ–¹å¼æ¥åªå¼•ç”¨ä¸€ä¸ªå­Pod. </p>\n<h2 id=\"cocoapodsçš„ç›¸å…³çŸ¥è¯†\"><a href=\"#cocoapodsçš„ç›¸å…³çŸ¥è¯†\" class=\"headerlink\" title=\"cocoapodsçš„ç›¸å…³çŸ¥è¯†\"></a>cocoapodsçš„ç›¸å…³çŸ¥è¯†</h2><p>è¿™é‡Œæ˜¯CocoaPodsçš„å…¶ä»–ç›¸å…³çŸ¥è¯†, åšä¸€ä¸ªå¤‡å¿˜.</p>\n<h3 id=\"Podçš„ç‰ˆæœ¬è¯´æ˜\"><a href=\"#Podçš„ç‰ˆæœ¬è¯´æ˜\" class=\"headerlink\" title=\"Podçš„ç‰ˆæœ¬è¯´æ˜\"></a>Podçš„ç‰ˆæœ¬è¯´æ˜</h3><p>CocoaPods ä½¿ç”¨<a href=\"http://semver.org/lang/zh-CN/\" target=\"_blank\" rel=\"noopener\">è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ - Semantic Versioning</a>å‘½åçº¦å®šæ¥è§£å†³å¯¹ç‰ˆæœ¬çš„ä¾èµ–. å¸¸è§çš„ç‰ˆæœ¬è¯´æ˜ç¬¦å·æœ‰ä»¥ä¸‹è¿™äº›.</p>\n<ul>\n<li>= 0.1 Version 0.1.</li>\n<li>0.1 Any version higher than 0.1.</li>\n<li><blockquote>\n<p>= 0.1 Version 0.1 and any higher version.</p>\n</blockquote>\n</li>\n<li>&lt; 0.1 Any version lower than 0.1.</li>\n<li>&lt;= 0.1 Version 0.1 and any lower version.</li>\n<li>~&gt; 0.1.2 Version 0.1.2 and the versions up to 0.2, not including 0.2. </li>\n</ul>\n<h3 id=\"å¸¸è§Podä¾èµ–çš„å‡ ç§å†™æ³•\"><a href=\"#å¸¸è§Podä¾èµ–çš„å‡ ç§å†™æ³•\" class=\"headerlink\" title=\"å¸¸è§Podä¾èµ–çš„å‡ ç§å†™æ³•\"></a>å¸¸è§Podä¾èµ–çš„å‡ ç§å†™æ³•</h3><ul>\n<li>pod â€˜AFNetworkingâ€™, :configurations =&gt; [â€˜Debugâ€™, â€˜Betaâ€™]</li>\n<li>pod â€˜QueryKit/Attributeâ€™</li>\n<li>pod â€˜QueryKitâ€™, :subspecs =&gt; [â€˜Attributeâ€™, â€˜QuerySetâ€™]</li>\n<li>pod â€˜AFNetworkingâ€™, :path =&gt; â€˜~/Documents/AFNetworkingâ€™</li>\n<li>pod â€˜AFNetworkingâ€™, :git =&gt; â€˜<a href=\"https://github.com/gowalla/AFNetworking.git\" target=\"_blank\" rel=\"noopener\">https://github.com/gowalla/AFNetworking.git</a>â€˜</li>\n<li>pod â€˜JSONKitâ€™, :podspec =&gt; â€˜<a href=\"https://example.com/JSONKit.podspec\" target=\"_blank\" rel=\"noopener\">https://example.com/JSONKit.podspec</a>â€˜</li>\n</ul>\n<hr>\n<p>å‚è€ƒæ–‡ç« :<br>1.<a href=\"https://swiftcafe.io/2015/10/25/swift-daily-carthage-package/\" target=\"_blank\" rel=\"noopener\">Carthage åŒ…ç®¡ç†å·¥å…·ï¼Œå¦ä¸€ç§æ•æ·è½»å¿«çš„ iOS &amp; MAC å¼€å‘ä½“éªŒ</a>.</p>\n<p>2.<a href=\"https://bestswifter.com/cocoapods/\" target=\"_blank\" rel=\"noopener\">ç»†èŠCocoapodsä¸Xcodeå·¥ç¨‹é…ç½®</a>.</p>\n<p>3.<a href=\"http://guides.cocoapods.org/making/using-pod-lib-create.html\" target=\"_blank\" rel=\"noopener\">Cocoapodså®˜æ–¹æ–‡æ¡£</a>.</p>\n<p>4.<a href=\"http://blog.wtlucky.com/blog/2015/02/26/create-private-podspec/\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨Cocoapodsåˆ›å»ºç§æœ‰podspec</a></p>\n<p>5.<a href=\"http://draveness.me/cocoapods.html\" target=\"_blank\" rel=\"noopener\">CocoaPods éƒ½åšäº†ä»€ä¹ˆï¼Ÿ</a></p>\n<p>6.<a href=\"http://www.jianshu.com/p/d6a592d6fced\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨ç§æœ‰Cocoapodsä»“åº“ä¸­å¼•ç”¨.aåº“</a></p>\n<p>7.<a href=\"https://objccn.io/issue-6-4/\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç†è§£CocoaPods</a></p>\n<p>8.<a href=\"https://guides.cocoapods.org/syntax/podspec.html\" target=\"_blank\" rel=\"noopener\">podspecå®˜æ–¹æ–‡æ¡£</a></p>\n<p>9.<a href=\"https://guides.cocoapods.org/syntax/Podfile.html\" target=\"_blank\" rel=\"noopener\">Podfileå®˜æ–¹æ–‡æ¡£</a></p>\n","categories":["åŸºç¡€çŸ¥è¯†","æ¨¡å—åŒ–"],"tags":["åŸºç¡€çŸ¥è¯†","æ¨¡å—åŒ–"]},{"title":"iOSçš„ç»„ä»¶åŒ–å®è·µ","url":"http://hchong.net/2017/05/23/iOSçš„æ¨¡å—åŒ–å®è·µ/","content":"<h1 id=\"iOSçš„ç»„ä»¶åŒ–å®è·µ\"><a href=\"#iOSçš„ç»„ä»¶åŒ–å®è·µ\" class=\"headerlink\" title=\"iOSçš„ç»„ä»¶åŒ–å®è·µ\"></a>iOSçš„ç»„ä»¶åŒ–å®è·µ</h1><p>éšç€å·¥ç¨‹çš„å˜å¤§, ä¸šåŠ¡çš„å¤æ‚, å¼€å‘äººå‘˜çš„å¢å¤š, å¦‚ä½•æé«˜æˆå‘˜é—´çš„å¼€å‘æ•ˆç‡å’Œæœ€å¤§ç¨‹åº¦çš„å¤ç”¨ä»£ç , æˆä¸ºäº†äºŸå¾…è§£å†³çš„é—®é¢˜. é™¤äº†æ›´åŠ æ¸…æ™°çš„ç»“æ„ç›®å½•å¤–, æ¨¡å—åŒ–, åº”è¯¥æ˜¯ä¸€ç§æ¯”è¾ƒä¼˜é›…è§£å†³æ–¹æ¡ˆ. å…³äºç»„ä»¶åŒ–æˆ‘ä»¬è¦è¾¾æˆçš„ä¸€ä¸ªç›®æ ‡å°±æ˜¯<em>é‡ç”¨é«˜åº¦æŠ½è±¡åŒ–çš„ä»£ç å•å…ƒ</em>.</p>\n<p>å‚è€ƒæ–‡ç« ç³»åˆ—åŸºæœ¬ä¸Šå¯ä»¥ä»£è¡¨ä¸šç•Œç›®å‰å¯¹ç»„ä»¶åŒ–çš„ä¸€äº›æ€è€ƒ, å»ºè®®æŒ‰ç…§é¡ºåºé˜…è¯». ä¸‹é¢æ˜¯æˆ‘ç»“åˆæˆ‘å¸é¡¹ç›®ä¸­çš„ä¸€äº›å®é™…åº”ç”¨, è°ˆä¸€ä¸‹æˆ‘å¯¹ç»„ä»¶åŒ–çš„ç†è§£.</p>\n<p>æˆ‘å¸çš„ç»„ä»¶åŒ–ä¹‹è·¯, å¤§è‡´å¯ä»¥åˆ†ä¸ºå‡ ä¸ªé˜¶æ®µ, ä¸‹é¢æˆ‘å°±é¡¹ç›®çš„å˜åŒ–å†ç¨‹æ¥åˆ†ææˆ‘å¸çš„ç»„ä»¶åŒ–ä¹‹è·¯.</p>\n<h2 id=\"å¤§æ‚çƒ©\"><a href=\"#å¤§æ‚çƒ©\" class=\"headerlink\" title=\"å¤§æ‚çƒ©\"></a>å¤§æ‚çƒ©</h2><p>æœ€å¼€å§‹, æˆ‘ä»¬çš„é¡¹ç›®æ‰€æœ‰ä»£ç éƒ½åœ¨å·¥ç¨‹é‡Œé¢, æ¯ä¸ªå…·ä½“çš„ä¸šåŠ¡ä½¿ç”¨ç‹¬ç«‹çš„æ–‡ä»¶å¤¹è¿›è¡Œåˆ†å‰², çœ‹ä¼¼ååˆ†æ•´æ´, ä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤šä¸ä¾¿ä¹‹å¤„. å„ä¸ªæ¨¡å—ä¹‹é—´è€¦åˆæ€§å¾ˆå¼º, è´£ä»»äººä¸æ˜ç¡®. è¿™ä¸ªæ—¶å€™å¯ä»¥è¯´å®Œå…¨æ²¡æœ‰ç»„ä»¶åŒ–çš„æ¦‚å¿µ, ååˆ†æ··ä¹±. </p>\n<p>ç»„ä»¶åŒ–çš„å¼•å…¥, æºäºå’Œå¦å¤–ä¸€ä¸ªé¡¹ç›®çš„ä»£ç å¤ç”¨. å½“æ—¶åœ¨åšä¸€ä¸ªè¥é”€ç›¸å…³çš„ä¸šåŠ¡, ç”±äºæ•ˆæœååˆ†å¥½, æ‰€ä»¥å†³å®šåœ¨å¦å¤–ä¸€ä¸ªé¡¹ç›®ä¸­ä¹Ÿæ¥å…¥è¿™å—ä¸šåŠ¡. ç„¶è€Œ, å¹¶æ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆç®€å•. ç”±äºè·¨é¡¹ç›®, åå°å®Œå…¨ä¸åŒ, ç‰µæ¶‰åˆ°ç½‘ç»œåº“è°ƒç”¨, å…¬å…±ç»„ä»¶çš„ä½¿ç”¨, è¦æƒ³æŠŠè¿™ä¸ªä¸šåŠ¡å•ç‹¬æ‹†åˆ†å‡ºå», å°±å¿…é¡»æŠŠè¿™ä¸ªä¸šåŠ¡ç”¨åˆ°çš„ç½‘ç»œåº“, å…¬å…±ç»„ä»¶åº“ä¹Ÿæ‹†åˆ†å‡ºå», éš¾åº¦éå¸¸ä¹‹å¤§. è¿™æ—¶å€™, å°±æƒ³åˆ°äº†ä½¿ç”¨Cocoapodsæ¥ç®¡ç†ä¸€äº›å·¥å…·ç±»å’Œå…¬å…±ç»„ä»¶, äºæ˜¯å°±æœ‰äº†ç¬¬äºŒé˜¶æ®µ.</p>\n<h2 id=\"éä¸šåŠ¡ä»£ç ç»„ä»¶åŒ–\"><a href=\"#éä¸šåŠ¡ä»£ç ç»„ä»¶åŒ–\" class=\"headerlink\" title=\"éä¸šåŠ¡ä»£ç ç»„ä»¶åŒ–\"></a>éä¸šåŠ¡ä»£ç ç»„ä»¶åŒ–</h2><p>åœ¨è¿™ä¸€é˜¶æ®µ, æˆ‘ä»¬å……åˆ†ä½¿ç”¨Cocoapodsçš„æ¨¡å—åŒ–åŠŸèƒ½, å°†ä¸€äº›é€šç”¨çš„ç±», å·¥å…·ç±», å°è£…æˆç§æœ‰çš„Pod(<a href=\"http://hchong.net/2017/05/24/Cocoapods%E5%AE%9E%E8%B7%B5/\">å‚è€ƒè¿™é‡Œ</a>). è¿™æ ·ä¸€æ¥, å°±æŠŠåŸºç¡€ä»£ç ä»é¡¹ç›®ä¸­æŠ½ç¦»å‡ºæ¥, å…¶ä»–çš„é¡¹ç›®è¦æƒ³ä½¿ç”¨, åªéœ€ä¾èµ–æˆ‘ä»¬çš„ç§æœ‰Podå°±å¯ä»¥äº†. é‚£ä¹ˆä¸Šé¢æƒ³è¦æ‹†åˆ†å…¬å…±ä¸šåŠ¡ç»„ä»¶çš„æƒ³æ³•å°±å¯ä»¥å®ç°äº†.</p>\n<p>ç„¶è€Œ, éšç€ä¸šåŠ¡çš„æ‰“é€š. ä¸åŒçš„é¡¹ç›®ä¹‹é—´éœ€è¦è°ƒç”¨çš„å…±åŒç»„ä»¶è¶Šæ¥è¶Šå¤š, ç»„ä»¶ä¸ç»„ä»¶ä¹‹é—´å¦‚ä½•è¿›è¡Œäº¤äº’, ç»„ä»¶ä¸é¡¹ç›®ä¹‹é—´åˆå¦‚ä½•è¿›è¡Œäº¤äº’, è¿™äº›é—®é¢˜åˆå‡ºæ¥äº†. äºæ˜¯, åˆæœ‰äº†ç°åœ¨çš„å®Œå…¨ç»„ä»¶åŒ–æ–¹æ¡ˆ.</p>\n<h2 id=\"å®Œå…¨ç»„ä»¶åŒ–\"><a href=\"#å®Œå…¨ç»„ä»¶åŒ–\" class=\"headerlink\" title=\"å®Œå…¨ç»„ä»¶åŒ–\"></a>å®Œå…¨ç»„ä»¶åŒ–</h2><p>ç§°ä¹‹ä¸ºå®Œå…¨ç»„ä»¶åŒ–æ–¹æ¡ˆ, æ˜¯å› ä¸ºæˆ‘å¸ç›®å‰é‡‡ç”¨çš„å°±æ˜¯è¿™æ ·çš„è§£å†³æ–¹æ¡ˆ, å¹¶ä¸”æš‚æ—¶ä¹Ÿæ‰¾ä¸åˆ°æ›´åŠ å¥½çš„è§£å†³æ–¹æ¡ˆ. å®Œå…¨ç»„ä»¶åŒ–æ–¹æ¡ˆ, å®é™…è¿˜æ˜¯åœ¨<em>éä¸šåŠ¡ä»£ç ç»„ä»¶åŒ–</em>çš„åŸºç¡€ä¸Š, é€šè¿‡å¼•å…¥<a href=\"http://hchong.net/2017/05/23/iOS%E7%9A%84%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E5%AE%9E%E8%B7%B5/\">è·¯ç”±åè®®</a>æ¥å®ç°çš„.</p>\n<p>é€šè¿‡è·¯ç”±åè®®, ç›¸å½“äºæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¸­é—´å±‚æ¥è½¬å‘æˆ‘ä»¬ç»„ä»¶ä¸ç»„ä»¶ä¹‹é—´çš„é€šä¿¡, è¿™æ ·å°±å®ç°äº†ç»„ä»¶ä¹‹é—´çš„è§£è€¦, è€Œç»„ä»¶å†…éƒ¨åˆæ˜¯å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘, å±äºé«˜å†…èš, ä½è€¦åˆ.</p>\n<p>è‡³æ­¤, å°±å®Œæˆäº†æˆ‘ä»¬çš„ç»„ä»¶åŒ–ä¹‹è·¯, è§£é™¤ç»„ä»¶ä¹‹é—´ç›¸äº’å¼•ç”¨çš„ä»£ç ç¡¬ä¾èµ–, è§„èŒƒäº†ç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ¥å£, å„ä¸ªç»„ä»¶æœ¬èº«å°±ç›¸å½“äºä¸€ä¸ªé»‘ç›’, å¯ä»¥ç‹¬ç«‹å¼€å‘.</p>\n<h2 id=\"å…¶ä»–ç»„ä»¶åŒ–æ–¹æ¡ˆ\"><a href=\"#å…¶ä»–ç»„ä»¶åŒ–æ–¹æ¡ˆ\" class=\"headerlink\" title=\"å…¶ä»–ç»„ä»¶åŒ–æ–¹æ¡ˆ\"></a>å…¶ä»–ç»„ä»¶åŒ–æ–¹æ¡ˆ</h2><p>å¯ä»¥å°†éœ€è¦å°è£…çš„ä»£ç æ‰“åŒ…æˆé™æ€åº“, é™æ€åº“ä¸­æŠŠéœ€è¦æš´éœ²å‡ºæ¥çš„å¤´æ–‡ä»¶é€‰æ‹©æ€§çš„æš´éœ²å‡ºæ¥, ä¸è¿‡è¿™æ ·å„ä¸ªæ¨¡å—ä¹‹é—´çš„è€¦åˆæ€§è¿˜æ˜¯æ¯”è¾ƒé«˜çš„.</p>\n<hr>\n<p>å‚è€ƒæ–‡ç« :<br>1.<a href=\"http://limboy.me/tech/2016/03/10/mgj-components.html\" target=\"_blank\" rel=\"noopener\">è˜‘è‡è¡—Appçš„ç»„ä»¶åŒ–ä¹‹è·¯</a>.</p>\n<p>2.<a href=\"https://casatwy.com/iOS-Modulization.html\" target=\"_blank\" rel=\"noopener\">iOSåº”ç”¨æ¶æ„è°ˆ ç»„ä»¶åŒ–æ–¹æ¡ˆ</a>.</p>\n<p>3.<a href=\"http://limboy.me/tech/2016/03/14/mgj-components-continued.html\" target=\"_blank\" rel=\"noopener\">è˜‘è‡è¡—Appçš„ç»„ä»¶åŒ–ä¹‹è·¯.ç»­</a>.</p>\n<p>4.<a href=\"http://blog.cnbang.net/tech/3080/\" target=\"_blank\" rel=\"noopener\">iOSç»„ä»¶åŒ–æ–¹æ¡ˆæ¢è®¨</a>.</p>\n","categories":["æ¨¡å—åŒ–"],"tags":["æ¨¡å—åŒ–","cocoapods"]},{"title":"iOSçš„è·¯ç”±åè®®å®è·µ","url":"http://hchong.net/2017/05/23/iOSçš„è·¯ç”±åè®®å®è·µ/","content":"<h1 id=\"iOSçš„è·¯ç”±åè®®å®è·µ\"><a href=\"#iOSçš„è·¯ç”±åè®®å®è·µ\" class=\"headerlink\" title=\"iOSçš„è·¯ç”±åè®®å®è·µ\"></a>iOSçš„è·¯ç”±åè®®å®è·µ</h1><p>è·¯ç”±åè®®, æ˜¯ç»„ä»¶åŒ–çš„æ ¸å¿ƒæ‰€åœ¨. ç»„ä»¶åŒ–, å®é™…å°±ä¼šæŠŠä»£ç æ‹†åˆ†ä¸ºä¸€ä¸ªä¸€ä¸ªçš„æ¨¡å—, æ— è®ºé‡‡ç”¨Podçš„æ–¹å¼,  æ–‡ä»¶å¤¹åˆ†å‰²çš„æ–¹å¼, è¿˜æ˜¯é™æ€åº“çš„æ–¹å¼, å®è´¨éƒ½æ˜¯æŠŠä»£ç åˆ†ä¸ºä¸€ä¸ªä¸ªçš„æ¨¡å—. å¦‚ä½•åœ¨æ¨¡å—ä¹‹é—´å’Œåº”ç”¨ä¹‹é—´é€šä¿¡, å°±æ˜¯è·¯ç”±åè®®éœ€è¦è€ƒè™‘çš„é—®é¢˜.</p>\n<p>å…³äºè·¯ç”±åè®®, å†°éœœçš„<a href=\"https://halfrost.com/ios_router/\" target=\"_blank\" rel=\"noopener\">è¿™ç¯‡åšå®¢</a>å†™çš„å®åœ¨æ˜¯å¤ªè¯¦ç»†äº†, çœ‹å¾—æ˜¯ç”·é»˜å¥³æ³ª, ç®€ç›´æ˜¯ä¸šç•Œè‰¯å¿ƒ. ç®€å•è¯´æ¥, è·¯ç”±åè®®è·³è½¬ä¸»è¦è§£å†³è¿™å‡ ç±»é—®é¢˜:</p>\n<ol>\n<li>å¤–éƒ¨è·³è½¬åˆ°Appå†…éƒ¨ä¸€ä¸ªå¾ˆæ·±å±‚æ¬¡çš„ä¸€ä¸ªç•Œé¢.</li>\n<li>Appä¹‹é—´çš„ç›¸äº’è·³è½¬.</li>\n<li>è§£é™¤Appç»„ä»¶ä¹‹é—´å’ŒAppé¡µé¢ä¹‹é—´çš„è€¦åˆæ€§.</li>\n<li>ç»Ÿä¸€iOSå’ŒAndroidä¸¤ç«¯çš„é¡µé¢è·³è½¬é€»è¾‘, ç»Ÿä¸€ä¸‰ç«¯çš„è¯·æ±‚èµ„æºçš„æ–¹å¼.</li>\n<li>iOSå’ŒAndroidä¸¤è¾¹åªè¦å…±ç”¨ä¸€å¥—åŠ¨æ€ä¸‹å‘é…ç½®æ–‡ä»¶æ¥é…ç½®Appçš„è·³è½¬é€»è¾‘.</li>\n<li>åœ¨Appä»»ä½•ç•Œé¢éƒ½å¯ä»¥è°ƒç”¨ä»»æ„ä¸€ä¸ªç•Œé¢æˆ–è€…ä»»æ„ä¸€ä¸ªç»„ä»¶.</li>\n</ol>\n<h2 id=\"åº”ç”¨é—´è·¯ç”±è·³è½¬\"><a href=\"#åº”ç”¨é—´è·¯ç”±è·³è½¬\" class=\"headerlink\" title=\"åº”ç”¨é—´è·¯ç”±è·³è½¬\"></a>åº”ç”¨é—´è·¯ç”±è·³è½¬</h2><p>åº”ç”¨é—´è·¯ç”±è·³è½¬ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å¸¸è§çš„ä½¿ç”¨åœºæ™¯: </p>\n<ol>\n<li>ä½¿ç”¨ç¬¬ä¸‰æ–¹ç”¨æˆ·ç™»å½•ï¼Œè·³è½¬åˆ°éœ€æˆæƒçš„Appæˆ–è·³è½¬åˆ°åˆ†äº«appçš„å¯¹åº”é¡µé¢.</li>\n<li>åº”ç”¨ç¨‹åºæ¨å¹¿, è·³è½¬åˆ°å¦ä¸€ä¸ªåº”ç”¨ç¨‹åº(æœ¬æœºå·²ç»å®‰è£…).</li>\n<li>è·³è½¬åˆ°iTuneså¹¶æ˜¾ç¤ºåº”ç”¨ç¨‹åºä¸‹è½½é¡µé¢(æœ¬æœºæ²¡æœ‰å®‰è£…).</li>\n<li>ç¬¬ä¸‰æ–¹æ”¯ä»˜, è·³è½¬åˆ°ç¬¬ä¸‰æ–¹æ”¯ä»˜App, å¦‚æ”¯ä»˜å®æ”¯ä»˜, å¾®ä¿¡æ”¯ä»˜.</li>\n<li>ä½¿ç”¨ç³»ç»Ÿå†…ç½®ç¨‹åº, å¦‚è·³è½¬åˆ°æ‰“ç”µè¯, å‘çŸ­ä¿¡, å‘é‚®ä»¶, Safariç­‰.</li>\n</ol>\n<p>åº”ç”¨é—´çš„è·³è½¬ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼: URL Schemeå’ŒUniversal Links. è¿™ä¸¤ç§å®ç°æ–¹å¼å¹¶ä¸å†²çª, å¯ä»¥å…±å­˜.</p>\n<h3 id=\"URL-Schemeæ–¹å¼è·³è½¬\"><a href=\"#URL-Schemeæ–¹å¼è·³è½¬\" class=\"headerlink\" title=\"URL Schemeæ–¹å¼è·³è½¬\"></a>URL Schemeæ–¹å¼è·³è½¬</h3><p>ä»¥A-&gt;Bä¸ºä¾‹, æ¥è¯´æ˜ä¸‹å¦‚ä½•è·³è½¬.<br>é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ†åˆ«åœ¨ä¸¤ä¸ªAppçš„info.plisté‡Œé¢æ·»åŠ å¯¹åº”çš„URL types - URL Schemes, å¦‚å›¾æ‰€ç¤º:</p>\n<p><img src=\"http://img.souche.com/f2e/2b762dfb368b3b50621cd5c39b51a86e.png\" alt=\"æ·»åŠ URL types\"></p>\n<p>Açš„URL Schemesæ˜¯APPA, Bçš„URL Schemesæ˜¯APPB. ç”±äºiOS9å¼•å…¥äº†ç™½åå•çš„æ¦‚å¿µ,<br>å¦‚æœä½¿ç”¨ canOpenURL:æ–¹æ³•, è¯¥æ–¹æ³•æ‰€æ¶‰åŠåˆ°çš„ URL Schemes å¿…é¡»åœ¨â€Info.plistâ€ä¸­å°†å®ƒä»¬åˆ—ä¸ºç™½åå•, å¦åˆ™<code>canOpenURL</code>è¿”å›<code>NO</code>, ä¸èƒ½æ­£å¸¸è·³è½¬. æ‰€ä»¥è¦åœ¨Aä¸­æ·»åŠ Bçš„URL Schemes, Bä¸­æ·»åŠ Açš„Schemes. keyå«åš<code>LSApplicationQueriesSchemes</code>, é”®å€¼å†…å®¹æ˜¯ä¸Šä¸€æ­¥å¯¹åº”åº”ç”¨ç¨‹åºçš„URL Schemes. </p>\n<pre><code>\n- jumpToAppB:(id)sender {\n   // 1.è·å–åº”ç”¨ç¨‹åºApp-Bçš„URL Scheme\n   NSURL *appBUrl = [NSURL URLWithString:@&quot;zacharyB1://&quot;];\n   // 2.åˆ¤æ–­æ‰‹æœºä¸­æ˜¯å¦å®‰è£…äº†å¯¹åº”ç¨‹åº\n   if ([[UIApplication sharedApplication] canOpenURL:appBUrl]) {\n       // 3. æ‰“å¼€åº”ç”¨ç¨‹åºApp-B\n       //[[UIApplication sharedApplication] openURL:appBUrl];//iOS 9ä¹‹åè¢«åºŸå¼ƒ\n       [[UIApplication sharedApplication] openURL:appBUrl options:@{UIApplicationOpenURLOptionUniversalLinksOnly : @YES} completionHandler:^(BOOL success) {\n\n        }];\n   } else {\n       NSLog(@&quot;æ²¡æœ‰å®‰è£…&quot;);\n   }\n}\n</code></pre><p>optionsç›®å‰å¯ä¼ å…¥å‚æ•°Keyåœ¨UIApplicationå¤´æ–‡ä»¶åªæœ‰ä¸€ä¸ª:UIApplicationOpenURLOptionUniversalLinksOnly, å…¶å¯¹åº”çš„Valueä¸ºå¸ƒå°”å€¼, é»˜è®¤ä¸ºFalse. å¦‚è¯¥Keyå¯¹åº”çš„Valueä¸ºTrue, é‚£ä¹ˆæ‰“å¼€æ‰€ä¼ å…¥çš„Universal Linkæ—¶, åªå…è®¸é€šè¿‡è¿™ä¸ªLinkæ‰€ä»£è¡¨çš„iOSåº”ç”¨è·³è½¬çš„æ–¹å¼æ‰“å¼€è¿™ä¸ªé“¾æ¥, å¦åˆ™å°±ä¼šè¿”å›successä¸ºfalse, ä¹Ÿå°±æ˜¯è¯´åªæœ‰å®‰è£…äº†Linkæ‰€å¯¹åº”çš„Appçš„æƒ…å†µä¸‹æ‰èƒ½æ‰“å¼€è¿™ä¸ªUniversal Link, è€Œä¸æ˜¯é€šè¿‡å¯åŠ¨Safariæ–¹å¼æ‰“å¼€è¿™ä¸ªLinkçš„ä»£è¡¨çš„ç½‘ç«™. </p>\n<p>è‡³æ­¤, å°±å¯ä»¥æ­£å¸¸è·³è½¬äº†, å¦‚æœæˆ‘ä»¬ä¸å¸Œæœ›æŸä¸ªAPPé€šè¿‡URL Schemeçš„æ–¹å¼æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨, æˆ‘ä»¬å¯ä»¥åœ¨<code>- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation</code>æ–¹æ³•ä¸­åˆ¤æ–­æŒ‡å®šçš„Schemeç„¶åè¿”å›<code>NO</code>, å¦‚ä¸‹æ‰€ç¤º, åªæœ‰<code>com.tencent.weixin</code>çš„Schemeæ‰èƒ½æ‰“å¼€æˆ‘ä»¬çš„APP. </p>\n<pre><code>- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {\n    NSLog(@&quot;sourceApplication: %@&quot;, sourceApplication);\n    NSLog(@&quot;URL scheme:%@&quot;, [url scheme]);\n    NSLog(@&quot;URL query: %@&quot;, [url query]);\n\n    if ([sourceApplication isEqualToString:@&quot;com.tencent.weixin&quot;]){\n        // å…è®¸æ‰“å¼€\n        return YES;\n    }else{\n        return NO;\n    }\n}\n</code></pre><h3 id=\"Universal-Linksæ–¹å¼è·³è½¬\"><a href=\"#Universal-Linksæ–¹å¼è·³è½¬\" class=\"headerlink\" title=\"Universal Linksæ–¹å¼è·³è½¬\"></a>Universal Linksæ–¹å¼è·³è½¬</h3><p>ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½å¯ä»¥ä½¿æˆ‘ä»¬çš„Appé€šè¿‡HTTPé“¾æ¥æ¥å¯åŠ¨App, é€šç”¨é“¾æ¥å°±æ˜¯HTTPåè®®çš„æ™®é€šURL, é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šé…ç½®ä¸€äº›æ–‡ä»¶, é…åˆåº”ç”¨. å®ç°å®¢æˆ·ç‚¹å‡»ç½‘é¡µé“¾æ¥ä¹‹åç›´æ¥æ‰“å¼€åº”ç”¨. å®¢æˆ·åœ¨å¾®ä¿¡\\QQä¸­ç‚¹å‡»é“¾æ¥æ—¶ä¸å†éœ€è¦ç‚¹å‡»å³ä¸Šâ€™åœ¨Safariæµè§ˆå™¨æ‰“å¼€â€™æ‰èƒ½æ‰“å¼€è½¯ä»¶, å®ç°å®¢æˆ·æ“ä½œçš„æ— ç¼è·³è½¬, è®©å®¢æˆ·ä½“éªŒæ›´åŠ è¿è´¯, æ›´é¡ºç•…. </p>\n<ol>\n<li><p>å¦‚æœå®‰è£…è¿‡App, ä¸ç®¡åœ¨å¾®ä¿¡é‡Œé¢httpé“¾æ¥è¿˜æ˜¯åœ¨Safariæµè§ˆå™¨, è¿˜æ˜¯å…¶ä»–ç¬¬ä¸‰æ–¹æµè§ˆå™¨, éƒ½å¯ä»¥æ‰“å¼€App. </p>\n</li>\n<li><p>å¦‚æœæ²¡æœ‰å®‰è£…è¿‡App, å°±ä¼šæ‰“å¼€ç½‘é¡µ. </p>\n</li>\n</ol>\n<p>å…·ä½“è®¾ç½®éœ€è¦3æ­¥: </p>\n<ol>\n<li><p>Appéœ€è¦å¼€å¯Associated DomainsæœåŠ¡, å¹¶è®¾ç½®Domains, æ³¨æ„å¿…é¡»è¦applinksï¼šå¼€å¤´. è¿™é‡Œéœ€è¦åœ¨APPä½¿ç”¨çš„è¯ä¹¦ä¸­è®¾ç½®è¿™ä¸ªé€‰é¡¹, å¦åˆ™åœ¨APPè®¾ç½®ä¸­çœ‹ä¸åˆ°Associated DomainsæœåŠ¡. </p>\n</li>\n<li><p>åŸŸåå¿…é¡»è¦æ”¯æŒHTTPS. </p>\n</li>\n<li><p>ä¸Šä¼ å†…å®¹æ˜¯Jsonæ ¼å¼çš„æ–‡ä»¶, æ–‡ä»¶åä¸ºapple-app-site-associationåˆ°è‡ªå·±åŸŸåçš„æ ¹ç›®å½•ä¸‹, æˆ–è€….well-knownç›®å½•ä¸‹. iOSè‡ªåŠ¨ä¼šå»è¯»å–è¿™ä¸ªæ–‡ä»¶. å…·ä½“çš„æ–‡ä»¶å†…å®¹è¯·æŸ¥çœ‹<a href=\"https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a>. </p>\n</li>\n</ol>\n<p><a href=\"http://www.jianshu.com/p/c83164c2aec2\" target=\"_blank\" rel=\"noopener\">å‚è€ƒæ–‡ç« ä¸€</a></p>\n<p><a href=\"http://www.jianshu.com/p/1970fd59de12\" target=\"_blank\" rel=\"noopener\">å‚è€ƒæ–‡ç« äºŒ</a></p>\n<h2 id=\"åº”ç”¨å†…è·¯ç”±åè®®è®¾è®¡æ€è·¯\"><a href=\"#åº”ç”¨å†…è·¯ç”±åè®®è®¾è®¡æ€è·¯\" class=\"headerlink\" title=\"åº”ç”¨å†…è·¯ç”±åè®®è®¾è®¡æ€è·¯\"></a>åº”ç”¨å†…è·¯ç”±åè®®è®¾è®¡æ€è·¯</h2><p><em>é¡µé¢é—´è·³è½¬</em> å’Œ <em>ç»„ä»¶é—´è°ƒç”¨</em>, æ˜¯åº”ç”¨å†…è·¯ç”±åè®®è¦è§£å†³çš„ä¸¤å¤§é—®é¢˜, ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹:</p>\n<ul>\n<li><em>é¡µé¢è·³è½¬</em>, å¦‚æœä»¥ä¼ ç»Ÿçš„Pushæ¥è¯´, æˆ‘ä»¬æ€ä¹ˆæ‰èƒ½ä»ä»»ä¸€ç•Œé¢pushåˆ°å¦å¤–ä»»ä¸€ç•Œé¢, å„ä¸ªç•Œé¢ä¹‹é—´çš„è·³è½¬å¿…ç„¶è¦ç›¸äº’<code>Import</code>, è¿™äº›æ€ä¹ˆè§£å†³.</li>\n<li><em>ç»„ä»¶è§è°ƒç”¨</em>, éšç€ä¸šåŠ¡çš„æ¨¡å—åŒ–æ‹†åˆ†, å„ä¸ªæ¨¡å—ä¹‹é—´æœ‰ä¸šåŠ¡è°ƒç”¨æ€ä¹ˆåŠ, æœ¬èº«ç‹¬ç«‹çš„æ¨¡å—, ä¸ºäº†ç›¸äº’è°ƒç”¨å¿…ç„¶åˆå¢åŠ æ¥å£ä¾›å¤–éƒ¨è°ƒç”¨, æœ¬èº«ç›¸å¯¹ç‹¬ç«‹çš„ä¸šåŠ¡æ¨¡å—, ç¬é—´åˆå˜å¾—ç›¸äº’è€¦åˆäº†.</li>\n</ul>\n<p>è€Œè·¯ç”±åè®®æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€ç±»é—®é¢˜, ç°åœ¨æ¯”è¾ƒæµè¡Œçš„è·¯ç”±åè®®æœ‰å¦‚ä¸‹å‡ ç§:</p>\n<ul>\n<li><a href=\"https://github.com/joeldev/JLRoutes\" target=\"_blank\" rel=\"noopener\">JLRouts</a></li>\n<li><a href=\"https://github.com/clayallsopp/routable-ios\" target=\"_blank\" rel=\"noopener\">Routable</a></li>\n<li><a href=\"https://github.com/lightory/HHRouter\" target=\"_blank\" rel=\"noopener\">HHRouter</a></li>\n<li><a href=\"https://github.com/meili/MGJRouter\" target=\"_blank\" rel=\"noopener\">MGJRouter</a></li>\n<li><a href=\"https://github.com/casatwy/CTMediator\" target=\"_blank\" rel=\"noopener\">CTMediator</a></li>\n</ul>\n<p><img src=\"https://ob6mci30g.qnssl.com/Blog/ArticleImage/40_15.png\" alt=\"URLèµ„æº\"></p>\n<p>é€šè¿‡ä¸Šé¢åº”ç”¨é—´çš„è·³è½¬, æˆ‘ä»¬å¯ä»¥å‘ç°iOS ç³»ç»Ÿé‡Œé¢ä½¿ç”¨çš„æ˜¯URL Schemeæ–¹å¼. å¯¹äºä¸€ä¸ªèµ„æºçš„è®¿é—®ï¼Œè‹¹æœä¹Ÿæ˜¯ç”¨URLçš„æ–¹å¼æ¥è®¿é—®çš„, é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æƒ³åŠæ³•é€šè¿‡URLæ¥ç»Ÿä¸€ä¸‰ç«¯çš„è·³è½¬. ä¸€æ®µæ ‡å‡†çš„URLçš„æ ¼å¼, æ¯ä¸€éƒ¨åˆ†éƒ½ä»£è¡¨ä¸åŒçš„å«ä¹‰. æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è§„åˆ™æ¥è§£ææ¥å—åˆ°çš„URL, ä»è€Œè·å¾—æœ‰ç”¨çš„ä¿¡æ¯. ä¸‹é¢è¯´ä¸€ä¸‹æˆ‘çš„è§£å†³æ–¹æ¡ˆ. </p>\n<p>å¤§è‡´çš„è§£å†³æ€è·¯å¦‚ä¸‹:</p>\n<ol>\n<li><p>åœ¨APPå¼€å§‹åŠ è½½æ—¶è®¾ç½®Moduleçš„<code>Scheme</code>, å¹¶ä¸”åˆå§‹åŒ–Moduleçš„æ ¸å¿ƒç±»<code>HCModuleCore</code>.</p>\n<p> <code>Scheme</code>æ˜¯ç”¨æ¥æ ‡è®°å½“å‰APP, æ¯ä¸ªAPPçš„<code>Scheme</code>ä¸å°½ç›¸åŒ, ä»–å’Œåº”ç”¨é—´è·³è½¬æ—¶è®¾ç½®çš„<code>Scheme</code>æ˜¯ä¸€ä¸ªä¸œè¥¿. <code>HCModuleCore</code>æ˜¯ä¸ªå•ä¾‹, å®ƒå­˜åœ¨äºæ•´ä¸ªAPPçš„ç”Ÿå‘½å‘¨æœŸä¸­. </p>\n</li>\n<li><p>æœ‰ä¸€ä¸ª<code>HCModuleProtocol</code>åè®®, é‡Œé¢æœ‰å‡ ä¸ªå¿…é¡»è¦å®ç°çš„æ–¹æ³•.</p>\n<p> å¦‚æœæŸä¸ªç±»æƒ³è¦é€šè¿‡åè®®è¢«è·³è½¬å°±å¿…é¡»å®ç°è¯¥åè®®, å¹¶ä¸”å®ç°åè®®ä¸­çš„<code>@required</code>æ–¹æ³•. <code>@optional</code>æ–¹æ³•æ ¹æ®å®é™…éœ€è¦é€‰æ‹©å®ç°.</p>\n<pre><code> HCModuleProtocol.h\n\n @required\n /**\n è¯¥æ–¹æ³•è¿”å›å½“å‰ç±»çš„æ ‡ç­¾, è¯¥æ ‡ç­¾æ˜¯å½“å‰ç±»çš„å”¯ä¸€æ ‡è¯†, ä¸å¯é‡å¤\n @return å­—ç¬¦ä¸²ç±»å‹\n */\n + (NSString *)moduleName;\n\n @optional\n /**\n å¦‚æœæ˜¯é€šè¿‡pushæ–¹å¼æ‰“å¼€, å°±å®ç°è¯¥æ–¹æ³•, è¿”å›å½“å‰ç±»çš„self\n\n @param params ä¼ å…¥çš„å‚æ•°\n @param callback ä¼ å…¥çš„blockå›è°ƒ\n @return å®ç°è·³è½¬åè®®ç±»çš„self\n */\n - (id)open:(NSDictionary *)params callback:(void(^)(NSDictionary *))callback;\n\n /**\nå¦‚æœæ˜¯é€šè¿‡presentæ–¹å¼æ‰“å¼€, å°±å®ç°è¯¥æ–¹æ³•, è¿”å›å½“å‰ç±»çš„self\n\n @param params ä¼ å…¥çš„å‚æ•°\n @param callback ä¼ å…¥çš„blockå›è°ƒ\n @return å®ç°è·³è½¬åè®®ç±»çš„self\n */\n - (id)open_present:(NSDictionary *)params callback:(void(^)(NSDictionary *))callback;\n</code></pre></li>\n<li><p><code>HCModuleCore</code>æ˜¯ä¸ªå•ä¾‹, åœ¨åˆå§‹åŒ–çš„æ—¶å€™, é€šè¿‡runtimeæä¾›çš„æ–¹æ³•æŠŠéµå®ˆ``çš„ç±»åç¼“å­˜èµ·æ¥, ç¼“å­˜ä¿¡æ¯å­˜å‚¨åœ¨å•ä¾‹ä¸­, å­˜åœ¨äºæ•´ä¸ªAPPçš„ç”Ÿå‘½å‘¨æœŸä¸­.</p>\n<pre><code> HCModuleCore.m\n\n + (instancetype)moduleCore {\n     static HCModuleCore *moduleCore;\n     static dispatch_once_t onceToken;\n     dispatch_once(&amp;onceToken, ^{\n         moduleCore = [[HCModuleCore alloc] init];\n     });\n     return moduleCore;\n }\n\n - (instancetype)init {\n     self = [super init];\n     if (self) {\n         [self cacheModuleProrocolClasses];\n     }\n     return self;\n }\n\n /**\n æŠŠéµå®ˆHCModuleProtocolçš„ç±»ç¼“å­˜èµ·æ¥\n */\n - (void)cacheModuleProrocolClasses {\n     if (_cache.count != 0) {\n         return;\n     }\n     NSMutableDictionary *tmpCache = [NSMutableDictionary dictionary];\n     Class *classes;\n     unsigned int outCount;\n     classes = objc_copyClassList(&amp;outCount);//è·å–å…¨éƒ¨ç±»\n     for (int i = 0; i &lt; outCount; i++) {\n         Class class = classes[i];\n\n         //å®ç°äº†HCModuleProtocolçš„ç±»\n         if (class_conformsToProtocol(class, @protocol(HCModuleProtocol))) {\n             NSString *moduleName = [class moduleName];\n             //é‡å¤æ£€æŸ¥\n             NSCAssert([tmpCache objectForKey:moduleName] == nil, @&quot;in class %@, module %@ has defined, please check!&quot;, NSStringFromClass(class), moduleName);\n             [tmpCache setObject:NSStringFromClass(class) forKey:moduleName];\n         }\n     }\n     free(classes);\n     self.cache = [tmpCache copy];\n}\n</code></pre></li>\n<li><p>ä¸»è¦æ˜¯é€šè¿‡ä¼ å…¥çš„moduleNameæˆ–è€…URlæ¥è·å–åˆ°è¢«æ‰“å¼€é¡µé¢çš„å”¯ä¸€æ ‡è¯†, å†é€šè¿‡å”¯ä¸€æ ‡è¯†ä»å•ä¾‹ä¸­ç¼“å­˜çš„éµå®ˆè·³è½¬åè®®çš„ç±»ä¸­å»æ‰¾. å¦‚æœæ‰¾åˆ°çš„è¯, <code>performSelector:withObject:withObject:</code>æ–¹æ³•çš„è¿”å›å€¼æ˜¯å“åº”çš„æ–¹æ³•çš„è¿”å›å€¼, é€šè¿‡è¯¥å‡½æ•°è·å–åˆ°è¢«è·³è½¬çš„ç±»çš„å®ä¾‹. </p>\n<pre><code> HCModuleCore.m\n\n //æ ¹æ®moduleNameè¿”å›å¯¹åº”æ³¨å†Œçš„ç±»\n - (id)moduleName:(NSString *)moduleName openWithParams:(NSDictionary *)params callback:(void(^)(NSDictionary *moduleInfo))callback {\n     NSCAssert(moduleName != nil, @&quot;moduleName can not be nil!&quot;);\n     id module = [self moduleName:moduleName performSelectorName:@&quot;open:callback:&quot; withParams:params callback:callback];\n     if (module == nil) {\n         module = [self moduleName:moduleName performSelectorName:@&quot;open_present:callback:&quot; withParams:params callback:callback];\n     }\n     return module;\n }\n\n //è·å–ç¼“å­˜èµ·æ¥çš„å“åº”ç›¸åº”åè®®æ–¹æ³•çš„ç±»\n - (id)moduleName:(NSString *)moduleName performSelectorName:(NSString *)selectorName withParams:(NSDictionary *)params callback:(void(^)(NSDictionary *moduleInfo))callback {\n     NSCAssert(moduleName != nil &amp;&amp; selectorName != nil, @&quot;moduleName and selectorName can not be nil!&quot;);\n     id module;\n     NSString *clsName = self.cache[moduleName];\n     if (clsName.length) {\n         Class class = NSClassFromString(clsName);//æ ¹æ®ç¼“å­˜çš„ç±»åå­—åˆ›å»ºç±»\n         SEL selec = NSSelectorFromString(selectorName);\n         if (class) {\n             id target = [[class alloc] init];//åˆå§‹åŒ–ä¸€ä¸ªç±»çš„å¯¹è±¡\n             if ([target respondsToSelector:selec]) {\n#pragma clang diagnostic push\n#pragma clang diagnostic ignored &quot;-Warc-performSelector-leaks&quot;\n                 //performSelector:withObject:withObject:çš„è¿”å›å€¼æ˜¯å“åº”çš„æ–¹æ³•çš„è¿”å›å€¼\n                 module = [target performSelector:selec withObject:params withObject:callback];\n#pragma clang diagnostic pop\n             }\n         }\n     }\n     return module;\n }\n</code></pre></li>\n<li><p>ç„¶åæœ‰ä¸¤ä¸ªcategory, åˆ†åˆ«æ˜¯<code>UINavigationController+HCModuleCore</code>å’Œ<code>UIViewController+HCModuleCore</code>. åˆ†åˆ«å¯¹åº”pushå’Œpresentçš„æƒ…å†µ. å› ä¸ºä¸Šé¢å·²ç»æ‹¿åˆ°äº†è¦è·³è½¬åˆ°çš„é¡µé¢çš„å®ä¾‹, è¿™é‡Œå°±å¯ä»¥é€šè¿‡pushæˆ–è€…presentçš„æ–¹æ³•è·³è½¬è¿‡å».   </p>\n</li>\n</ol>\n<hr>\n<p>å‚è€ƒæ–‡ç« :<br>1.<a href=\"https://halfrost.com/ios_router/\" target=\"_blank\" rel=\"noopener\">iOS ç»„ä»¶åŒ– â€”â€” è·¯ç”±è®¾è®¡æ€è·¯åˆ†æ</a></p>\n<p>2.<a href=\"http://awhisper.github.io/2016/06/12/%E8%B7%AF%E7%94%B1%E8%B7%B3%E8%BD%AC%E7%9A%84%E6%80%9D%E8%80%83/\" target=\"_blank\" rel=\"noopener\">è·¯ç”±è·³è½¬çš„æ€è€ƒ</a></p>\n<p>3.<a href=\"http://wereadteam.github.io/2016/03/19/iOS-Component/\" target=\"_blank\" rel=\"noopener\">iOSç»„ä»¶åŒ–æ–¹æ¡ˆæ¢è®¨</a></p>\n<p>4.<a href=\"https://casatwy.com/iOS-Modulization.html\" target=\"_blank\" rel=\"noopener\">iOSåº”ç”¨æ¶æ„è°ˆ-ç»„ä»¶åŒ–æ–¹æ¡ˆ</a></p>\n<p>5.<a href=\"http://www.jianshu.com/p/bb3f42fdbc31\" target=\"_blank\" rel=\"noopener\">iOS10è·³è½¬ç³»ç»Ÿè®¾ç½®çš„æ­£ç¡®å§¿åŠ¿</a></p>\n<p>6.<a href=\"http://www.jianshu.com/p/32ca4bcda3d1\" target=\"_blank\" rel=\"noopener\">å…³äº iOS ç³»ç»ŸåŠŸèƒ½çš„ URL æ±‡æ€»åˆ—è¡¨</a></p>\n<p>7.<a href=\"http://www.jianshu.com/p/b5e8ef8c76a3\" target=\"_blank\" rel=\"noopener\">iOSåº”ç”¨é—´ç›¸äº’è·³è½¬</a></p>\n<p>8.<a href=\"http://www.jianshu.com/p/c83164c2aec2\" target=\"_blank\" rel=\"noopener\">ä»å¾®ä¿¡ç›´æ¥è·³è½¬åˆ°æˆ‘ä»¬çš„APP</a></p>\n<p>9.<a href=\"http://www.jianshu.com/p/1970fd59de12\" target=\"_blank\" rel=\"noopener\">iOS Universal Links(é€šç”¨é“¾æ¥)çš„ä½¿ç”¨</a></p>\n","categories":["æ¨¡å—åŒ–"],"tags":["æ¨¡å—åŒ–","è·¯ç”±"]},{"title":"Xcodeè‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬","url":"http://hchong.net/2017/05/17/Xcodeè‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬/","content":"<h1 id=\"Xcodeè‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬\"><a href=\"#Xcodeè‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬\" class=\"headerlink\" title=\"Xcodeè‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬\"></a>Xcodeè‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬</h1><p>è‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬æ˜¯é…åˆ<a href=\"http://hchong.net/2017/03/12/%E5%A4%9ATarget%E5%AE%9E%E7%8E%B0/\">å¤šæ¸ é“åŒ…å’Œå¤šç¯å¢ƒåŒ…çš„è‡ªåŠ¨åŒ–å®ç°</a>ä½¿ç”¨çš„, å®é™…ä¸Šè„šæœ¬è¯­è¨€éƒ½å¯ä»¥åšåˆ°, æˆ‘è¿™é‡Œé€‰ç”¨äº†Shellå’ŒPythonä¸¤ç§å®ç°æ–¹å¼. å¯¹æ¯”ä¸‹æ¥å‘ç°, Pythonæ›´å¥½æ‡‚ä¸€ç‚¹, ä½†æ˜¯Shellæ›´åŠ ç®€æ´.</p>\n<h2 id=\"æ‰“åŒ…çš„åŸºæœ¬æ€è·¯\"><a href=\"#æ‰“åŒ…çš„åŸºæœ¬æ€è·¯\" class=\"headerlink\" title=\"æ‰“åŒ…çš„åŸºæœ¬æ€è·¯\"></a>æ‰“åŒ…çš„åŸºæœ¬æ€è·¯</h2><p>è¿™é‡Œè¯´ä¸€ä¸‹æ‰“åŒ…è„šæœ¬çš„åŸºæœ¬å®ç°æ€è·¯:</p>\n<ol>\n<li>éœ€è¦ä¼ å…¥çš„å‚æ•°æœ‰Scheme(ç”¨æ¥æŒ‡å®šæ‰“å“ªä¸ªç¯å¢ƒçš„åŒ…), å¦‚æœä½¿ç”¨Firæ¥ä½œä¸ºå†…æµ‹åˆ†å‘å·¥å…·çš„è¯, è¿˜éœ€è¦ä¼ å…¥Firçš„Token.</li>\n<li>åœ¨è„šæœ¬å†…éœ€è¦æŒ‡å®šå·¥ç¨‹çš„è·¯å¾„, å·¥ç¨‹å, ArchiveåŒ…çš„è·¯å¾„, IPAåŒ…çš„è·¯å¾„.</li>\n<li>é€šè¿‡Xcodebuildå‘½ä»¤è¡Œç”ŸæˆArchiveåŒ….</li>\n<li>æ ¹æ®ç”Ÿæˆçš„ArchiveåŒ…å¯¼å‡ºIPAåŒ….</li>\n<li>ä¸Šä¼ IPAåŒ…åˆ°Fir.</li>\n</ol>\n<h2 id=\"é‡åˆ°çš„é—®é¢˜\"><a href=\"#é‡åˆ°çš„é—®é¢˜\" class=\"headerlink\" title=\"é‡åˆ°çš„é—®é¢˜\"></a>é‡åˆ°çš„é—®é¢˜</h2><ol>\n<li>Xcode8.3å, éœ€è¦ä¸€ä¸ªæ‰“åŒ…å‚æ•°é…ç½®çš„plistæ–‡ä»¶, ç”ŸæˆArchiveåŒ…æ—¶ä¼šç”¨åˆ°.</li>\n<li>shellè„šæœ¬éœ€è¦ç»™æƒé™<code>chomd 777 xx.sh</code>.</li>\n<li>Archiveå¯¼å‡ºä¸ºIPAæœ‰æ—¶ä¼šæŠ¥é”™<code>Code=14 &quot;No applicable devices found.&quot;</code>, è¿™ä¸ªå¤šå°‘æ˜¯Rubyçš„è·¯å¾„æ²¡æœ‰æŒ‡å®šå¯¼è‡´, æ‰¾äº†ä¸€å¤§åœˆæœ‰ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆ:<ol>\n<li>é€šè¿‡<code>sudo gem install CFPropertyList</code>, <code>rvm list</code>, <code>rvm use system</code>æ¥è§£å†³, Pythonæˆ–è€…Shelléƒ½å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼.</li>\n<li>Shellä¸‹è¿˜æœ‰å¦å¤–çš„è§£å†³æ–¹æ¡ˆ, åœ¨shellè„šæœ¬å‰åŠ å…¥å¦‚ä¸‹ä»£ç , æŒ‡å®šè·¯å¾„.<pre><code>[[ -s &quot;$HOME/.rvm/scripts/rvm&quot; ]] &amp;&amp; source &quot;$HOME/.rvm/scripts/rvm&quot;\nrvm use system\nxcodebuild &quot;$@&quot;\n</code></pre></li>\n</ol>\n</li>\n</ol>\n<h2 id=\"Xcode8-3åçš„plistæ–‡ä»¶\"><a href=\"#Xcode8-3åçš„plistæ–‡ä»¶\" class=\"headerlink\" title=\"Xcode8.3åçš„plistæ–‡ä»¶\"></a>Xcode8.3åçš„plistæ–‡ä»¶</h2><p>ä½¿ç”¨<code>xcodebuild -help</code> å¯ä»¥æŸ¥çœ‹Xcodebuildç›¸å…³ä»‹ç»</p>\n<pre><code>Available keys for -exportOptionsPlist:\n\n    compileBitcode : Bool\n\n        For non-App Store exports, should Xcode re-compile the app from bitcode? Defaults to YES.\n\n    embedOnDemandResourcesAssetPacksInBundle : Bool\n\n        For non-App Store exports, if the app uses On Demand Resources and this is YES, asset packs are embedded in the app bundle so that the app can be tested without a server to host asset packs. Defaults to YES unless onDemandResourcesAssetPacksBaseURL is specified.\n\n    iCloudContainerEnvironment\n\n        For non-App Store exports, if the app is using CloudKit, this configures the &quot;com.apple.developer.icloud-container-environment&quot; entitlement. Available options: Development and Production. Defaults to Development.\n\n    manifest : Dictionary\n\n        For non-App Store exports, users can download your app over the web by opening your distribution manifest file in a web browser. To generate a distribution manifest, the value of this key should be a dictionary with three sub-keys: appURL, displayImageURL, fullSizeImageURL. The additional sub-key assetPackManifestURL is required when using on demand resources.\n\n    method : String\n\n        Describes how Xcode should export the archive. Available options: app-store, ad-hoc, package, enterprise, development, and developer-id. The list of options varies based on the type of archive. Defaults to development.\n\n    onDemandResourcesAssetPacksBaseURL : String\n\n        For non-App Store exports, if the app uses On Demand Resources and embedOnDemandResourcesAssetPacksInBundle isn&#39;t YES, this should be a base URL specifying where asset packs are going to be hosted. This configures the app to download asset packs from the specified URL.\n\n    teamID : String\n\n        The Developer Portal team to use for this export. Defaults to the team used to build the archive.\n\n    thinning : String\n\n        For non-App Store exports, should Xcode thin the package for one or more device variants? Available options: &lt;none&gt; (Xcode produces a non-thinned universal app), &lt;thin-for-all-variants&gt; (Xcode produces a universal app and all available thinned variants), or a model identifier for a specific device (e.g. &quot;iPhone7,1&quot;). Defaults to &lt;none&gt;.\n\n    uploadBitcode : Bool\n\n        For App Store exports, should the package include bitcode? Defaults to YES.\n\n    uploadSymbols : Bool\n\n        For App Store exports, should the package include symbols? Defaults to YES.\n</code></pre><p>æˆ‘ä»¬åœ¨å·¥ç¨‹ä¸­æ–°å»ºä¸€ä¸ªplistæ–‡ä»¶, å¯ä»¥çœ‹å‡º, å¤§éƒ¨åˆ†æ˜¯æœ‰é»˜è®¤å€¼çš„, æ‰€ä»¥æˆ‘ä»¬ä¸ç”¨æ¯ä¸ªé€‰é¡¹éƒ½å¡«, åªå†™ä¸€äº›å¿…å¡«çš„å°±å¯ä»¥. </p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE plist PUBLIC &quot;-//Apple Computer//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;\n&lt;plist version=&quot;1.0&quot;&gt;\n    &lt;dict&gt;\n        &lt;key&gt;method&lt;/key&gt;\n        &lt;string&gt;enterprise&lt;/string&gt;\n        &lt;key&gt;uploadSymbols&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;uploadBitcode&lt;/key&gt;\n        &lt;false/&gt;\n    &lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre><hr>\n<p><a href=\"https://github.com/HChong3210/buildScript.git\" target=\"_blank\" rel=\"noopener\">é™„ä»¶ä¸‹è½½</a></p>\n<hr>\n<p>å‚è€ƒæ–‡ç« :</p>\n<p>1.<a href=\"https://diaojunxian.github.io/2016/10/21/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E5%AE%9E%E6%96%BD-%E4%B8%83/\" target=\"_blank\" rel=\"noopener\">è‡ªåŠ¨åŒ–æµ‹è¯•-æŒç»­é›†æˆ(7)</a></p>\n<p>2.<a href=\"http://stackoverflow.com/questions/33041109/xcodebuild-no-applicable-devices-found-when-exporting-archive\" target=\"_blank\" rel=\"noopener\">xcodebuild: â€œNo applicable devices found.â€ when exporting archive</a></p>\n<p>3.<a href=\"\"></a></p>\n","categories":["è‡ªåŠ¨åŒ–æ‰“åŒ…"],"tags":["è‡ªåŠ¨åŒ–æ‰“åŒ…","Target","è§£å†³æ–¹æ¡ˆ"]},{"title":"Xcodeä¸­çš„Workspace, Scheme, Project, Targetå’ŒBuild Settingsçš„å…³ç³»","url":"http://hchong.net/2017/05/16/Settingså…³ç³»/","content":"<h1 id=\"Xcodeä¸­çš„Workspace-Scheme-Project-Targetå’ŒBuild-Settingsçš„å…³ç³»\"><a href=\"#Xcodeä¸­çš„Workspace-Scheme-Project-Targetå’ŒBuild-Settingsçš„å…³ç³»\" class=\"headerlink\" title=\"Xcodeä¸­çš„Workspace, Scheme, Project, Targetå’ŒBuild Settingsçš„å…³ç³»\"></a>Xcodeä¸­çš„Workspace, Scheme, Project, Targetå’ŒBuild Settingsçš„å…³ç³»</h1><h2 id=\"Xcode-Workspace\"><a href=\"#Xcode-Workspace\" class=\"headerlink\" title=\"Xcode Workspace\"></a>Xcode Workspace</h2><p>å®˜æ–¹æ–‡æ¡£å¦‚ä¸‹: </p>\n<blockquote>\n<p>A workspace is an Xcode document that groups projects and other documents so you can work on them together. A workspace can contain any number of Xcode projects, plus any other files you want to include. In addition to organizing all the files in each Xcode project, a workspace provides implicit and explicit relationships among the included projects and their targets.</p>\n</blockquote>\n<p>workspaceæ˜¯Xcodeçš„ä¸€ç§æ–‡ä»¶ï¼Œç”¨æ¥ç®¡ç†å·¥ç¨‹å’Œé‡Œé¢çš„æ–‡ä»¶ï¼Œä¸€ä¸ªworkspaceå¯ä»¥åŒ…å«è‹¥å¹²ä¸ªå·¥ç¨‹ï¼Œç”šè‡³å¯ä»¥æ·»åŠ ä»»ä½•ä½ æƒ³æ·»åŠ çš„æ–‡ä»¶ã€‚workspaceæä¾›äº†å·¥ç¨‹å’Œå·¥ç¨‹é‡Œé¢çš„targetä¹‹é—´éšå¼å’Œæ˜¾å¼ä¾èµ–å…³ç³»ï¼Œç”¨æ¥ç®¡ç†å’Œç»„ç»‡å·¥ç¨‹é‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶.</p>\n<p> ä¸€ä¸ªworkspaceå¯ä»¥ç®¡ç†å¤šä¸ªProject, <code>pod install</code>çš„è¿‡ç¨‹å°±æ˜¯ç”Ÿæˆäº†ä¸€ä¸ªworkspaceå’Œä¸€ä¸ªå…¨æ˜¯Podç»„ä»¶çš„Project, ç„¶åæˆ‘ä»¬é€šè¿‡ç”Ÿæˆçš„workspaceæ¥ç®¡ç†æ–°ç”Ÿæˆçš„Projectå’ŒåŸæœ¬çš„Project.</p>\n<h2 id=\"Xcode-Project\"><a href=\"#Xcode-Project\" class=\"headerlink\" title=\"Xcode Project\"></a>Xcode Project</h2><p>å®˜æ–¹æ–‡æ¡£å¦‚ä¸‹:</p>\n<blockquote>\n<p>An Xcode project is a repository for all the files, resources, and information required to build one or more software products. A project contains all the elements used to build your products and maintains the relationships between those elements. It contains one or more targets, which specify how to build products. A project defines default build settings for all the targets in the project (each target can also specify its own build settings, which override the project build settings).</p>\n</blockquote>\n<p>projectå°±æ˜¯ä¸€ä¸ªä¸ªçš„ä»“åº“ï¼Œé‡Œé¢ä¼šåŒ…å«å±äºè¿™ä¸ªé¡¹ç›®çš„æ‰€æœ‰æ–‡ä»¶ï¼Œèµ„æºï¼Œä»¥åŠç”Ÿæˆä¸€ä¸ªæˆ–è€…å¤šä¸ªè½¯ä»¶äº§å“çš„ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªprojectä¼šåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ª targetsï¼Œè€Œæ¯ä¸€ä¸ª target å‘Šè¯‰æˆ‘ä»¬å¦‚ä½•ç”Ÿäº§ productsã€‚project ä¼šä¸ºæ‰€æœ‰ targets å®šä¹‰äº†é»˜è®¤çš„ build settingsï¼Œæ¯ä¸€ä¸ª target ä¹Ÿèƒ½è‡ªå®šä¹‰è‡ªå·±çš„ build settingsï¼Œä¸” target çš„ build settings ä¼šé‡å†™ project çš„ build settingsã€‚</p>\n<p>Xcodeä¸­çš„ projecté‡Œé¢åŒ…å«äº†æ‰€æœ‰çš„æºæ–‡ä»¶ï¼Œèµ„æºæ–‡ä»¶å’Œæ„å»ºä¸€ä¸ªæˆ–è€…å¤šä¸ªproductçš„ä¿¡æ¯ã€‚projectåˆ©ç”¨ä»–ä»¬å»ç¼–è¯‘æˆ‘ä»¬æ‰€éœ€çš„productï¼Œä¹Ÿå¸®æˆ‘ä»¬ç»„ç»‡å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚ä¸€ä¸ªprojectå¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªtargetã€‚projectå®šä¹‰äº†ä¸€äº›åŸºæœ¬çš„ç¼–è¯‘è®¾ç½®ï¼Œæ¯ä¸ªtargetéƒ½ç»§æ‰¿äº†projectçš„é»˜è®¤è®¾ç½®ï¼Œæ¯ä¸ªtargetå¯ä»¥é€šè¿‡é‡æ–°è®¾ç½®targetçš„ç¼–è¯‘é€‰é¡¹æ¥å®šä¹‰è‡ªå·±çš„ç‰¹æ®Šç¼–è¯‘é€‰é¡¹ã€‚</p>\n<p>projectåŒ…å«äº†ä»¥ä¸‹ä¿¡æ¯ï¼š</p>\n<ul>\n<li>æºæ–‡ä»¶<ul>\n<li>ä»£ç çš„å¤´æ–‡ä»¶å’Œå®ç°æ–‡ä»¶</li>\n<li>é™æ€åº“ï¼ŒåŠ¨æ€åº“ï¼Œ</li>\n<li>èµ„æºæ–‡ä»¶(å¦‚æ–‡æœ¬ï¼Œxmlï¼Œplistç­‰)</li>\n<li>å›¾ç‰‡èµ„æº</li>\n<li>ç•Œé¢èµ„æºæ–‡ä»¶(xibï¼Œ storyboardç­‰)</li>\n</ul>\n</li>\n<li>åœ¨æ–‡ä»¶ç»“æ„çš„å¯¼èˆªä¸­ï¼Œé‡‡ç”¨groupå»ç»„ç»‡æ–‡ä»¶(å®é™…å¼€å‘ä¸­ï¼Œå°½é‡ä½¿ç”¨å®ä½“æ–‡ä»¶å¤¹)</li>\n<li>projectçš„ç¼–è¯‘çº§åˆ«é…ç½®æ–‡ä»¶å¦‚(debugï¼Œ release)</li>\n<li>target</li>\n<li>è¿è¡Œç¯å¢ƒå¦‚ï¼šdebugï¼Œtest</li>\n</ul>\n<p>projectå¯ä»¥å•ç‹¬å­˜åœ¨ï¼Œæˆ–è€…å­˜åœ¨äºä¸€ä¸ªworkspaceä¸­.<br>â€‹    </p>\n<h2 id=\"Xcode-Target\"><a href=\"#Xcode-Target\" class=\"headerlink\" title=\"Xcode Target\"></a>Xcode Target</h2><p>å®˜æ–¹æ–‡æ¡£å¦‚ä¸‹:</p>\n<blockquote>\n<p>A target specifies a product to build and contains the instructions for building the product from a set of files in a project or workspace. A target defines a single product; it organizes the inputs into the build systemâ€”the source files and instructions for processing those source filesâ€”required to build that product. Projects can contain one or more targets, each of which produces one product.</p>\n</blockquote>\n<p>target å®šä¹‰äº†ç”Ÿæˆçš„å”¯ä¸€ product, å®ƒå°†æ„å»ºè¯¥ product æ‰€éœ€çš„æ–‡ä»¶å’Œå¤„ç†è¿™äº›æ–‡ä»¶æ‰€éœ€çš„æŒ‡ä»¤é›†æ•´åˆè¿› build system ä¸­ã€‚Projects ä¼šåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ª targets,æ¯ä¸€ä¸ª target å°†ä¼šäº§å‡ºä¸€ä¸ª product.</p>\n<p>è¿™äº›æŒ‡ä»¤ä»¥ build setting å’Œ build phases çš„å½¢å¼å­˜åœ¨ï¼Œä½ å¯åœ¨ Xcode çš„é¡¹ç›®ç¼–è¾‘å™¨(TARGETS-&gt;Build Setting, TARGETS-&gt;Build Phases)ä¸­è¿›è¡ŒæŸ¥çœ‹å’Œç¼–è¾‘ã€‚target ä¸­çš„ build setting å‚æ•°ç»§æ‰¿è‡ª project çš„ build settings, ä½†æ˜¯ä½ å¯ä»¥åœ¨ target ä¸­ä¿®æ”¹ä»»æ„ settings æ¥é‡å†™ project settingsï¼Œè¿™æ ·ï¼Œæœ€ç»ˆç”Ÿæ•ˆçš„ settings å‚æ•°ä»¥åœ¨ target ä¸­è®¾ç½®çš„ä¸ºå‡†. Project å¯åŒ…å«å¤šä¸ª target, ä½†æ˜¯åœ¨åŒä¸€æ—¶åˆ»ï¼Œåªä¼šæœ‰ä¸€ä¸ª target ç”Ÿæ•ˆï¼Œå¯ç”¨ Xcode çš„ scheme æ¥æŒ‡å®šæ˜¯å“ªä¸€ä¸ª target ç”Ÿæ•ˆ.</p>\n<p>target å’Œå…¶ç”Ÿæˆçš„ product å¯ä¸å¦ä¸€ä¸ª target æœ‰å…³ï¼Œå¦‚æœä¸€ä¸ª target çš„ build ä¾èµ–äºå¦ä¸€ä¸ª target çš„è¾“å‡ºï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯´å‰ä¸€ä¸ª target ä¾èµ–äºåä¸€ä¸ª target .å¦‚æœè¿™äº› target åœ¨åŒä¸€ä¸ª workspace ä¸­ï¼Œé‚£ä¹ˆ Xcode èƒ½å¤Ÿå‘ç°è¿™ç§ä¾èµ–å…³ç³»ï¼Œä»è€Œä½¿å…¶ä»¥æˆ‘ä»¬æœŸæœ›çš„é¡ºåºç”Ÿæˆ products.è¿™ç§å…³ç³»è¢«ç§°ä¸ºéšå¼ä¾èµ–å…³ç³»ã€‚åŒæ—¶ï¼Œä½ å¯ä»¥æ˜¾ç¤ºæŒ‡å®š targets ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”è¿™ç§ä¾èµ–å…³ç³»ä¼šè¦†ç›– Xcode æ¨æµ‹å‡ºçš„éšå¼ä¾èµ–å…³ç³»ã€‚</p>\n<p>æŒ‡å®š targets ä¹‹é—´çš„ä¾èµ–å…³ç³»çš„åœ°æ–¹åœ¨ Project Editor-&gt;TRAGETS-&gt;Build Phases-&gt;Target Dependencies å¤„è®¾ç½®.</p>\n<h2 id=\"Scheme\"><a href=\"#Scheme\" class=\"headerlink\" title=\"Scheme\"></a>Scheme</h2><p>å®˜æ–¹æ–‡æ¡£å¦‚ä¸‹:</p>\n<blockquote>\n<p>An Xcode scheme defines a collection of targets to build, a configuration to use when building, and a collection of tests to execute.</p>\n</blockquote>\n<p>ä¸€ä¸ªSchemeå°±åŒ…å«äº†ä¸€å¥—targets(è¿™äº›targetsä¹‹é—´å¯èƒ½æœ‰ä¾èµ–å…³ç³»)ï¼Œä¸€ä¸ªconfigurationï¼Œä¸€å¥—å¾…æ‰§è¡Œçš„testsã€‚æŒ‡å®šäº†ç¼–è¯‘å“ªä¸ªtargetï¼Œä½¿ç”¨å“ªä¸ªbuild configurationå»ç¼–è¯‘targetï¼Œæä¾›è¿è¡Œtargetçš„æ‰§è¡Œç¯å¢ƒç­‰ç­‰ã€‚å¯ä»¥é€šè¿‡scheme editoræ¥ç¼–è¾‘scheme.</p>\n<blockquote>\n<p>You can have as many schemes as you want, but only one can be active at a time. You can specify whether a scheme should be stored in a projectâ€”in which case itâ€™s available in every workspace that includes that project, or in the workspaceâ€”in which case itâ€™s available only in that workspace. When you select an active scheme, you also select a run destination (that is, the architecture of the hardware for which the products are built).</p>\n</blockquote>\n<p>schemeå®šä¹‰äº†ä¸€ç³»åˆ—æ„å»ºçš„targetsï¼Œæ„å»ºæ—¶çš„é…ç½®ï¼Œå’Œä¸€ç³»åˆ—æ‰§è¡Œçš„æµ‹è¯•ã€‚å¯ä»¥æœ‰å¾ˆå¤šscheme,ä½†åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ã€‚é€‰æ‹©schemeæ—¶ï¼Œæ„å‘³ç€ä½ ä¹Ÿé€‰æ‹©äº†ä¸€ä¸ªè¿è¡Œç›®æ ‡ï¼ˆproductæ„å»ºçš„ç¡¬ä»¶å¹³å°)ã€‚å¯ä»¥æŒ‡å®šschemeæ˜¯å¦å­˜å‚¨åœ¨projectä¸­ï¼Œä»¥ä¾¿åŒ…å«æ­¤projectçš„æ‰€æœ‰workspaceéƒ½å¯ä»¥ä½¿ç”¨äº›scheme,å½“ç„¶ä¹Ÿå¯ä»¥æŒ‡å®šåªå­˜å‚¨åœ¨æŸä¸ªworkspaceä¸­ã€‚</p>\n<h2 id=\"Build-Settings\"><a href=\"#Build-Settings\" class=\"headerlink\" title=\"Build Settings\"></a>Build Settings</h2><p>å®˜æ–¹æ–‡æ¡£å¦‚ä¸‹:</p>\n<blockquote>\n<p>A build setting is a variable that contains information about how a particular aspect of a productâ€™s build process should be performed. For example, the information in a build setting can specify which options Xcode passes to the compiler.</p>\n</blockquote>\n<p>ä¸€ä¸ªbuild settingæ˜¯ä¸€ä¸ªæŒ‡ç¤ºäº§å“æŸä¸ªæ–¹é¢æ„å»ºæ–¹å¼çš„å˜é‡ï¼Œæ¯”å¦‚å†³å®šxcodeä¼ ç»™ç¼–è¯‘å™¨çš„å‚æ•°é€‰é¡¹æ˜¯æ€æ ·ã€‚å…¶æ˜¯ä¸€ä¸ªå¸¸é‡æˆ–è€…ä¸€ä¸ªå…¬å¼ä¾›ç»™xcodeåœ¨æ„å»ºçš„æ—¶å€™è®¡ç®—build settingã€‚</p>\n<p>build setting ä¸­åŒ…å«äº† product ç”Ÿæˆè¿‡ç¨‹ä¸­æ‰€éœ€çš„å‚æ•°ä¿¡æ¯ã€‚ä½ å¯ä»¥åœ¨ project-level å’Œ target-level å±‚æŒ‡å®š build settingsã€‚project-level çš„ build settings é€‚ç”¨äº project ä¸­çš„æ‰€æœ‰targetsï¼Œä½†æ˜¯å½“ target-level çš„ build settings é‡å†™äº† project-level çš„ build settingsï¼Œä»¥ target-level ä¸­çš„ build settings ä¸­çš„å€¼ä¸ºå‡†</p>\n<p>ä¸€ä¸ª build configaration æŒ‡å®šäº†ä¸€å¥— build settings ç”¨äºç”ŸæˆæŸä¸€ target çš„ productï¼Œä¾‹å¦‚ï¼Œåœ¨ Xcode åˆ›å»ºé¡¹ç›®æ—¶é»˜è®¤å°±æœ‰ä¸¤å¥—ç‹¬ç«‹çš„ build configarations, åˆ†åˆ«ç”¨äºç”Ÿæˆ debug å’Œ release æ¨¡å¼ä¸‹çš„ productã€‚</p>\n<p>é™¤äº†åˆ›å»ºå·¥ç¨‹æ—¶ç”Ÿæˆçš„é»˜è®¤ build settingsï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ project-level æˆ–è€… target-level çš„ build settings.</p>\n<p>å…³äºç»§æ‰¿å…³ç³»ï¼Œ<a href=\"https://pewpewthespells.com/blog/xcconfig_guide.html#BuildSettingInheritance\" target=\"_blank\" rel=\"noopener\">The Unofficial Guide to xcconfig files</a> è¿™é‡Œä¹Ÿæœ‰è¯¦ç»†çš„è¯´æ˜ï¼Œå¼ºçƒˆå»ºè®®é˜…è¯»ã€‚</p>\n<p>åŠ¨æ€ç¯å¢ƒé…ç½®å°±æ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„ build settings æ¥å®ç°çš„.</p>\n<hr>\n<p>å‚è€ƒèµ„æ–™:</p>\n<p>1.<a href=\"http://liumh.com/2016/05/22/use-xcconfig-config-specific-variable/\" target=\"_blank\" rel=\"noopener\">Xcodeä½¿ç”¨xcconfigæ–‡ä»¶é…ç½®ç¯å¢ƒ</a>.<br>â€‹<br>2.<a href=\"https://developer.apple.com/library/content/featuredarticles/XcodeConcepts/Concept-Targets.html\" target=\"_blank\" rel=\"noopener\">Appleå®˜æ–¹æ–‡æ¡£</a>.</p>\n<p>3.<a href=\"https://xiuchundao.me/post/xcode-scheme-and-build-configuration\" target=\"_blank\" rel=\"noopener\">Xcodeä¸­çš„Schemeå’ŒBuild Configuration</a>.</p>\n<p>4.<a href=\"http://www.jianshu.com/p/1f312abafeff\" target=\"_blank\" rel=\"noopener\">Xcode workSpace å¤šä¸ªprojectè”ç¼–</a></p>\n<p>5.<a href=\"https://pewpewthespells.com/blog/xcconfig_guide.html#BuildSettingInheritance\" target=\"_blank\" rel=\"noopener\">The Unofficial Guide to xcconfig files</a></p>\n","categories":["åŸºç¡€çŸ¥è¯†"],"tags":["åŸºç¡€çŸ¥è¯†","Target"]},{"title":"é€šè®¯å½•æ•°æ®çš„è¯»å–å’Œæ€§èƒ½ä¼˜åŒ–","url":"http://hchong.net/2017/04/23/é€šè®¯å½•æ•°æ®çš„è¯»å–å’Œæ€§èƒ½ä¼˜åŒ–/","content":"<h1 id=\"é€šè®¯å½•æ•°æ®çš„è¯»å–å’Œæ€§èƒ½ä¼˜åŒ–\"><a href=\"#é€šè®¯å½•æ•°æ®çš„è¯»å–å’Œæ€§èƒ½ä¼˜åŒ–\" class=\"headerlink\" title=\"é€šè®¯å½•æ•°æ®çš„è¯»å–å’Œæ€§èƒ½ä¼˜åŒ–\"></a>é€šè®¯å½•æ•°æ®çš„è¯»å–å’Œæ€§èƒ½ä¼˜åŒ–</h1><p>å‰æ®µæ—¶é—´å†åšä¸€ä¸ªå…³äºé€šè®¯å½•ç›¸å…³çš„é¡¹ç›®, è®°å½•ä¸€ä¸‹é€šè®¯å½•ç›¸å…³çš„åŸºç¡€å’Œè¯»å–ä¼˜åŒ–çš„éƒ¨åˆ†. åœ¨æœ¬ç¯‡æ–‡ç« ä¸­, æˆ‘ä¸»è¦ä¾§é‡è¯»å–é€šè®¯å½•æ•°æ®æ–¹é¢, è‡³äºè°ƒç”¨åŸç”Ÿçš„ç•Œé¢åœ¨è¿™é‡Œåˆ™ä¸åšé˜è¿°. å…³äºé€šè®¯å½•çš„API, åœ¨iOS9ä¹‹ååšäº†è¾ƒå¤§çš„è°ƒæ•´, ä½¿ç”¨<code>Contacts Framework</code>æ›¿ä»£<code>AddressBookFramework</code>. ä¸‹é¢æˆ‘å°†å°±iOS9å’ŒiOS8ä¸¤ç§APIè¿›è¡Œåˆ†æ.</p>\n<h2 id=\"é€šè®¯å½•çš„æˆæƒ\"><a href=\"#é€šè®¯å½•çš„æˆæƒ\" class=\"headerlink\" title=\"é€šè®¯å½•çš„æˆæƒ\"></a>é€šè®¯å½•çš„æˆæƒ</h2><p>æ—¢ç„¶è¦è¯»å–é€šè®¯å½•, é‚£ä¹ˆé€šè®¯å½•æˆæƒçŠ¶æ€çš„æŸ¥è¯¢, è¦æ”¾åœ¨åœ¨å‰é¢, è¿™é‡Œä¹ŸåŒºåˆ†iOS9å’ŒiOS8ç³»ç»Ÿ.</p>\n<h3 id=\"iOS8æŸ¥è¯¢é€šè®¯å½•æˆæƒçŠ¶æ€\"><a href=\"#iOS8æŸ¥è¯¢é€šè®¯å½•æˆæƒçŠ¶æ€\" class=\"headerlink\" title=\"iOS8æŸ¥è¯¢é€šè®¯å½•æˆæƒçŠ¶æ€\"></a>iOS8æŸ¥è¯¢é€šè®¯å½•æˆæƒçŠ¶æ€</h3><pre><code>+ (void)checkAddressBookAuthorization:(void (^)(bool isAuthorized))block {\n    ABAddressBookRef addressBookRef =  ABAddressBookCreateWithOptions(NULL, NULL);\n    switch (ABAddressBookGetAuthorizationStatus()) {\n        case kABAuthorizationStatusNotDetermined: {\n            NSLog(@&quot;æœªè¯¢é—®ç”¨æˆ·æ˜¯å¦æˆæƒ&quot;);\n            ABAddressBookRequestAccessWithCompletion(addressBookRef, ^(bool granted, CFErrorRef error) {\n                if (granted) {\n                    NSLog(@&quot;æˆæƒå¯ä»¥è¯»å–&quot;);\n                    block(YES);\n                } else {\n                    NSLog(@&quot;æˆæƒä¸èƒ½è¯»å–&quot;);\n                    block(NO);\n                }\n            });\n        } break;\n        case kABAuthorizationStatusAuthorized: {\n            NSLog(@&quot;åŒæ„æˆæƒé€šè®¯å½•&quot;);\n            block(YES);\n        } break;\n        case kABAuthorizationStatusDenied: {\n            block(NO);\n            NSLog(@&quot;æœªæˆæƒï¼Œç”¨æˆ·æ‹’ç»é€ æˆçš„&quot;);\n        } break;\n        case kABAuthorizationStatusRestricted: {\n            block(NO);\n            NSLog(@&quot;æœªæˆæƒï¼Œä¾‹å¦‚å®¶é•¿æ§åˆ¶&quot;);\n        } break;\n        default: {\n        } break;\n    }\n}\n</code></pre><h3 id=\"iOS9æŸ¥è¯¢é€šè®¯å½•æˆæƒçŠ¶æ€\"><a href=\"#iOS9æŸ¥è¯¢é€šè®¯å½•æˆæƒçŠ¶æ€\" class=\"headerlink\" title=\"iOS9æŸ¥è¯¢é€šè®¯å½•æˆæƒçŠ¶æ€\"></a>iOS9æŸ¥è¯¢é€šè®¯å½•æˆæƒçŠ¶æ€</h3><pre><code>- (void)addressBookEmpowerCheck {\n    CNAuthorizationStatus status = [CNContactStore authorizationStatusForEntityType:CNEntityTypeContacts];\n    switch (status) {\n        case CNAuthorizationStatusNotDetermined: {\n            [[[CNContactStore alloc]init] requestAccessForEntityType:CNEntityTypeContacts completionHandler:^(BOOL granted, NSError * _Nullable error) {\n                NSLog(@&quot;è¿˜æ²¡é—®&quot;);\n                if (granted) {\n                    NSLog(@&quot;ç‚¹å‡»äº†åŒæ„&quot;);\n                } else {\n                    NSLog(@&quot;ç‚¹å‡»äº†æ‹’ç»&quot;);\n                }\n            }];\n        }\n        break;\n        case CNAuthorizationStatusRestricted: {\n            NSLog(@&quot;æœªæˆæƒ, ä¾‹å¦‚å®¶é•¿æ§åˆ¶&quot;);\n        }\n        break;\n        case CNAuthorizationStatusDenied: {\n            NSLog(@&quot;æœªæˆæƒ, ç”¨æˆ·æ‹’ç»æ‰€è‡´&quot;);\n        }\n        break;\n        case CNAuthorizationStatusAuthorized: {\n            NSLog(@&quot;å·²ç»æˆæƒ&quot;);\n        }\n        break;\n        default: {\n        }\n        break;\n    }\n}\n</code></pre><p>æ³¨æ„: å¦‚æœæ˜¯iOS10çš„ç³»ç»Ÿéœ€è¦åœ¨<code>Info.plist</code>é…ç½®<code>NSContactsUsageDescription</code></p>\n<pre><code>&lt;key&gt;NSContactsUsageDescription&lt;/key&gt;\n&lt;string&gt;è¯·æ±‚è®¿é—®é€šè®¯å½•&lt;/string&gt;\n</code></pre><h2 id=\"é€šè®¯å½•æ•°æ®å†™å…¥å’Œåˆ é™¤\"><a href=\"#é€šè®¯å½•æ•°æ®å†™å…¥å’Œåˆ é™¤\" class=\"headerlink\" title=\"é€šè®¯å½•æ•°æ®å†™å…¥å’Œåˆ é™¤\"></a>é€šè®¯å½•æ•°æ®å†™å…¥å’Œåˆ é™¤</h2><p>å½“é€šè®¯å½•æ•°æ®å°‘æ—¶, æ•°æ®çš„è¯»å–è€—æ—¶è¾ƒå°‘, ä¸ºäº†æ›´å¥½åœ°æµ‹è¯•å¤§é‡æ•°æ®ä¸‹çš„æ€§èƒ½é—®é¢˜, æˆ‘ä»¬å…ˆå†™å…¥å¤§é‡çš„æ•°æ®æ¥è¿›è¡Œæµ‹è¯•. </p>\n<h3 id=\"iOS8å†™å…¥è”ç³»äºº\"><a href=\"#iOS8å†™å…¥è”ç³»äºº\" class=\"headerlink\" title=\"iOS8å†™å…¥è”ç³»äºº\"></a>iOS8å†™å…¥è”ç³»äºº</h3><pre><code>- (void)creatItemWithName:(NSString *)name phone:(NSString *)phone {\n    if((name.length &lt; 1)||(phone.length &lt; 1)){\n        NSLog(@&quot;è¾“å…¥å±æ€§ä¸èƒ½ä¸ºç©º&quot;);\n        return;\n    }\n    CFErrorRef error = NULL;\n\n    ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(NULL, &amp;error);\n    ABRecordRef newRecord = ABPersonCreate();\n    ABRecordSetValue(newRecord, kABPersonFirstNameProperty, (__bridge CFTypeRef)name, &amp;error);\n\n    ABMutableMultiValueRef multi = ABMultiValueCreateMutable(kABMultiStringPropertyType);\n    ABMultiValueAddValueAndLabel(multi, (__bridge CFTypeRef)name, kABPersonPhoneMobileLabel, NULL);\n\n    ABRecordSetValue(newRecord, kABPersonPhoneProperty, multi, &amp;error);\n    CFRelease(multi);\n\n    ABAddressBookAddRecord(addressBook, newRecord, &amp;error);\n    CFRelease(newRecord);\n    CFRelease(addressBook);\n}\n</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯, åœ¨æœ¬ä¾‹ä¸­, åªå¡«å†™äº†<code>FirstName</code>å’Œ<code>phone</code>, å®é™…è¿˜æœ‰è®¸å¤šå…¶ä»–å±æ€§å¯ä¾›é€‰æ‹©, å…·ä½“å‚ç…§<code>ABAddressBookRef</code>å’Œ<code>ABRecordRef</code>éœ€è¦è°ƒç”¨<code>CFRelease</code>æ¥é‡Šæ”¾å†…å­˜.</p>\n<h3 id=\"iOS9å†™å…¥è”ç³»äºº\"><a href=\"#iOS9å†™å…¥è”ç³»äºº\" class=\"headerlink\" title=\"iOS9å†™å…¥è”ç³»äºº\"></a>iOS9å†™å…¥è”ç³»äºº</h3><pre><code>- (void)creatItemWithName:(NSString *)name phone:(NSString *)phone {\n    // åˆ›å»ºå¯¹è±¡\n    CNMutableContact * contact = [[CNMutableContact alloc]init];\n    contact.givenName = name?:@&quot;defaultname&quot;;\n    CNLabeledValue *phoneNumber = [CNLabeledValue labeledValueWithLabel:CNLabelPhoneNumberMobile value:[CNPhoneNumber phoneNumberWithStringValue:phone?:@&quot;10086&quot;]];\n    contact.phoneNumbers = @[phoneNumber];\n\n    // æŠŠå¯¹è±¡åŠ åˆ°è¯·æ±‚ä¸­\n    CNSaveRequest * saveRequest = [[CNSaveRequest alloc]init];\n    [saveRequest addContact:contact toContainerWithIdentifier:nil];\n\n    // æ‰§è¡Œè¯·æ±‚\n    CNContactStore * store = [[CNContactStore alloc]init];\n    [store executeSaveRequest:saveRequest error:nil];\n}\n</code></pre><p>æ›´ç¨³å¥ä¸€ç‚¹çš„å†™æ³•, æ˜¯å¯ä»¥æŠŠè¯·æ±‚æ”¾åœ¨é€šè®¯å½•æˆæƒåˆ¤æ–­çš„blockä¸­</p>\n<pre><code>    CNContactStore *store = [[CNContactStore alloc] init];\n    [store requestAccessForEntityType:CNEntityTypeContacts completionHandler:^(BOOL granted, NSError * _Nullable error) {\n        if (!granted) {\n            dispatch_async(dispatch_get_main_queue(), ^{\n                //å¤±è´¥åŸå› \n            });\n            return;\n        }\n        //do something\n    }];\n</code></pre><p>ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼</p>\n<pre><code> - (void)addContactWithName:(NSString *)name {\n\n    CNContactStore *store = [[CNContactStore alloc] init];\n    [store requestAccessForEntityType:CNEntityTypeContacts completionHandler:^(BOOL granted, NSError * _Nullable error) {\n        if (!granted) {\n            dispatch_async(dispatch_get_main_queue(), ^{\n                //å¤±è´¥åŸå› \n            });\n            return;\n        }\n\n        CNMutableContact *contact = [[CNMutableContact alloc] init];\n        contact.familyName = @&quot;Doe&quot;;\n        contact.givenName = @&quot;John&quot;;\n\n        CNLabeledValue *homePhone = [CNLabeledValue labeledValueWithLabel:CNLabelHome value:[CNPhoneNumber phoneNumberWithStringValue:@&quot;312-555-1212&quot;]];\n        contact.phoneNumbers = @[homePhone];\n\n        CNSaveRequest *request = [[CNSaveRequest alloc] init];\n        [request addContact:contact toContainerWithIdentifier:nil];\n\n        // save it\n        NSError *saveError;\n        if (![store executeSaveRequest:request error:&amp;saveError]) {\n            NSLog(@&quot;error = %@&quot;, saveError);\n        }\n    }];\n}\n</code></pre><h3 id=\"iOS8åˆ é™¤è”ç³»äºº\"><a href=\"#iOS8åˆ é™¤è”ç³»äºº\" class=\"headerlink\" title=\"iOS8åˆ é™¤è”ç³»äºº\"></a>iOS8åˆ é™¤è”ç³»äºº</h3><pre><code>- (void)removeItemWithName:(NSString *)name phone:(NSString *)phone {\n    ABAddressBookRef addressbook = ABAddressBookCreate();\n    CFStringRef nameRef = (__bridge CFStringRef) name;\n    CFArrayRef  allSearchRecords = ABAddressBookCopyPeopleWithName(addressbook, nameRef);\n    if (allSearchRecords != NULL)\n    {\n        CFIndex count = CFArrayGetCount(allSearchRecords);\n        for (int i = 0; i &lt; count; ++i)\n        {\n            ABRecordRef contact = CFArrayGetValueAtIndex(allSearchRecords, i);\n            ABAddressBookRemoveRecord(addressbook, contact, nil);\n        }\n    }\n    ABAddressBookSave(addressbook, nil);\n    CFRelease(addressbook);\n}\n</code></pre><h3 id=\"iOS9åˆ é™¤è”ç³»äºº\"><a href=\"#iOS9åˆ é™¤è”ç³»äºº\" class=\"headerlink\" title=\"iOS9åˆ é™¤è”ç³»äºº\"></a>iOS9åˆ é™¤è”ç³»äºº</h3><pre><code>- (void)removeContactWithName:(NSString *)name {\n    CNContactStore *store = [[CNContactStore alloc] init];\n    NSPredicate *predicate = [CNContact predicateForContactsMatchingName:name];\n    NSArray *contacts = [store unifiedContactsMatchingPredicate:predicate keysToFetch:@[CNContactGivenNameKey, CNContactFamilyNameKey] error:nil];\n\n    for (CNMutableContact *contact in contacts) {\n        CNSaveRequest *request = [[CNSaveRequest alloc] init];\n        [request deleteContact:contact];\n        // save it\n        NSError *saveError;\n        if (![store executeSaveRequest:request error:&amp;saveError]) {\n            NSLog(@&quot;error = %@&quot;, saveError);\n        }\n    }\n}\n</code></pre><h2 id=\"é€šè®¯å½•æ•°æ®è¯»å–\"><a href=\"#é€šè®¯å½•æ•°æ®è¯»å–\" class=\"headerlink\" title=\"é€šè®¯å½•æ•°æ®è¯»å–\"></a>é€šè®¯å½•æ•°æ®è¯»å–</h2><p>é€šè¿‡ä¸Šé¢çš„ä¸€é€šæ“ä½œ, æˆ‘ä»¬å·²ç»å¯ä»¥åˆ›å»ºå’Œåˆ é™¤é€šè®¯å½•äº†, é‚£ä¹ˆæˆ‘ä»¬å°±é€šè¿‡æ‰¹é‡å†™å…¥é€šè®¯å½•æ•°æ®, æ¥è¿›è¡Œé€šè®¯å½•æ•°æ®çš„è¯»å–, å¹¶ä¸”æŒ‰ç…§å§“åå’Œé¦–å­—æ¯åˆ†ç»„æ’åº. ç›¸åº”çš„, æ­¤å¤„æˆ‘ä»¬ä¹ŸåŒºåˆ†<code>iOS8</code>å’Œ<code>iOS9</code>ä¸‹é¢ä¸¤ä¸ªä¸åŒçš„æ¡†æ¶.</p>\n<h3 id=\"iOS8è¯»å–è”ç³»äºº\"><a href=\"#iOS8è¯»å–è”ç³»äºº\" class=\"headerlink\" title=\"iOS8è¯»å–è”ç³»äºº\"></a>iOS8è¯»å–è”ç³»äºº</h3><pre><code>+ (NSArray *)getAllContact {\n    NSMutableArray *array = [NSMutableArray arrayWithCapacity:0];\n\n    CFErrorRef *error = NULL;\n    ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(NULL, error);\n\n    CFIndex numberOfPeople = ABAddressBookGetPersonCount(addressBook);\n    CFArrayRef people = ABAddressBookCopyArrayOfAllPeople(addressBook);\n    if (numberOfPeople == 0) {\n        CFRelease(people);\n        CFRelease(addressBook);\n        return @[];\n    }\n    for ( int i = 0; i &lt; numberOfPeople; i++){\n        AddressBookContact *contact = [[AddressBookContact alloc] init];\n\n        ABRecordRef person = CFArrayGetValueAtIndex(people, i);\n\n        //å§“å\n        NSString *firstName = (NSString *)CFBridgingRelease(ABRecordCopyValue(person, kABPersonFirstNameProperty));\n        NSString *lastName = (NSString *)CFBridgingRelease(ABRecordCopyValue(person, kABPersonLastNameProperty));\n        NSString *name = [NSString stringWithFormat:@&quot;%@%@&quot;, lastName, firstName;\n        contact.name = name;\n\n        //ç¬¬ä¸€æ¬¡æ·»åŠ è¯¥æ¡è®°å½•çš„æ—¶é—´æˆ³\n        NSDate *createDate = (NSDate *)CFBridgingRelease(ABRecordCopyValue(person, kABPersonCreationDateProperty));\n        NSTimeInterval timeIn = [createDate timeIntervalSince1970];\n        NSInteger createTime = round(timeIn);\n        contact.createTime = [NSString stringWithFormat:@&quot;%010ld&quot;, (long)createTime];\n\n        //è¯»å–ç”µè¯å¤šå€¼\n        ABMultiValueRef phone = ABRecordCopyValue(person, kABPersonPhoneProperty);\n        NSArray *arr = (NSArray *)CFBridgingRelease(ABMultiValueCopyArrayOfAllValues(phone));\n        contact.phone = [AddressBookData filterPhoneFormate:[arr lastObject]];\n\n        if (contact.phone.length &gt; 0) {\n            [array addObject:contact];\n        }\n    }\n    CFRelease(people);\n    CFRelease(addressBook);\n    return array;\n}\n\n//å‰”é™¤æ‰‹æœºå·ä¸­çš„ç‰¹æ®Šå­—ç¬¦\n+ (NSString *)filterPhoneFormate:(NSString *)phoneNumber {\n    NSCharacterSet *notAllowedChars = [[NSCharacterSet characterSetWithCharactersInString:@&quot;0123456789&quot;] invertedSet];\n    NSString *resultString = [[phoneNumber componentsSeparatedByCharactersInSet:notAllowedChars] componentsJoinedByString:@&quot;&quot;];\n    return resultString;\n}\n</code></pre><h3 id=\"iOS9è¯»å–è”ç³»äºº\"><a href=\"#iOS9è¯»å–è”ç³»äºº\" class=\"headerlink\" title=\"iOS9è¯»å–è”ç³»äºº\"></a>iOS9è¯»å–è”ç³»äºº</h3><pre><code>    // åˆ›å»ºé€šä¿¡å½•å¯¹è±¡\n    CNContactStore *contactStore = [[CNContactStore alloc] init];\n\n    // åˆ›å»ºè·å–é€šä¿¡å½•çš„è¯·æ±‚å¯¹è±¡\n    // æ‹¿åˆ°æ‰€æœ‰æ‰“ç®—è·å–çš„å±æ€§å¯¹åº”çš„key\n    NSArray *keys = @[CNContactGivenNameKey, CNContactFamilyNameKey, CNContactPhoneNumbersKey];\n\n    // åˆ›å»ºCNContactFetchRequestå¯¹è±¡\n    CNContactFetchRequest *request = [[CNContactFetchRequest alloc] initWithKeysToFetch:keys];\n\n    // éå†æ‰€æœ‰çš„è”ç³»äºº\n    [contactStore enumerateContactsWithFetchRequest:request error:nil usingBlock:^(CNContact * _Nonnull contact, BOOL * _Nonnull stop) {\n        // è·å–è”ç³»äººçš„å§“å\n        NSString *lastname = contact.familyName;\n        NSString *firstname = contact.givenName;\n        NSLog(@&quot;%@ %@&quot;, lastname, firstname);\n\n        // è·å–è”ç³»äººçš„ç”µè¯å·ç \n        NSArray *phoneNums = contact.phoneNumbers;\n        for (CNLabeledValue *labeledValue in phoneNums) {\n            // è·å–ç”µè¯å·ç çš„KEY\n            NSString *phoneLabel = labeledValue.label;\n\n            // è·å–ç”µè¯å·ç \n            CNPhoneNumber *phoneNumer = labeledValue.value;\n            NSString *phoneValue = phoneNumer.stringValue;\n\n            NSLog(@&quot;%@ %@&quot;, phoneLabel, phoneValue);\n            AddressBookContact *contact = [[AddressBookContact alloc] init];\n            contact.name = [NSString stringWithFormat:@&quot;%@%@&quot;,lastname,firstname];\n            person.phone = phoneValue;\n            [_addressBookArray addObject:contact];\n        }\n    }];\n</code></pre><p>æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„æ–¹æ³•æ‹¿åˆ°çš„æ•°æ®æ˜¯ä¸€ä¸ªå…ƒç´ æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰æ•°æ®æ¨¡å‹<code>AddressBookContact</code>çš„æ•°ç»„, æ‰€æœ‰çš„æ•°æ®éƒ½åœ¨è¿™ä¸€ä¸ªæ•°ç»„é‡Œé¢, æ²¡æœ‰åˆ†ç»„, ç›¸åŒé¦–å­—æ¯çš„è”ç³»äººæŒ‰ç…§åˆ›å»ºæ—¶é—´æ¥æ’åº.æ˜¾ç„¶è¿™æ ·çš„æ•°æ®æ˜¯ä¸èƒ½æ»¡è¶³æˆ‘ä»¬ä¸šåŠ¡éœ€æ±‚çš„. å¸¸è§çš„æ˜¯æŒ‰ç…§é¦–å­—æ¯æ¥åˆ†ç»„, ä¸‹é¢æˆ‘ä»¬å°±ä»¥iOS8ä¸ºä¾‹æ¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„æ’åºå’Œå±•ç¤º, ç±»ä¼¼äºç³»ç»Ÿé€šè®¯å½•åˆ—è¡¨.</p>\n<h3 id=\"é€šè®¯å½•åˆ†ç»„\"><a href=\"#é€šè®¯å½•åˆ†ç»„\" class=\"headerlink\" title=\"é€šè®¯å½•åˆ†ç»„\"></a>é€šè®¯å½•åˆ†ç»„</h3><pre><code>//è¿”å›åŒ…å«åˆ†ç»„ä¿¡æ¯å’Œåˆ†ç»„åé€šè®¯å½•æ•°æ®çš„å­—å…¸\n+ (NSDictionary *)dealDataWithArray:(NSArray *)array {\n    if (array.count == 0) {\n        return nil;\n    }\n    NSMutableArray *titleArray = [NSMutableArray arrayWithCapacity:0];\n    NSMutableArray *data = [NSMutableArray arrayWithCapacity:0];\n    NSMutableArray * tmpArray = [[NSMutableArray alloc]init];\n    for (NSInteger i =0; i &lt;27; i++) {\n        //ç»™ä¸´æ—¶æ•°ç»„åˆ›å»º27ä¸ªæ•°ç»„ä½œä¸ºå…ƒç´ ï¼Œç”¨æ¥å­˜æ”¾A-Zå’Œ#å¼€å¤´çš„è”ç³»äºº\n        NSMutableArray * array = [[NSMutableArray alloc]init];\n        [tmpArray addObject:array];\n    }\n\n    for (AddressBookContact * model in array) {\n        //AddressModeæ˜¯è”ç³»äººçš„æ•°æ®æ¨¡å‹\n        //è½¬åŒ–ä¸ºé¦–æ‹¼éŸ³å¹¶å–é¦–å­—æ¯\n        NSString * nickName = [AddressBookDataManager returnFirstWordWithString:model.name];\n\n        if (nickName.length == 0) {\n            //å¦‚æœä¸æ˜¯ï¼Œå°±æ”¾åˆ°æœ€åä¸€ä¸ªä»£è¡¨#çš„æ•°ç»„\n            NSMutableArray * array =[tmpArray lastObject];\n            [array addObject:model];\n        } else {\n            int firstWord = [nickName characterAtIndex:0];\n            //æŠŠå­—å…¸æ”¾åˆ°å¯¹åº”çš„æ•°ç»„ä¸­å»\n\n            if (firstWord &gt;= 65 &amp;&amp; firstWord &lt;= 90) {\n                //å¦‚æœé¦–å­—æ¯æ˜¯A-Zï¼Œç›´æ¥æ”¾åˆ°å¯¹åº”æ•°ç»„\n                NSMutableArray * array = tmpArray[firstWord - 65];\n                [array addObject:model];\n\n            } else {\n                //å¦‚æœä¸æ˜¯ï¼Œå°±æ”¾åˆ°æœ€åä¸€ä¸ªä»£è¡¨#çš„æ•°ç»„\n                NSMutableArray * array =[tmpArray lastObject];\n                [array addObject:model];\n            }\n        }\n    }\n\n    //æ­¤æ—¶æ•°æ®å·²æŒ‰é¦–å­—æ¯æ’åºå¹¶åˆ†ç»„\n    //éå†æ•°ç»„ï¼Œåˆ æ‰ç©ºæ•°ç»„\n    for (NSMutableArray * mutArr in tmpArray) {\n        //å¦‚æœæ•°ç»„ä¸ä¸ºç©ºå°±æ·»åŠ åˆ°æ•°æ®æºå½“ä¸­\n        if (mutArr.count != 0) {\n            [data addObject:mutArr];\n            AddressBookContact * model = mutArr[0];\n            NSString * nickName = [AddressBookDataManager returnFirstWordWithString:model.name];\n\n            if (nickName.length != 0) {\n                int firstWord = [nickName characterAtIndex:0];\n                //å–å‡ºå…¶ä¸­çš„é¦–å­—æ¯æ”¾å…¥åˆ°æ ‡é¢˜æ•°ç»„ï¼Œæš‚æ—¶ä¸è€ƒè™‘éA-Zçš„æƒ…å†µ\n                if (firstWord &gt;= 65 &amp;&amp; firstWord &lt;= 90) {\n                    [titleArray addObject:nickName];\n                }\n            }\n        }\n    }\n\n    //åˆ¤æ–­æ˜¯å¦éœ€è¦åŠ #\n    if (titleArray.count != data.count) {\n        [titleArray addObject:@&quot;#&quot;];\n    }\n\n    NSDictionary *dic = @{@&quot;source&quot;: [AddressBookDataManager sortedArray:data],\n                          @&quot;title&quot;: titleArray};\n    return dic;\n}\n\n+ (NSArray *)sortedArray:(NSArray *)data {\n    NSMutableArray *sortedArray = [NSMutableArray array];\n    for (NSInteger index = 0; index &lt; data.count; index++) {\n        NSMutableArray *personArrayForSection = data[index];\n        NSArray *temp = [personArrayForSection sortedArrayUsingComparator:^NSComparisonResult(AddressBookContact * contact1, AddressBookContact * contact2) {\n            return [contact1.name compare:contact2.name];\n        }];\n        sortedArray[index] = temp;\n    }\n    return sortedArray;\n}\n\n\n#pragma mark - Tool\n+ (BOOL)objectIsNull:(id)obj{\n    return ([obj isKindOfClass:[NSNull class]] || obj == nil) ? YES : NO;\n}\n\n+ (NSString*)strNoNull:(id)str{\n    if ([AddressBookDataManager objectIsNull:str]) {\n        str = @&quot;&quot;;\n    }\n    return str;\n}\n\n//æ±‰å­—è½¬æ‹¼éŸ³å¹¶å–å¾—å…³é”®å­—\n+ (NSString *)returnFirstWordWithString:(NSString *)str {\n    NSMutableString * mutStr = [NSMutableString stringWithString:str];\n\n    //å°†mutSträ¸­çš„æ±‰å­—è½¬åŒ–ä¸ºå¸¦éŸ³æ ‡çš„æ‹¼éŸ³ï¼ˆå¦‚æœæ˜¯æ±‰å­—å°±è½¬æ¢ï¼Œå¦‚æœä¸æ˜¯åˆ™ä¿æŒåŸæ ·ï¼‰\n    CFStringTransform((__bridge CFMutableStringRef)mutStr, NULL, kCFStringTransformMandarinLatin, NO);\n    //å°†å¸¦æœ‰éŸ³æ ‡çš„æ‹¼éŸ³è½¬æ¢æˆä¸å¸¦éŸ³æ ‡çš„æ‹¼éŸ³ï¼ˆè¿™ä¸€æ­¥æ˜¯ä»ä¸Šä¸€æ­¥çš„åŸºç¡€ä¸Šæ¥çš„ï¼Œæ‰€ä»¥è¿™ä¸¤å¥è¯ä¸€å¥ä¹Ÿä¸èƒ½å°‘ï¼‰\n    CFStringTransform((__bridge CFMutableStringRef)mutStr, NULL, kCFStringTransformStripCombiningMarks, NO);\n    if (mutStr.length &gt; 0) {\n        //å…¨éƒ¨è½¬æ¢ä¸ºå¤§å†™    å–å‡ºé¦–å­—æ¯å¹¶è¿”å›\n        NSString * res = [[mutStr uppercaseString] substringToIndex:1];\n        return res;\n    } else {\n        return @&quot;&quot;;\n    }\n}\n\n//å‰”é™¤æ‰‹æœºå·ä¸­çš„ç‰¹æ®Šå­—ç¬¦\n+ (NSString *)filterPhoneFormate:(NSString *)phoneNumber {\n    NSCharacterSet *notAllowedChars = [[NSCharacterSet characterSetWithCharactersInString:@&quot;0123456789&quot;] invertedSet];\n    NSString *resultString = [[phoneNumber componentsSeparatedByCharactersInSet:notAllowedChars] componentsJoinedByString:@&quot;&quot;];\n    return resultString;\n}\n</code></pre><p><img src=\"http://ohjcp7fjy.bkt.clouddn.com/IMG_0277.PNG\" alt=\"æ•°æ®æˆªå›¾\"><br>è‡³æ­¤, æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç¬¦åˆä¸šåŠ¡éœ€æ±‚çš„é€šè®¯å½•é¡µé¢, å·²ç»æŒ‰ç…§å§“åé¦–å­—æ¯åˆ†ç»„, å¹¶ä¸”å®ç°äº†å¿«é€Ÿç´¢å¼•. æˆ‘çš„é€šè®¯å½•æµ‹è¯•æ•°æ®æœ‰2700+æ¡æ•°æ®, æ¯æ¬¡é€šè®¯å½•æ‰“å¼€éƒ½è¦è€—æ—¶ç‰¹åˆ«ä¹…, ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ, è¿™æ—¶å°±ä¼šæƒ³åˆ°è¦ä¼˜åŒ–ä¸€ä¸‹ä»£ç äº†.</p>\n<h3 id=\"æ€§èƒ½ä¼˜åŒ–\"><a href=\"#æ€§èƒ½ä¼˜åŒ–\" class=\"headerlink\" title=\"æ€§èƒ½ä¼˜åŒ–\"></a>æ€§èƒ½ä¼˜åŒ–</h3><p>è¯´é“æ€§èƒ½ä¼˜åŒ–, é¦–å…ˆå°±è¦è¿›è¡Œæ€§èƒ½åˆ†æ, çŸ¥é“æˆ‘ä»¬éœ€è¦ä¼˜åŒ–çš„åœ°æ–¹åœ¨å“ªé‡Œ. Xcodeæä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„åˆ†æå·¥å…·Instruments, å…·ä½“ä¸€äº›å¸¸è§çš„åˆ†æå¯ä»¥å‚è€ƒ<a href=\"http://hchong.net/2017/04/13/Xcode%E7%A5%9E%E5%99%A8-Instruments%E5%A4%A7%E6%B3%95/\">è¿™é‡Œ</a>.<br>æˆ‘ä»¬ä¸»è¦ä½¿ç”¨Instrumentsçš„Time ProFileræ¥åˆ†æä¸€ä¸‹, ç©¶ç«Ÿè€—æ—¶çš„ä»£ç åœ¨å“ªé‡Œ, å¹¶ä¸”åšä¸€ä¸‹ä¼˜åŒ–.<br><img src=\"http://ww1.sinaimg.cn/large/006tNc79gy1ffevnuzt0zj30pg0e2wfj.jpg\" alt=\"è€—æ—¶æ“ä½œ\"><br><img src=\"http://ww2.sinaimg.cn/large/006tNc79gy1ffevnwtfovj317m0q440f.jpg\" alt=\"è€—æ—¶æ“ä½œçš„å…·ä½“ä»£ç \"><br>é€šè¿‡åˆ†æå¯ä»¥å‘ç°, ç›®å‰çš„ç“¶é¢ˆä¸»è¦å‡ºç°åœ¨æ±‰å­—è½¬æ‹¼éŸ³å–é¦–å­—æ¯çš„æ–¹æ³•ä¸Š, å¯ä»¥å‘ç°æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯<code>CFStringTransform</code>ç±», æˆ‘ä»¬å…ˆå¯¹è¿™ä¸ªè¿›è¡Œä¸€äº›ä¼˜åŒ–</p>\n<pre><code>//æ±‰å­—é¦–å­—æ¯\n+ (NSString *)returnFirstWordWithString:(NSString *)str {\n    NSMutableString *mutableString = [NSMutableString stringWithString:str];\n    CFStringTransform((CFMutableStringRef)mutableString, NULL, kCFStringTransformToLatin, false);\n    mutableString = (NSMutableString *)[mutableString stringByFoldingWithOptions:NSDiacriticInsensitiveSearch locale:[NSLocale currentLocale]];\n    NSString *string = [mutableString stringByReplacingOccurrencesOfString:@&quot;&#39;&quot; withString:@&quot;&quot;];\n    return [[string uppercaseString] substringToIndex:1];\n}\n</code></pre><p>å†ä½¿ç”¨Instrumentsåˆ†æå‘ç°, å¹¶æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„æ•ˆæœ. åˆ†æä¸€ä¸‹å‘ç°, å‘ç°æˆ‘ä»¬å–é¦–å­—æ¯ä¸»è¦æœ‰ä¸¤ä¸ªç”¨é€”.ä¸€ä¸ªæ˜¯æŠŠå…¨éƒ¨é€šè®¯å½•æŒ‰ç…§é¦–å­—æ¯çš„æ–¹å¼è¿›è¡Œåˆ†ç»„, å¦ä¸€ä¸ªç”¨é€”å°±æ˜¯ä¸ºäº†åœ¨åˆ—è¡¨é¡µç”Ÿæˆç´¢å¼•æ•°ç»„. </p>\n<h4 id=\"æ–¹æ¡ˆä¸€\"><a href=\"#æ–¹æ¡ˆä¸€\" class=\"headerlink\" title=\"æ–¹æ¡ˆä¸€\"></a>æ–¹æ¡ˆä¸€</h4><p>ä¸€ç•ªæŸ¥æ‰¾å‘ç°, ç³»ç»Ÿé’ˆå¯¹è¿™ç§æƒ…å†µå·²ç»æœ‰APIå¯ä¾›æˆ‘ä»¬è°ƒç”¨äº†(è´´å¿ƒçš„Apple).ä¸‹é¢å°±è¦ä»‹ç»æœ¬æ¬¡ä¼˜åŒ–çš„å…³é”®ç±»<code>UILocalizedIndexedCollation</code>.</p>\n<blockquote>\n<p>è¿”å›ä¼ å…¥objectå¯¹è±¡æŒ‡å®šselectoråœ¨[UILocalizedIndexedCollation currentCollation]ä¸­çš„åŒ¹é…çš„ç´¢å¼•<br>// Returns the index of the section that will contain the object.<br>// selector must not take any arguments and return an NSString.</p>\n<pre><code>- (NSInteger)sectionForObject:(id)object collationStringSelector:(SEL)selector;\n</code></pre><p>è¿”å›ä¼ å…¥objectå¯¹è±¡æŒ‡å®šselectoråœ¨[UILocalizedIndexedCollation currentCollation]ä¸­çš„åŒ¹é…çš„ç´¢å¼•<br>// Returns the index of the section that will contain the object.<br>// selector must not take any arguments and return an NSString.</p>\n<pre><code>- (NSInteger)sectionForObject:(id)object collationStringSelector:(SEL)selector;\n-\n</code></pre></blockquote>\n<pre><code>+ (NSDictionary *)dealDataWithArray:(NSArray *)array {\n\n    // 1.åˆå§‹åŒ–ä¸€ä¸ªç´¢å¼•ï¼Œæ ¹æ®ä¸åŒå›½å®¶è¯­è¨€ï¼Œä¼šåˆå§‹åŒ–å‡ºä¸åŒçš„ç´¢å¼•ï¼Œä¸­æ–‡çš„æ˜¯â€œA~Z,#â€\n    UILocalizedIndexedCollation *collation = [UILocalizedIndexedCollation currentCollation];\n    // 2.è·å–ç´¢å¼•çš„æ•°é‡ï¼Œå¹¶åˆå§‹åŒ–å¯¹åº”æ•°é‡çš„ç©ºæ•°ç»„ï¼Œç”¨äºå­˜æ”¾ç­›é€‰æ•°æ®\n    NSInteger sectionTitlesCount = [[collation sectionTitles] count];\n    NSMutableArray *sectionArrays = [NSMutableArray arrayWithCapacity:sectionTitlesCount];\n    for (int i = 0; i &lt; sectionTitlesCount; i++) {\n        NSMutableArray *sectionArray = [NSMutableArray arrayWithCapacity:1];\n        [sectionArrays addObject:sectionArray];\n    }\n    // 3.æ’åºçš„æ–¹æ³•\n    SEL sorter = ABPersonGetSortOrdering() == kABPersonSortByFirstName ? NSSelectorFromString(@&quot;name&quot;) : NSSelectorFromString(@&quot;name&quot;);\n    // 4.åˆ†ç»„\n    for (AddressBookContact *contact in array) {\n        //è·å–nameå±æ€§çš„å€¼æ‰€åœ¨çš„ä½ç½®ï¼Œæ¯”å¦‚&quot;å°ç™½é¼ &quot;ï¼Œé¦–å­—æ¯æ˜¯Xï¼Œåœ¨A~Zä¸­æ’ç¬¬23ï¼ˆç¬¬ä¸€ä½æ˜¯0ï¼‰ï¼ŒsectionNumberå°±ä¸º23\n        NSInteger sectionNumber = [collation sectionForObject:contact collationStringSelector:sorter];\n        //æŠŠnameä¸ºâ€œå°ç™½é¼ â€çš„contactåŠ å…¥newSectionsArrayä¸­çš„ç¬¬23ä¸ªæ•°ç»„ä¸­å»\n        NSMutableArray *sectionNames = sectionArrays[sectionNumber];\n        [sectionNames addObject:contact];\n    }\n    //5.æ’åº\n    for (NSInteger i = 0; i &lt; sectionTitlesCount; i++) {\n        NSMutableArray *personArrayForSection = sectionArrays[i];\n        NSArray *sortedPersonArrayForSection = [collation sortedArrayFromArray:personArrayForSection collationStringSelector:@selector(name)];\n        sectionArrays[i] = sortedPersonArrayForSection;\n    }\n\n    NSArray *titleArray = [[[UILocalizedIndexedCollation currentCollation] sectionTitles] copy];\n    NSDictionary *dic = @{@&quot;source&quot;: sectionArrays,\n                          @&quot;title&quot;: titleArray};\n    return dic;\n    }\n</code></pre><p>åˆ†æä¸€ä¸‹ä¸Šé¢çš„ä»£ç , æˆ‘ä»¬ä½¿ç”¨<code>UILocalizedIndexedCollation</code>æä¾›çš„æ–¹æ³•, æŒ‰ç…§A-Zæ¥å¿«è¯»æ•°æ®è¿›è¡Œåˆ†ç»„, å¹¶ä¸”æ’åº. ç´¢å¼•æ•°ç»„ä¹Ÿç›´æ¥ä½¿ç”¨<code>UILocalizedIndexedCollation</code>è‡ªå¸¦çš„æ–¹æ³•.è¿™æ ·å°±é¿å…äº†å¤§é‡çš„å¾ªç¯éå†å’Œå–å§“åæ‹¼éŸ³é¦–å­—æ¯é€ æˆçš„å¼€é”€.</p>\n<p>ç›¸åº”çš„, åˆ—è¡¨å±•ç¤ºé¡µé¢çš„titleå’Œç´¢å¼•ä¹Ÿè¦åšè°ƒæ•´</p>\n<pre><code>- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section{\n    if ([self.dataArray[section] count] == 0 || self.dataArray.count == 0) {\n        return 0.01;\n    }\n    return 22;\n}\n\n// æŒ‰ç…§ç´¢å¼•ä¸ªæ•°é…ç½®tableviewåŒºæ•°\n- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {\n    if ([self.dataArray[section] count] == 0 || self.dataArray.count == 0) {\n        return @&quot;&quot;;\n    }\n    return [[UILocalizedIndexedCollation currentCollation] sectionTitles][section];\n}\n\n// é…ç½®ç´¢å¼•å†…å®¹ï¼Œå°±æ˜¯é€šè®¯å½•ä¸­å³ä¾§çš„é‚£ä¸€åˆ—â€œA~Zã€#â€\n- (NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView {\n    return [[UILocalizedIndexedCollation currentCollation] sectionIndexTitles];\n}\n\n// ç´¢å¼•ç‚¹å‡»å“åº”\n- (NSInteger)tableView:(UITableView *)tableView sectionForSectionIndexTitle:(NSString *)title atIndex:(NSInteger)index {\n    return [[UILocalizedIndexedCollation currentCollation] sectionForSectionIndexTitleAtIndex:index];\n}\n</code></pre><p>è‡³æ­¤ä¼˜åŒ–ç»“æŸ, å†é€šè¿‡Time Profileræ¥åˆ†æä¸‹å‘ç°æ—¶é—´å·²ç»ä»5.8såˆ°2.6s, ä¼˜åŒ–æ•ˆæœè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„. 2.6sä¸­æ•°ç»„æ’åºå¤§æ¦‚è€—æ—¶1.7s, æˆ‘ä»¬ä½¿ç”¨çš„å·²ç»æ˜¯ç³»ç»Ÿæ¨èçš„æ’åºæ–¹æ³•, é™¤éé‡‡ç”¨å¤æ‚åº¦æ›´ä½çš„æ’åºç®—æ³•, è¿™é‡Œå·²ç»æ²¡åŠæ³•å†ä¼˜åŒ–äº†.</p>\n<p>è¿™é‡Œæœ‰ä¸‰ç§ä¸åŒå®ç°çš„æ’åºæ–¹æ³•, æµ‹è¯•äº†ä¸‹, ä¼˜åŒ–æ•ˆæœéƒ½ä¸æ˜æ˜¾</p>\n<pre><code>+ (NSArray *)sortedArray:(NSArray *)data {\n    //        NSMutableArray *sortedArray = [NSMutableArray array];\n    //        //å¯¹æ¯ä¸ªsectionä¸­çš„æ•°ç»„æŒ‰ç…§nameå±æ€§æ’åº\n    //        for (NSInteger index = 0; index &lt; data.count; index++) {\n    //            NSMutableArray *personArrayForSection = data[index];\n    //            NSSortDescriptor *nameDesc    = [NSSortDescriptor sortDescriptorWithKey:@&quot;name&quot;\n    //                                                                          ascending:YES];\n    //            NSArray *descriptorArray = @[nameDesc];//æ­¤å¤„å¯ä»¥æŒ‰ç…§å¤šä¸ªæ’åºè§„åˆ™, é¡ºåºæ¯”è¾ƒ, æ¯”è¾ƒçš„é¡ºåºå°±æ˜¯æ•°ç»„é‡Œé¢å…ƒç´ çš„é¡ºåº\n    //\n    //            NSArray *temp = [personArrayForSection sortedArrayUsingDescriptors: descriptorArray];\n    //            sortedArray[index] = temp;\n    //        }\n\n\n    NSMutableArray *sortedArray = [NSMutableArray array];\n    for (NSInteger index = 0; index &lt; data.count; index++) {\n        NSMutableArray *personArrayForSection = data[index];\n        NSArray *temp = [personArrayForSection sortedArrayUsingComparator:^NSComparisonResult(AddressBookContact * contact1, AddressBookContact * contact2) {\n            return [contact1.name compare:contact2.name];\n        }];\n        sortedArray[index] = temp;\n    }\n\n\n\n    //    UILocalizedIndexedCollation *collation = [UILocalizedIndexedCollation currentCollation];\n    //    NSMutableArray *sortedArray = [NSMutableArray array];\n    //    //å¯¹æ¯ä¸ªsectionä¸­çš„æ•°ç»„æŒ‰ç…§nameå±æ€§æ’åº\n    //    for (NSInteger index = 0; index &lt; data.count; index++) {\n    //        NSMutableArray *personArrayForSection = data[index];\n    //        NSArray *sortedPersonArrayForSection = [collation sortedArrayFromArray:personArrayForSection collationStringSelector:@selector(name)];\n    //        sortedArray[index] = sortedPersonArrayForSection;\n    //    }\n    return sortedArray;\n}\n</code></pre><h4 id=\"æ–¹æ¡ˆäºŒ\"><a href=\"#æ–¹æ¡ˆäºŒ\" class=\"headerlink\" title=\"æ–¹æ¡ˆäºŒ\"></a>æ–¹æ¡ˆäºŒ</h4><p>è‡³äºç¬¬äºŒç§ä¼˜åŒ–æ–¹æ¡ˆ, æˆ‘ä»¬éœ€è¦å€ŸåŠ©æœ¬åœ°åŒ–å­˜å‚¨SQLæ¥å®ç°. å½“ç„¶å¦‚æœæ²¡æœ‰æœ¬åœ°åŒ–å­˜å‚¨çš„éœ€æ±‚, åˆ™æ–¹æ¡ˆä¸€å°±å¤Ÿç”¨äº†.</p>\n<p>å› ä¸ºä¸»è¦è€—æ—¶çš„æ“ä½œåœ¨åˆ†ç»„å’Œæ’åºä¸Š, æˆ‘ä¹ˆä½ å¯ä»¥åˆ©ç”¨SQLçš„å¿«é€ŸæŸ¥æ‰¾å’Œæ’åºæ¥å®ç°.åœ¨3000æ¡å·¦å³æ•°æ®æ—¶å’Œæ–¹æ¡ˆä¸€çš„æ•ˆæœå·®ä¸å¤š, æ­¤å¤„å°±ä¸å†è´´ä»£ç äº†, åªæä¾›ä¸€ä¸‹æ€è·¯.</p>\n<h2 id=\"ç›‘å¬é€šè®¯å½•æ•°æ®å˜åŒ–\"><a href=\"#ç›‘å¬é€šè®¯å½•æ•°æ®å˜åŒ–\" class=\"headerlink\" title=\"ç›‘å¬é€šè®¯å½•æ•°æ®å˜åŒ–\"></a>ç›‘å¬é€šè®¯å½•æ•°æ®å˜åŒ–</h2><p>æ­¤å¤„ä»ç„¶åŒºåˆ†iOS8å’ŒiOS9çš„API, ä½†æ˜¯éœ€è¦æ³¨æ„ç›‘å¬è§„åˆ™:<br>1.å½“Appæ´»è·ƒï¼ˆå‰å°+åå°åŒ…æ´»æœŸé—´ï¼‰çš„æ—¶å€™, å½“é€šè®¯å½•ä¿®æ”¹çš„æ—¶å€™, ä¼šæ”¶åˆ°é€šçŸ¥.<br>2.å½“Appä¸æ´»è·ƒçš„æ—¶å€™(æŒ‚èµ·çš„æ—¶å€™), Appæ”¶ä¸åˆ°é€šçŸ¥; è€Œæ˜¯, å½“Appåˆ°å‰å°çš„æ—¶å€™æ”¶åˆ°å»¶è¿Ÿçš„é€šçŸ¥.<br>3.å½“Appè¢«æ€æ‰è¿›ç¨‹å, Appæ”¶ä¸åˆ°é€šçŸ¥; å½“å†æ¬¡è¿›å…¥Appæ—¶ä¾ç„¶æ²¡æœ‰é€šçŸ¥.</p>\n<h3 id=\"ios8ç›‘å¬é€šè®¯å½•å˜åŒ–\"><a href=\"#ios8ç›‘å¬é€šè®¯å½•å˜åŒ–\" class=\"headerlink\" title=\"ios8ç›‘å¬é€šè®¯å½•å˜åŒ–\"></a>ios8ç›‘å¬é€šè®¯å½•å˜åŒ–</h3><pre><code>@property (nonatomic, assign) ABAddressBookRef addresBook;\n\n- (instancetype)init {\n    self = [super init];\n    if (self) {\n        _addresBook = ABAddressBookCreateWithOptions(NULL, NULL);\n        ABAddressBookRegisterExternalChangeCallback(_addresBook, addressBookChanged, nil);\n    }\n    return self;\n}\n\n//ç›‘å¬é€šè®¯å½•å˜åŒ–\nvoid addressBookChanged(ABAddressBookRef addressBook, CFDictionaryRef info, void *context) {\n    NSLog(@&quot;é€šè®¯å½•å˜åŒ–å•¦....&quot;);\n    //    VC1 *myVC = (__bridge VC1 *)context;\n    //    [myVC getPersonOutOfAddressBook];\n}\n\n- (void)dealloc {\n    NSLog(@&quot;%@-------------------dealloc&quot;, self);\n    ABAddressBookUnregisterExternalChangeCallback(_addresBook, addressBookChanged, nil);\n}\n</code></pre><h3 id=\"ios9ç›‘å¬é€šè®¯å½•å˜åŒ–\"><a href=\"#ios9ç›‘å¬é€šè®¯å½•å˜åŒ–\" class=\"headerlink\" title=\"ios9ç›‘å¬é€šè®¯å½•å˜åŒ–\"></a>ios9ç›‘å¬é€šè®¯å½•å˜åŒ–</h3><pre><code>- (instancetype)init {\n    self = [super init];\n    if (self) {\n        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(addressBookDidChange:) name:CNContactStoreDidChangeNotification object:nil];\n\n    }\n    return self;\n}\n\n\n- (void)dealloc {\n    NSLog(@&quot;%@-------------------dealloc&quot;, self);\n    [[NSNotificationCenter defaultCenter] removeObserver:self name:CNContactStoreDidChangeNotification object:nil];\n}\n\n- (void)addressBookDidChange:(NSNotification*)notification{\n    NSLog(@&quot;é€šè®¯å½•å˜åŒ–å•¦....&quot;);\n}\n</code></pre><p>å‚è€ƒæ–‡æ¡£:</p>\n<p>1.<a href=\"http://www.jianshu.com/p/47189c71543b\" target=\"_blank\" rel=\"noopener\">iOS9ä¸‹å…¨æ–°çš„é€šè®¯å½•æ¡†æ¶</a></p>\n<p>2.<a href=\"http://www.jianshu.com/p/94e8444f1ad6\" target=\"_blank\" rel=\"noopener\">iOSå­¦ä¹ ç¬”è®°29-ç³»ç»ŸæœåŠ¡(äºŒ)é€šè®¯å½•</a></p>\n<p>3.<a href=\"http://www.jianshu.com/p/6acad14cf3c9\" target=\"_blank\" rel=\"noopener\">iOSé€šè®¯å½•å¼€å‘</a></p>\n<p>4.<a href=\"https://developer.apple.com/reference/contacts/cncontact\" target=\"_blank\" rel=\"noopener\">CNContactå®˜æ–¹æ–‡æ¡£</a></p>\n<p>5.<a href=\"https://developer.apple.com/reference/addressbook\" target=\"_blank\" rel=\"noopener\">AddressBookå®˜æ–¹æ–‡æ¡£</a></p>\n<p>6.<a href=\"http://www.bijishequ.com/detail/320846?p=\" target=\"_blank\" rel=\"noopener\">UILocalizedIndexedCollationâ€”â€”æœ¬åœ°åŒ–ç´¢å¼•æ’åº</a></p>\n<p>7.<a href=\"http://www.olinone.com/?p=131\" target=\"_blank\" rel=\"noopener\">iOSå¼€å‘ä¸­å¦‚ä½•å¿«é€Ÿçš„å®ç°æ±‰å­—è½¬æ‹¼éŸ³</a></p>\n<p>8.<a href=\"http://www.jianshu.com/p/d0a752bcda3f\" target=\"_blank\" rel=\"noopener\">iOSé€šè®¯å½•æ•°æ®å˜åŒ–ç›‘å¬</a></p>\n","categories":["åŸºç¡€çŸ¥è¯†","æ€§èƒ½ä¼˜åŒ–"],"tags":["é€šè®¯å½•"]},{"title":"Xcodeç¥å™¨-Instrumentså¤§æ³•","url":"http://hchong.net/2017/04/13/Xcodeç¥å™¨-Instrumentså¤§æ³•/","content":"<h1 id=\"Xcodeè°ƒè¯•ç¥å™¨-Instrumentså¤§æ³•\"><a href=\"#Xcodeè°ƒè¯•ç¥å™¨-Instrumentså¤§æ³•\" class=\"headerlink\" title=\"Xcodeè°ƒè¯•ç¥å™¨-Instrumentså¤§æ³•\"></a>Xcodeè°ƒè¯•ç¥å™¨-Instrumentså¤§æ³•</h1><p>ç”¨æˆ·ä½“éªŒ, æ˜¯æ¯ä¸ªAppå¼€å‘å¾ˆé‡è¦çš„ç‚¹, æ˜¯æ¯ä¸ªç¨‹åºçŒ¿éƒ½åº”è¯¥æ—¶åˆ»è¢«æƒ³åˆ°çš„ç‚¹. å¥½çš„ç”¨æˆ·ä½“éªŒå°±å¿…ç„¶è¦æœ‰å¥½çš„æ€§èƒ½. Xcodeç»™æˆ‘ä»¬æä¾›äº†å¼ºå¤§çš„æ€§èƒ½åˆ†æå·¥å…·Instruments.</p>\n<p>æ‰“å¼€Xcode, é€‰æ‹©Xcode -&gt; Open Developer Toolæ‰“å¼€å¦‚ä¸‹ç•Œé¢<br><img src=\"http://ww1.sinaimg.cn/large/006tNc79gy1ffevnub9j1j316s0q2wfd.jpg\" alt=\"Instrumentsé¦–ç•Œé¢\"><br>è¿™é‡Œæˆ‘ä»¬ä¸»è¦ä»‹ç»ä¸‰ä¸ªå¸¸ç”¨çš„å·¥å…·Core Animation(æ£€æµ‹å¸§ç‡), Leaks(å†…å­˜æ³„æ¼), Time Profiler(æ£€æŸ¥è€—æ—¶æ“ä½œ)</p>\n<h2 id=\"Core-Animation\"><a href=\"#Core-Animation\" class=\"headerlink\" title=\"Core Animation\"></a>Core Animation</h2><p>Core Animationä¸»è¦ç”¨æ¥è¯„ä¼°å±å¹•æ¸²æŸ“æ—¶çš„å¸§ç‡, å¸§ç‡ä¸€èˆ¬æ¥è¯´è¶Šæ¥è¿‘60å°±è¶Šæµç•…, å½“ä½äº40æ—¶, å°±ä¼šæ„Ÿè§‰åˆ°æ˜æ˜¾çš„å¡é¡¿.<br><img src=\"http://ww1.sinaimg.cn/large/006tNbRwgy1ffffmifexvj310w0nxwfn.jpg\" alt=\"å¸§ç‡\"><br>åœ¨å±å¹•çš„ä¸‹æ–¹æœ‰ä¸€ä¸ªDebug OptionsæŒ‰é’®, ç‚¹å‡»å±•å¼€èœå•ä¸­å¯ä»¥é€‰æ‹©ä¸€äº›æ›´åŠ å…·ä½“çš„UIæ€§èƒ½çš„æ£€æµ‹,<br><img src=\"http://ww3.sinaimg.cn/large/006tNbRwgy1ffffp2z37cj30xk0i474v.jpg\" alt=\"é€‰é¡¹\"><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›é€‰é¡¹ï¼Œæ¥ç›‘æµ‹æ›´åŠ å…·ä½“çš„å›¾å½¢æ€§èƒ½, å…·ä½“å‚è€ƒå¦‚ä¸‹:</p>\n<ul>\n<li><code>Color Blended Layers</code>ï¼Œè¿™ä¸ªé€‰é¡¹é€‰é¡¹åŸºäºæ¸²æŸ“ç¨‹åº¦å¯¹å±å¹•ä¸­çš„æ··åˆåŒºåŸŸè¿›è¡Œç»¿åˆ°çº¢çš„é«˜äº®æ˜¾ç¤ºï¼Œè¶Šçº¢è¡¨ç¤ºæ€§èƒ½è¶Šå·®ï¼Œä¼šå¯¹å¸§ç‡ç­‰æŒ‡æ ‡é€ æˆè¾ƒå¤§çš„å½±å“ã€‚çº¢è‰²é€šå¸¸æ˜¯ç”±äºå¤šä¸ªåŠé€æ˜å›¾å±‚å åŠ å¼•èµ·ã€‚</li>\n<li><code>Color Hits Green and Misses Red</code>ï¼Œå½“ UIView.layer.shouldRasterize = YES æ—¶ï¼Œè€—æ—¶çš„å›¾ç‰‡ç»˜åˆ¶ä¼šè¢«ç¼“å­˜ï¼Œå¹¶å½“åšä¸€ä¸ªç®€å•çš„æ‰å¹³å›¾ç‰‡æ¥å‘ˆç°ã€‚è¿™æ—¶å€™ï¼Œå¦‚æœé¡µé¢çš„å…¶ä»–åŒºå—(æ¯”å¦‚ UITableViewCell çš„å¤ç”¨)ä½¿ç”¨ç¼“å­˜ç›´æ¥å‘½ä¸­ï¼Œå°±æ˜¾ç¤ºç»¿è‰²ï¼Œåä¹‹ï¼Œå¦‚æœä¸å‘½ä¸­ï¼Œè¿™æ—¶å°±æ˜¾ç¤ºçº¢è‰²ã€‚çº¢è‰²è¶Šå¤šï¼Œæ€§èƒ½è¶Šå·®ã€‚å› ä¸ºæ …æ ¼åŒ–ç”Ÿæˆç¼“å­˜çš„è¿‡ç¨‹æ˜¯æœ‰å¼€é”€çš„ï¼Œå¦‚æœç¼“å­˜èƒ½è¢«å¤§é‡å‘½ä¸­å’Œæœ‰æ•ˆä½¿ç”¨ï¼Œåˆ™æ€»ä½“ä¸Šä¼šé™ä½å¼€é”€ï¼Œåä¹‹åˆ™æ„å‘³ç€è¦é¢‘ç¹ç”Ÿæˆæ–°çš„ç¼“å­˜ï¼Œè¿™ä¼šè®©æ€§èƒ½é—®é¢˜é›ªä¸ŠåŠ éœœã€‚</li>\n<li><code>Color Copied Images</code>ï¼Œå¯¹äº GPU ä¸æ”¯æŒçš„è‰²å½©æ ¼å¼çš„å›¾ç‰‡åªèƒ½ç”± CPU æ¥å¤„ç†ï¼ŒæŠŠè¿™æ ·çš„å›¾ç‰‡æ ‡ä¸ºè“è‰²ã€‚è“è‰²è¶Šå¤šï¼Œæ€§èƒ½è¶Šå·®ã€‚å› ä¸ºï¼Œæˆ‘ä»¬ä¸å¸Œæœ›åœ¨æ»šåŠ¨è§†å›¾çš„æ—¶å€™ï¼Œç”± CPU æ¥å¤„ç†å›¾ç‰‡ï¼Œè¿™æ ·å¯èƒ½ä¼šå¯¹ä¸»çº¿ç¨‹é€ æˆé˜»å¡ã€‚</li>\n<li><code>Color Non-Standard Surface Formats</code>, ä¸æ ‡å‡†çš„è¡¨é¢é¢œè‰²æ ¼å¼.</li>\n<li><code>Color Immediately</code>ï¼Œé€šå¸¸ Core Animation Instruments ä»¥æ¯æ¯«ç§’ 10 æ¬¡çš„é¢‘ç‡æ›´æ–°å›¾å±‚è°ƒè¯•é¢œè‰²ã€‚å¯¹æŸäº›æ•ˆæœæ¥è¯´ï¼Œè¿™æ˜¾ç„¶å¤ªæ…¢äº†ã€‚è¿™ä¸ªé€‰é¡¹å°±å¯ä»¥ç”¨æ¥è®¾ç½®æ¯å¸§éƒ½æ›´æ–°ï¼ˆå¯èƒ½ä¼šå½±å“åˆ°æ¸²æŸ“æ€§èƒ½ï¼Œè€Œä¸”ä¼šå¯¼è‡´å¸§ç‡æµ‹é‡ä¸å‡†ï¼Œæ‰€ä»¥ä¸è¦ä¸€ç›´éƒ½è®¾ç½®å®ƒï¼‰ã€‚</li>\n<li><code>Color Misaligned Images</code>ï¼Œè¿™ä¸ªé€‰é¡¹æ£€æŸ¥äº†å›¾ç‰‡æ˜¯å¦è¢«ç¼©æ”¾ï¼Œä»¥åŠåƒç´ æ˜¯å¦å¯¹é½ã€‚è¢«æ”¾ç¼©çš„å›¾ç‰‡ä¼šè¢«æ ‡è®°ä¸ºé»„è‰²ï¼Œåƒç´ ä¸å¯¹é½åˆ™ä¼šæ ‡æ³¨ä¸ºç´«è‰²ã€‚é»„è‰²ã€ç´«è‰²è¶Šå¤šï¼Œæ€§èƒ½è¶Šå·®ã€‚</li>\n<li><code>Color Offscreen-Rendered Yellow</code>ï¼Œè¿™ä¸ªé€‰é¡¹ä¼šæŠŠé‚£äº›ç¦»å±æ¸²æŸ“çš„å›¾å±‚æ˜¾ç¤ºä¸ºé»„è‰²ã€‚é»„è‰²è¶Šå¤šï¼Œæ€§èƒ½è¶Šå·®ã€‚è¿™äº›æ˜¾ç¤ºä¸ºé»„è‰²çš„å›¾å±‚å¾ˆå¯èƒ½éœ€è¦ç”¨ shadowPath æˆ–è€… shouldRasterize æ¥ä¼˜åŒ–ã€‚</li>\n<li><code>Color Compositing Fast Path Blue</code>ï¼Œè¿™ä¸ªé€‰é¡¹ä¼šæŠŠä»»ä½•ç›´æ¥ä½¿ç”¨ OpenGL ç»˜åˆ¶çš„å›¾å±‚æ˜¾ç¤ºä¸ºè“è‰²ã€‚è“è‰²è¶Šå¤šï¼Œæ€§èƒ½è¶Šå¥½ã€‚å¦‚æœä»…ä»…ä½¿ç”¨ UIKit æˆ–è€… Core Animation çš„ APIï¼Œé‚£ä¹ˆä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚å¦‚æœä½¿ç”¨ GLKView æˆ–è€… CAEAGLLayerï¼Œé‚£å¦‚æœä¸æ˜¾ç¤ºè“è‰²å—çš„è¯å°±æ„å‘³ç€ä½ æ­£åœ¨å¼ºåˆ¶ CPU æ¸²æŸ“é¢å¤–çš„çº¹ç†ï¼Œè€Œä¸æ˜¯ç»˜åˆ¶åˆ°å±å¹•ã€‚</li>\n<li><code>Flash Updated Regions</code>ï¼Œè¿™ä¸ªé€‰é¡¹ä¼šæŠŠé‡ç»˜çš„å†…å®¹æ˜¾ç¤ºä¸ºé»„è‰²ã€‚ä¸è¯¥å‡ºç°çš„é»„è‰²è¶Šå¤šï¼Œæ€§èƒ½è¶Šå·®ã€‚é€šå¸¸æˆ‘ä»¬å¸Œæœ›åªæ˜¯æ›´æ–°çš„éƒ¨åˆ†è¢«æ ‡è®°å®Œé»„è‰²ã€‚</li>\n</ul>\n<p>ä½¿ç”¨æ—¶è¦æ³¨æ„Xcodeå’Œæ‰‹æœºç³»ç»Ÿçš„ç‰ˆæœ¬å·åŒ¹é…, å¦åˆ™ä¼šå‡ºç°è®¾å¤‡off line æ— æ³•è¢«é€‰ä¸­çš„æƒ…å†µ.</p>\n<h2 id=\"Leaks\"><a href=\"#Leaks\" class=\"headerlink\" title=\"Leaks\"></a>Leaks</h2><p>å…³äºå†…å­˜æ–¹é¢çš„ç›‘æ§, æœ‰<code>Leaks</code>ç”¨æ¥æ£€æµ‹å†…å­˜æ³„æ¼, <code>Zombies</code>ç”¨æ¥æ£€æµ‹åƒµå°¸å¯¹è±¡. å…³äºå†…å­˜æ³„æ¼å¸¸è§çš„å‡ ç§æƒ…å†µ, <a href=\"http://www.jianshu.com/p/d465831aebbf\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a>è®²çš„ç‰¹åˆ«æ¸…æ™°å’Œå…¨é¢.</p>\n<h2 id=\"Time-Profiler\"><a href=\"#Time-Profiler\" class=\"headerlink\" title=\"Time Profiler\"></a>Time Profiler</h2><p>è¿™ä¸ªä¸»è¦æ˜¯ç”¨æ¥ç»Ÿè®¡å„ä¸ªæ–¹æ³•æ¶ˆè€—çš„æ—¶é—´.<br><img src=\"http://ww4.sinaimg.cn/large/006tNbRwgy1fffhjy18vij31kw0zi44c.jpg\" alt=\"Time Profiler\"><br>å¦‚å›¾æ‰€ç¤º, å±•ç¤ºå„ä¸ªæ–¹æ³•å æ¯”å’Œæ¶ˆè€—çš„æ—¶é—´, ä»¥msä¸ºå•ä½. å³ä¾§èœå•æ ä¸€èˆ¬ä¼šæ˜¾ç¤ºæœ€è€—æ—¶çš„ä¸€äº›æ“ä½œ, å¦‚æœä¸€èˆ¬å‰é¢çš„å°å›¾ç‰‡æ˜¯é»‘è‰²çš„è¯, é‚£å°±è¯´æ˜è¿™éƒ¨åˆ†ä»£ç , å ç”¨äº†å¤§é‡çš„ç³»ç»Ÿæ—¶é—´, æ˜¯éœ€è¦è¿«åˆ‡ä¼˜åŒ–çš„.</p>\n<p>åœ¨ä¸‹æ–¹çš„call Treeä¸­æœ‰ä¸€äº›é€‰é¡¹èœå•, é€‰æ‹©ä¸åŒçš„èœå•, å¯ä»¥æŸ¥çœ‹ä¸åŒçš„çŠ¶æ€, å…·ä½“å¦‚ä¸‹:</p>\n<ul>\n<li><code>Separate byt Thread</code>ï¼ˆå»ºè®®é€‰æ‹©ï¼‰ï¼šé€šè¿‡çº¿ç¨‹åˆ†ç±»æ¥æŸ¥çœ‹é‚£äº›çº¯ç§å ç”¨CPUæœ€å¤šã€‚</li>\n<li><code>Invert Call Tree</code>ï¼ˆä¸å»ºè®®é€‰æ‹©ï¼‰ï¼šè°ƒç”¨æ ‘å€’è¿”è¿‡æ¥ï¼Œå°†ä¹ æƒ¯æ€§çš„ä»æ ¹å‘ä¸‹ä¸€çº§ä¸€çº§çš„æ˜¾ç¤ºï¼Œå¦‚é€‰ä¸Šå°±ä¼šè¿”è¿‡æ¥ä»æœ€åº•å±‚è°ƒç”¨å‘ä¸€çº§ä¸€çº§çš„æ˜¾ç¤ºã€‚å¦‚æœæƒ³è¦æŸ¥çœ‹é‚£ä¸ªæ–¹æ³•è°ƒç”¨ä¸ºæœ€æ·±æ—¶ä½¿ç”¨ä¼šæ›´æ–¹ä¾¿äº›ã€‚</li>\n<li><code>Hide Missing Symbols</code>ï¼ˆå»ºè®®é€‰æ‹©ï¼‰ï¼šéšè—ä¸¢å¤±çš„ç¬¦å·ï¼Œæ¯”å¦‚åº”ç”¨æˆ–è€…ç³»ç»Ÿçš„dSYMæ–‡ä»¶æ‰¾ä¸åˆ°çš„è¯ï¼Œåœ¨è¯¦æƒ…é¢æ¿ä¸Šæ˜¯çœ‹ä¸åˆ°æ–¹æ³•åçš„ï¼Œåªèƒ½çœ‹ä¸€äº›è¯»ä¸æ˜çš„åå…­è¿›å€¼ï¼Œæ‰€ä»¥å¯¹æˆ‘ä»¬æ¥è¯´æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå»æ‰äº†ä¼šä½¿é˜…è¯»æ›´æ¸…æ¥šäº›ã€‚</li>\n<li><code>Hide System Libraries</code>ï¼ˆå»ºè®®é€‰æ‹©ï¼‰ï¼šé€‰ä¸Šå®ƒåªä¼šå±•ç¤ºä¸åº”ç”¨æœ‰å…³çš„ç¬¦å·ä¿¡æ¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬åªå…³å¿ƒè‡ªå·±å†™çš„ä»£ç æ‰€éœ€çš„è€—æ—¶ï¼Œè€Œä¸å…³å¿ƒç³»ç»Ÿåº“çš„CPUè€—æ—¶ã€‚</li>\n<li><code>Flatten Recursion</code>ï¼ˆä¸€èˆ¬ä¸é€‰ï¼‰ï¼šé€‰ä¸Šå®ƒä¼šå°†è°ƒç”¨æ ˆé‡Œé€’å½’å‡½æ•°ä½œä¸ºä¸€ä¸ªå…¥å£ã€‚</li>\n<li><code>Top Functions</code>ï¼ˆå¯é€‰ï¼‰ï¼šé€‰ä¸Šå®ƒä¼šå°†æœ€è€—æ—¶çš„å‡½æ•°é™åºæ’åˆ—ï¼Œè€Œè¿™ç§è€—æ—¶æ˜¯ç´¯åŠ çš„ï¼Œæ¯”å¦‚Aè°ƒç”¨äº†Bï¼Œé‚£ä¹ˆAçš„è€—æ—¶æ•°æ˜¯ä¼šåŒ…å«Bçš„è€—æ—¶æ•°ã€‚</li>\n</ul>\n<h2 id=\"å…¶ä»–é—®é¢˜\"><a href=\"#å…¶ä»–é—®é¢˜\" class=\"headerlink\" title=\"å…¶ä»–é—®é¢˜\"></a>å…¶ä»–é—®é¢˜</h2><p>åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ä¹Ÿé‡åˆ°ä¸€äº›é—®é¢˜, è®°å½•ä¸‹æ¥.</p>\n<h3 id=\"è®¾å¤‡ç°è‰²ä¸å¯é€‰\"><a href=\"#è®¾å¤‡ç°è‰²ä¸å¯é€‰\" class=\"headerlink\" title=\"è®¾å¤‡ç°è‰²ä¸å¯é€‰\"></a>è®¾å¤‡ç°è‰²ä¸å¯é€‰</h3><p>è§£å†³æ–¹æ¡ˆï¼šé‡å¯<br>æˆ‘æœ€ç»ˆçš„è§£å†³æ­¥éª¤ï¼š<br>1.æ‹”æ‰iPhoneçš„USBçº¿ï¼Œé‡å¯iPhone<br>2.å…³é—­Xcodeå’ŒInstruments<br>3.é‡æ–°è¿æ¥iPhoneåˆ°Macä¸Š<br>4.é‡å¯Xcodeå¹¶å¯åŠ¨Profile<br>5.æˆåŠŸ</p>\n<p>å‚è€ƒè¿™ä¸ª<a href=\"http://stackoverflow.com/questions/32878283/unable-to-profile-app-on-device-with-ios-9-0-1-using-xcode-7-7-0-1-or-7-1-beta\" target=\"_blank\" rel=\"noopener\">å¸–å­</a>.</p>\n<h3 id=\"Time-Profileræ— æ³•å®šä½åˆ°ä»£ç \"><a href=\"#Time-Profileræ— æ³•å®šä½åˆ°ä»£ç \" class=\"headerlink\" title=\"Time Profileræ— æ³•å®šä½åˆ°ä»£ç \"></a>Time Profileræ— æ³•å®šä½åˆ°ä»£ç </h3><p>Time Profliter éƒ½æ˜¯åœ°å€ç¬¦å·ï¼Œå¾€æ·±é‡Œä¹Ÿä¸€ç›´æ˜¯åœ°å€ç¬¦å·ï¼Œæ ¹æœ¬æ²¡æ³•åˆ¤æ–­æ˜¯å“ªäº›ä»£ç çš„æ‰§è¡Œæ—¶é—´, æ— æ³•å®šä½ä»£ç </p>\n<p>è§£å†³æ–¹æ³•:</p>\n<ol>\n<li>Project-&gt;Build Settings-&gt;Debug Information Format é€‰æ‹©DWARF with dSYM File</li>\n<li>Profileè¦åœ¨debugæ¨¡å¼ä¸‹è¿è¡Œ, BuildConfigurationè¦é€‰æ‹©debug.</li>\n</ol>\n<hr>\n<p>å‚è€ƒèµ„æ–™:</p>\n<p>1.<a href=\"https://blog.leancloud.cn/2835/\" target=\"_blank\" rel=\"noopener\">iOS æ€§èƒ½ä¼˜åŒ–ï¼šInstruments å·¥å…·çš„æ•‘å‘½ä¸‰æ‹›</a></p>\n<p>2.<a href=\"http://www.jianshu.com/p/439e158b44de\" target=\"_blank\" rel=\"noopener\">Instrumentsæ€§èƒ½ä¼˜åŒ–-Core Animation</a></p>\n<p>3.<a href=\"http://www.samirchen.com/use-instruments/\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨ Instruments åš iOS ç¨‹åºæ€§èƒ½è°ƒè¯•</a></p>\n<p>4.<a href=\"http://www.jianshu.com/p/d465831aebbf\" target=\"_blank\" rel=\"noopener\">å…³äºå†…å­˜æ³„æ¼ï¼Œè¿˜æœ‰å“ªäº›æ˜¯ä½ ä¸çŸ¥é“çš„ï¼Ÿ</a></p>\n<p>5.<a href=\"http://www.jianshu.com/p/c0aa12d91f05\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨Instrumentså®šä½iOSåº”ç”¨çš„Memory Leaks</a></p>\n<p>6.<a href=\"http://www.jianshu.com/p/21d29be26479\" target=\"_blank\" rel=\"noopener\">instrument Time Profileræ€»ç»“</a></p>\n<p>7.<a href=\"http://stackoverflow.com/questions/32878283/unable-to-profile-app-on-device-with-ios-9-0-1-using-xcode-7-7-0-1-or-7-1-beta\" target=\"_blank\" rel=\"noopener\">Unable to profile app on device with iOS 9.0.1 using Xcode 7, 7.0.1 or 7.1 beta</a></p>\n","categories":["åŸºç¡€çŸ¥è¯†"],"tags":["åŸºç¡€çŸ¥è¯†","è°ƒè¯•"]},{"title":"iOSé€†å‘-ä¸‹è½½å†å²ç‰ˆæœ¬","url":"http://hchong.net/2017/04/06/iOSé€†å‘-ä¸‹è½½å†å²ç‰ˆæœ¬/","content":"<h1 id=\"iOSé€†å‘-ä¸‹è½½å†å²ç‰ˆæœ¬\"><a href=\"#iOSé€†å‘-ä¸‹è½½å†å²ç‰ˆæœ¬\" class=\"headerlink\" title=\"iOSé€†å‘-ä¸‹è½½å†å²ç‰ˆæœ¬\"></a>iOSé€†å‘-ä¸‹è½½å†å²ç‰ˆæœ¬</h1><p>ç›®å‰App Storeé»˜è®¤åªèƒ½ä¸‹è½½æœ€æ–°ç‰ˆ, è€Œæˆ‘ä»¬çš„ç›®çš„æ˜¯è¦èƒ½å¤Ÿä¸‹è½½åˆ°App Storeä¸­çš„å†å²ç‰ˆ, é‚£å°±è¦å€ŸåŠ©ä¸€äº›å…¶ä»–å·¥å…·æ¥å®ç°.<br>åŸç†å¦‚ä¸‹:</p>\n<blockquote>\n<p>é€šè¿‡Charlesæ¥è·å–ä¸‹è½½é“¾æ¥, é€šè¿‡åˆ†ææ¥å¾—åˆ°æ¯ä¸ªç‰ˆæœ¬åœ¨è¿æ¥ä¸­æ‰€å¯¹åº”çš„å­—æ®µ, å†é€šè¿‡Charlesæ¥æˆªå–å’Œæ›¿æ¢ä¸‹è½½é“¾æ¥ä¸­çš„å‚æ•°, æ¥è¾¾åˆ°ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Appçš„ç›®çš„.</p>\n<h2 id=\"å‡†å¤‡å·¥ä½œ\"><a href=\"#å‡†å¤‡å·¥ä½œ\" class=\"headerlink\" title=\"å‡†å¤‡å·¥ä½œ\"></a>å‡†å¤‡å·¥ä½œ</h2><ol>\n<li>å®‰è£…Charles.</li>\n<li>ä¸ºäº†Charlesèƒ½å¤ŸæŠ“å–HTTPSç±»å‹çš„é“¾æ¥, éœ€è¦å®‰è£…Charlesçš„è¯ä¹¦, å‚è€ƒè¿™é‡Œ<a href=\"http://hchong.net/2017/02/28/Charles%E6%8A%93%E5%8C%85Https%E8%AF%B7%E6%B1%82/\">CharlesæŠ“åŒ…HTTPSè¯·æ±‚</a>.</li>\n</ol>\n</blockquote>\n<h2 id=\"å¼€å§‹æŠ“åŒ…\"><a href=\"#å¼€å§‹æŠ“åŒ…\" class=\"headerlink\" title=\"å¼€å§‹æŠ“åŒ…\"></a>å¼€å§‹æŠ“åŒ…</h2><p>å®‰è£…äº†Charlesä¹‹å, æˆ‘ä»¬å°±å¯ä»¥è·å–Appçš„ä¸‹è½½é“¾æ¥äº†, å¹¶ä¸”ä»ä¸­åˆ†æå‡ºæˆ‘ä»¬éœ€è¦çš„å‚æ•°.</p>\n<h3 id=\"è·å–APPçš„ä¸‹è½½é“¾æ¥å’Œç‰ˆæœ¬å·å¯¹åº”çš„å‚æ•°\"><a href=\"#è·å–APPçš„ä¸‹è½½é“¾æ¥å’Œç‰ˆæœ¬å·å¯¹åº”çš„å‚æ•°\" class=\"headerlink\" title=\"è·å–APPçš„ä¸‹è½½é“¾æ¥å’Œç‰ˆæœ¬å·å¯¹åº”çš„å‚æ•°\"></a>è·å–APPçš„ä¸‹è½½é“¾æ¥å’Œç‰ˆæœ¬å·å¯¹åº”çš„å‚æ•°</h3><p>ä¸‹é¢æˆ‘ä»¬ä»¥iOSä¸Šä¸€æ¬¾æ¯”è¾ƒå¥½ç”¨çš„çœ‹ä¹¦è½¯ä»¶<em>è¿½ä¹¦ç¥å™¨</em>ä¸ºä¾‹æ¥è¯´æ˜.</p>\n<ol>\n<li>é¦–å…ˆæ‰“å¼€ITunesæ¥ä¸‹è½½è½¯ä»¶, ç‚¹å‡»ä¸‹è½½, é€šè¿‡Charlesæ¥ç¡®å®šä¸‹è½½è½¯ä»¶çš„é“¾æ¥.<br><img src=\"https://ww3.sinaimg.cn/large/006tKfTcgy1fel4m4udoqj30zo0iwdhx.jpg\" alt=\"ç‚¹å‡»ä¸‹è½½\"></li>\n<li>åœ¨Charlesä¸­è§‚å¯Ÿå‘ç°, ITunesä½¿ç”¨çš„æ˜¯HTTPSé“¾æ¥, æ— æ³•ç›´æ¥æŸ¥çœ‹requestå†…å®¹.<br><img src=\"https://ww2.sinaimg.cn/large/006tKfTcgy1fel4n5nyodj30f707e74h.jpg\" alt=\"æ— æ³•ç›´æ¥æŸ¥çœ‹HTTPS\"></li>\n<li>æˆ‘ä»¬é€šè¿‡æ·»åŠ SSL Proxyingæ¥æŸ¥çœ‹requestå†…å®¹, å¹¶ä¸”é€šè¿‡ç»™é“¾æ¥åŠ æ–­ç‚¹æ¥è¯¦ç»†åˆ†æè¯·æ±‚çš„å‚æ•°.</li>\n</ol>\n<p><img src=\"https://ww3.sinaimg.cn/large/006tKfTcgy1fel4nt57ykj30b60jr74v.jpg\" alt=\"æ·»åŠ SSL Proxy\"><br><img src=\"https://ww1.sinaimg.cn/large/006tKfTcgy1fel4ogb7edj30bg0lkab0.jpg\" alt=\"æ·»åŠ æ–­ç‚¹\"></p>\n<h3 id=\"æ¨æ–­æ§åˆ¶ç‰ˆæœ¬çš„å…³é”®å­—æ®µ\"><a href=\"#æ¨æ–­æ§åˆ¶ç‰ˆæœ¬çš„å…³é”®å­—æ®µ\" class=\"headerlink\" title=\"æ¨æ–­æ§åˆ¶ç‰ˆæœ¬çš„å…³é”®å­—æ®µ\"></a>æ¨æ–­æ§åˆ¶ç‰ˆæœ¬çš„å…³é”®å­—æ®µ</h3><p>è§‚å¯Ÿresponse, æ¨æ–­<code>softwareVersionExternalIdentifiers</code>å±•ç¤ºçš„æ˜¯å…¨éƒ¨çš„APPå¯¹åº”çš„ç‰ˆæœ¬, <code>softwareVersionExternalIdentifier</code>æ˜¯ç”¨æ¥æ ‡è®°å½“å‰ç‰ˆæœ¬.<em>è¿½ä¹¦ç¥å™¨</em>ç›®å‰çš„ç‰ˆæœ¬æ ‡è®°æ˜¯<code>820420814</code><br><img src=\"https://ww2.sinaimg.cn/large/006tKfTcgy1fel4pltv74j310w0qjq5r.jpg\" alt=\"å­—æ®µåˆ†æ\"><br>é€šè¿‡åœ¨requestä¸­æœç´¢<code>820420814</code>å‘ç°,<code>appExtVrsId</code>æ˜¯æ¥æ ‡è®°è¦ä¸‹è½½å“ªä¸ªç‰ˆæœ¬.<br><img src=\"https://ww2.sinaimg.cn/large/006tKfTcgy1fel4p2c1jqj30be08wwew.jpg\" alt=\"æ¨æ–­å…³é”®å­—\"></p>\n<h3 id=\"ä¿®æ”¹Requestå‚æ•°ä¸‹è½½å†å²ç‰ˆæœ¬\"><a href=\"#ä¿®æ”¹Requestå‚æ•°ä¸‹è½½å†å²ç‰ˆæœ¬\" class=\"headerlink\" title=\"ä¿®æ”¹Requestå‚æ•°ä¸‹è½½å†å²ç‰ˆæœ¬\"></a>ä¿®æ”¹Requestå‚æ•°ä¸‹è½½å†å²ç‰ˆæœ¬</h3><p>æˆ‘ä»¬åœ¨<code>softwareVersionExternalIdentifiers</code>ä¸­ä»»é€‰ä¸€ä¸ªç‰ˆæœ¬å·, æ­¤å¤„æˆ‘ä»¥<code>819147298</code>ä¸ºä¾‹</p>\n<ol>\n<li>åˆ é™¤åˆšæ‰ä¸‹è½½å¥½çš„è½¯ä»¶, é‡æ–°ä¸‹è½½.</li>\n<li>å› ä¸ºæˆ‘ä»¬åœ¨ä¸‹è½½é“¾æ¥ä¸­åŠ çš„æœ‰æ–­ç‚¹, å†æ¬¡ä¸‹è½½æ—¶Charlesä¼šåœåœ¨æ–­ç‚¹çš„ä½ç½®</li>\n<li>ç‚¹å‡»<code>Edit Request</code>æ¥ç¼–è¾‘<code>appExtVrsId</code>å­—æ®µ<br><img src=\"https://ww1.sinaimg.cn/large/006tKfTcgy1fel4qg1avyj30yf0o60v0.jpg\" alt=\"Edit Request\"></li>\n<li>æ‰§è¡Œæ–­ç‚¹, ç»§ç»­ä¸‹è½½.</li>\n<li>åœ¨ITunesä¸­çœ‹åˆ°æ›´æ–°çš„æ ‡å¿—è¯´æ˜ä¸‹è½½æˆåŠŸ<br><img src=\"https://ww1.sinaimg.cn/large/006tNbRwgy1fel4komzx2j30p00c8t9i.jpg\" alt=\"ä¸‹è½½æˆåŠŸ\"></li>\n</ol>\n<h2 id=\"è½¯ä»¶å®‰è£…\"><a href=\"#è½¯ä»¶å®‰è£…\" class=\"headerlink\" title=\"è½¯ä»¶å®‰è£…\"></a>è½¯ä»¶å®‰è£…</h2><p>é€šè¿‡ITunesæ¥å®‰è£…ä¸‹è½½å¥½çš„è½¯ä»¶åˆ°æ‰‹æœº.</p>\n<hr>\n<p>å‚è€ƒæ–‡çŒ®:<br>1.<a href=\"http://hchong.net/2017/02/28/Charles%E6%8A%93%E5%8C%85Https%E8%AF%B7%E6%B1%82/\">CharlesæŠ“åŒ…HTTPSè¯·æ±‚</a>.<br>2.<a href=\"http://www.jianshu.com/p/edfed1b1822c\" target=\"_blank\" rel=\"noopener\">iOSç§˜ç±-ä¸‹è½½å†å²ç‰ˆæœ¬Appè¶…è¯¦ç»†æ•™ç¨‹</a>.</p>\n","categories":["iOSé€†å‘"],"tags":["Charles","iOSé€†å‘"]},{"title":"ä½¿ç”¨Jenkinså®ç°æŒç»­é›†æˆ","url":"http://hchong.net/2017/03/23/Jenkinsè‡ªåŠ¨åŒ–æ‰“åŒ…/","content":"<h1 id=\"ä½¿ç”¨Jenkinså®ç°æŒç»­é›†æˆ\"><a href=\"#ä½¿ç”¨Jenkinså®ç°æŒç»­é›†æˆ\" class=\"headerlink\" title=\"ä½¿ç”¨Jenkinså®ç°æŒç»­é›†æˆ\"></a>ä½¿ç”¨Jenkinså®ç°æŒç»­é›†æˆ</h1><p>ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ, æŒç»­é›†æˆæ˜¯ä¸€ç§è½¯ä»¶å¼€å‘å®è·µï¼Œå³å›¢é˜Ÿå¼€å‘æˆå‘˜ç»å¸¸é›†æˆå®ƒä»¬çš„å·¥ä½œï¼Œé€šè¿‡æ¯ä¸ªæˆå‘˜æ¯å¤©è‡³å°‘é›†æˆä¸€æ¬¡ï¼Œä¹Ÿå°±æ„å‘³ç€æ¯å¤©å¯èƒ½ä¼šå‘ç”Ÿå¤šæ¬¡é›†æˆã€‚æ¯æ¬¡é›†æˆéƒ½é€šè¿‡è‡ªåŠ¨åŒ–çš„æ„å»ºï¼ˆåŒ…æ‹¬ç¼–è¯‘ï¼Œå‘å¸ƒï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼‰æ¥éªŒè¯ï¼Œä»è€Œå°½æ—©åœ°å‘ç°é›†æˆé”™è¯¯ã€‚</p>\n<p>å¸¸è§çš„æŒç»­é›†æˆçš„å·¥å…·æœ‰<a href=\"http://jenkins-ci.org/\" target=\"_blank\" rel=\"noopener\">Jenkins</a>  <a href=\"https://travis-ci.com/\" target=\"_blank\" rel=\"noopener\">Travis</a>  <a href=\"http://hudson-ci.org/\" target=\"_blank\" rel=\"noopener\">Hudson</a>  <a href=\"https://circleci.com/\" target=\"_blank\" rel=\"noopener\">Circle</a>. ç„¶è€Œå¥½å¤šæˆ‘å¹¶æ²¡æœ‰å®è·µè¿‡, ğŸ˜‚. <a href=\"http://www.infoq.com/cn/articles/ios-code-server-jenkins-travis-fastlane\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a>æœ‰ä¸€ç¯‡æ–‡ç« , å¯¹æ¯”è®²è§£äº†ä¸»æµiOSæŒç»­åŒ–é›†æˆæ–¹æ¡ˆ, åŒ…æ‹¬äº†Xcode Server.</p>\n<p>Code review, å•å…ƒæµ‹è¯•, æ‰“åŒ…ä¸åˆ†å‘, è¿™äº›æ„æˆäº†ä¸€ä¸ªAPPå¼€å‘ç”Ÿå‘½å‘¨æœŸ. æ‰€ä»¥ä¸€ä¸ªå®Œæ•´æŒç»­åŒ–é›†æˆåº”è¯¥åŒ…å«ä»¥ä¸Šçš„è€Œå…¨éƒ¨ä¿¡æ¯, è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®²è§£ä¸€ä¸‹æ‰“åŒ…ä¸åˆ†å‘çš„æŒç»­åŒ–é›†æˆæ–¹æ¡ˆ. å…³äºæˆ‘ä»¬ä¸ºä»€ä¹ˆé€‰æ‹©Jenkins, è€Œä¸ä½¿ç”¨å…¶ä»–çš„æŒç»­åŒ–æ–¹æ¡ˆ, <a href=\"http://www.infoq.com/cn/articles/ios-code-server-jenkins-travis-fastlane\" target=\"_blank\" rel=\"noopener\">è¿™ç¯‡æ–‡ç« </a>å·²ç»è®²è§£çš„å¾ˆæ¸…æ¥šäº†. ä¸‹é¢å°±è·Ÿéšæˆ‘ä¸€æ­¥æ­¥çš„æ­å»ºJenkins, å®ç°ä¸€ä¸ªç®€å•ä½†å¼ºå¤§çš„æŒç»­åŒ–é›†æˆæ–¹æ¡ˆ. æœ¬æ–‡å‡ä»¥Jenkins2.35ä¸ºä¾‹.</p>\n<h2 id=\"å®‰è£…Jenkins\"><a href=\"#å®‰è£…Jenkins\" class=\"headerlink\" title=\"å®‰è£…Jenkins\"></a>å®‰è£…Jenkins</h2><p>é¦–å…ˆ, æˆ‘ä»¬è¦å®‰è£…Jenkins. å®‰è£…Jenkinsä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼. </p>\n<p>ç¬¬ä¸€ç§æˆ‘ä»¬å¯ä»¥ä»<a href=\"https://jenkins.io/\" target=\"_blank\" rel=\"noopener\">å®˜ç½‘</a>ä¸Šä¸‹è½½æœ€æ–°çš„pkgå®‰è£…åŒ…ã€‚</p>\n<p><img src=\"https://ws2.sinaimg.cn/large/006tKfTcgy1fh5vhnmh9bj30h80c7dgr.jpg\" alt=\"å®‰è£…æ­¥éª¤1\"></p>\n<p>ä¸€è·¯ç‚¹å‡»ç»§ç»­, ç›´åˆ°å®‰è£…æˆåŠŸä¸ºæ­¢.</p>\n<p><img src=\"https://ws2.sinaimg.cn/large/006tKfTcgy1fh5vikplwxj30hb0c5q35.jpg\" alt=\"å®‰è£…å®Œæˆ\"></p>\n<p>ç¬¬äºŒç§æ–¹å¼ä¹Ÿå¯ä»¥ä¸‹è½½<code>brew install jenkins</code>, åˆ‡æ¢åˆ°åˆ‡æ¢åˆ° <code>cd /usr/local/Cellar/jenkins/ç‰ˆæœ¬å·/libexec/jenkins.war</code>,  ç„¶åè¿è¡ŒJava -jar jenkins.warï¼Œè¿›è¡Œå®‰è£….<br>æ³¨æ„: å¦‚æœbrewæ— æ•ˆè¦å…ˆå®‰è£…homebrew, <code>ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></p>\n<p>å®‰è£…å®Œæˆå, é‡å¯ç”µè„‘, ä½ ä¼šå‘ç°å¤šäº†ä¸€ä¸ªJenkinsçš„ç”¨æˆ·, ä½†æ˜¯ä»–çš„ç™»å½•å¯†ç æˆ‘ä»¬å¹¶ä¸çŸ¥é“. æˆ‘ä»¬åº”è¯¥æ‰“å¼€<a href=\"http://localhost:8080\" target=\"_blank\" rel=\"noopener\">http://localhost:8080</a>, æ­¤æ—¶å¯ä»¥çœ‹åˆ°Jenkinsçš„åˆå§‹ç•Œé¢. </p>\n<p><img src=\"https://ws2.sinaimg.cn/large/006tKfTcgy1fh5vod9epvj30yg0jet93.jpg\" alt=\"Jenkinsåˆå§‹ç•Œé¢\"><br>æ³¨æ„, ç”±äºJenkinsæ˜¯ç”±Javaå¼€å‘çš„, æ‰€ä»¥Jenkinsçš„è¿è¡Œå¿…é¡»æ˜¯åœ¨Javaç¯å¢ƒä¸‹, å¦‚æœä½ æ‰“å¼€ç•Œé¢ä¸ºç©ºç™½çš„è¯, é‚£å°±è¯´æ˜ä½ éœ€è¦å®‰è£…Javaç¯å¢ƒäº†.</p>\n<p>æŒ‰ç…§æç¤ºï¼Œæ‰¾åˆ°/Users/Shared/Jenkins/Home/ è¿™ä¸ªç›®å½•, ç”±äºéJenkinsç”¨æˆ·æ²¡æœ‰æŸ¥çœ‹æƒé™, æ‰€ä»¥éœ€è¦æˆ‘ä»¬å³é”® -&gt; æ˜¾ç¤ºç®€ä»‹, ç»™è¿™ä¸ªæ–‡ä»¶å¤¹èµ‹äºˆè¯»å†™æƒé™. æŒ‰ç…§æç¤ºæ‰¾åˆ°<em>initialAdminPassword</em>æ–‡ä»¶, å¤åˆ¶å‡ºå¯†ç ï¼Œå°±å¯ä»¥å¡«åˆ°ç½‘é¡µä¸Šå»é‡ç½®å¯†ç äº†.</p>\n<p><img src=\"https://ws3.sinaimg.cn/large/006tKfTcgy1fh5vsrxh73j30yg0je0t5.jpg\" alt=\"é‡ç½®å¯†ç \"></p>\n<p><img src=\"https://ws4.sinaimg.cn/large/006tKfTcgy1fh5vt9bk89j30yg0jemxk.jpg\" alt=\"å¼€å§‹å®‰è£…\"></p>\n<p>ç„¶åä¸€è·¯å®‰è£…ä¸‹å», è¾“å…¥ç”¨æˆ·åï¼Œå¯†ç ï¼Œé‚®ä»¶è¿™äº›ï¼Œå°±ç®—å®‰è£…å®Œæˆäº†ã€‚</p>\n<h2 id=\"Jenkinsæ’ä»¶é…ç½®-amp-ç³»ç»Ÿè®¾ç½®\"><a href=\"#Jenkinsæ’ä»¶é…ç½®-amp-ç³»ç»Ÿè®¾ç½®\" class=\"headerlink\" title=\"Jenkinsæ’ä»¶é…ç½®&amp;ç³»ç»Ÿè®¾ç½®\"></a>Jenkinsæ’ä»¶é…ç½®&amp;ç³»ç»Ÿè®¾ç½®</h2><p>æ‰“å¼€<a href=\"http://localhost:8080\" target=\"_blank\" rel=\"noopener\">http://localhost:8080</a>é¡µé¢, æˆ‘ä»¬éœ€è¦å®‰è£…ä¸€äº›è¾…åŠ©æ’ä»¶, é€‰æ‹©<em>ç³»ç»Ÿç®¡ç†</em> -&gt; <em>ç®¡ç†æ’ä»¶</em>. ä¸‹é¢æˆ‘åˆ—ä¸€ä¸‹æˆ‘å®‰è£…åˆ°çš„ä¸€äº›å¸¸ç”¨çš„æ’ä»¶: </p>\n<ul>\n<li><p>GitLab Plugin, Gitlab Hook Plugin. ç”¨äºè¿æ¥åˆ°GitLab, å¦‚æœä½ çš„æºç åœ¨Gitlabä¸Šæ‰˜ç®¡, è¿™è¿ä¸ªæ’ä»¶å¿…é¡»è¦å®‰è£….</p>\n</li>\n<li><p>Xcode integration. è¿™ä¸ªçœ‹åå­—å°±çŸ¥é“å¿…é¡»å®‰è£…äº†.</p>\n</li>\n<li><p>Environment Injector Plugin. è‡ªå®šä¹‰å…¨å±€å˜é‡çš„æ’ä»¶, å¿…é¡»å®‰è£….</p>\n</li>\n<li><p>Keychains and Provisioning Profiles Management. ç”¨äºç®¡ç†é’¥åŒ™ä¸²å’Œæè¿°æ–‡ä»¶, å¿…é¡»å®‰è£….</p>\n</li>\n<li><p>build timeout plugin. å¦‚æœæ„å»ºè¶…æ—¶, è‡ªåŠ¨åœæ­¢Jenkinså½“å‰çš„æ„å»º, å¯é€‰.</p>\n</li>\n<li><p>Email Extension Plugin. ç”¨äºå‘é‚®ä»¶, å¯é€‰.</p>\n<h2 id=\"Jenkinsæ‰“åŒ…é…ç½®å‡†å¤‡å·¥ä½œ\"><a href=\"#Jenkinsæ‰“åŒ…é…ç½®å‡†å¤‡å·¥ä½œ\" class=\"headerlink\" title=\"Jenkinsæ‰“åŒ…é…ç½®å‡†å¤‡å·¥ä½œ\"></a>Jenkinsæ‰“åŒ…é…ç½®å‡†å¤‡å·¥ä½œ</h2></li>\n</ul>\n<p>é¦–å…ˆ, æˆ‘ä»¬éœ€è¦æ˜ç¡®åœ¨è¿™ä¸€æ­¥æˆ‘ä»¬çš„ç›®çš„: æŠŠæŒ‡å®šä»£ç çš„æŒ‡å®šåˆ†æ”¯æ‰“åŒ…ä¸ºç­¾åè¿‡çš„IPAåŒ…, å¹¶ä¸”ç”Ÿæˆä¸€ä¸ªå¯ä¾›ä¸‹è½½çš„é“¾æ¥. é‚£ä¹ˆæ˜ç¡®äº†æˆ‘ä»¬çš„ç›®çš„, æ¥ä¸‹æ¥å°±ä¸€æ­¥ä¸€æ­¥çš„æ¥å®ç°å®ƒ. æ‰“å¼€<a href=\"http://localhost:8080\" target=\"_blank\" rel=\"noopener\">http://localhost:8080</a>é¡µé¢, æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹æ–°å»ºä¸€ä¸ªæ‰“åŒ…é¡¹ç›®. ç‚¹å‡»å·¦ä¾§å·¥å…·æ <em>æ–°å»º</em>, é€‰æ‹©<em>æ„å»ºä¸€ä¸ªè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®</em>, æ³¨æ„è¿™é‡Œæœ€å¥½ä½¿ç”¨è‹±æ–‡, ä¸è¦å‡ºç°ä¸­æ–‡å’Œç‰¹æ®Šå­—ç¬¦.</p>\n<p>è¿›å…¥é¡¹ç›®é…ç½®é¡µé¢, æ¥ä¸‹æ¥æˆ‘å°†ä»<em>General</em>, <em>æºç ç®¡ç†</em>, <em>æ„å»ºè§¦å‘å™¨</em>, <em>æ„å»ºç¯å¢ƒ</em>, <em>æ„å»º</em>, å’Œ<em>æ„å»ºåæ“ä½œ</em>å‡ ä¸ªæ–¹é¢æ¥é…ç½®æ‰“åŒ…é¡¹ç›®.</p>\n<p>åœ¨é¡¹ç›®é…ç½®ä¹‹å‰, æˆ‘ä»¬éœ€è¦å…ˆé…ç½®ä¸€äº›å…¶ä»–å…¨å±€çš„å˜é‡, è¿™äº›å˜é‡åœ¨é¡¹ç›®çš„é…ç½®ä¸­ä¼šä½¿ç”¨åˆ°.</p>\n<h3 id=\"gitlabä»£ç åœ°å€é…ç½®\"><a href=\"#gitlabä»£ç åœ°å€é…ç½®\" class=\"headerlink\" title=\"gitlabä»£ç åœ°å€é…ç½®\"></a>gitlabä»£ç åœ°å€é…ç½®</h3><p>Jenkinsç³»ç»Ÿç®¡ç† -&gt; ç³»ç»Ÿè®¾ç½® -&gt; Gitlabé€‰é¡¹, å› ä¸ºæˆ‘ä»¬çš„ä»£ç æ‰˜ç®¡åœ¨gitlabä¸Šé¢, æ‰€ä»¥åœ¨è¿™é‡Œéœ€è¦é…ç½®ç›¸å…³ä¿¡æ¯. ç‚¹å‡»<em>å¢åŠ </em>. å¡«å†™ç›¸å…³ä¿¡æ¯.<br><img src=\"https://ws2.sinaimg.cn/large/006tNc79gy1fh93xkbelyj31ei0qk75f.jpg\" alt=\"gitlabåœ°å€é…ç½®\"></p>\n<p>æ³¨: è¿™é‡Œä¼šæŠ¥ä¸€ä¸ª<em>API Token for Gitlab access required</em>çš„é”™è¯¯, å¯ä»¥æš‚æ—¶å¿½ç•¥, æ˜¯å› ä¸ºgitlabä¸€èˆ¬éƒ½æ˜¯ç§æœ‰çš„ä»“åº“, Jenkinsæ²¡æœ‰è¿æ¥çš„æƒé™å¯¼è‡´çš„.</p>\n<h3 id=\"æ·»åŠ ä¸gitlabè¿æ¥çš„è¯ä¹¦\"><a href=\"#æ·»åŠ ä¸gitlabè¿æ¥çš„è¯ä¹¦\" class=\"headerlink\" title=\"æ·»åŠ ä¸gitlabè¿æ¥çš„è¯ä¹¦\"></a>æ·»åŠ ä¸gitlabè¿æ¥çš„è¯ä¹¦</h3><p>Jenkins -&gt; Credentials -&gt; Add Credentials, <a href=\"http://localhost:8080/credentials/store/system/domain/_/newCredentials\" target=\"_blank\" rel=\"noopener\">http://localhost:8080/credentials/store/system/domain/_/newCredentials</a>å¢åŠ ä¸€ä¸ªæ–°çš„è¯ä¹¦, ç”¨æ¥è¿æ¥gitlab. </p>\n<p><img src=\"https://ws2.sinaimg.cn/large/006tNc79gy1fh94ryjjgvj31kw0qngml.jpg\" alt=\"è¿æ¥gitlabçš„è¯ä¹¦\"></p>\n<p><em>kind</em> , <em>Scope</em> å’Œ <em>Private Key</em> å°±æŒ‰ç…§å¦‚å›¾æ‰€ç¤ºé€‰æ‹©å¥½. <em>UserName</em> è¡¨ç¤ºè¿™ä¸ªè¯ä¹¦çš„åå­—, <em>ID</em> è‡ªåŠ¨ç”Ÿæˆ, ç”¨æ¥æ ‡è®°è¿™ä¸ªè¯ä¹¦. <em>Description</em>æ˜¯å…³äºè¿™ä¸ªè¯ä¹¦çš„æè¿°. <em>key</em> é‚£é‡Œå¡«å†™SSHçš„Private Key, <em>Passphrase</em> é‚£é‡Œå¡«å†™ç”ŸæˆSSHæ—¶å¡«å†™çš„å¯†ç .  <a href=\"https://git-scm.com/book/zh/v1/%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84-Git-%E7%94%9F%E6%88%90-SSH-%E5%85%AC%E9%92%A5\" target=\"_blank\" rel=\"noopener\">å…³äºSSHçš„ç”³è¯·</a>.</p>\n<p>æ³¨æ„: è¿™é‡Œè®°å¾—è¦åœ¨ä½ çš„gitlabçš„Profile Settings -&gt; SSH Keysä¸­æ·»åŠ ä¸Šä¸€æ­¥ç”Ÿæˆçš„Public Key, </p>\n<h3 id=\"æ·»åŠ é’¥åŒ™ä¸²å’Œæè¿°æ–‡ä»¶\"><a href=\"#æ·»åŠ é’¥åŒ™ä¸²å’Œæè¿°æ–‡ä»¶\" class=\"headerlink\" title=\"æ·»åŠ é’¥åŒ™ä¸²å’Œæè¿°æ–‡ä»¶\"></a>æ·»åŠ é’¥åŒ™ä¸²å’Œæè¿°æ–‡ä»¶</h3><p>åœ¨Jenkins -&gt; ç³»ç»Ÿç®¡ç† -&gt; KeyChain and Provisioning Profiles Management ä¸­æ·»åŠ  keychains å’Œ Provisioning Profileæ–‡ä»¶.<br><img src=\"https://ws2.sinaimg.cn/large/006tNc79gy1fha7tvmt2uj30yg08ljrq.jpg\" alt=\"æ·»åŠ é’¥åŒ™ä¸²å’Œæè¿°æ–‡ä»¶\"></p>\n<p>åˆ†åˆ«ä¸Šä¼ keychains å’Œ Provisioning Profile.</p>\n<ul>\n<li><p>keychainsçš„è·¯å¾„åœ¨/Users/ç®¡ç†å‘˜ç”¨æˆ·å/Library/keychains/login.keychain,å½“æŠŠè¿™ä¸ªKeychainè®¾ç½®å¥½äº†ä¹‹åï¼ŒæŠŠè¿™ä¸ªKeychainæ‹·è´åˆ°/Users/Shared/Jenkins/Library/keychainsè¿™é‡Œï¼Œ(Libraryæ˜¯éšè—æ–‡ä»¶)ã€‚</p>\n</li>\n<li><p>Provisioning Profilesæ–‡ä»¶åœ¨~/Library/MobileDevice/Provisioning Profiles ç›®å½•ä¸‹, è¿™é‡Œé¢å¯èƒ½ä¼šæœ‰è®¸å¤šæè¿°æ–‡ä»¶, æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„, ä¸Šä¼ å¹¶ä¸”æ‹·è´åˆ°/Users/Shared/Jenkins/Library/MobileDeviceæ–‡ä»¶ç›®å½•ä¸‹.</p>\n</li>\n</ul>\n<p>æ³¨: å¦‚æœ Jenkins ä¸‹ä¿å­˜ keychain å’Œ Provision profile çš„ç›®å½•ä¸å­˜åœ¨å¯ä»¥æ‰‹åŠ¨åˆ›å»º. æˆ‘ä»¬å¯ä»¥é‚®ä»¶æŸ¥çœ‹è¦æ‰“åŒ…å·¥ç¨‹*.xcodeprojçš„åŒ…å†…å®¹, æŸ¥çœ‹project.pbxprojæ–‡ä»¶, é€šè¿‡æœç´¢æ‰¾åˆ°æè¿°æ–‡ä»¶çš„ID, å†åœ¨~/Library/MobileDevice/Provisioning Profilesæ–‡ä»¶å¤¹ä¸­æ ¹æ®IDæ¥æ‰¾åˆ°å…·ä½“çš„æè¿°æ–‡ä»¶.</p>\n<h3 id=\"Xcode-Builder\"><a href=\"#Xcode-Builder\" class=\"headerlink\" title=\"Xcode Builder\"></a>Xcode Builder</h3><p>åœ¨Jenkins -&gt; ç³»ç»Ÿè®¾ç½® -&gt; Xcode Builder -&gt; æ–°å¢, å¦‚ä¸‹å›¾æ‰€ç¤º.<br><img src=\"https://ws1.sinaimg.cn/large/006tNc79gy1fha9gi02fyj30nu0fz74v.jpg\" alt=\"Xcode Builder\"></p>\n<p>Keychain Nameæ˜¯è¦æ‰“åŒ…çš„è¯ä¹¦çš„åå­—, åœ¨é’¥åŒ™ä¸²ä¸­æ‰¾åˆ°è¯¥è¯ä¹¦, ç‚¹å‡»å³é”® æ˜¾ç¤ºç®€ä»‹, å¤åˆ¶è¿‡æ¥å°±å¥½.</p>\n<p>Keychain passwordæ˜¯å¼€æœºå¯†ç .</p>\n<h2 id=\"Jenkinsæ‰“åŒ…é…ç½®\"><a href=\"#Jenkinsæ‰“åŒ…é…ç½®\" class=\"headerlink\" title=\"Jenkinsæ‰“åŒ…é…ç½®\"></a>Jenkinsæ‰“åŒ…é…ç½®</h2><p><img src=\"https://ws4.sinaimg.cn/large/006tNc79gy1fha9o70e7wj31kw0t4758.jpg\" alt=\"Jenkinsæ‰“åŒ…å·¥ç¨‹çš„é…ç½®\"></p>\n<h3 id=\"General\"><a href=\"#General\" class=\"headerlink\" title=\"General\"></a>General</h3><p>é…ç½®ä¸€äº›é€šç”¨çš„é€‰é¡¹. é¡¹ç›®åç§°å’Œé¡¹ç›®æè¿°å¦‚å…¶å­—é¢æ„æ€ä¸€æ ·. <code>GitLab connection</code>æ˜¯æºç çš„åœ°å€, åœ¨å¤–é¢é…ç½®å¥½çš„é€‰é¡¹, åœ¨è¿™é‡Œå¯é€‰.</p>\n<ul>\n<li><p>èŠ‚æµæ„å»ºï¼Œé€šè¿‡è®¾ç½®æ—¶é—´æ®µå†…å…è®¸å¹¶å‘çš„æ¬¡æ•°æ¥å®ç°æ„å»ºçš„æ§åˆ¶</p>\n</li>\n<li><p>ä¸¢å¼ƒæ—§çš„æ„å»º, æŒ‰éœ€é€‰æ‹©.</p>\n</li>\n<li><p>å‚æ•°åŒ–æ„å»ºè¿‡ç¨‹, åœ¨Jenkinså¼€å§‹æ‰“åŒ…ä¹‹å‰, å¡«å†™éœ€è¦ä½ ä¼ å…¥çš„å‚æ•°.</p>\n</li>\n<li><p>å…³é—­æ„å»º, åœ¨å¿…è¦çš„æ—¶å€™å¹¶å‘æ„å»º. å¯é€‰</p>\n</li>\n</ul>\n<h2 id=\"æºç ç®¡ç†\"><a href=\"#æºç ç®¡ç†\" class=\"headerlink\" title=\"æºç ç®¡ç†\"></a>æºç ç®¡ç†</h2><p>æ ¹æ®è‡ªå·±çš„å®é™…éœ€æ±‚, ä¸ç®¡æ˜¯SVNæˆ–è€…Git. å› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯Git, åœ¨ä¸€å¼€å§‹å®‰è£…äº†Gitç®¡ç†çš„æ’ä»¶, æ‰€ä»¥è¿™é‡Œé€‰æ‹©Git.<br><img src=\"https://ws4.sinaimg.cn/large/006tNc79gy1fhab3vad6rj30tm0f3q3d.jpg\" alt=\"\"></p>\n<ol>\n<li><p>è¿™é‡Œçš„ <em>Credentials</em> å¦‚æœä½¿ç”¨çš„æ˜¯SSHæ¨¡å¼, é‚£ä¸Šé¢çš„ <em>Repository URL</em>å°±è¦ä½¿ç”¨SSHç±»å‹çš„åœ°å€. å¦‚æœæ˜¯è´¦å·å¯†ç æ¨¡å¼, é‚£ä¸Šé¢çš„æºç å°±è¦ä½¿ç”¨HTTPå½¢å¼çš„åœ°å€. ä¸¤è€…å¿…é¡»ä¿æŒä¸€è‡´.</p>\n</li>\n<li><p>æŒ‡å®šä»£ç , æˆ‘ä»¬å¯ä»¥æ‹‰å–æŒ‡å®šgitåœ°å€çš„ä»£ç . å› ä¸ºåˆ†æ”¯æ˜¯ä¸ªå˜é‡, å®ƒä¸åƒgitåœ°å€é‚£æ ·ä¸€æˆä¸å˜, æ‰€ä»¥æœ€å¥½æ˜¯å¤–éƒ¨ä¼ å…¥, é‚£å°±ç”¨åˆ°äº†å…¨å±€ç¯å¢ƒå˜é‡. </p>\n</li>\n</ol>\n<h2 id=\"æ„å»ºè§¦å‘å™¨\"><a href=\"#æ„å»ºè§¦å‘å™¨\" class=\"headerlink\" title=\"æ„å»ºè§¦å‘å™¨\"></a>æ„å»ºè§¦å‘å™¨</h2><p>æ„å»ºè§¦å‘å™¨æ˜¯è®¾ç½®è‡ªåŠ¨åŒ–æ„å»ºçš„åœ°æ–¹, å¦‚æœæƒ³è®¾ç½®è‡ªåŠ¨åŒ–æ„å»º, ä¾‹å¦‚ç›‘æµ‹åˆ°gitæœ‰æ›´æ–°å°±æ‰“åŒ…, æˆ–è€…æ¯éš”å›ºå®šæ—¶é—´å°±æ‰“ä¸€æ¬¡åŒ….</p>\n<ul>\n<li><p>Poll SCM (poll source code management) è½®è¯¢æºç ç®¡ç†. éœ€è¦è®¾ç½®æºç çš„è·¯å¾„æ‰èƒ½èµ·åˆ°è½®è¯¢çš„æ•ˆæœã€‚ä¸€èˆ¬è®¾ç½®ä¸ºç±»ä¼¼ç»“æœï¼š 0/5 æ¯5åˆ†é’Ÿè½®è¯¢ä¸€æ¬¡</p>\n</li>\n<li><p>Build periodically (å®šæ—¶build) ä¸€èˆ¬è®¾ç½®ä¸ºç±»ä¼¼ï¼š 00 20 * æ¯å¤© 20ç‚¹æ‰§è¡Œå®šæ—¶build ã€‚å½“ç„¶ä¸¤è€…çš„è®¾ç½®éƒ½æ˜¯ä¸€æ ·å¯ä»¥é€šç”¨çš„.</p>\n</li>\n</ul>\n<p><img src=\"https://ws3.sinaimg.cn/large/006tNc79gy1fhfrpjn2twj31kw0cegma.jpg\" alt=\"æ„å»ºè§¦å‘å™¨\"></p>\n<h2 id=\"æ„å»ºç¯å¢ƒ\"><a href=\"#æ„å»ºç¯å¢ƒ\" class=\"headerlink\" title=\"æ„å»ºç¯å¢ƒ\"></a>æ„å»ºç¯å¢ƒ</h2><p>æ„å»ºç¯å¢ƒ, ä¸»è¦æ˜¯å¯¹æ„å»ºæ—¶ä¸€äº›ç¯å¢ƒå˜é‡çš„é…ç½®.<br><img src=\"https://ws4.sinaimg.cn/large/006tKfTcgy1fhgvjboomwj31a60eujrv.jpg\" alt=\"æ„å»ºç¯å¢ƒ\"></p>\n<p>åœ¨è¯¥æ¨¡å—ä¸­ ä¸»è¦è®¾ç½® xcode build æ‰“åŒ…æ—¶éœ€è¦çš„ keychains å’Œ Provision Profiles é…ç½®æ–‡ä»¶ã€‚<br>å¦‚æœä¸é…ç½® å°±ä¼šä½¿ç”¨ xcode è‡ªåŠ¨çš„é…ç½®ï¼Œæ¥å»ç³»ç»Ÿä¸­æŸ¥æ‰¾ç›¸åº”çš„é…ç½®ï¼Œä¸è¿‡æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„,å°±æ˜¯é’¥åŒ™ä¸²ä¸­ï¼Œç™»é™†é’¥åŒ™ä¸²ä¸­çš„è¯ä¹¦ è¦å¤åˆ¶åˆ° ç³»ç»Ÿé’¥åŒ™ä¸²ä¸­ï¼Œå› ä¸ºjenkins è®¿é—®çš„æ˜¯ç³»ç»Ÿä¸­çš„é’¥åŒ™ä¸² è¿™æ ·åœ¨ç¬¬ä¸€æ¬¡æ‰“åŒ…çš„æ—¶å€™ï¼Œä¼šæç¤º æ˜¯å¦æˆæƒè®¿é—®é’¥åŒ™ä¸²ï¼Œç‚¹å‡»å§‹ç»ˆå…è®¸å°±å¯ä»¥äº†ã€‚</p>\n<p><img src=\"https://ws1.sinaimg.cn/large/006tNc79gy1fhjnx3dnwvj31gg0jo755.jpg\" alt=\"Keychains and Code Signing Identities\"><br><em>Keychains and Code Signing Identities</em> ä¸­çš„é€‰é¡¹, å› ä¸ºåœ¨å‰é¢å·²ç»é€‰æ‹©è¿‡äº† <em> Keychain </em> å’Œ <em>Code Signing Identity</em>åœ¨å‰é¢å·²ç»å¡«å†™è¿‡, æ­¤å¤„åªç”¨æ ¹æ®å½“å‰å·¥ç¨‹æ¥é€‰æ‹©æ­£ç¡®çš„é€‰é¡¹.</p>\n<p><img src=\"https://ws3.sinaimg.cn/large/006tNc79gy1fhjo37irdyj31g20hojs1.jpg\" alt=\"Mobile Provisioning Profiles\"></p>\n<p><em>Mobile Provisioning Profiles</em>ç”±äºå‰é¢å·²ç»å¡«å†™è¿‡æè¿°æ–‡ä»¶, æ­¤å¤„åªéœ€è¦é€‰æ‹©ä¸å½“å‰æ‰“åŒ…å·¥ç¨‹ç›¸åŒ¹é…çš„æè¿°æ–‡ä»¶.</p>\n<h2 id=\"æ„å»º\"><a href=\"#æ„å»º\" class=\"headerlink\" title=\"æ„å»º\"></a>æ„å»º</h2><p>åœ¨è¿™é‡Œæ‰è¿›å…¥äº†è‡ªåŠ¨åŒ–é›†æˆçš„å…³é”®æ­¥éª¤, å‰é¢çš„éƒ½æ˜¯ä¸€äº›å‡†å¤‡å·¥ä½œ. æˆ‘ä»¬é€‰æ‹©<em>å¢åŠ æ„å»ºæ­¥éª¤</em>, æŒ‰ç…§è‡ªå·±çš„å®é™…éœ€æ±‚, é€‰æ‹©æ‰“åŒ…è„šæœ¬çš„ç±»å‹. å› ä¸ºJenkinsè‡ªå¸¦Shellè„šæœ¬é›†æˆ, æ‰€ä»¥æ­¤å¤„æˆ‘é€‰æ‹©<em>Execute shell</em>, ä½¿ç”¨shellè„šæœ¬æ¥è¿›è¡Œæ„å»º.</p>\n<pre><code>export PATH\n#######æ‰§è¡Œè„šæœ¬å‘½ä»¤#######\nrm -rf Users/Shared/Jenkins/Library/ipa/JenkinsTest/JenkinsTest.ipa\nsecurity unlock-keychain  -p &quot;HChong&quot; ~/Library/Keychains/login.keychain\nsh /Users/Shared/Jenkins/Library/BuildScript/build.sh JenkinsTest 4c86cf7c8b4d00013c59b30b0c8d5e77\nfir p /Users/Shared/Jenkins/Library/ipa/JenkinsTest/JenkinsTest.ipa -T 4c86cf7c8b4d00013c59b30b0c8d5e77\n</code></pre><p>shellè„šæœ¬çš„å…·ä½“å†…å®¹å¦‚ä¸‹</p>\n<pre><code>#!/bin/bash\n\n#=================é¡¹ç›®è·¯å¾„é…ç½®===============\nPROJECT_PATH=&#39;/Users/Shared/Jenkins/Home/workspace/iOSPackage&#39;\nWORKSPACE_NAME=&#39;JenkinsTest.xcworkspace&#39;\nArchive_PATH=&#39;/Users/Shared/Jenkins/Library/archive&#39;\nIPA_PATH=&#39;/Users/Shared/Jenkins/Library/ipa&#39;\nPLIST_PATH=&#39;/Users/Shared/Jenkins/Home/workspace/iOSPackage/exportArchive.plist&#39;\n\n\n#===================================è„šæœ¬å¼€å§‹=================================================\n#ä½¿ç”¨å¸®åŠ©\nif [ $# == 0 ];then\necho &quot;===========================å¦‚ä½•ä½¿ç”¨=============================&quot;\necho &quot; eg: ./build [scheme] [token] &#39;ç‰ˆæœ¬æè¿°ä¸­é—´ä¸è¦ç•™ç©ºæ ¼&#39;, ä¸ä¼ tokené»˜è®¤ç”¨å½“å‰å·²ç»ç™»å½•çš„fir token&quot;\necho &quot; scheme list:&quot;\necho &quot; JenkinsTest&quot;\necho &quot; token list:&quot;\necho &quot;================================================================&quot;\nexit\nfi\n\n#update code from gitlab\ncd $PROJECT_PATH\n#git pull\n\n#update pod\n#pod install --repo-update\n#pod update\n\n#åˆ é™¤æ—§çš„ç¼–è¯‘ç›®å½•\nAPP_BUILD_LOCATION=${PROJECT_PATH}/Build/\nrm -rf ${APP_BUILD_LOCATION}\n#åˆ›å»ºdfcç›®å½•\n\n#key auth\nsecurity unlock-keychain &quot;-p&quot; &quot;é’¥åŒ™ä¸²å¯†ç &quot; &quot;/Users/hc/Library/Keychains/login.keychain&quot;\n\n#åˆ›å»ºARCHIVEç›®å½•\nmkdir -p IPA_PATH\n#Archive_NAME = $1.xcarchive\n\n#å¼€å§‹æ‰“åŒ…\ncd ${PROJECT_PATH}\npwd\n\nXCCONFIG_PATH=${PROJECT_PATH}/dfc_v2/appconfig\n\n#xcodebuild -workspace ${WORKSPACE_NAME} -scheme Enterprise -xcconfig ${XCCONFIG_PATH}/$1.xcconfig -archivePath ${Archive_PATH}/$1.xcarchive archive\nxcodebuild -workspace ${WORKSPACE_NAME} -scheme $1 -config $1 -archivePath ${Archive_PATH}/$1.xcarchive archive\necho &quot;--------------------------------------------&quot;${Archive_PATH}/$1.xcarchive\n\n#åˆ›å»ºipa\nIPA_LOCATION=${IPA_PATH}/$1\n\n#åˆ é™¤æ—§çš„ipa\nrm -rf IPA_LOCATION\nmkdir -p ${IPA_PATH}/$1\nxcodebuild -exportArchive -exportOptionsPlist ${PLIST_PATH} -archivePath ${Archive_PATH}/$1.xcarchive -exportPath ${IPA_LOCATION}\n\n\nIPA_FILE_LOCATION=${IPA_PATH}/$1/$1.ipa\n\n#æ£€æŸ¥ipaæ˜¯å¦åˆ›å»ºæˆåŠŸ\nif [ -f $IPA_FILE_LOCATION ]; then\necho &quot;ipaå·²ç»åˆ›å»º:&quot;${IPA_FILE_LOCATION}\nelse\necho &quot;æ‰“åŒ…å¤±è´¥&quot;\nexit 0\nfi\n</code></pre><h2 id=\"æ„å»ºåçš„æ“ä½œ\"><a href=\"#æ„å»ºåçš„æ“ä½œ\" class=\"headerlink\" title=\"æ„å»ºåçš„æ“ä½œ\"></a>æ„å»ºåçš„æ“ä½œ</h2><p>é¡¾åæ€ä¹‰, å°±æ˜¯æ„å»ºä¹‹åè¿›è¡Œçš„æ“ä½œ. åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©<em>Execute a set of scripts</em>, é€šè¿‡è„šæœ¬æ¥å®ç°æ„å»ºåçš„æ“ä½œ. å¸¸è§çš„æ˜¯å°†æ„å»ºçš„ç»“æœ, ä¸Šä¼ åˆ°å†…æµ‹å¹³å°æˆ–è€…å†…éƒ¨ä¸‹è½½åœ°å€. ä½†æ˜¯å¦‚æœæ„å»ºæ“ä½œçš„è„šæœ¬ä¸­åŒ…å«æœ‰è¿™ä¸€é¡¹, è¿™ä¸€ä¸ªæ­¥éª¤ä¹Ÿå°±å¯ä»¥å¿½ç•¥æ‰äº†.</p>\n<h2 id=\"é‡åˆ°çš„é—®é¢˜\"><a href=\"#é‡åˆ°çš„é—®é¢˜\" class=\"headerlink\" title=\"é‡åˆ°çš„é—®é¢˜\"></a>é‡åˆ°çš„é—®é¢˜</h2><h3 id=\"æ‰¾ä¸åˆ°Firå‘½ä»¤\"><a href=\"#æ‰¾ä¸åˆ°Firå‘½ä»¤\" class=\"headerlink\" title=\"æ‰¾ä¸åˆ°Firå‘½ä»¤\"></a>æ‰¾ä¸åˆ°Firå‘½ä»¤</h3><p><img src=\"https://ws2.sinaimg.cn/large/006tNc79gy1fhjsalg3fej31b80cewfp.jpg\" alt=\"æ‰¾ä¸åˆ°Firå‘½ä»¤\"><br>å‡ºç°å¦‚å›¾æ‰€ç¤ºçš„Error, ä¸€èˆ¬æ˜¯ç”±äºæ²¡æœ‰å®‰è£…fit-cliå‘½ä»¤å¯¼è‡´, é€šè¿‡å®‰è£…<code>gem install fir-cli -V --no-ri --no-rdoc</code>æ¥è§£å†³. å¦‚æœæç¤ºå®‰è£…æˆåŠŸ, ä½†æ˜¯è¿˜æ˜¯æŠ¥é”™çš„è¯, é‚£å°±åœ¨å®‰è£…å‘½ä»¤å‰åŠ ä¸Š<code>sudo</code>, è¦†ç›–å®‰è£…å³å¯.</p>\n<h3 id=\"fir-cli-jenkins-fir-command-not-found\"><a href=\"#fir-cli-jenkins-fir-command-not-found\" class=\"headerlink\" title=\"fir-cli jenkins fir:command not found\"></a>fir-cli jenkins fir:command not found</h3><p>è¿™ä¸ªé”™è¯¯æ˜¯ç”±äºæ²¡æœ‰å¯¼å…¥fir-cliå®‰è£…ç›®å½•å¯¼è‡´çš„, å¯ä»¥å…ˆåœ¨ç»ˆç«¯è¾“å…¥<code>echo $PATH</code>, ç„¶åæŠŠè¾“å‡ºç»“æœå¤åˆ¶ä¸‹æ¥, åœ¨Jenkins -&gt; ç³»ç»Ÿç®¡ç† -&gt; æ·»åŠ å…¨å±€å˜é‡. ç„¶ååœ¨å·¥ç¨‹æ„å»ºæ­¥éª¤, å…ˆå¼•å…¥å…¨å±€å˜é‡<code>export ${PATH}</code>. å¦‚æœæ²¡æœ‰è®¾ç½®å…¨å±€å˜é‡çš„è¯, ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨<code>export PATH=</code>echo $PATH çš„è¾“å‡ºç»“æœ``</p>\n<p><img src=\"https://ws4.sinaimg.cn/large/006tNc79gy1fhk9pyt7nsj31dg0cmwen.jpg\" alt=\"æ·»åŠ Pathå…¨å±€å˜é‡\"></p>\n<h3 id=\"è¯ä¹¦é…ç½®æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°\"><a href=\"#è¯ä¹¦é…ç½®æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°\" class=\"headerlink\" title=\"è¯ä¹¦é…ç½®æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°\"></a>è¯ä¹¦é…ç½®æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°</h3><p>No iOS profile matching â€˜xxxxxx/xxxxxxxâ€™ found:Xcode couldnâ€™t find a profile<br>matching â€˜xxxxxx/xxxxxxxâ€™.<br>Install the profile (by dragging and dropping it onto Xcodeâ€™s dock item)<br>or select a different one in the General tab of the target editor.<br>Code signing is required for product type â€˜Applicationâ€™ in SDK â€˜iOS 10.3â€™ </p>\n<p>æ˜¯å› ä¸ºArchiveæ—¶æ²¡æœ‰æ‰¾åˆ°profileå¯¼è‡´çš„. è§£å†³åŠæ³•æ˜¯, æŠŠç³»ç»Ÿçš„<code>/Users/ç”¨æˆ·å/Library/MobileDevice/Provisioning Profiles</code>æ•´ä¸ªProvisioning Profilesæ–‡ä»¶å¤¹å¤åˆ¶åˆ°<code>/Users/Shared/Jenkins/Library/MobileDevice</code>ç›®å½•ä¸‹, å¹¶ä¸”åœ¨Jenkins -&gt; Keychains and Provisioning Profiles Management çš„Provisioning Profiles Directory Pathä¸­, è®¾ç½®å¥½profileçš„å­˜æ”¾ç›®å½•.</p>\n<h3 id=\"Command-usr-bin-codesign-failed-with-exit-code-1\"><a href=\"#Command-usr-bin-codesign-failed-with-exit-code-1\" class=\"headerlink\" title=\"Command/usr/bin/codesign failed with exit code 1\"></a>Command/usr/bin/codesign failed with exit code 1</h3><h2 id=\"è¿™ä¸ªæ˜¯ç”±äºæ²¡æœ‰ç»™é’¥åŒ™ä¸²å¼€é”æƒé™å¯¼è‡´-ç¼–è¯‘ä¹‹å‰æ·»åŠ -security-unlock-keychain-p-quot-ä½ çš„å¯†ç -quot-quot-path-to-keychain-login-keychain-quot-è§£å†³\"><a href=\"#è¿™ä¸ªæ˜¯ç”±äºæ²¡æœ‰ç»™é’¥åŒ™ä¸²å¼€é”æƒé™å¯¼è‡´-ç¼–è¯‘ä¹‹å‰æ·»åŠ -security-unlock-keychain-p-quot-ä½ çš„å¯†ç -quot-quot-path-to-keychain-login-keychain-quot-è§£å†³\" class=\"headerlink\" title=\"è¿™ä¸ªæ˜¯ç”±äºæ²¡æœ‰ç»™é’¥åŒ™ä¸²å¼€é”æƒé™å¯¼è‡´, ç¼–è¯‘ä¹‹å‰æ·»åŠ  security unlock-keychain -p &quot;ä½ çš„å¯†ç &quot; &quot;path to keychain/login.keychain&quot;è§£å†³.\"></a>è¿™ä¸ªæ˜¯ç”±äºæ²¡æœ‰ç»™é’¥åŒ™ä¸²å¼€é”æƒé™å¯¼è‡´, ç¼–è¯‘ä¹‹å‰æ·»åŠ  <code>security unlock-keychain -p &quot;ä½ çš„å¯†ç &quot; &quot;path to keychain/login.keychain&quot;</code>è§£å†³.</h2><h2 id=\"å¾…è§£å†³\"><a href=\"#å¾…è§£å†³\" class=\"headerlink\" title=\"å¾…è§£å†³\"></a>å¾…è§£å†³</h2><p>ä½¿ç”¨Tomcat, æŠŠJenkinså‘å¸ƒå‡ºå», è¿™ä¸ªæ˜¯ä¸‹ä¸€æ­¥è¦è§£å†³çš„é—®é¢˜.<br>å‚è€ƒæ–‡ç« :</p>\n<p>1.<a href=\"https://runningyoung.github.io/2016/04/01/2016-04-05-jenkins2/\" target=\"_blank\" rel=\"noopener\">iOSæŒç»­é›†æˆï¼šjenkins+gitlab+è’²å…¬è‹±+é‚®ä»¶é€šçŸ¥(Part 2)</a></p>\n<p>2.<a href=\"http://www.jianshu.com/p/c69deb29720d\" target=\"_blank\" rel=\"noopener\">ä¸€æ­¥ä¸€æ­¥æ„å»ºiOSæŒç»­é›†æˆ:Jenkins+GitLab+è’²å…¬è‹±+FTP</a></p>\n<p>3.<a href=\"http://www.jianshu.com/p/e19c8327b167\" target=\"_blank\" rel=\"noopener\">Jenkins/git/KeyChains &amp; Provisioning, è®°å½•CIä¸­çš„ä¸€äº›å‘</a></p>\n<p>4.<a href=\"http://www.jianshu.com/p/e19c8327b167\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨ Jenkins æŒç»­é›†æˆ iOS é¡¹ç›®æ—¶ç¢°åˆ°çš„ä¸€äº›é—®é¢˜</a></p>\n<p>5.<a href=\"http://www.jianshu.com/p/41ecb06ae95f\" target=\"_blank\" rel=\"noopener\">æ‰‹æŠŠæ‰‹æ•™ä½ åˆ©ç”¨JenkinsæŒç»­é›†æˆiOSé¡¹ç›®</a></p>\n","categories":["è‡ªåŠ¨åŒ–æ‰“åŒ…","æŒç»­é›†æˆ"],"tags":["è‡ªåŠ¨åŒ–æ‰“åŒ…","Jenkins","æŒç»­é›†æˆ"]},{"title":"å¤šæ¸ é“åŒ…å’Œå¤šç¯å¢ƒåŒ…çš„è‡ªåŠ¨åŒ–å®ç°","url":"http://hchong.net/2017/03/12/å¤šTargetå®ç°/","content":"<h1 id=\"å¤šæ¸ é“åŒ…å’Œå¤šç¯å¢ƒåŒ…çš„è‡ªåŠ¨åŒ–å®ç°\"><a href=\"#å¤šæ¸ é“åŒ…å’Œå¤šç¯å¢ƒåŒ…çš„è‡ªåŠ¨åŒ–å®ç°\" class=\"headerlink\" title=\"å¤šæ¸ é“åŒ…å’Œå¤šç¯å¢ƒåŒ…çš„è‡ªåŠ¨åŒ–å®ç°\"></a>å¤šæ¸ é“åŒ…å’Œå¤šç¯å¢ƒåŒ…çš„è‡ªåŠ¨åŒ–å®ç°</h1><p>åœ¨Appçš„å¼€å‘è¿‡ç¨‹ä¸­, è‚¯å®šä¼šæœ‰å¾ˆå¤šåå°ç¯å¢ƒçš„åŒºåˆ†. ä¾‹å¦‚å¼€å‘æ—¶, æˆ‘ä»¬ç”¨çš„æ˜¯å¼€å‘ç¯å¢ƒ. æµ‹è¯•æ—¶ä½¿ç”¨çš„æ˜¯æµ‹è¯•ç¯å¢ƒ. åœ¨é¢„å‘å¸ƒä¹‹å‰è‚¯å®šè¦æœ‰ä¸ªç¼“å†²çš„ç¯å¢ƒ, ä¹Ÿå°±æ˜¯é¢„å‘å¸ƒç¯å¢ƒ. æœ€åè¿˜æœ‰ä¸€ä¸ªçº¿ä¸Šçš„ç¯å¢ƒ, ä¹Ÿç§°ä¸ºç”Ÿäº§ç¯å¢ƒ. é‚£ä¹ˆè¿™ä¹ˆå¤šç¯å¢ƒ, é—®é¢˜å°±æ¥äº†, è¯¥æ€ä¹ˆåœ¨å„ä¸ªç¯å¢ƒä¹‹é—´æ— ç¼åˆ‡æ¢å‘¢?  </p>\n<p>é¦–å…ˆæˆ‘ä»¬ä¼šæƒ³åˆ°åœ¨ä»£ç ä¸­å»ºä¸€ä¸ªå•ç‹¬çš„ç±», æŠŠç”¨åˆ°çš„æ‰€æœ‰æœåŠ¡æŒ‰ç…§ç¯å¢ƒåˆ—ä¸€ä¸ªé, æ¯æ¬¡éœ€è¦è¿è¡Œä»€ä¹ˆç¯å¢ƒå°±æŒ‰ç…§ä»€ä¹ˆç¯å¢ƒä»ç±»é‡Œé¢å»å–ç›¸å…³ç¯å¢ƒä»£ç . äºæ˜¯æœ‰äº†æ–¹æ¡ˆä¸€.</p>\n<h2 id=\"æ–¹æ¡ˆä¸€\"><a href=\"#æ–¹æ¡ˆä¸€\" class=\"headerlink\" title=\"æ–¹æ¡ˆä¸€\"></a>æ–¹æ¡ˆä¸€</h2><p>æ–¹æ¡ˆä¸€çš„ä¼ªä»£ç , å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­çš„:</p>\n<pre><code class=\"objective-c\">+ (void)getHttpHostWithStatus:(NSInteger)status {\n    switch (status) {\n        case 0: {\n            Host1 = @&quot;å¼€å‘ç¯å¢ƒ&quot;;\n            Host2 = @&quot;å¼€å‘ç¯å¢ƒ&quot;;\n        }\n            break;\n        case 1: {\n            Host1 = @&quot;æµ‹è¯•ç¯å¢ƒ&quot;;\n            Host2 = @&quot;æµ‹è¯•ç¯å¢ƒ&quot;;\n        }\n            break;\n        case 2: {\n            Host1 = @&quot;é¢„å‘å¸ƒç¯å¢ƒ&quot;;\n            Host2 = @&quot;é¢„å‘å¸ƒç¯å¢ƒ&quot;;\n        }\n            break;\n        case 3: {\n            Host1 = @&quot;çº¿ä¸Šç¯å¢ƒ&quot;;\n            Host2 = @&quot;çº¿ä¸Šç¯å¢ƒ&quot;;\n        }\n            break;\n        default:\n            break;\n    }\n}\n</code></pre>\n<p>åœ¨Appæ¯æ¬¡å¯åŠ¨æ—¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•, æ¥è·å–å„ä¸ªHostçš„åœ°å€, å®Œç¾è§£å†³. </p>\n<p>æµ‹è¯•æ¯æ¬¡æƒ³è¦ä¸ªæ–°çš„åŒ…æ¥æµ‹è¯•, éƒ½ä¼šæœ‰å¦‚ä¸‹å¯¹è¯, â€œå¸®æˆ‘æ‰“ä¸ªåŒ…å§â€, â€œä½ è¦ä»€ä¹ˆç¯å¢ƒçš„â€, â€œé¢„å‘ç¯å¢ƒâ€, â€œå¥½çš„â€. äºæ˜¯ ,æˆ‘ä»¬ä¸€åŒæ“ä½œ, ä¼ å…¥é¢„å‘çš„status, è°ƒç”¨åŠ¨æ€å–Hostçš„æ–¹æ³•, ç„¶åProduct-&gt;Archive, ç­‰ä¸ªåå‡ äºŒååˆ†é’Ÿ, æ‰“åŒ…å®Œæ¯•, ç”Ÿæˆä¸€ä¸ªIPAæ–‡ä»¶, è‡ªå·±æ‹¿ITuneså®‰è£…. å—¯, è™½ç„¶è¾›è‹¦ç‚¹, ä½†æ˜¯ç›®å‰çœ‹æ¥, ä¸€åˆ‡éƒ½å¾ˆå®Œç¾å˜›, æ‰“åŒ…çš„æ—¶å€™è¿˜èƒ½å–ä¸ªèŒ¶.</p>\n<p>ç„¶è€Œ, éšç€æˆ‘å¸æµ‹è¯•æµç¨‹çš„è§„èŒƒåŒ–, é€æ¸æ¨è¿›ä½¿ç”¨<a href=\"\">JenkinsæŒç»­é›†æˆ</a>æ¥æ‰“åŒ…, é‚£ä¹ˆé—®é¢˜å°±æ¥äº†. ä½ è®©æµ‹è¯•ä¹Ÿè£…ä¸ªXcode, æ¯æ¬¡åˆ‡æ¢ä¸€ä¸‹ç¯å¢ƒ, æ‰‹åŠ¨Archiveå—, å‘µå‘µ. äºæ˜¯æˆ‘ä»¬æœ‰äº†æ–¹æ¡ˆäºŒ.</p>\n<h2 id=\"æ–¹æ¡ˆäºŒ\"><a href=\"#æ–¹æ¡ˆäºŒ\" class=\"headerlink\" title=\"æ–¹æ¡ˆäºŒ\"></a>æ–¹æ¡ˆäºŒ</h2><p>æˆ‘ä»¬å…ˆæ¥ç†ä¸€ä¸‹æ–¹æ¡ˆäºŒä¸»è¦è§£å†³çš„é—®é¢˜: <em>æµ‹è¯•è¦èƒ½å¤Ÿåœ¨ä¸æ”¹ä»£ç çš„å‰æä¸‹ä½¿ç”¨Jenkinsæ‰“ä¸åŒç¯å¢ƒçš„åŒ…</em>. å¬èµ·æ¥æœ‰ç‚¹å¤æ‚å‘¢, æˆ‘ä»¬æ¥é€ä¸ªåˆ†æä¸‹.</p>\n<ol>\n<li>ä½¿ç”¨Jenkinsæ¥æ‰“åŒ…, é‚£å°±æ˜¯è·‘è„šæœ¬å˜›, xcodebuildå·²ç»å¯‚å¯éš¾è€.</li>\n<li>æ—¢ç„¶æJenkinsäº†, ä¸èƒ½å†ç”¨IPAè‡ªå·±å®‰è£…çš„æ–¹å¼äº†, Low, è’²å…¬è‹±å’ŒFirç®€ç›´ä¸è¦å¤ªæ–¹ä¾¿.</li>\n<li>æ—¢ç„¶è¦ç”¨è„šæœ¬æ¥æ‰“åŒ…äº†, é‚£ä¸èƒ½æ¯æ¬¡è·‘è„šæœ¬ä¹‹å‰, å…ˆæ”¹ä¸€ä¸‹ä»£ç å§, äºæ˜¯æƒ³åˆ°æˆ‘ä»¬åº”è¯¥æœ‰ä¸€ä¸ªå‚æ•°æ¥åœ¨å·¥ç¨‹ä¸­åŒºåˆ†ä¸åŒçš„ç¯å¢ƒ, </li>\n</ol>\n<p>ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬æ–¹æ¡ˆäºŒè¦è§£å†³çš„ä¸»è¦é—®é¢˜, ä¸‹é¢æˆ‘ä»¬æ¥é€ä¸ªåˆ†æå’Œè§£å†³.</p>\n<h3 id=\"æ‰“åŒ…è„šæœ¬\"><a href=\"#æ‰“åŒ…è„šæœ¬\" class=\"headerlink\" title=\"æ‰“åŒ…è„šæœ¬\"></a>æ‰“åŒ…è„šæœ¬</h3><p>å…³äºæ‰“åŒ…çš„è„šæœ¬, ç‰ˆæœ¬å¾ˆå¤š, æœ‰Pythonæµ, æœ‰Shellæµ, å¯ä»¥<a href=\"\">å‚è€ƒè¿™é‡Œ</a>. ä½†è¯´åˆ°åº•, æ— éç”¨çš„æ˜¯xcodebuildæ¥å®ç°çš„, åœ¨ç»ˆç«¯ä¸­è¾“å…¥<code>xcodebuild -help</code>å¯ä»¥æŸ¥çœ‹xcodebuildçš„ç›¸å…³æ“ä½œ<a href=\"http://www.jianshu.com/p/4f4d16326152\" target=\"_blank\" rel=\"noopener\">è¿™ç¯‡æ–‡ç« </a>å°†çš„ä¹Ÿæ¯”è¾ƒå…¨é¢, å¯ä»¥å‚è€ƒä¸‹.</p>\n<p>åœ¨è¿™é‡Œ, æˆ‘ä»¬ä¸»è¦ç”¨åˆ°çš„å‘½ä»¤æœ‰ä¸¤ä¸ª.</p>\n<pre><code class=\"objective-c\">//ç¼–è¯‘\nxcodebuild -workspace &lt;workspacename&gt; -scheme &lt;schemeName&gt; [-destination &lt;destinationspecifier&gt;]... [-configuration &lt;configurationname&gt;] [-arch &lt;architecture&gt;]... [-sdk [&lt;sdkname&gt;|&lt;sdkpath&gt;]] [-showBuildSettings] [&lt;buildsetting&gt;=&lt;value&gt;]... [&lt;buildaction&gt;]...\n\n//ç”ŸæˆIPA\nxcodebuild -exportArchive -archivePath &lt;xcarchivepath&gt; -exportPath &lt;destinationpath&gt; -exportOptionsPlist &lt;plistpath&gt;\n</code></pre>\n<p>åˆ°è¿™ä¸€æ­¥, æˆ‘ä»¬çš„æ‰“åŒ…è„šæœ¬ä»…ä»…å®Œæˆäº†ç¬¬ä¸€æ­¥, ç”Ÿæˆäº†IPAæ–‡ä»¶. </p>\n<h3 id=\"å†…æµ‹åˆ†å‘å¹³å°\"><a href=\"#å†…æµ‹åˆ†å‘å¹³å°\" class=\"headerlink\" title=\"å†…æµ‹åˆ†å‘å¹³å°\"></a>å†…æµ‹åˆ†å‘å¹³å°</h3><p>ç”ŸæˆIPAä¹‹å, æˆ‘ä»¬è¦æä¾›ä¸€ä¸ªå¯ä¾›ä¸‹è½½å®‰è£…çš„é“¾æ¥. æ­¤å¤„æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯<a href=\"https://fir.im/\" target=\"_blank\" rel=\"noopener\">Fir</a>, å®ƒæä¾›çš„ä¹Ÿæœ‰<a href=\"https://github.com/FIRHQ/fir-cli/blob/master/README.md\" target=\"_blank\" rel=\"noopener\">å‘½ä»¤è¡Œæ“ä½œ</a>, å¯ä»¥ç›´æ¥ä¸Šä¼ IPAæ–‡ä»¶, ç”Ÿæˆå¯ä¾›ä¸‹è½½çš„äºŒç»´ç .ğŸ‘</p>\n<p>å½“ç„¶æœ‰æ¡ä»¶çš„å…¬å¸ä¹Ÿå¯ä»¥è‡ªå·±æ­å»ºä¸€ä¸ªä¸‹è½½åœ°å€, åˆ¶ä½œä¸€ä¸ªç®¡ç†åå°, ç”¨æ¥ç®¡ç†è‡ªå·±çš„å†…æµ‹.</p>\n<h3 id=\"APPé…ç½®å¤šä¸ªç¯å¢ƒå˜é‡\"><a href=\"#APPé…ç½®å¤šä¸ªç¯å¢ƒå˜é‡\" class=\"headerlink\" title=\"APPé…ç½®å¤šä¸ªç¯å¢ƒå˜é‡\"></a>APPé…ç½®å¤šä¸ªç¯å¢ƒå˜é‡</h3><p>æ¥ä¸‹æ¥è¿™ä¸ª, æ‰æ˜¯æœ¬æ¬¡è§£å†³æ–¹æ¡ˆçš„é‡ç‚¹, æ˜ç¡®äº†æˆ‘ä»¬çš„ç›®çš„, å°±æ˜¯é…ç½®å¤šç¯å¢ƒå˜é‡, é‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹å§. å…³äºå¤šç¯å¢ƒå˜é‡çš„é…ç½®, å†°éœœå¤§ç¥çš„<a href=\"http://www.jianshu.com/p/83b6e781eb51\" target=\"_blank\" rel=\"noopener\">è¿™ç¯‡æ–‡ç« </a>è®²è§£çš„æ¯”è¾ƒè¯¦ç»†. ä½†æ˜¯æˆ‘ä»¬é‡‡ç”¨çš„æ–¹æ¡ˆå’Œä»–çš„åˆç•¥æœ‰åŒºåˆ«, ä¸€å¼€å§‹æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å¤šTargetçš„æ–¹å¼, åæ¥æ„Ÿè§‰ä¸å¤Ÿè½»é‡åŒ–, å¹¶ä¸”æ¯ä¸ªTargetçš„Seetingä¹ŸåŸºæœ¬ä½ æ²¡æœ‰å¤§çš„ä¸åŒ, äºæ˜¯å°±é‡‡ç”¨äº†å¤šSchemeçš„æ–¹å¼æ¥è§£å†³.</p>\n<p>å…·ä½“æ­¥éª¤å¦‚ä¸‹:<br>1.æ–°å»ºScheme. æ³¨æ„è¿™é‡Œä¸€å®šè¦æŠŠSchemeçš„åå­—å’Œç¼–è¯‘æ–¹å¼åŒºåˆ†å¼€ï¼Œé€‰æ‹©äº†ä¸€ä¸ªSchemeï¼Œåªæ˜¯ç›¸å½“äºé€‰æ‹©äº†ä¸€ä¸ªç¯å¢ƒï¼Œå¹¶ä¸æ˜¯ä»£è¡¨è¿™Debugè¿˜æ˜¯Release, æ­¤å¤„ä»¥<code>PrePublish</code>ä¸ºä¾‹.<br><img src=\"http://ww3.sinaimg.cn/large/006tNbRwgy1ffl8ovbi6rj318o0aq0t6.jpg\" alt=\"æ–°å»ºScheme\"></p>\n<p>2.æ–°å»ºxcconfigæ–‡ä»¶, åå­—ä¸Schemeå¯¹åº”. åœ¨æ–°å»ºæ—¶, ä¸€å®šè¦åœ¨Targeté‚£é‡Œå‹¾é€‰ä¸Š(é»˜è®¤æ˜¯éå‹¾é€‰çŠ¶æ€).<br><img src=\"http://ww3.sinaimg.cn/large/006tNbRwgy1ffl8qe5nx2j313k13umy6.jpg\" alt=\"æ–°å»ºxcconfig\"></p>\n<p>3.Project -&gt; Info -&gt; Configurations æ–°å»ºConfigurationsæ–‡ä»¶. æ³¨æ„, å¦‚æœæœ‰ä½¿ç”¨Podçš„è¯, æ­¤å¤„éœ€è¦ç«‹é©¬æ‰§è¡Œ<code>pod install</code>, ç”Ÿæˆå¯¹åº”çš„Podçš„xcconfigæ–‡ä»¶<br><img src=\"http://ww3.sinaimg.cn/large/006tNbRwgy1ffl8s76f92j318u0h2aap.jpg\" alt=\"æ–°å»ºConfigurations\"></p>\n<p>4.ä¿®æ”¹Configurationsæ–‡ä»¶, ä½¿ä¹‹ä¸å¯¹åº”çš„Schemeç›¸å…³è”.<br><img src=\"http://ww4.sinaimg.cn/large/006tNbRwgy1ffl8vld5eyj31c00g4mxp.jpg\" alt=\"ä¿®æ”¹Configurations\"></p>\n<p>5.Edit Scheme<br><img src=\"http://ww2.sinaimg.cn/large/006tNbRwgy1ffl92zbnlhj31ds0s0q3p.jpg\" alt=\"Edit Scheme\"></p>\n<p>6.ç¼–è¾‘PrePublish.xcconfigæ–‡ä»¶, è®¾ç½®è‡ªå®šä¹‰å­—æ®µ. å…·ä½“å¦‚ä¸‹:</p>\n<pre><code>#include &quot;Pods/Target Support Files/Pods-MultipleChannel/Pods-MultipleChannel.prepublish.xcconfig&quot;\n\nHOST1 = @&quot;HOST1/PrePublish&quot;\n\nHOST2 = @&quot;HOST2/PrePublish&quot;\n\nGCC_PREPROCESSOR_DEFINITIONS = $(inherited) HOST2=&#39;$(HOST2)&#39; HOST1=&#39;$(HOST1)&#39;\n</code></pre><p>æ³¨æ„, æ­¤å¤„å¿…é¡»è¦å¼•å…¥<code>pod install</code>ç”Ÿæˆçš„å¯¹åº”çš„Podçš„xcconfig, å¦åˆ™ä¼šæŠ¥é”™.<br><img src=\"http://ww4.sinaimg.cn/large/006tNbRwgy1ffl9102hzij30ji0aoglq.jpg\" alt=\"æŠ¥é”™\"><br>7.Manage Schemes</p>\n<p>å› ä¸ºä¸€èˆ¬æ˜¯å¤šäººåˆä½œå¼€å‘, æ‰€ä»¥æ­¤å¤„çš„Schemeéœ€è¦è®¾ç½®ä¸ºShareçŠ¶æ€<br><img src=\"http://ww1.sinaimg.cn/large/006tNbRwgy1ffl969kivwj316o0o0jrt.jpg\" alt=\"\"></p>\n<p>è‡³æ­¤, å·²ç»å¯ä»¥åœ¨å·¥ç¨‹ä¸­ä½¿ç”¨æˆ‘ä»¬åœ¨xcconfigä¸­è‡ªå®šä¹‰çš„å­—æ®µäº†. å› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†<code>GCC_PREPROCESSOR_DEFINITIONS</code>, ä»–ä¼šåœ¨ç¼–è¯‘æ—¶ç”Ÿæˆä¸€ä¸ªå®å®šä¹‰, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å®å®šä¹‰</p>\n<pre><code>NSLog(@&quot;----------%@&quot;, HOST1);\nNSLog(@&quot;----------%@&quot;, HOST2);\n</code></pre><p>æ³¨: æ­¤å¤–, è¿˜æœ‰å¦å¤–ä¸€ç§ä½¿ç”¨æ–¹å¼. æˆ‘ä»¬å¯ä»¥æ¯ä¸ªSchemeæ–°å»ºä¸€ä¸ªplist(ä¹Ÿå¯ä½¿ç”¨Info.plist)æ–‡ä»¶ä¸ä¹‹å¯¹åº”, åœ¨plistæ–‡ä»¶ä¸­æ–°å¢<code>key-value</code>æ¥ä¸xcconfigä¸­çš„è‡ªå®šä¹‰å­—æ®µå¯¹åº”.</p>\n<p>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹:</p>\n<p>1.åœ¨plistä¸­æ–°å¢ä¸xcconfigä¸­è‡ªå®šä¹‰å­—æ®µå¯¹åº”çš„<code>key-value</code><br><img src=\"http://ww3.sinaimg.cn/large/006tNbRwgy1ffl9dzmseoj310y0nqjsm.jpg\" alt=\"plistæ–‡ä»¶æ–°å¢\"></p>\n<p>2.ä½¿ç”¨æ–¹å¼å¦‚ä¸‹:</p>\n<pre><code>    NSString *bundlePath = [[NSBundle mainBundle] pathForResource:@&quot;Info&quot; ofType:@&quot;plist&quot;];\n    NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithContentsOfFile:bundlePath];\n    NSLog(@&quot;----------%@&quot;, [dict objectForKey:@&quot;HOST1&quot;]);\n    NSLog(@&quot;----------%@&quot;, [dict objectForKey:@&quot;HOST2&quot;]);\n</code></pre><p>è‡³æ­¤, æˆ‘ä»¬å·²ç»å®ç°ä¸åŒSchemeä¸‹, å‚æ•°çš„åŠ¨æ€åŒ–é…ç½®çš„ä¸¤ç§æ–¹æ¡ˆ, ä¸‹é¢æˆ‘ä»¬åˆ†æä¸‹åŸç†:</p>\n<p>é¦–å…ˆ, æˆ‘ä»¬å…ˆæ¥åŒºåˆ†ä¸€ä¸‹Xcode Workspaceã€Xcode Schemeã€Xcode Projectã€Xcode Targetã€Build Settings è¿™5è€…çš„å…³ç³», ç”±äºç¯‡å¹…è¾ƒé•¿, <a href=\"http://hchong.net/2017/05/16/Settings%E5%85%B3%E7%B3%BB/\">å¦å¼€ä¸€æ–‡</a>.<br>è¿™5è€…çš„å…³ç³»åœ¨è‹¹æœå®˜æ–¹æ–‡æ¡£ä¸Šå…¶å®éƒ½å·²ç»è¯´æ˜çš„å¾ˆæ¸…æ¥šäº†ã€‚è¯¦æƒ…è§æ–‡æ¡£<a href=\"https://developer.apple.com/library/content/featuredarticles/XcodeConcepts/Concept-Targets.html\" target=\"_blank\" rel=\"noopener\">Xcode Concepts</a>ã€‚ </p>\n<p>æ€»ç»“èµ·æ¥, ä¸€ä¸ªWorkspaceå¯ä»¥åŒ…å«å¤šä¸ªProject,ä¸€ä¸ªProjectå¯ä»¥åŒ…å«å¤šä¸ªTargetï¼ŒSchemeåŒ…å«äº†æ‰€æœ‰çš„Targeté›†åˆï¼Œè¿™ä¸ªé›†åˆæŒ‡å®šäº†ï¼Œç¼–è¯‘å“ªä¸ªtargetï¼Œä½¿ç”¨å“ªä¸ªbuild configurationå»ç¼–è¯‘targetï¼Œæä¾›è¿è¡Œtargetçš„æ‰§è¡Œç¯å¢ƒç­‰ç­‰.</p>\n<p>xcconfigæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨æ¥ä¿å­˜Build Settingsé”®å€¼å¯¹çš„çº¯æ–‡æœ¬æ–‡ä»¶, è¿™äº›é”®å€¼å¯¹ä¼šè¦†ç›–Build Settingsä¸­çš„å€¼. xcconifgæ”¯æŒå¯ä»¥æ ¹æ®ä¸åŒçš„Configurationé€‰é¡¹é…ç½®ä¸åŒçš„æ–‡ä»¶. ä¸åŒçš„xcconfigå¯ä»¥æŒ‡å®šä¸åŒçš„Build Settingsé‡Œçš„å±æ€§å€¼.</p>\n<h2 id=\"æ–¹æ¡ˆä¸‰\"><a href=\"#æ–¹æ¡ˆä¸‰\" class=\"headerlink\" title=\"æ–¹æ¡ˆä¸‰\"></a>æ–¹æ¡ˆä¸‰</h2><p>æˆ‘ä»¬çš„åˆè¡·æ˜¯ç”¨è¿™ä¸ªæ¥åŠ¨æ€é…ç½®Appçš„ç¯å¢ƒ. æ—¢ç„¶å·²ç»å¯ä»¥é€šè¿‡xcconfigå’ŒSchemeæ¥é…åˆä¿®æ”¹Build Seetingsçš„å€¼, é‚£ä¹ˆå°±ä¼šæœ‰ä¸€äº›æ›´åŠ é«˜çº§çš„ç©æ³•. ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥åœ¨<code>Images.xcassets</code>ä¸­æ–°å»ºæ–°çš„iconå’Œlaunch Imageçš„åˆ†ç±», é€šè¿‡<code>ASSETCATALOG_COMPILER_APPICON_NAME</code>å’Œ<code>ASSETCATALOG_COMPILER_LAUNCHIMAGE_NAME</code>ä¸­çš„è®¾ç½®, ä»¥åŠ<code>Display Name</code>,<code>Bundle Identifier</code>, <code>Provisioning Profile</code>ç­‰ä¸€äº›é…ç½®(æ­¤å¤„Build Settingsä¸­çš„å€¼å¯ä»¥ç›´æ¥<code>command + C</code>æ¥copy)æ¥ç®¡ç†å¤§é‡çš„ç›¸ä¼¼APP.</p>\n<p>Info.plistä¸­çš„å€¼, éœ€è¦åœ¨Valueä¸­ä½¿ç”¨${Value}æ¥åŠ¨æ€é…ç½®, å‚è€ƒåŸŸåçš„é…ç½®.</p>\n<p>xcconfigè¿˜èƒ½åŠ¨æ€é…ç½®Build Settingsé‡Œé¢çš„å¾ˆå¤šå‚æ•°ã€‚è¿™å…¶å®ç±»ä¼¼äºcocopodsçš„åšæ³•ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªå¤§ç¥çš„åšæ³•å¾ˆä¼˜é›…ã€‚å€¼å¾—å¤§å®¶æ„Ÿå…´è¶£çš„äººå»å­¦ä¹ å­¦ä¹ ã€‚iOSå¤§ç¥Justin Spahr-Summersçš„å¼€æºåº“æä¾›äº†ä¸€ä¸ªç±»æƒå¨çš„<a href=\"https://github.com/jspahrsummers/xcconfigs\" target=\"_blank\" rel=\"noopener\">æ¨¡æ¿</a>.</p>\n<p>é‚£ä¹ˆä¼´éšç€ä¸šåŠ¡çš„å‘å±•, å°±æœ‰æœ‰é—®é¢˜äº†. å¦‚æœæˆ‘æƒ³ç®¡ç†å¤§é‡ç›¸ä¼¼çš„APP, æ¯æ¬¡å‘å¸ƒæ–°ç‰ˆæœ¬, æˆ‘å°±è¦æ‰“Nå¤šä¸ªæ–°åŒ…. æ¯æ¬¡è·‘è„šæœ¬, æ•°é‡å¤šäº†æ—¶é—´ä¹Ÿå¾ˆé•¿, é‚£è¿™å°±ä¸æ˜¯ä¸€æ¯èŒ¶çš„åŠŸå¤«äº†, ç”šè‡³è¦ä¸€ä¸¤ä¸ªå°æ—¶. å¹¶ä¸”æˆ‘è¿˜è¦ç®¡ç†Nå¤šä¸ªScheme, è¿™äº›Schemeæ˜æ˜åªæœ‰å¾ˆå°‘çš„å·®åˆ«, çœŸçš„å¥½çƒ¦å•Š. æœ‰æ²¡æœ‰æ›´åŠ ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆå‘¢, æ¥çœ‹ä¸‹æ–¹æ¡ˆå››.</p>\n<h2 id=\"æ–¹æ¡ˆå››\"><a href=\"#æ–¹æ¡ˆå››\" class=\"headerlink\" title=\"æ–¹æ¡ˆå››\"></a>æ–¹æ¡ˆå››</h2><p>é¦–å…ˆ, è¿˜æ˜¯å…ˆæ¥æ˜ç¡®ä¸‹æˆ‘ä»¬è¿™ä¸ªæ–¹æ¡ˆè¦è§£å†³çš„é—®é¢˜:</p>\n<ol>\n<li>Schemeå¤ªå¤š, æ¯ä¸ªæ¸ é“ä¸€ä¸ªScheme, ç®¡ç†èµ·æ¥è´¹åŠ².</li>\n<li>æ–°ç‰ˆæœ¬å‘å¸ƒæ—¶, å„ä¸ªæ¸ é“çš„åŒ…, è·‘è„šæœ¬è·‘åˆ°æ‰‹è½¯.</li>\n</ol>\n<hr>\n<p>é™„ä»¶ä¸‹è½½åœ°å€:</p>\n<p>1.<a href=\"\">æ‰“åŒ…è„šæœ¬</a>    </p>\n<p>2.<a href=\"https://github.com/HChong3210/MultipleChannel\" target=\"_blank\" rel=\"noopener\">Demo</a>    </p>\n<hr>\n<p>å‚è€ƒæ–‡ç« :</p>\n<p>1.<a href=\"http://www.jianshu.com/p/4f4d16326152\" target=\"_blank\" rel=\"noopener\">xcodebuildå‘½ä»¤è¯´æ˜</a></p>\n<p>2.<a href=\"https://fir.im/\" target=\"_blank\" rel=\"noopener\">Fir.im</a></p>\n<p>3.<a href=\"http://www.jianshu.com/p/83b6e781eb51\" target=\"_blank\" rel=\"noopener\">æ‰‹æŠŠæ‰‹æ•™ä½ ç»™ä¸€ä¸ªiOS appé…ç½®å¤šä¸ªç¯å¢ƒå˜é‡</a></p>\n<p>4.<a href=\"http://www.jianshu.com/p/9a6f3019d81f\" target=\"_blank\" rel=\"noopener\">Xcode é…ç½®æ–‡ä»¶ xcconfig</a></p>\n<p>5.<a href=\"http://liumh.com/2016/05/22/use-xcconfig-config-specific-variable/\" target=\"_blank\" rel=\"noopener\">Xcodeä½¿ç”¨xcconfigæ–‡ä»¶é…ç½®ç¯å¢ƒ</a></p>\n<p>6.<a href=\"http://blog.csdn.net/vbirdbest/article/details/53454014\" target=\"_blank\" rel=\"noopener\">iOS Xcodeä½¿ç”¨xcconfigé…ç½®ç¯å¢ƒå‚æ•°(Debug&amp;Release)</a></p>\n<p>7.<a href=\"https://pewpewthespells.com/blog/xcconfig_guide.html\" target=\"_blank\" rel=\"noopener\">The Unofficial Guide to xcconfig files</a></p>\n","categories":["è‡ªåŠ¨åŒ–æ‰“åŒ…"],"tags":["è‡ªåŠ¨åŒ–æ‰“åŒ…","Target"]},{"title":"CharlesæŠ“åŒ…Httpsè¯·æ±‚","url":"http://hchong.net/2017/02/28/CharlesæŠ“åŒ…Httpsè¯·æ±‚/","content":"<h1 id=\"CharlesæŠ“åŒ…HTTPSè¯·æ±‚\"><a href=\"#CharlesæŠ“åŒ…HTTPSè¯·æ±‚\" class=\"headerlink\" title=\"CharlesæŠ“åŒ…HTTPSè¯·æ±‚\"></a>CharlesæŠ“åŒ…HTTPSè¯·æ±‚</h1><p>æœ‰æ—¶æˆ‘ä»¬ä¼šå¯¹æ‰‹æœºé‡Œé¢çš„Appè¿›è¡Œä¸€äº›åˆ†æ, äº§çœ‹Appçš„è¯·æ±‚åŒ…, è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ç¥­å‡ºç¥å™¨<a href=\"https://www.charlesproxy.com/\" target=\"_blank\" rel=\"noopener\">Charles</a>äº†.<br>ä¸‹é¢è·Ÿç€æˆ‘æ¥æ•™ä½ ä»é›¶å¼€å§‹æŠ“å–Appçš„è¯·æ±‚åŒ….</p>\n<h2 id=\"å®‰è£…Charles\"><a href=\"#å®‰è£…Charles\" class=\"headerlink\" title=\"å®‰è£…Charles\"></a>å®‰è£…Charles</h2><p>è¿™ä¸ªçº¯å±å å‘(åºŸè¯).</p>\n<h2 id=\"æŠ“å–HTTPè¯·æ±‚\"><a href=\"#æŠ“å–HTTPè¯·æ±‚\" class=\"headerlink\" title=\"æŠ“å–HTTPè¯·æ±‚\"></a>æŠ“å–HTTPè¯·æ±‚</h2><p>æˆ‘ä»¬å…ˆæ‹¿ä¸€ä¸ªç®€å•çš„HTTPè¯·æ±‚æ¥ç»ƒä¸€ä¸‹æ‰‹.</p>\n<h3 id=\"æŸ¥çœ‹æœ¬åœ°IPåœ°å€å’ŒCharlesç«¯å£å·\"><a href=\"#æŸ¥çœ‹æœ¬åœ°IPåœ°å€å’ŒCharlesç«¯å£å·\" class=\"headerlink\" title=\"æŸ¥çœ‹æœ¬åœ°IPåœ°å€å’ŒCharlesç«¯å£å·\"></a>æŸ¥çœ‹æœ¬åœ°IPåœ°å€å’ŒCharlesç«¯å£å·</h3><p>æŸ¥çœ‹IPåœ°å€çš„æ–¹æ³•æ¯”è¾ƒå¤š, è¿™é‡Œåªä»‹ç»ä¸¤ç§æ¯”è¾ƒå¸¸ç”¨çš„:</p>\n<ol>\n<li>å¯ä»¥åœ¨ç½‘ç»œåå¥½è®¾ç½®-&gt;é«˜çº§-&gt;TCP/IPä¸‹æŸ¥çœ‹å¯¹åº”ç½‘ç»œçš„IP.<br> <img src=\"https://ww2.sinaimg.cn/large/006tKfTcgy1fd5z8oku1vj311a0lwgpb.jpg\" alt=\"ç½‘ç»œåå¥½è®¾ç½®ä¸­æŸ¥çœ‹\"></li>\n<li>option+å·¦é”®å•å‡»å±å¹•ä¸Šæ–¹çš„WiFiæ ‡å¿—ä¹Ÿå¯ä»¥æŸ¥çœ‹.<br> <img src=\"https://ww3.sinaimg.cn/large/006tKfTcgy1fd65kx0mjhj308c0eft9q.jpg\" alt=\"option+å·¦é”®æŸ¥çœ‹\"></li>\n</ol>\n<h3 id=\"æŸ¥çœ‹Charlesçš„ç«¯å£å·\"><a href=\"#æŸ¥çœ‹Charlesçš„ç«¯å£å·\" class=\"headerlink\" title=\"æŸ¥çœ‹Charlesçš„ç«¯å£å·\"></a>æŸ¥çœ‹Charlesçš„ç«¯å£å·</h3><p>æ‰“å¼€Charles-&gt;Proxy-&gt;Proxy SettingsæŸ¥çœ‹ç«¯å£å·, é»˜è®¤ä¸€èˆ¬æ˜¯<code>8888</code>. æ³¨æ„ä¸è¦éšæ„ä¿®æ”¹ç«¯å£å·, ä»¥é¿å…è¢«å ç”¨.</p>\n<h3 id=\"åœ¨iPhoneä¸­è®¾ç½®\"><a href=\"#åœ¨iPhoneä¸­è®¾ç½®\" class=\"headerlink\" title=\"åœ¨iPhoneä¸­è®¾ç½®\"></a>åœ¨iPhoneä¸­è®¾ç½®</h3><p>æ‰“å¼€æ‰‹æœº, è¿ä¸ŠWiFi, æ³¨æ„æ­¤å¤„çš„WiFiæœ€å¥½å’ŒMacè¿æ¥çš„WiFiæ˜¯åŒä¸€ä¸ª, é¿å…å‡ºç°ä¸åœ¨ä¸€ä¸ªç½‘æ®µçš„æƒ…å†µ.<br>æ‰“å¼€è®¾ç½®-&gt;æ— çº¿å±€åŸŸç½‘-&gt;ç‚¹å‡»å¯¹åº”WiFiåçš„æ›´å¤š.<br><img src=\"https://ww4.sinaimg.cn/large/006tKfTcgy1fd65mobyrjj30b40jrq3k.jpg\" alt=\"WiFiåˆ—è¡¨\"><br>ç‚¹å‡»æ‰‹åŠ¨, è®¾ç½®HTTPä»£ç†åœ°å€(ä¸Macçš„IPåœ°å€ä¸€è‡´)å’Œç«¯å£å·(ä¸Charlesä¸­ä»£ç†çš„ç«¯å£å·ä¸€è‡´)<br><img src=\"https://ww3.sinaimg.cn/large/006tKfTcgy1fd65mo3y0aj30b40jrmxm.jpg\" alt=\"è®¾ç½®HTTPä»£ç†åœ°å€å’Œç«¯å£å·\"></p>\n<p>è‡³æ­¤, å°±å¯ä»¥è½»æ¾çš„æŠ“å–Appä¸­çš„HTTPè¯·æ±‚å•¦.</p>\n<h2 id=\"æŠ“å–HTTPSè¯·æ±‚\"><a href=\"#æŠ“å–HTTPSè¯·æ±‚\" class=\"headerlink\" title=\"æŠ“å–HTTPSè¯·æ±‚\"></a>æŠ“å–HTTPSè¯·æ±‚</h2><p>HTTPSçš„è¯·æ±‚æŠ“å–, ç•¥å¾®å¤æ‚, ä»–çš„åŸç†å¤§è‡´æ˜¯è¿™æ ·çš„.</p>\n<blockquote>\n<p>Charlesèƒ½è¿›è¡Œhttpsåè®®æŠ“åŒ…åˆ†æï¼Œæ˜¯ä½¿ç”¨äº†ä¸­é—´äººä»£ç†çš„æ–¹æ³•ï¼ˆman-in-the-middleï¼Œä¹Ÿå¸¸ä½œä¸ºä¸€ä¸ªé»‘å®¢æ”»å‡»æ‰‹æ®µï¼‰ã€‚Charlesä»£æ›¿ä½ çš„appæ¥å—serverçš„è¯ä¹¦ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªè¯ä¹¦é€šè¿‡SSLå’Œserveré€šä¿¡ï¼›åŒæ—¶ï¼ŒCharlesä¼šåŠ¨æ€çš„ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„è¯ä¹¦ï¼ˆç”¨Charlesçš„CAè¯ä¹¦ç­¾åï¼‰ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªè¯ä¹¦å’Œä½ çš„appé€šä¿¡ï¼Œè¿™æ ·å°±å®Œæˆäº†ä¸€ä¸ªä¸­é—´äººä»£ç†ï¼Œä»è€Œå¯ä»¥æŠŠappå’Œserverçš„httpsåŒ…ç»™æŠ“åˆ°å’Œè§£ç å‡ºæ¥ã€‚</p>\n</blockquote>\n<p>ä»é‡Œé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€äº›å…³é”®å­—: <code>è¯ä¹¦</code>, <code>ä»£ç†</code>, ç­‰. é‚£ä¹ˆæˆ‘ä»¬å°±é€šè¿‡è¿™äº›æ‰‹æ®µæ¥æŠ“å–HTTPSçš„è¯·æ±‚.</p>\n<h3 id=\"è®¾ç½®ä»£ç†åœ°å€å’Œç«¯å£å·\"><a href=\"#è®¾ç½®ä»£ç†åœ°å€å’Œç«¯å£å·\" class=\"headerlink\" title=\"è®¾ç½®ä»£ç†åœ°å€å’Œç«¯å£å·\"></a>è®¾ç½®ä»£ç†åœ°å€å’Œç«¯å£å·</h3><p>è¿™ä¸€æ­¥éª¤, å’ŒæŠ“å–HTTPçš„æ–¹æ³•ä¸€æ ·, è¿™é‡Œä¸å†èµ˜è¿°, éœ€è¦è®¾ç½®ç«¯å£å·å’ŒIPåœ°å€.</p>\n<h3 id=\"Macå®‰è£…è¯ä¹¦\"><a href=\"#Macå®‰è£…è¯ä¹¦\" class=\"headerlink\" title=\"Macå®‰è£…è¯ä¹¦\"></a>Macå®‰è£…è¯ä¹¦</h3><p>å®‰è£…Charlesçš„è¯ä¹¦åˆ°Mac, ä¿¡ä»»è¯¥è¯ä¹¦, ä»¥ä¾¿Charlesèƒ½å¤Ÿé€šè¿‡è¯¥è¯ä¹¦è¿›è¡Œé€šä¿¡. å…·ä½“æ­¥éª¤å¦‚ä¸‹: </p>\n<ol>\n<li>æ‰“å¼€Charles, ç‚¹å‡»Help-&gt;SSL Proxying-&gt;Install Charles Root Certificate<br> <img src=\"https://ww1.sinaimg.cn/large/006tKfTcgy1fd607vw0k6j30pk094gmj.jpg\" alt=\"å®‰è£…æ ¹è¯ä¹¦\"></li>\n<li>ä¿¡ä»»è¯¥è¯ä¹¦<br><img src=\"http://upload-images.jianshu.io/upload_images/1552510-461959c476a2d9d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"è¯ä¹¦ä¸è¢«ä¿¡ä»»æ—¶\"></li>\n</ol>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/1552510-8c43e95be0a35b5f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"ä¿¡ä»»Charlesè¯ä¹¦\"></p>\n<h3 id=\"iPhoneå®‰è£…è¯ä¹¦\"><a href=\"#iPhoneå®‰è£…è¯ä¹¦\" class=\"headerlink\" title=\"iPhoneå®‰è£…è¯ä¹¦\"></a>iPhoneå®‰è£…è¯ä¹¦</h3><p>å®‰è£…Charlesè¯ä¹¦åˆ°æ‰‹æœº, ä¿¡ä»»è¯¥è¯ä¹¦, ä»¥ä¾¿Charlesèƒ½å¤Ÿæˆªè·ç½‘ç»œè¯·æ±‚. å…·ä½“æ­¥éª¤å¦‚ä¸‹:</p>\n<ol>\n<li>åœ¨Charlesä¸­, ç‚¹å‡»Help-&gt;SSL Proxying-&gt;Install Charles Root Certificate on a Mobile Device or Remote Browser, æ¥æŸ¥çœ‹å½“å‰IPåœ°å€ä¸‹, æ‰‹æœºä¸‹è½½è¯ä¹¦çš„ç½‘å€.<br> <img src=\"https://ww2.sinaimg.cn/large/006tKfTcgy1fd60jpjcgvj30nx094my0.jpg\" alt=\"æ­¥éª¤ä¸€:é€‰æ‹©ç”Ÿæˆæ‰‹æœºä¸‹è½½è¯ä¹¦çš„ç½‘å€\"></li>\n<li>åœ¨æ‰‹æœºä¸­ç”¨Safariæ‰“å¼€ç½‘å€(å¦‚å›¾æ‰€ç¤ºçš„ç½‘å€)<br> <img src=\"https://ww4.sinaimg.cn/large/006tKfTcgy1fd60l2cz81j30nz06t3yl.jpg\" alt=\"æ­¥éª¤äºŒ:è¾“å…¥ç”Ÿæˆçš„ç½‘å€\"></li>\n<li>æ‰“å¼€ç½‘å€åè‡ªåŠ¨è·³è½¬åˆ°è¯ä¹¦å®‰è£…ç•Œé¢, å®‰è£…å¹¶ä¿¡ä»»è¯¥è¯ä¹¦.<br> <img src=\"https://ww1.sinaimg.cn/large/006tKfTcgy1fd65rnpokjj30b40jrgly.jpg\" alt=\"æ­¥éª¤ä¸‰:å®‰è£…å¹¶ä¿¡ä»»è¯¥è¯ä¹¦\"></li>\n<li>æ‰“å¼€Charlesé€‰æ‹©Proxy-&gt;SSL Proxying Settings-&gt;SSL Proxying(å› ä¸ºCharlesé»˜è®¤æ˜¯ä¸ä¼šæŠ“å–ä»»ä½•åŸŸåä¸‹çš„HTTPS, æ‰€ä»¥éœ€è¦æˆ‘ä»¬æ·»åŠ åŸŸååˆ°Locationä¸‹)å‹¾é€‰Enable SSL Proxying, å•å‡»Add, æ·»åŠ åŸŸåå’Œç«¯å£(ç”¨*æ¥è¡¨ç¤ºæ‰€æœ‰).<br> <img src=\"https://ww1.sinaimg.cn/large/006tKfTcgy1fd60zndgejj30gj0cb0st.jpg\" alt=\"æ­¥éª¤å››:è®¾ç½®æŠ“å–çš„åŸŸåå’Œç«¯å£\"></li>\n</ol>\n<p>è‡³æ­¤, æˆ‘ä»¬å†æ‰“å¼€æ‰‹æœºAppå°±ä¼šå‘ç°, ä¹‹å‰<code>Unknown</code>çš„HTTPSæ¥å£, å°±éƒ½å¯ä»¥æ­£å¸¸ç°å®å•¦.</p>\n<p>å‚è€ƒèµ„æ–™:<br>1.<a href=\"http://www.jianshu.com/p/a0215dd2047f\" target=\"_blank\" rel=\"noopener\">HTTP/HTTPSæŠ“åŒ…å·¥å…·Charles</a><br>2.<a href=\"http://www.jianshu.com/p/a83b19a36a8b\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨Charlesè¿›è¡ŒhttpsæŠ“åŒ…</a><br>3.<a href=\"http://blog.devtang.com/2015/11/14/charles-introduction/\" target=\"_blank\" rel=\"noopener\">Charles ä»å…¥é—¨åˆ°ç²¾é€š</a></p>\n","categories":["iOSé€†å‘"],"tags":["é€†å‘","å®‰å…¨","Charles"]},{"title":"ç»Ÿè®¡æ‰“ç‚¹çš„AOPå®ç°","url":"http://hchong.net/2017/02/13/ç»Ÿè®¡æ‰“ç‚¹çš„AOPå®ç°/","content":"<h1 id=\"ç»Ÿè®¡æ‰“ç‚¹çš„AOPå®ç°\"><a href=\"#ç»Ÿè®¡æ‰“ç‚¹çš„AOPå®ç°\" class=\"headerlink\" title=\"ç»Ÿè®¡æ‰“ç‚¹çš„AOPå®ç°\"></a>ç»Ÿè®¡æ‰“ç‚¹çš„AOPå®ç°</h1><p>æ¯ä¸€ä¸ªApp, å¿…ç„¶ä¼šæœ‰å¤§é‡çš„åˆ†ææ•°æ®æ¥ç»Ÿè®¡ç”¨æˆ·è¡Œä¸º. è€Œè¿™äº›ç»Ÿè®¡å¯¹åº”åœ¨å®¢æˆ·ç«¯å°±æ˜¯, ç»Ÿè®¡æ‰“ç‚¹, åˆç§°åŸ‹ç‚¹.<br>å…³äºåŸ‹ç‚¹çš„æœ¬è´¨, æˆ‘ç†è§£çš„å°±æ˜¯ç”¨æˆ·å‡ºå‘ä¸€ä¸ªè¡Œä¸ºå, è°ƒç”¨ä¸€ä¸ªç‰¹å®šçš„æ¥å£. æœåŠ¡ç«¯æ‹¿åˆ°æˆ‘ä»¬çš„è¯·æ±‚å, æ ¹æ®å®¢æˆ·ç«¯ä¼ çš„å‚æ•°ä¹Ÿå°±æ˜¯äº‹ä»¶IDæ¥åŒºåˆ†æ˜¯ä»€ä¹ˆæ“ä½œ(æ³¨æ„, è¿™é‡Œçš„äº‹ä»¶IDæ˜¯å…·æœ‰å”¯ä¸€æ€§çš„, ä¸åŒçš„IDå¯¹åº”ç”¨æˆ·ä¸åŒçš„æ“ä½œ). æœ‰æ—¶ä¹Ÿå¯èƒ½ä¼šéœ€è¦å…¶ä»–çš„ä¿¡æ¯, æ¯”å¦‚æ“ä½œäººçš„IDç­‰. æœåŠ¡ç«¯æ‹¿åˆ°è¿™äº›ä¿¡æ¯ä¹‹å, å†æ•´ç†ç­›é€‰, é€šè¿‡è§†å›¾, æŠ¥è¡¨çš„å½¢å¼å±•ç°å‡ºæ¥.<br>å› ä¸ºåŸ‹ç‚¹æ˜¯å’Œä¸šåŠ¡ç´§å¯†ç›¸è¿çš„, æ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬çš„åŸ‹ç‚¹ä»£ç (å°±æ˜¯è°ƒç”¨ç‰¹å®šç½‘ç»œæ¥å£çš„ä»£ç )åˆ†æ•£åœ¨æ•´ä¸ªé¡¹ç›®çš„å„ä¸ªåœ°æ–¹. å½“ä¸šåŠ¡è¶Šæ¥è¶Šå¤æ‚, å·¥ç¨‹è¶Šæ¥è¶Šå¤§æ—¶, æˆ‘ä»¬çš„åŸ‹ç‚¹ä»£ç å°±ä¼šå˜å¾—å¾ˆéš¾ç»´æŠ¤, åŸ‹ç‚¹äº‹ä»¶åˆ†æ•£åœ¨å„ä¸ªåœ°æ–¹, å¾ˆéš¾æœ‰ä¸ªæ¸…æ™°çš„é€»è¾‘. å¹¶ä¸”æŠŠåŸ‹ç‚¹äº‹ä»¶å’Œä¸šåŠ¡ä»£ç é«˜åº¦è€¦åˆåœ¨ä¸€èµ·, ä¹Ÿä¸æ˜¯ä¸€ä¸ªæ˜æ™ºçš„é€‰æ‹©.<br>è¿™ä¸ªæ—¶å€™, å°±ä¼šæƒ³åˆ°, è¦æ˜¯èƒ½ç”¨AOPçš„æ–¹å¼æ¥è§£å†³åŸ‹ç‚¹çš„å®ç°, æŠŠåŸ‹ç‚¹äº‹ä»¶å’Œä¸šåŠ¡ä»£ç è§£è€¦å¼€æ¥, é‚£æˆ‘ä»¬ç»´æŠ¤èµ·æ¥å°±ä¼šæ–¹ä¾¿å¥½å¤š.</p>\n<blockquote>\n<p>AOPä¸ºAspect Oriented Programmingçš„ç¼©å†™ï¼Œæ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚AOPä¸OOPæ˜¯é¢å‘ä¸åŒé¢†åŸŸçš„ä¸¤ç§è®¾è®¡æ€æƒ³ã€‚<br>OOPï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰é’ˆå¯¹ä¸šåŠ¡å¤„ç†è¿‡ç¨‹çš„å®ä½“åŠå…¶å±æ€§å’Œè¡Œä¸ºè¿›è¡ŒæŠ½è±¡å°è£…ï¼Œä»¥è·å¾—æ›´åŠ æ¸…æ™°é«˜æ•ˆçš„é€»è¾‘å•å…ƒåˆ’åˆ†ã€‚<br>AOPåˆ™æ˜¯é’ˆå¯¹ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­çš„åˆ‡é¢è¿›è¡Œæå–ï¼Œå®ƒæ‰€é¢å¯¹çš„æ˜¯å¤„ç†è¿‡ç¨‹ä¸­çš„æŸä¸ªæ­¥éª¤æˆ–é˜¶æ®µï¼Œä»¥è·å¾—é€»è¾‘è¿‡ç¨‹ä¸­å„éƒ¨åˆ†ä¹‹é—´ä½è€¦åˆæ€§çš„éš”ç¦»æ•ˆæœã€‚<br>AOPå¯ä»¥ç”¨åœ¨æ—¥å¿—è®°å½•ï¼Œæ€§èƒ½ç»Ÿè®¡ï¼Œå®‰å…¨æ§åˆ¶ï¼Œäº‹åŠ¡å¤„ç†ï¼Œå¼‚å¸¸å¤„ç†ç­‰ç­‰ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦è®²çš„æ˜¯åŸ‹ç‚¹ä¹Ÿå°±æ˜¯æ—¥å¿—è®°å½•</p>\n</blockquote>\n<p>åœ¨Objective-Cä¸­ä½¿ç”¨AOPä¸»è¦æŒ‡çš„æ˜¯ä½¿ç”¨Objective-Cçš„Runtimeç‰¹æ€§, ç»™æŒ‡å®šçš„æ–¹æ³•æ·»åŠ è‡ªå®šä¹‰ä»£ç . æœ‰å¾ˆå¤šæ–¹å¼æ¥å®ç°AOP, MethodSwizzlingåªæ˜¯å…¶ä¸­ä¹‹ä¸€.è€Œåˆæœ‰ä¸€äº›ç¬¬ä¸‰æ–¹åº“, å°†Runtimeè¿›è¡Œäº†å¾ˆå¥½åœ°å°è£…, è®©æˆ‘ä»¬ä¸ç”¨äº†è§£Runtimeçš„çŸ¥è¯†, å°±èƒ½å¾ˆå¥½åœ°ä½¿ç”¨AOP.<br>æˆ‘ä»¬ä¸»è¦ä½¿ç”¨çš„æ˜¯<a href=\"https://github.com/steipete/Aspects\" target=\"_blank\" rel=\"noopener\">Aspects</a>è¿™ä¸ªç¬¬ä¸‰æ–¹åº“, å…³äºAspectsçš„å†…éƒ¨å®ç°, å¯ä»¥å‚è€ƒè¿™ç¯‡åšæ–‡<a href=\"http://www.jianshu.com/p/dc9dca24d5de\" target=\"_blank\" rel=\"noopener\">iOS å¦‚ä½•å®ç°Aspect Oriented Programming</a>.<br>ç”±ä»¥ä¸Šçš„è§£é‡Š, å¯ä»¥åŸºæœ¬äº†è§£, æˆ‘ä»¬ä¸»è¦æ˜¯é€šè¿‡Aspectæ¥Hookå¯¹åº”äº‹ä»¶çš„æ–¹æ³•, ä¼ é€’äº‹ä»¶å”¯ä¸€çš„IDç»™æœåŠ¡ç«¯æ¥æ ‡è®°æ­¤äº‹ä»¶å“åº”è¿‡ä¸€æ¬¡.æ‰€ä»¥, æˆ‘ä»¬çš„ä»£ç å¤§è‡´åº”è¯¥æ˜¯è¿™æ ·.<br>é¦–å…ˆæœ‰ä¸€ä¸ªç±»ç”¨æ¥è®°å½•åŸ‹ç‚¹äº‹ä»¶IDå’Œéœ€è¦Hookçš„ç±»å’Œæ–¹æ³•, å¹¶ä¸”å°†ä»–ä»¬ä¸€ä¸€å¯¹åº”.</p>\n<p>æ ¹æ®è®°å½•åŸ‹ç‚¹äº‹ä»¶çš„å¤æ‚ç¨‹åº¦, æˆ‘ä»¬å¤§è‡´å¯ä»¥å°†åŸ‹ç‚¹åˆ†ä¸ºç®€å•åŸ‹ç‚¹å’Œå¤æ‚åŸ‹ç‚¹ä¸¤ç§:</p>\n<ol>\n<li>ç®€å•åŸ‹ç‚¹: åªç”¨è®°å½•æŸä¸ªæ“ä½œäº‹ä»¶å“åº”æ¬¡æ•°</li>\n<li>å¤æ‚åŸ‹ç‚¹:<ul>\n<li>éœ€è¦ä¼ é™¤äº†äº‹ä»¶IDå¤–çš„å‚æ•°</li>\n<li>éœ€è¦æ ¹æ®æœåŠ¡ç«¯è¿”å›çš„æ•°æ®æ¥å“åº”ä¸åŒçš„äº‹ä»¶</li>\n<li>åŸ‹ç‚¹äº‹ä»¶IDæ”¾åœ¨æœåŠ¡ç«¯è¿”å›çš„å­—æ®µä¸­</li>\n</ul>\n</li>\n</ol>\n<p>æˆ‘ä»¬æ–°å»ºä¸¤ä¸ªç±», ä¸€ä¸ªç”¨æ¥è®°å½•Hookçš„ç±»<code>HYZTrackList</code>, Hookçš„æ–¹æ³•å’Œä¸ä¹‹å¯¹åº”çš„äº‹ä»¶ID. å¦å¤–ä¸€ä¸ªç±»<code>HYZTrackManager</code>, ç”¨æ¥å®ç°åŸ‹ç‚¹äº‹ä»¶çš„å…·ä½“æ“ä½œæ–¹æ³•.</p>\n<h2 id=\"ç®€å•åŸ‹ç‚¹çš„å®ç°\"><a href=\"#ç®€å•åŸ‹ç‚¹çš„å®ç°\" class=\"headerlink\" title=\"ç®€å•åŸ‹ç‚¹çš„å®ç°\"></a>ç®€å•åŸ‹ç‚¹çš„å®ç°</h2><p>æˆ‘ä»¬åœ¨<code>HYZTrackList</code>ä¸­å®ç°<code>trackList</code>æ–¹æ³•, è¿”å›ä¸€ä¸ªæ•°ç»„. æ•°ç»„çš„å…ƒç´ æ˜¯ä¸€ä¸ªä¸ªçš„å­—å…¸, ç”¨å¯¹è®°å½•æ¯ä¸€ä¸ªäº‹ä»¶çš„ç›¸å…³ä¿¡æ¯.</p>\n<pre><code>+ (NSArray *)trackList {\n    NSArray *trackList = @[\n  //=======================================ç®€å•åŸ‹ç‚¹==========================================\n                           //HYZViewController1ç®€å•åŸ‹ç‚¹ç‚¹å‡»äº‹ä»¶\n                           @{kClassName:@&quot;HYZViewController1&quot;,\n                             kHookFunction:@&quot;simpleTrack:para2:&quot;,\n                             kEventType:HYZViewController1SimpleButtonClick,\n                             kIsLightEvent:@(YES)},\n                           //HYZViewController1å¤æ‚åŸ‹ç‚¹ç‚¹å‡»äº‹ä»¶\n                           @{kClassName:@&quot;HYZViewController1&quot;,\n                             kHookFunction:@&quot;blockButtonAction:&quot;,\n                             kEventType:HYZViewController1BlockButtonClick,\n                             kIsLightEvent:@(YES)},\n                           //HYZViewController1blockåŸ‹ç‚¹ç‚¹å‡»äº‹ä»¶\n                           @{kClassName:@&quot;HYZViewController1&quot;,\n                             kHookFunction:@&quot;complexButtonAction:&quot;,\n                             kEventType:HYZViewController1ComplexButtonClick,\n                             kIsLightEvent:@(YES)},\n\n//=======================================å¤æ‚åŸ‹ç‚¹==========================================\n                           @{kClassName:@&quot;HYZViewController3&quot;,\n                             kHookFunction:@&quot;trackWithTag:&quot;,\n                             kHandlerBlock:@&quot;HYZViewController3TrackHandleBlock&quot;,\n                             kIsLightEvent:@(NO)}];\n    return trackList;\n}\n</code></pre><p>å¦‚ä¸Šæ‰€ç¤º, æˆ‘ä»¬æ˜¯è¦è®°å½•<code>HYZViewController1</code>ç±»é‡Œé¢çš„<code>simpleTrack:para2:</code>æ–¹æ³•çš„ç‚¹å‡»äº‹ä»¶, äº‹ä»¶IDæ˜¯<code>HYZViewController1SimpleButtonClick</code>.<br>æˆ‘ä»¬åœ¨<code>APPDelegate</code>çš„<code>application:didFinishLaunchingWithOptions:</code>æ–¹æ³•ä¸­, æ¥hookæ‰€æœ‰çš„åœ¨<code>trackList</code>ä¸­è®°å½•çš„æ–¹æ³•.<br>åœ¨``ä¸­, å®ç°å¦‚ä¸‹ç›¸å…³ä»£ç .</p>\n<pre><code>+ (void)setup {\n    //å®ç°å’Œæ›¿æ¢hookçš„blockæ–¹æ³•\n    NSMutableDictionary *blockDict = [[NSMutableDictionary alloc] init];\n    [HYZTrackManager weightEventEntry:blockDict];\n\n    [[HYZTrackList trackList] enumerateObjectsUsingBlock:^(id  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {\n        BOOL isLightEvent = [obj[kIsLightEvent] boolValue];\n        NSString *className = obj[kClassName];\n        NSString *functionName = obj[kHookFunction];\n        NSString *eventName = obj[kEventType];\n        Class class = NSClassFromString(className);\n        SEL selector = NSSelectorFromString(functionName);\n        if (isLightEvent == YES) {\n            if (!functionName) {\n                return;\n            }\n            [HYZTrackManager lightTrackTarget:class selector:selector functionName:functionName trackId:eventName];\n        } else {\n            NSString *blockName = obj[kHandlerBlock];\n            id handleBlock = [blockDict objectForKey:blockName];\n            if (!handleBlock) {\n                return;\n            }\n            [HYZTrackManager complexTrackTarget:class selector:selector usingBlock:handleBlock];\n        }\n    }];\n}\n</code></pre><p>é’ˆå¯¹ç®€å•åŸ‹ç‚¹, æˆ‘ä»¬ç›´æ¥ä½¿ç”¨</p>\n<pre><code>//ç®€å•åŸ‹ç‚¹è™½ç„¶å¯ä»¥æ‹¿åˆ°å¯¹åº”æ–¹æ³•çš„å‚æ•°, ä½†æ˜¯å¦‚æœéœ€è¦æŠŠè¯¥å‚æ•°ä¼ åˆ°åŸ‹ç‚¹è¯·æ±‚çš„ç½‘ç»œäº‹ä»¶ä¸­çš„è¯, å¿…é¡»ä½¿ç”¨å¤æ‚åŸ‹ç‚¹æ¥å¤„ç†\n+ (void)lightTrackTarget:(Class)target selector:(SEL)selector functionName:(NSString *)functionName trackId:(NSString *)trackId {\n    NSError *error;\n    NSInteger functionParamCount = [[functionName componentsSeparatedByString:@&quot;:&quot;] count] - 1;\n    switch (functionParamCount) {\n        case 0: {\n            [target aspect_hookSelector:selector withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo){\n                [HYZTrackManager trackRequestWithTrackId:trackId, nil];\n            }error:&amp;error];\n        }\n            break;\n        case 1: {\n            [target aspect_hookSelector:selector withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo, id p1){\n                [HYZTrackManager trackRequestWithTrackId:trackId, p1, nil];\n            }error:&amp;error];\n        }\n            break;\n        case 2: {\n            [target aspect_hookSelector:selector withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo, id p1, id p2){\n                [HYZTrackManager trackRequestWithTrackId:trackId, p1, p2, nil];\n            }error:&amp;error];\n        }\n            break;\n        case 3: {\n            [target aspect_hookSelector:selector withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo, id p1, id p2, id p3){\n                [HYZTrackManager trackRequestWithTrackId:trackId, p1, p2, p3, nil];\n            }error:&amp;error];\n        }\n            break;\n        case 4: {\n            [target aspect_hookSelector:selector withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo, id p1, id p2, id p3, id p4){\n                [HYZTrackManager trackRequestWithTrackId:trackId, p1, p2, p3, p4, nil];\n            }error:&amp;error];\n        }\n            break;\n        default:\n            break;\n    }\n}\n</code></pre><p>ç®€å•åŸ‹ç‚¹è™½ç„¶ä¹Ÿå¯ä»¥æ‹¿åˆ°Hookçš„æ–¹æ³•çš„å‚æ•°, ä½†æ˜¯ç”±äºé€šç”¨æ€§, æ‰€ä»¥ä¸èƒ½ç”¨æ¥ä¼ é€’å¯å˜çš„å‚æ•°.</p>\n<p>çœŸæ­£çš„åŸ‹ç‚¹è¯·æ±‚æ˜¯è¿™æ ·çš„</p>\n<pre><code>+ (void)trackRequestWithTrackId:(NSString *)trackId, ... NS_REQUIRES_NIL_TERMINATION{\n    // å®šä¹‰ä¸€ä¸ªæŒ‡å‘ä¸ªæ•°å¯å˜çš„å‚æ•°åˆ—è¡¨æŒ‡é’ˆï¼›\n    va_list args;\n    // ç”¨äºå­˜æ”¾å–å‡ºçš„å‚æ•°\n    NSString *arg;\n    // åˆå§‹åŒ–å˜é‡åˆšå®šä¹‰çš„va_listå˜é‡ï¼Œè¿™ä¸ªå®çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç¬¬ä¸€ä¸ªå¯å˜å‚æ•°çš„å‰ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå›ºå®šçš„å‚æ•°\n    va_start(args, trackId);\n    // éå†å…¨éƒ¨å‚æ•° va_argè¿”å›å¯å˜çš„å‚æ•°(a_argçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä½ è¦è¿”å›çš„å‚æ•°çš„ç±»å‹)\n    while ((arg = va_arg(args, NSString *))) {\n        NSLog(@&quot;%@&quot;, arg);\n    }\n    // æ¸…ç©ºå‚æ•°åˆ—è¡¨ï¼Œå¹¶ç½®å‚æ•°æŒ‡é’ˆargsæ— æ•ˆ\n    va_end(args);\n    NSLog(@&quot;æ­¤å¤„ç”¨æ¥å®ç°åŸ‹ç‚¹äº‹ä»¶è®°å½•%@çš„ç½‘ç»œè¯·æ±‚&quot;, trackId);\n}\n</code></pre><p>è‡³æ­¤, å®ç°äº†ç®€å•åŸ‹ç‚¹çš„æ–¹æ³•Hook.</p>\n<h2 id=\"å¤æ‚åŸ‹ç‚¹\"><a href=\"#å¤æ‚åŸ‹ç‚¹\" class=\"headerlink\" title=\"å¤æ‚åŸ‹ç‚¹\"></a>å¤æ‚åŸ‹ç‚¹</h2><p>å¤æ‚åŸ‹ç‚¹, å› ä¸ºè¦ä¼ å‚æ•°è¿›æ¥, æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨<code>+ (id&lt;AspectToken&gt;)aspect_hookSelector:(SEL)selector withOptions:(AspectOptions)options usingBlock:(id)block error:(NSError **)error;</code>å¯ä»¥ä¼ blockå‚æ•°æ¥å®ç°.<br>é¦–å…ˆ, æˆ‘ä»¬åœ¨<code>HYZTrackList</code>ä¸­æŠŠç±»å, æ–¹æ³•åå’Œéœ€è¦å®šä¹‰çš„Blockå…³è”èµ·æ¥,å¦‚ä¸‹æ‰€ç¤º.</p>\n<pre><code>{kClassName:@&quot;HYZViewController3&quot;,\nkHookFunction:@&quot;trackWithTag:&quot;,\nkHandlerBlock:@&quot;HYZViewController3TrackHandleBlock&quot;,\nkIsLightEvent:@(NO)}\n</code></pre><p>åœ¨<code>APPDelegate</code>ä¸­åˆå§‹åŒ–æ—¶, éœ€è¦åœ¨<code>HYZTrackManager</code>ä¸­å®ç°Blockçš„å®šä¹‰, </p>\n<pre><code>//hookçš„blockåœ¨è¿™é‡Œå®šä¹‰å’Œå®ç°\n+ (void)weightEventEntry:(NSMutableDictionary*)blockDict{\n    [HYZTrackManager trackButtonAction:blockDict];\n}\n\n//blockçš„å†…éƒ¨å®ç°\n+ (void)trackButtonAction:(NSMutableDictionary *)blockDict {\n    void(^HYZViewController3TrackHandleBlock)(id, NSInteger tag) = ^(id &lt;AspectInfo&gt;aspectInfo, NSInteger tag) {\n        switch (tag) {\n                case 1: {\n                    [HYZTrackManager trackRequestWithTrackId:[NSString stringWithFormat:@&quot;%ld&quot;, tag], nil];\n                }\n                break;\n                case 2: {\n                    [HYZTrackManager trackRequestWithTrackId:[NSString stringWithFormat:@&quot;%ld&quot;, tag], nil];\n                }\n                break;\n                case 3: {\n                    [HYZTrackManager trackRequestWithTrackId:[NSString stringWithFormat:@&quot;%ld&quot;, tag], nil];\n                }\n                break;\n                case 4: {\n                    [HYZTrackManager trackRequestWithTrackId:[NSString stringWithFormat:@&quot;%ld&quot;, tag], nil];\n                }\n                break;\n            default:\n                break;\n        }\n    };\n    [blockDict setObject:[HYZViewController3TrackHandleBlock copy] forKey:@&quot;HYZViewController3TrackHandleBlock&quot;];\n}\n</code></pre><p>ç„¶åHookåŸæ–¹æ³•;</p>\n<pre><code>//å¤æ‚çš„åŸ‹ç‚¹,\n+ (void)complexTrackTarget:(Class)target selector:(SEL)selector usingBlock:(id)block {\n    NSError *error;\n    [target aspect_hookSelector:selector withOptions:AspectPositionAfter usingBlock:block error:&amp;error];\n}\n</code></pre><p><a href=\"https://github.com/HChong3210/AOPTrack\" target=\"_blank\" rel=\"noopener\">Demo</a><br>å‚è€ƒèµ„æ–™: </p>\n<ol>\n<li><a href=\"http://www.jianshu.com/p/dc9dca24d5de\" target=\"_blank\" rel=\"noopener\">iOS å¦‚ä½•å®ç°Aspect Oriented Programming</a></li>\n<li><a href=\"http://www.vienta.me/2016/09/21/AOP%E5%9C%A8iOS%E4%B8%AD%E7%9A%84%E5%AE%9E%E8%B7%B5%E4%B8%80%E7%BB%9F%E8%AE%A1%E5%9F%8B%E7%82%B9/\" target=\"_blank\" rel=\"noopener\">AOPåœ¨iOSä¸­çš„å®è·µâ€”â€”ç»Ÿè®¡åŸ‹ç‚¹</a></li>\n<li><a href=\"http://www.cocoachina.com/ios/20160421/15912.html\" target=\"_blank\" rel=\"noopener\">å¯å¤ç”¨ä¸”é«˜åº¦è§£è€¦çš„iOSç”¨æˆ·ç»Ÿè®¡å®ç°</a></li>\n<li><a href=\"http://www.cocoachina.com/ios/20150120/10959.html\" target=\"_blank\" rel=\"noopener\">Method Swizzlingå’ŒAOP(é¢å‘åˆ‡é¢ç¼–ç¨‹)å®è·µ</a></li>\n</ol>\n","categories":["ç»Ÿè®¡æ‰“ç‚¹"],"tags":["è§£å†³æ–¹æ¡ˆ","AOP","ç»Ÿè®¡æ‰“ç‚¹"]},{"title":"è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼","url":"http://hchong.net/2017/02/08/è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼/","content":"<h1 id=\"è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼\"><a href=\"#è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼\" class=\"headerlink\" title=\"è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼\"></a>è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼</h1><p>ä¸‹é¢æœ‰ä¸€ä¸ªcase, è¦ç¼–å†™ä¸€ä¸ªç®€å•çš„è®¡ç®—å™¨ç¨‹åº, ç”¨æ¥å®ç°åŠ å‡ä¹˜é™¤çš„è¿ç®—æ“ä½œ, å¹¶ä¸”å±•ç¤ºå‡ºæ¥.æˆ‘ä»¬å°±æ‹¿è¿™ä¸ªæœ€ç®€å•çš„ä¾‹å­æ¥ä¸€æ­¥ä¸€æ­¥è§è¯†ä¸€ä¸‹â€å·¥å‚æ¨¡å¼â€çš„é­…åŠ›.</p>\n<h2 id=\"ç‰ˆæœ¬ä¸€\"><a href=\"#ç‰ˆæœ¬ä¸€\" class=\"headerlink\" title=\"ç‰ˆæœ¬ä¸€\"></a>ç‰ˆæœ¬ä¸€</h2><p>ç‰ˆæœ¬ä¸€:æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„æœ€ç®€å•çš„æ¨¡å¼å°±æ˜¯æˆ‘ä»¬å…ˆä»ä¸šåŠ¡ä¸Šæ¥æ‹†åˆ†, æŠŠè®¡ç®—å™¨ç¨‹åºåˆ†æˆä¸¤éƒ¨åˆ†<em>è®¡ç®—</em>å’Œ<em>å±•ç¤º</em>ä¸¤ä¸ªç±»æ¥å†™ä»£ç .OCä½œä¸ºä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€, åœ¨è¿™é‡Œæˆ‘ä»¬å·²ç»å¯ä»¥æ¸…æ¥šåœ°æ„è¯†åˆ°æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†<em>å°è£…</em>è¿™é¢å‘å¯¹è±¡è¯­è¨€çš„ä¸€å¤§ç‰¹æ€§.ä½†æ˜¯éšç€ä¸šåŠ¡çš„å‘å±•, æˆ‘ä»¬å‘ç°å¯èƒ½ä¼šå¢åŠ å…¶ä»–çš„ä¸šåŠ¡(ä¾‹å¦‚å¢åŠ å…¶ä»–çš„è¿ç®—æ“ä½œ),è¿™æ˜¯æˆ‘ä»¬æ¯æ¬¡éƒ½è¦ä¿®æ”¹<em>è®¡ç®—</em>è¿™ä¸ªç±», æ…¢æ…¢çš„ä»£ç å°±ä¼šè¶Šæ¥è¶Šå¤š, ä¸åˆ©äºç»´æŠ¤.è€Œä¸”åœ¨æ–°åŠ é€»è¾‘çš„è¿‡ç¨‹ä¸­æœ‰å¯èƒ½ä¼šä¿®æ”¹åˆ°è€çš„ä»£ç , ç»´æŠ¤æˆæœ¬å¾ˆé«˜.è¿™æ˜¯æˆ‘ä»¬å°±ä¼šæƒ³åˆ°å…¶ä»–ä¸¤ä¸ªç‰¹æ€§<em>ç»§æ‰¿</em>å’Œ<em>å¤šæ€</em>.äºæ˜¯, å°±æœ‰äº†ç‰ˆæœ¬äºŒ.</p>\n<h2 id=\"ç‰ˆæœ¬äºŒ\"><a href=\"#ç‰ˆæœ¬äºŒ\" class=\"headerlink\" title=\"ç‰ˆæœ¬äºŒ\"></a>ç‰ˆæœ¬äºŒ</h2><p>è¿™æ—¶æˆ‘ä»¬å‘ç°,æŠŠæ‰€æœ‰çš„è¿ç®—å†™åˆ°ä¸€ä¸ªç±»ä¸­æ˜¯æœ‰äº›ä¸å¦¥å½“çš„, é‚£ä¹ˆè¦æ€ä¹ˆæ¥ä¿®æ”¹å‘¢.æˆ‘ä»¬è‡ªç„¶åœ°æƒ³åˆ°, æ¯ä¸€ç§è¿ç®—å¯ä»¥å•ç‹¬åº¦çš„å°è£…ä¸ºä¸€ä¸ªç±», åªç”¨äºå®ç°å›ºå®šçš„è®¡ç®—.äºæ˜¯æˆ‘ä»¬å¯ä»¥å¾—åˆ°<em>åŠ </em>,<em>å‡</em>,<em>ä¹˜</em>,<em>é™¤</em>å››ä¸ªç±», æ¯ä¸ªç±»éƒ½ä¸‰ä¸ªå±æ€§, åˆ†åˆ«æ˜¯<em>æ“ä½œæ•°</em>å’Œ<em>ç»“æœ</em>.å“ªé‡Œæ€ªæ€ªçš„å‘¢, æœ‰æ²¡æœ‰ä¸€ä¸â€åä»£ç â€çš„å‘³é“å‘¢.é€šè¿‡æç‚¼æˆ‘ä»¬å‘ç°å››ä¸ªç±»éƒ½æœ‰ç›¸åŒçš„ä¸‰ä¸ªå±æ€§,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·åšæ–°å»ºä¸€ä¸ª<code>Operation</code>æ“ä½œç±», åŒ…å«ä¸‰ä¸ª<code>Public</code>å±æ€§</p>\n<pre><code>@interface Operation : NSObject\n\n@property (nonatomic, assign) CGFloat numberA;\n@property (nonatomic, assign) CGFloat numberB;\n@property (nonatomic, assign) CGFloat numberResult;\n\n- (CGFloat)getResult;\n@end\n</code></pre><p>è¿™æ ·çš„è¯, åªéœ€è¦æ¯ä¸€ä¸ªå•ç‹¬çš„è®¡ç®—ç±»ç»§æ‰¿äº<code>Operation</code>ç±», å°±ä¼šè‡ªå¸¦çˆ¶ç±»çš„ä¸‰ä¸ªå±æ€§, åªç”¨åœ¨ä»–ä»¬å†…éƒ¨å®ç°è‡ªå·±ç‹¬æœ‰çš„è®¡ç®—æ–¹æ³•, è¿”å›è®¡ç®—ç»“æœå°±å¯ä»¥äº†.åˆ°è¿™é‡Œ, æˆ‘ä»¬ä¼šå‘ç°ä»£ç å˜å¾—æ›´åŠ æœ‰æ„æ€äº†.<br>ä½†æ˜¯æˆ‘ä»¬åˆå‘ç°äº†ä¸€ä¸ªæ–°çš„é—®é¢˜, é‚£å°±æ˜¯æˆ‘ä»¬è¯¥ä½•æ—¶åˆå§‹åŒ–å“ªä¸ªç±»å‘¢, æ¯•ç«Ÿæˆ‘ä»¬ç°åœ¨æœ‰äº†å››ä¸ªè®¡ç®—å­ç±».æˆ‘ä»¬åªå¥½è®¡ç®—ç»“æœçš„åœ°æ–¹å†™<code>Switch</code>æ¡ä»¶æ¥åˆ¤æ–­åˆ°åº•è¦åˆå§‹åŒ–é‚£ä¸€ä¸ªå­ç±».</p>\n<p>å¯æ˜¯ä»ç„¶æ„Ÿè§‰å“ªé‡Œè¿˜æ˜¯æ€ªæ€ªçš„.æˆ‘ä»¬ä¸æ˜¯è¿˜æœ‰<em>å¤šæ€</em>è¿™ç§ç‰¹æ€§æ²¡æœ‰ä½¿ç”¨çš„å˜›.ä»”ç»†ä¸€æƒ³, äºæ˜¯åˆæœ‰äº†ç‰ˆæœ¬ä¸‰.</p>\n<h2 id=\"ç‰ˆæœ¬ä¸‰\"><a href=\"#ç‰ˆæœ¬ä¸‰\" class=\"headerlink\" title=\"ç‰ˆæœ¬ä¸‰\"></a>ç‰ˆæœ¬ä¸‰</h2><blockquote>\n<p>å¤šæ€:å¤šæ€è¡¨ç¤ºä¸åŒçš„å¯¹è±¡å¯ä»¥æ‰§è¡Œç›¸åŒçš„æ“ä½œ, ä½†è¦é€šè¿‡ä»–ä»¬è‡ªå·±çš„å®ç°ä»£ç æ¥æ‰§è¡Œ.<br>è¿™æ˜¯æˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªå·¥å‚ç±»<code>OperationFactory</code>, ç”¨æ¥åˆ¤æ–­è¦åˆå§‹åŒ–å“ªä¸€ä¸ªå­ç±».</p>\n</blockquote>\n<p><code>OperationFactory.h</code>ä»£ç å¦‚ä¸‹:</p>\n<pre><code>@class Operation;\n@interface OperationFactory : NSObject\n\n+ (Operation *)createOperationWithOperate:(NSString *)operate;\n@end\n</code></pre><p><code>OperationFactory.m</code>ä»£ç å¦‚ä¸‹:</p>\n<pre><code>@implementation OperationFactory\n\n//ä¼ å…¥è®¡ç®—ç¬¦å·, åˆå§‹åŒ–ä¸åŒçš„å­ç±»\n+ (Operation *)createOperationWithOperate:(NSString *)operate {\n    if ([operate isEqualToString:@&quot;+&quot;]) {\n        OperationAdd *add = [[OperationAdd alloc] init];\n        return add;\n    }\n\n    if ([operate isEqualToString:@&quot;-&quot;]) {\n        OperationSubtraction *subtraction = [[OperationSubtraction alloc] init];\n        return subtraction;\n    }\n\n    ...\n    return nil;\n}\n\n@end\n</code></pre><p>æ­¤æ—¶å±•ç¤ºçš„åœ°æ–¹, ä»£ç å°±å˜å¾—å¾ˆç®€å•äº†:</p>\n<pre><code>@interface ViewController ()\n\n@end\n\n@implementation ViewController\n- (void)viewDidLoad {\n    [super viewDidLoad];\n    // Do any additional setup after loading the view, typically from a nib.\n    Operation *operation = [OperationFactory createOperationWithOperate:@&quot;-&quot;];//å­ç±»ä»¥çˆ¶ç±»çš„èº«ä»½å‡ºç°\n    operation.numberA = 3;\n    operation.numberB = 5;\n    CGFloat result = [operation getResult];//å­ç±»åœ¨å·¥ä½œæ—¶ä»¥è‡ªå·±çš„æ–¹å¼å®ç°\n    NSLog(@&quot;%f&quot;, result);\n    NSLog(@&quot;%f&quot;, operation.numberResult);\n}\n@end\n</code></pre><p>å¦‚ä¸Šæˆ‘ä»¬å¯ä»¥å‘ç°, æ•´ä¸ªå·¥å‚æ¨¡å¼çš„å…³é”®å°±åœ¨äº<code>OperationFactory</code>è¿™ä¸ªå·¥å‚ç±»çš„å®ç°.æˆ‘ä»¬åœ¨è°ƒç”¨çš„æ—¶å€™ä¸ç”¨å…³å¿ƒæˆ‘ä»¬è¦å®ç°å“ªä¸€ä¸ªç±», <code>CGFloat result = [operation getResult];</code>, åªç”¨è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å°±å¯ä»¥, è€Œå†…éƒ¨åˆ™æ˜¯å­ç±»è‡ªå·±çš„å®ç°.<br>è¿™é‡Œé¢è¿˜æœ‰å‡ ç‚¹è¦æ³¨æ„:</p>\n<blockquote>\n<ol>\n<li>å­ç±»ä»¥çˆ¶ç±»çš„èº«ä»½å‡ºç°</li>\n<li>å­ç±»åœ¨å·¥ä½œæ—¶ä»¥è‡ªå·±çš„æ–¹å¼å®ç°</li>\n<li>å­ç±»ç‹¬æœ‰çš„æ–¹æ³•å’Œå±æ€§ä¸å¯ä»¥ä½¿ç”¨</li>\n</ol>\n</blockquote>\n<p>åœ¨è¿™é‡Œè§£é‡Šä¸€ä¸‹å°±æ˜¯, æˆ‘ä»¬åœ¨å±•ç¤ºçš„æ—¶å€™åˆå§‹åŒ–çš„å®é™…ä¸Šæ˜¯çˆ¶ç±»<code>Operation</code>.ä½†æ˜¯åœ¨è·å–è®¡ç®—ç»“æœæ—¶, æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å­ç±»çš„è®¡ç®—æ–¹æ³•<code>CGFloat result = [operation getResult];</code>, å› ä¸ºæˆ‘ä»¬åœ¨å­ç±»é‡Œé¢å¤å†™äº†çˆ¶ç±»çš„æ–¹æ³•, æ‰€ä»¥å®é™…ä¸Šèµ°çš„è¿˜æ˜¯å­ç±»å„è‡ªè‡ªå·±çš„æ–¹æ³•.</p>\n","categories":["è®¾è®¡æ¨¡å¼"],"tags":["æ¶æ„","è®¾è®¡æ¨¡å¼"]},{"title":"å¸¸è§çš„ä»£ç \"åå‘³é“\"","url":"http://hchong.net/2016/12/28/å¸¸è§çš„ä»£ç åå‘³é“/","content":"<h1 id=\"å¸¸è§çš„ä»£ç â€åå‘³é“â€\"><a href=\"#å¸¸è§çš„ä»£ç â€åå‘³é“â€\" class=\"headerlink\" title=\"å¸¸è§çš„ä»£ç â€åå‘³é“â€\"></a><strong>å¸¸è§çš„ä»£ç â€åå‘³é“â€</strong></h1><p>æ­£æ‰€è°“ä¼˜é›…çš„ä»£ç æ˜¯ç›¸ä¼¼çš„, ä¸ä¼˜é›…çš„ä»£ç å´å„æœ‰å„çš„ä¸‘. æœ€è¿‘åœ¨æ‹œè¯»&lt;é‡æ„- æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡&gt;ä¸€ä¹¦, è™½ç„¶ä¹¦ä¸­å¤§é‡ç¤ºä¾‹æ˜¯ç”¨Javaç¼–å†™çš„, ä½†æ˜¯ä¹Ÿç»™äº†æˆ‘å¾ˆå¤šå¯å‘.<br>è§è´¤æ€é½, è€—æ—¶æŠŠæ„Ÿæƒ³è®°å½•ä¸‹æ¥, ç£ä¿ƒè‡ªå·±çš„æˆé•¿. </p>\n<h2 id=\"é‡å¤ä»£ç \"><a href=\"#é‡å¤ä»£ç \" class=\"headerlink\" title=\"é‡å¤ä»£ç \"></a><strong>é‡å¤ä»£ç </strong></h2><p>åå‘³é“è¡Œåˆ—ä¸­ ,æœ€å¸¸è§çš„å°±æ˜¯Duplicated Code. å¦‚æœä½ åœ¨ä¸€ä¸ªä»¥ä¸Šçš„åœ°ç‚¹çœ‹åˆ°ç›¸åŒçš„ç¨‹åºç»“æ„, é‚£ä¹ˆå¯ä»¥è‚¯å®š: æŠŠä»–ä»¬åˆè€Œä¸ºä¸€, ä¼šä½¿å¾—ä»£ç å˜å¾—æ›´å¥½.</p>\n<ol>\n<li><p>æœ€å•çº¯çš„Duplicated Codeå°±æ˜¯â€åŒä¸€ä¸ªç±»çš„ä¸¤ä¸ªå‡½æ•°æœ‰ç›¸åŒçš„è¡¨è¾¾å¼â€, è§£å†³åŠæ³•å°±æ˜¯:</p>\n<ul>\n<li>é‡‡ç”¨Extract Method(æç‚¼å‡½æ•°)æç‚¼å‡ºé‡å¤çš„ä»£ç , ç„¶åè¿™ä¸¤ä¸ªåœ°æ–¹éƒ½è°ƒç”¨æç‚¼å‡ºæ¥çš„é‚£ä¸€æ®µä»£ç .</li>\n</ul>\n</li>\n<li><p>ä¸¤ä¸ªäº’ä¸ºå…„å¼Ÿçš„å­ç±»å†…åŒ…å«ç›¸åŒçš„è¡¨è¾¾å¼, è§£å†³åŠæ³•å°±æ˜¯:</p>\n<ul>\n<li>å¯¹ä¸¤ä¸ªç±»éƒ½æ˜¯ç”¨Extract Method(æç‚¼å‡½æ•°), å†å¯¹æç‚¼å‡ºæ¥çš„ä»£ç ä½¿ç”¨Pull Up Method(å‡½æ•°ä¸Šç§»)</li>\n<li>å¦‚æœä»£ç åªæ˜¯ç±»ä¼¼è€Œä¸å®Œå…¨ç›¸åŒ, é‚£å°±è¦å…ˆä½¿ç”¨Extract Method(æç‚¼å‡½æ•°)å°†ç›¸ä¼¼å’Œå·®å¼‚çš„ä»£ç åˆ†éš”å¼€, æ„é€ æˆä¸€ä¸ªå•ç‹¬çš„å‡½æ•°, ç„¶åå†<em>å¡‘é€ æ¨¡æ¿å‡½æ•°</em></li>\n</ul>\n</li>\n<li><p>å¦‚æœä¸¤ä¸ªæ¯«ä¸ç›¸å…³çš„ç±»å‡ºç°Duplicated Code, åº”è¯¥æŠŠé‡å¤ä»£ç æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹ç±»ä¸­, ç„¶åå†å¦ä¸€ä¸ªç±»ä¸­ä½¿ç”¨è¿™ä¸ªæ–°ç±»</p>\n</li>\n</ol>\n<blockquote>\n<p>å‡½æ•°ä¸Šç§»(Pull Up Method): è‹¥å¹²ä¸ªèº«å¤„å­ç±»ä¸­çš„å‡½æ•°, ä»–ä»¬åˆå¯ä»¥é€šè¿‡æŸç§å½¢å¼çš„å‚æ•°è°ƒæ•´æˆä¸ºç›¸åŒçš„å‡½æ•°. è¿™æ—¶å€™, æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯é¦–å…ˆåˆ†åˆ«è°ƒæ•´è¿™äº›å‡½æ•°çš„å‚æ•°, ç„¶åå†å°†ä»–ä»¬æ¦‚æ‹¬åˆ°çˆ¶ç±»ä¸­å». ç‰¹æ®Šæƒ…å†µ: å½“å­ç±»çš„å‡½æ•°è¦†å†™äº†çˆ¶ç±»çš„å‡½æ•°, ä½†å´ä»ç„¶åšç›¸åŒçš„å·¥ä½œ.</p>\n<p>å¡‘é€ æ¨¡æ¿å‡½æ•°(Form Template Method): ä¸¤ä¸ªå‡½æ•°ä»¥ç›¸åŒé¡ºåºæ‰§è¡Œå¤§è‡´ç›¸è¿‘çš„æ“ä½œ, ä½†æ˜¯å„æ“ä½œä¸å®Œå…¨ç›¸åŒ. è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥å°†æ‰§è¡Œæ“ä½œçš„åºåˆ—ç§»è‡³çˆ¶ç±», å¹¶å€ŸåŠ©å¤šæ€ä¿è¯å„æ“ä»å¾—ä»¥ä¿æŒå·®å¼‚æ€§.</p>\n</blockquote>\n<h2 id=\"è¿‡é•¿å‡½æ•°-Long-Method\"><a href=\"#è¿‡é•¿å‡½æ•°-Long-Method\" class=\"headerlink\" title=\"è¿‡é•¿å‡½æ•°(Long Method)\"></a><strong>è¿‡é•¿å‡½æ•°(Long Method)</strong></h2><p>ç¨‹åºæ„ˆé•¿æ„ˆéš¾ç†è§£.<br>æˆ‘ä»¬åº”è¯¥ç§¯æåœ°åˆ†è§£å‡½æ•°, åªè¦ä½ æ„Ÿè§‰éœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹åŠ æ³¨é‡Š, æˆ‘ä»¬å°±è¦æŠŠéœ€è¦è¯´æ˜çš„ä¸œè¥¿å†™è¿›ä¸€ä¸ªç‹¬ç«‹å‡½æ•°, å¹¶ä»¥å…¶ç”¨é€”(è€Œéå®ç°æ‰‹æ³•)å‘½å. å“ªæ€•æ›¿æ¢åçš„å‡½æ•°è°ƒç”¨åŠ¨ä½œæ¯”å‡½æ•°è‡ªèº«è¿˜é•¿, åªè¦å‡½æ•°åç§°èƒ½å¤Ÿè§£é‡Šå…¶ç”¨é€”, æˆ‘ä»¬å°±åº”è¯¥æ¯«ä¸çŠ¹è±«åœ°é‚£ä¹ˆåš, å…³é”®ä¸åœ¨äºå‡½æ•°çš„é•¿åº¦, è€Œåœ¨äºâ€åšä»€ä¹ˆâ€å’Œâ€å¦‚ä½•åšâ€ä¹‹é—´çš„è¯­ä¹‰è·ç¦».</p>\n<ol>\n<li>å¤§å¤šæ•°åœºåˆ, æŠŠå‡½æ•°å˜å°, åªéœ€ä½¿ç”¨Extract Method(æç‚¼å‡½æ•°). æ‰¾åˆ°å‡½æ•°ä¸­é€‚åˆé›†ä¸­åœ¨ä¸€èµ·çš„éƒ¨åˆ†, å°†ä»–ä»¬æç‚¼å‡ºæ¥ä¸€ä¸ªæ–°å‡½æ•°.</li>\n<li>å¦‚æœå‡½æ•°ä¸­æœ‰å¤§é‡çš„å‚æ•°å’Œä¸´æ—¶å˜é‡, ä»–ä»¬ä¼šå¯¹ä½ çš„å‡½æ•°æç‚¼å½¢æˆé˜»ç¢. å¦‚æœ</li>\n</ol>\n<h2 id=\"è¿‡å¤§çš„ç±»-Large-Class\"><a href=\"#è¿‡å¤§çš„ç±»-Large-Class\" class=\"headerlink\" title=\"è¿‡å¤§çš„ç±»(Large Class)\"></a><strong>è¿‡å¤§çš„ç±»(Large Class)</strong></h2><h2 id=\"è¿‡é•¿å‚æ•°åˆ—-Long-Parameter-List\"><a href=\"#è¿‡é•¿å‚æ•°åˆ—-Long-Parameter-List\" class=\"headerlink\" title=\"è¿‡é•¿å‚æ•°åˆ—(Long Parameter List)\"></a><strong>è¿‡é•¿å‚æ•°åˆ—(Long Parameter List)</strong></h2><h2 id=\"å‘æ•£å¼å˜åŒ–-Divergent-Change\"><a href=\"#å‘æ•£å¼å˜åŒ–-Divergent-Change\" class=\"headerlink\" title=\"å‘æ•£å¼å˜åŒ–(Divergent Change)\"></a><strong>å‘æ•£å¼å˜åŒ–(Divergent Change)</strong></h2><h2 id=\"éœ°å¼¹å¼ä¿®æ”¹-Shotgun-Surgery\"><a href=\"#éœ°å¼¹å¼ä¿®æ”¹-Shotgun-Surgery\" class=\"headerlink\" title=\"éœ°å¼¹å¼ä¿®æ”¹(Shotgun Surgery)\"></a><strong>éœ°å¼¹å¼ä¿®æ”¹(Shotgun Surgery)</strong></h2><h2 id=\"ä¾æ‹æƒ…ç»“-Feature-Envy\"><a href=\"#ä¾æ‹æƒ…ç»“-Feature-Envy\" class=\"headerlink\" title=\"ä¾æ‹æƒ…ç»“(Feature Envy)\"></a><strong>ä¾æ‹æƒ…ç»“(Feature Envy)</strong></h2><h2 id=\"æ•°æ®æ³¥å›¢-Data-Clumps\"><a href=\"#æ•°æ®æ³¥å›¢-Data-Clumps\" class=\"headerlink\" title=\"æ•°æ®æ³¥å›¢(Data Clumps)\"></a><strong>æ•°æ®æ³¥å›¢(Data Clumps)</strong></h2><h2 id=\"åŸºæœ¬ç±»å‹åæ‰§-Primitive-Obsession\"><a href=\"#åŸºæœ¬ç±»å‹åæ‰§-Primitive-Obsession\" class=\"headerlink\" title=\"åŸºæœ¬ç±»å‹åæ‰§(Primitive Obsession)\"></a><strong>åŸºæœ¬ç±»å‹åæ‰§(Primitive Obsession)</strong></h2><h2 id=\"Switch-æƒŠæ‚šç°èº«-Switch-Statements\"><a href=\"#Switch-æƒŠæ‚šç°èº«-Switch-Statements\" class=\"headerlink\" title=\"Switch æƒŠæ‚šç°èº«(Switch Statements)\"></a><strong>Switch æƒŠæ‚šç°èº«(Switch Statements)</strong></h2><h2 id=\"å¹³è¡Œç»§æ‰¿ä½“ç³»-Parallel-Inheritance-Hierarchies\"><a href=\"#å¹³è¡Œç»§æ‰¿ä½“ç³»-Parallel-Inheritance-Hierarchies\" class=\"headerlink\" title=\"å¹³è¡Œç»§æ‰¿ä½“ç³»(Parallel Inheritance Hierarchies)\"></a><strong>å¹³è¡Œç»§æ‰¿ä½“ç³»(Parallel Inheritance Hierarchies)</strong></h2><h2 id=\"å†—èµ˜ç±»-Lazy-Class\"><a href=\"#å†—èµ˜ç±»-Lazy-Class\" class=\"headerlink\" title=\"å†—èµ˜ç±»(Lazy Class)\"></a><strong>å†—èµ˜ç±»(Lazy Class)</strong></h2><h2 id=\"å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§-Speculative-Generatlity\"><a href=\"#å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§-Speculative-Generatlity\" class=\"headerlink\" title=\"å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§(Speculative Generatlity)\"></a><strong>å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§(Speculative Generatlity)</strong></h2><h2 id=\"ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ-Temporary-Field\"><a href=\"#ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ-Temporary-Field\" class=\"headerlink\" title=\"ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ(Temporary Field)\"></a><strong>ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ(Temporary Field)</strong></h2><h2 id=\"è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾-Message-Chains\"><a href=\"#è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾-Message-Chains\" class=\"headerlink\" title=\"è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾(Message Chains)\"></a><strong>è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾(Message Chains)</strong></h2><h2 id=\"ä¸­é—´äºº-Middle-Man\"><a href=\"#ä¸­é—´äºº-Middle-Man\" class=\"headerlink\" title=\"ä¸­é—´äºº(Middle Man)\"></a><strong>ä¸­é—´äºº(Middle Man)</strong></h2><h2 id=\"ç‹æ˜µå…³ç³»-Inappropriate-Intimacy\"><a href=\"#ç‹æ˜µå…³ç³»-Inappropriate-Intimacy\" class=\"headerlink\" title=\"ç‹æ˜µå…³ç³»(Inappropriate Intimacy)\"></a><strong>ç‹æ˜µå…³ç³»(Inappropriate Intimacy)</strong></h2><h2 id=\"å¼‚æ›²åŒå·¥çš„ç±»-AlertNative-Classes-with-Different-Interfaces\"><a href=\"#å¼‚æ›²åŒå·¥çš„ç±»-AlertNative-Classes-with-Different-Interfaces\" class=\"headerlink\" title=\"å¼‚æ›²åŒå·¥çš„ç±»(AlertNative Classes with Different Interfaces)\"></a><strong>å¼‚æ›²åŒå·¥çš„ç±»(AlertNative Classes with Different Interfaces)</strong></h2><h2 id=\"ä¸å®Œç¾çš„åº“ç±»-Incomplete-Library-Class\"><a href=\"#ä¸å®Œç¾çš„åº“ç±»-Incomplete-Library-Class\" class=\"headerlink\" title=\"ä¸å®Œç¾çš„åº“ç±»(Incomplete Library Class)\"></a><strong>ä¸å®Œç¾çš„åº“ç±»(Incomplete Library Class)</strong></h2><h2 id=\"çº¯ç¨šçš„æ•°æ®ç±»-Data-Class\"><a href=\"#çº¯ç¨šçš„æ•°æ®ç±»-Data-Class\" class=\"headerlink\" title=\"çº¯ç¨šçš„æ•°æ®ç±»(Data Class)\"></a><strong>çº¯ç¨šçš„æ•°æ®ç±»(Data Class)</strong></h2><h2 id=\"è¢«æ‹’ç»çš„é—èµ -Refused-Bequest\"><a href=\"#è¢«æ‹’ç»çš„é—èµ -Refused-Bequest\" class=\"headerlink\" title=\"è¢«æ‹’ç»çš„é—èµ (Refused Bequest)\"></a><strong>è¢«æ‹’ç»çš„é—èµ (Refused Bequest)</strong></h2><h2 id=\"è¿‡å¤šçš„æ³¨é‡Š-COmments\"><a href=\"#è¿‡å¤šçš„æ³¨é‡Š-COmments\" class=\"headerlink\" title=\"è¿‡å¤šçš„æ³¨é‡Š(COmments)\"></a><strong>è¿‡å¤šçš„æ³¨é‡Š(COmments)</strong></h2>","categories":["æ¶æ„"],"tags":["é‡æ„","æ¶æ„"]},{"title":"ä»£ç é‡æ„ä¸æ‹†åˆ†","url":"http://hchong.net/2016/12/26/ä»£ç é‡æ„ä¸æ‹†åˆ†/","content":"<h1 id=\"ä»£ç çš„é‡æ„ä¸æ‹†åˆ†\"><a href=\"#ä»£ç çš„é‡æ„ä¸æ‹†åˆ†\" class=\"headerlink\" title=\"ä»£ç çš„é‡æ„ä¸æ‹†åˆ†\"></a><strong>ä»£ç çš„é‡æ„ä¸æ‹†åˆ†</strong></h1><p>æœ€è¿‘é¡¹ç›®ä¸­æœ‰ä¸€å—ä»£ç , å‡ ç»äººæ‰‹, æµè½åˆ°æˆ‘è¿™é‡Œ. ä»£ç çš„ä¸šåŠ¡é€»è¾‘ååˆ†å¤æ‚, è€Œä¸”éšç€ä¸šåŠ¡çš„æ‰©å¼ , è¢«ä¸åŒçš„äººåŠ å…¥è€Œä¸åŒé£æ ¼çš„ä»£ç , æœ€åˆçš„æ¶æ„å·²ç»ä¸é€‚åˆç°æœ‰ä¸šåŠ¡çš„å‘å±•äº†, ç»´æŠ¤èµ·æ¥ä¹Ÿæ˜¯ç›¸å½“çš„å›°éš¾. äºæ˜¯, æˆ‘å°±èµ°ä¸Šäº†é‡æ„å’Œæ‹†åˆ†ä¹‹è·¯.</p>\n<p>å®é™…ä¸Šæ¥è®², é‡æ„å’Œæ‹†åˆ†æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µ, ä½†æ˜¯åˆéƒ½æ˜¯ç›¸è¾…ç›¸æˆ, ä¸‹é¢æˆ‘ç®€å•è®²ä¸€ä¸‹æˆ‘çš„ç†è§£.</p>\n<blockquote>\n<p>é‡æ„: å¯¹è½¯ä»¶å†…éƒ¨ç»“æ„çš„ä¸€ç§è°ƒæ•´, ç›®çš„æ˜¯åœ¨ä¸æ”¹å˜è½¯ä»¶å¯è§‚å¯Ÿè¡Œä¸ºçš„å‰æä¸‹, æé«˜å…¶å¯ç†è§£æ€§, é™ä½å…¶ä¿®æ”¹æˆæœ¬.</p>\n</blockquote>\n<ul>\n<li>æ‹†åˆ†: æ•´ä½“é¡¹ç›®çš„æ¶æ„, é™ä½ä»£ç çš„è€¦åˆæ€§, ä½¿å¾—å›¢é˜Ÿä¸­çš„æˆå‘˜åä½œä½¿ç”¨èµ·æ¥æ›´åŠ å®¹æ˜“.</li>\n</ul>\n<p>ä¸ç®¡é‡æ„è¿˜æ˜¯æ‹†åˆ†, éƒ½æ˜¯ä¸ºäº†è®©ä»£ç èƒ½å¤Ÿè·Ÿä¸Šä¸šåŠ¡å‘å±•çš„æ°´å¹³, ä¸è‡³äºå˜å¾—ä¸€å›¢ä¹±éº», è®©å›¢é˜Ÿä¹‹é—´çš„åä½œå¼€å‘æ›´åŠ æœ‰æ•ˆ.</p>\n","categories":["æ¶æ„"],"tags":["é‡æ„","æ‹†åˆ†"]},{"title":"hexoå¸¸è§é—®é¢˜","url":"http://hchong.net/2016/12/21/hexoå¸¸è§é—®é¢˜/","content":"<h1 id=\"hexoå¸¸è§é—®é¢˜\"><a href=\"#hexoå¸¸è§é—®é¢˜\" class=\"headerlink\" title=\"hexoå¸¸è§é—®é¢˜\"></a><strong>hexoå¸¸è§é—®é¢˜</strong></h1><p>åœ¨ä½¿ç”¨hexoçš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é—®é¢˜, åœ¨è¿™é‡Œåˆ—å‡ºæ¥, åšä¸€ä¸ªè®°å½•.</p>\n<h2 id=\"hexoçš„å¸¸è§å‘å¸ƒæµç¨‹\"><a href=\"#hexoçš„å¸¸è§å‘å¸ƒæµç¨‹\" class=\"headerlink\" title=\"hexoçš„å¸¸è§å‘å¸ƒæµç¨‹\"></a><strong>hexoçš„å¸¸è§å‘å¸ƒæµç¨‹</strong></h2><ul>\n<li>hexoæ–°å»ºä¸€ç¯‡æ–‡ç« ä½¿ç”¨<code>hexo new type name</code>, <code>type</code>æœ‰ä¸‰ç§, æœ€å¸¸ä½¿ç”¨çš„æ˜¯<code>post</code>, <code>name</code>æ˜¯æ–°å»ºæ–‡æ¡£çš„åå­—.</li>\n<li><p>hexoæ–°å»ºå®Œæˆ, ç¼–è¾‘ä¹‹åå‘å¸ƒä¼šç»å¸¸ä½¿ç”¨åˆ°ä¸‹é¢å‡ ä¸ªå‘½ä»¤:</p>\n<ul>\n<li><code>hexo clean</code>æ¸…é™¤ä¹‹å‰ç¼“å­˜çš„ä¸€äº›ä¿¡æ¯, ä¾‹å¦‚ä¸»é¢˜ä¹‹ç±»çš„, ä¸æ˜¯æ¯æ¬¡éƒ½å¿…é¡»æ‰§è¡Œ.</li>\n<li><code>hexo g</code>ç›¸å½“äºç¼–è¯‘.</li>\n<li><code>hexo s</code>å‘å¸ƒåˆ°æœ¬åœ°æœåŠ¡å™¨, æŠŠ<em>.md</em>æ–‡ä»¶ç”Ÿæˆè®²å°htmlç”¨äºå±•ç¤º, ä¹Ÿå¯åšè°ƒè¯•ç”¨.</li>\n<li><code>hexo d</code>æ¨æœ¬åœ°çš„æ–‡ä»¶åˆ°æœåŠ¡å™¨, è¿™é‡ŒæŒ‡çš„æ˜¯githubä¸Šé¢, å¦‚æœç»‘å®šçš„æœ‰åŸŸå, å°±ç›´æ¥å‘å¸ƒåˆ°Internet. æ¯æ¬¡æ¨é€å‰, è¦ç¡®ä¿<code>hexo g</code>å’Œ<code>hexo s</code>æ²¡æœ‰é—®é¢˜, å¦åˆ™å¯é€ æˆInternetä¸Šé¢æ— æ³•æ­£å¸¸æ˜¾ç¤º.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"hexoç›®å½•ç»“æ„åˆ†æ\"><a href=\"#hexoç›®å½•ç»“æ„åˆ†æ\" class=\"headerlink\" title=\"hexoç›®å½•ç»“æ„åˆ†æ\"></a><strong>hexoç›®å½•ç»“æ„åˆ†æ</strong></h2><h3 id=\"æ ¹ç›®å½•\"><a href=\"#æ ¹ç›®å½•\" class=\"headerlink\" title=\"æ ¹ç›®å½•\"></a><strong>æ ¹ç›®å½•</strong></h3><ul>\n<li>_config.yml: ä½äºæœ¬åœ°åšå®¢çš„æ ¹ç›®å½•ä¸‹, åœ¨è¿™é‡Œé¢å¯¹æ•´ä¸ªåšå®¢çš„å†…å®¹è¿›è¡Œä¸€äº›è®¾ç½®.</li>\n<li>sourceæ–‡ä»¶å¤¹: é‡Œé¢å­˜å‚¨ä¸€äº›åšå®¢ä½¿ç”¨çš„æ–‡ä»¶èµ„æº, ä¾‹å¦‚<em>category(åˆ†ç±»)</em>, <em>tag(æ ‡ç­¾)</em>, <em>link(é“¾æ¥)</em>, <em>about(å…³äº)</em>, <em>project(å·¥ç¨‹)</em>, <em>search(æœç´¢)</em>, *_posts(ä½¿ç”¨postæ ¼å¼æ–°å»ºçš„æ–‡ç« .mdæ–‡ä»¶å­˜å‚¨åœ¨è¿™é‡Œ).éœ€è¦è¯´æ˜ä¸€ä¸‹çš„æ˜¯, è¿™äº›æ–‡ä»¶å¤¹çš„åç§°å’Œæ•°é‡ä¸å›ºå®š, è¦çœ‹ä½ ä½¿ç”¨çš„ä¸»é¢˜é‡Œé¢çš„æ¨¡å—å¤§æ¦‚æœ‰å‡ ä¸ª ,æˆ‘ä½¿ç”¨çš„æ˜¯<a href=\"http://forsigner.com/2016/03/10/fexo-doc-zh-cn/\" target=\"_blank\" rel=\"noopener\">fexo</a>.è¿˜æœ‰ä¸€äº›å‘, åé¢å†è¯¦è¿°.</li>\n<li>publicæ–‡ä»¶å¤¹: é‡Œé¢å­˜å‚¨çš„æ˜¯ä¹‹å‰å‘å¸ƒè¿‡å¾—ä¸€äº›å½’æ¡£æ•°æ®, å¦‚æœè¦åˆ é™¤ä¹‹å‰çš„æµ‹è¯•æ•°æ®çš„è¯, è®°å¾—æ¸…ç†é‡Œé¢å“åº”çš„å†…å®¹.</li>\n<li>scaffoldsæ–‡ä»¶å¤¹: å­˜å‚¨.mdæ–‡æ¡£çš„ç±»å‹.</li>\n<li>themesæ–‡ä»¶å¤¹: é‡Œé¢æ˜¯ä½ ä¸‹è½½çš„ä¸»é¢˜å†…å®¹, å¦‚æœæœ‰å¤šä¸ªä¸»é¢˜, å°±ä¼šæœ‰å¤šä¸ªæ–‡ä»¶å¤¹, ä½†åªèƒ½åŒæ—¶ä½¿ç”¨ä¸€ç§æ ·å¼çš„ä¸»é¢˜.è¿™ä¸ªåé¢ä¼šç€é‡åˆ†æä¸€ä¸‹.</li>\n</ul>\n<h3 id=\"themesæ–‡ä»¶å¤¹\"><a href=\"#themesæ–‡ä»¶å¤¹\" class=\"headerlink\" title=\"themesæ–‡ä»¶å¤¹\"></a><strong>themesæ–‡ä»¶å¤¹</strong></h3><p>è¿™é‡Œé¢ä¸»è¦ä¼šè¿›è¡Œä¸€äº›ä¸»é¢˜ç›¸å…³çš„è®¾ç½®.</p>\n<ul>\n<li>_config.yml: ä½äºä¸»é¢˜ç›®å½•ä¸‹, åœ¨è¿™é‡Œé¢å¯¹å½“å‰åªç”¨ä¸»é¢˜çš„å†…å®¹è¿›è¡Œä¸€äº›é…ç½®, ä¸åŒä¸»é¢˜çš„é…ç½®å¯èƒ½ä¸å¤ªä¸€æ ·, æˆ‘æ˜¯ç”¨çš„æ˜¯<a href=\"http://forsigner.com/2016/03/10/fexo-doc-zh-cn/\" target=\"_blank\" rel=\"noopener\">fexo</a></li>\n</ul>\n<ul>\n<li>sourceæ–‡ä»¶å¤¹: è¯¥æ–‡ä»¶å¤¹ä¸‹é¢æ˜¯è¯¥ä¸»é¢˜ç›¸å…³çš„ä¸€äº›èµ„æº, ä¾‹å¦‚ä¸€äº›é™æ€çš„å›¾ç‰‡ä¹‹ç±»çš„.</li>\n<li>layoutæ–‡ä»¶å¤¹: è¯¥æ–‡ä»¶å¤¹ä¸‹é¢æ˜¯é™æ€é¡µé¢æ˜¾ç¤ºçš„ç›¸å…³é…ç½®. ä»£ç é«˜äº®çš„è®¾ç½®ä¹Ÿæ˜¯åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹é¢. å…¶ä»–çš„ä¾‹å¦‚é™æ€é¡µé¢çš„å±•ç¤º, å¯ä»¥ä¿®æ”¹ç›¸å…³çš„jsæ–‡ä»¶.</li>\n</ul>\n<h2 id=\"ä¿®æ”¹ä»£ç é«˜äº®\"><a href=\"#ä¿®æ”¹ä»£ç é«˜äº®\" class=\"headerlink\" title=\"ä¿®æ”¹ä»£ç é«˜äº®\"></a><strong>ä¿®æ”¹ä»£ç é«˜äº®</strong></h2><p>ä»£ç é«˜äº®çš„å±•ç¤º, ä¸åŒçš„ä¸»é¢˜æœ‰ä¸åŒçš„ä½¿ç”¨æ–¹å¼, ä½†æ˜¯ä»£ç é«˜äº®çš„themeå¯ä»¥å‚è€ƒè¿™é‡Œ, æˆ‘ä½¿ç”¨çš„æ˜¯<a href=\"https://highlightjs.org/static/demo/\" target=\"_blank\" rel=\"noopener\">HighLight</a>, å®ƒæä¾›äº†å¤šç§Theme, åŸºæœ¬ä¸Šèƒ½æ»¡è¶³å„ç§éœ€æ±‚.</p>\n<p>ä¿®æ”¹æ­¥éª¤å¦‚ä¸‹:</p>\n<p>1.ä¿®æ”¹åšå®¢æ ¹ç›®å½•ä¸‹çš„<em>_config.yml</em>æ–‡ä»¶, å…³é—­hexoè‡ªå¸¦çš„ä»£ç é«˜äº®.</p>\n<pre><code class=\"js\">highlight:\n  enable: false\n  line_number: false\n  auto_detect: false\n  tab_replace:\n</code></pre>\n<p>2.<code>cd åšå®¢æ ¹ç›®å½•/themes/fexo/layout/_partial</code>æ‰“å¼€<em>head.ejs</em>æ–‡ä»¶, æœ€å¥½æ˜¯åœ¨<code>&lt;head&gt;&lt;/head&gt;</code>ä¹‹é—´å¼€å¤´å¤„æ’å…¥ä»£ç </p>\n<pre><code class=\"html5\">  &lt;link rel=&quot;stylesheet&quot; href=&quot;//cdn.bootcss.com/highlight.js/9.2.0/styles/rainbow.min.css&quot;&gt;\n  &lt;script src=&quot;//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js&quot;&gt;&lt;/script&gt;\n  &lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;\n</code></pre>\n<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å†™æ³•:</p>\n<pre><code class=\"h5\">&lt;link rel=&quot;stylesheet&quot; href=&quot;/path/to/styles/default.css&quot;&gt;\n&lt;script src=&quot;/path/to/highlight.pack.js&quot;&gt;&lt;/script&gt;\n&lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;\n</code></pre>\n<p>äºŒè€…çš„åŒºåˆ«åœ¨äº, ç¬¬ä¸€ç§å†™æ³•ä½¿ç”¨çš„æ˜¯CDNåˆ›å»ºçš„<a href=\"http://www.bootcdn.cn/?\" target=\"_blank\" rel=\"noopener\">åœ¨çº¿æ–‡æ¡£åœ°å€</a>, è¯¥åœ°å€è¿˜ä¿å­˜äº†å…¶ä»–ä¸€äº›å¸¸è§çš„æ–‡æ¡£, éå¸¸å¼ºå¤§.è€Œç¬¬äºŒç§å†™æ³•åˆ™æ˜¯æŠŠæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°, ä»æœ¬åœ°è¯»å–ä»£ç é«˜äº®çš„é…ç½®.</p>\n<hr>\n<p>ä¿®æ”¹è¿‡ç¨‹ä¸­, æˆ‘å‚è€ƒäº†ä»¥ä¸‹ä¸¤ç¯‡åšæ–‡, è¿˜è¶Ÿè¿‡ä¸å°‘å‘, è´´ä¸Šåšæ–‡çš„åœ°å€:</p>\n<ol>\n<li><a href=\"http://www.ieclipse.cn/en/2016/07/18/Web/Hexo-dev-highlight/\" target=\"_blank\" rel=\"noopener\">åœ°å€ä¸€</a></li>\n<li><a href=\"http://jumpbyte.cn/2016/07/02/use-and-install-prettify/\" target=\"_blank\" rel=\"noopener\">åœ°å€äºŒ</a></li>\n</ol>\n","categories":["hexo"],"tags":["hexo","ä¸ªäººåšå®¢"]},{"title":"å±æ€§ä¿®é¥°ç¬¦ä¹‹copyå’Œstrong","url":"http://hchong.net/2016/09/21/å±æ€§ä¿®é¥°ç¬¦ä¹‹copyå’Œstrong/","content":"<h1 id=\"å±æ€§ä¿®é¥°ç¬¦ä¹‹copyå’Œstrong\"><a href=\"#å±æ€§ä¿®é¥°ç¬¦ä¹‹copyå’Œstrong\" class=\"headerlink\" title=\"å±æ€§ä¿®é¥°ç¬¦ä¹‹copyå’Œstrong\"></a>å±æ€§ä¿®é¥°ç¬¦ä¹‹copyå’Œstrong</h1><p>åœ¨äº†è§£å±æ€§ä¿®é¥°ç¬¦çš„copyå’Œstrongçš„åŒºåˆ†ä¹‹å‰, æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹æµ…æ‹·è´å’Œæ·±æ‹·è´çš„åŒºåˆ«.</p>\n<h2 id=\"æ·±æµ…æ‹·è´\"><a href=\"#æ·±æµ…æ‹·è´\" class=\"headerlink\" title=\"æ·±æµ…æ‹·è´\"></a>æ·±æµ…æ‹·è´</h2><p>æµ…å¤åˆ¶å¹¶ä¸æ˜¯æ‹·è´å¯¹è±¡æœ¬èº«, ä»…ä»…æ˜¯æ‹·è´æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆ; æ·±å¤åˆ¶æ˜¯ç›´æ¥æ‹·è´æ•´ä¸ªå¯¹è±¡å†…å­˜åˆ°å¦ä¸€å—å†…å­˜ä¸­. ç®€å•åœ°è¯´:</p>\n<ul>\n<li><strong>æµ…å¤åˆ¶å°±æ˜¯æŒ‡é’ˆæ‹·è´,  ä¸ä¼šäº§ç”Ÿæ–°çš„å¯¹è±¡ï¼ŒæŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡; </strong></li>\n<li><strong>æ·±å¤åˆ¶å°±æ˜¯å†…å®¹æ‹·è´ï¼Œä¼šäº§ç”Ÿæ–°çš„å¯¹è±¡, ä¸åŒçš„å¯¹è±¡, å†…å®¹ç›¸åŒ.</strong></li>\n</ul>\n<p><img src=\"http://7s1ssm.com1.z0.glb.clouddn.com/image_note50592_1.png\" alt=\"æµ…å¤åˆ¶å’Œæ·±å¤åˆ¶\"></p>\n<h2 id=\"copyå’ŒmutableCopy\"><a href=\"#copyå’ŒmutableCopy\" class=\"headerlink\" title=\"copyå’ŒmutableCopy\"></a>copyå’ŒmutableCopy</h2><p><code>copy</code>å°±æ˜¯å¤åˆ¶äº†ä¸€ä¸ªimutableå¯¹è±¡, <code>mutableCopy</code>å°±æ˜¯å¤åˆ¶äº†ä¸€ä¸ªmutableå¯¹è±¡.</p>\n<p>ä¸€ä¸ª<code>NSObject</code>å¯¹è±¡è¦æƒ³ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°, å¿…é¡»å®ç°<code>NSCopying</code>åè®®å’Œ<code>NSMutableCopying</code>åè®®, å¹¶ä¸”åˆ†åˆ«å®ç°<code>- (id)copyWithZone:(nullable NSZone *)zone;</code>å’Œ<code>- (id)mutableCopyWithZone:(nullable NSZone *)zone;</code>æ–¹æ³•.ä½†æ˜¯å¸¸è§çš„<code>NSString</code>, <code>NSArray</code>, <code>NADictionary</code>ç­‰å¸¸ç”¨çš„ç³»ç»Ÿæä¾›çš„ç»“æ„ä½“éƒ½å·²ç»å®ç°. </p>\n<h3 id=\"ç³»ç»Ÿçš„éå®¹å™¨ç±»å¯¹è±¡\"><a href=\"#ç³»ç»Ÿçš„éå®¹å™¨ç±»å¯¹è±¡\" class=\"headerlink\" title=\"ç³»ç»Ÿçš„éå®¹å™¨ç±»å¯¹è±¡\"></a>ç³»ç»Ÿçš„éå®¹å™¨ç±»å¯¹è±¡</h3><p>è¿™é‡ŒæŒ‡çš„æ˜¯<code>NSString</code>, <code>NSNumber</code>ç­‰ç­‰ä¸€ç±»çš„å¯¹è±¡.ä¸‹é¢ä»¥<code>NSString</code>ä¸ºä¾‹.</p>\n<p>å¯¹<code>NSString</code>è¿›è¡Œcopyå’ŒmutableCopæ“ä½œ:</p>\n<pre><code class=\"objective-c\">NSString *originString = @&quot;origin&quot;;\nNSString *originStringCopy = [originString copy];\nNSMutableString *originStringMutableCopy = [originString mutableCopy];\nNSLog(@&quot;%p, %p, %p&quot;, originString, originStringCopy, originStringMutableCopy);\n</code></pre>\n<p>å†…å­˜åœ°å€åˆ†åˆ«æ˜¯:</p>\n<pre><code class=\"objective-c\">(lldb) p originString\n(__NSCFConstantString *) $0 = 0x0000000108dd8190 @&quot;origin&quot;\n(lldb) p originStringCopy\n(__NSCFConstantString *) $1 = 0x0000000108dd8190 @&quot;origin&quot;\n(lldb) p originStringMutableCopy\n(__NSCFString *) $2 = 0x0000608000262800 @&quot;origin&quot;\n</code></pre>\n<hr>\n<p>å¯¹<code>NSMutableString</code>è¿›è¡Œcopyå’ŒmutableCopyæ“ä½œ:</p>\n<pre><code class=\"objective-c\">NSMutableString *mutableOriginString = [NSMutableString stringWithString:@&quot;mutableOrigin&quot;];\nNSString *mutableOriginStringCopy = [mutableOriginString copy];\nNSMutableString *mutableOriginStringMutableCopy = [mutableOriginString mutableCopy];\n</code></pre>\n<p>å†…å­˜åœ°å€åˆ†åˆ«æ˜¯:</p>\n<pre><code class=\"objective-c\">(lldb) p mutableOriginString\n(__NSCFString *) $0 = 0x000060800026aa40 @&quot;mutableOrigin&quot;\n(lldb) p mutableOriginStringCopy\n(__NSCFString *) $1 = 0x0000608000222340 @&quot;mutableOrigin&quot;\n(lldb) p mutableOriginStringMutableCopy\n(__NSCFString *) $2 = 0x000060800026a700 @&quot;mutableOrigin&quot;\n</code></pre>\n<p>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯:</p>\n<pre><code class=\"objective-c\">NSMutableString *mutableOriginStringCopy = [mutableOriginString copy];\n[mutableOriginStringCopy appendString:@&quot;123&quot;];\n</code></pre>\n<p>è¿™æ ·å†™æ˜¯ä¼šcrashçš„, å› ä¸ºcopyç”Ÿæˆçš„æ˜¯imutableå¯¹è±¡, ä¸ç®¡å£°æ˜æ˜¯ä»€ä¹ˆæ ·çš„, ä¾æ—§æ˜¯imutableçš„.</p>\n<p><strong>ç»¼ä¸Š, å¯¹äºç³»ç»Ÿçš„éå®¹å™¨ç±»å¯¹è±¡:</strong></p>\n<ul>\n<li><strong>å¦‚æœå¯¹ä¸€ä¸å¯å˜å¯¹è±¡å¤åˆ¶, copyæ˜¯æŒ‡é’ˆå¤åˆ¶(æµ…å¤åˆ¶), mutableCopyæ˜¯å†…å®¹å¤åˆ¶(æ·±å¤åˆ¶).</strong></li>\n<li><strong>å¦‚æœå¯¹ä¸€å¯å˜å¯¹è±¡å¤åˆ¶, éƒ½æ˜¯æ·±å¤åˆ¶, ä½†æ˜¯copyè¿”å›çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„.</strong></li>\n</ul>\n<h3 id=\"ç³»ç»Ÿçš„å®¹å™¨ç±»å¯¹è±¡\"><a href=\"#ç³»ç»Ÿçš„å®¹å™¨ç±»å¯¹è±¡\" class=\"headerlink\" title=\"ç³»ç»Ÿçš„å®¹å™¨ç±»å¯¹è±¡\"></a>ç³»ç»Ÿçš„å®¹å™¨ç±»å¯¹è±¡</h3><p>å®¹å™¨ç±»å¯¹è±¡æŒ‡çš„æ˜¯<code>NSArray</code>, <code>NSDictionary</code>, <code>NSSet</code>ç­‰ç³»ç»Ÿæä¾›çš„ç»“æ„ä½“, ä¸‹é¢ä»¥<code>NSArray</code>ä¸ºä¾‹.</p>\n<p>å¯¹<code>NSArray</code>è¿›è¡Œcopyæ“ä½œ:</p>\n<pre><code class=\"objective-c\">NSArray *originArray = [NSArray arrayWithObjects:@&quot;a&quot;,@&quot;b&quot;,@&quot;c&quot;,nil];\nNSArray *originArrayCopy = [originArray copy];\nNSMutableArray *originArrayMutableCopy = [originArray mutableCopy];\nfor (NSInteger i = 0; i &lt; originArray.count; i++) {\n    NSLog(@&quot;originArray--%p&quot;, originArray[i]);\n    NSLog(@&quot;originArrayCopy--%p&quot;, originArrayCopy[i]);\n    NSLog(@&quot;originArrayMutableCopy--%p&quot;, originArrayMutableCopy[i]);\n}\n</code></pre>\n<p>å†…å­˜åœ°å€åˆ†åˆ«æ˜¯:</p>\n<pre><code class=\"objective-c\">(lldb) p originArray\n(__NSArrayI *) $0 = 0x00006080002405a0 @&quot;3 elements&quot;\n(lldb) p originArrayCopy\n(__NSArrayI *) $1 = 0x00006080002405a0 @&quot;3 elements&quot;\n(lldb) p originArrayMutableCopy\n(__NSArrayM *) $2 = 0x00006080002403c0 @&quot;3 elements&quot;\n</code></pre>\n<p>å¯ä»¥çœ‹å‡º, copyæ˜¯æµ…å¤åˆ¶, mutableCopyæ˜¯æ·±å¤åˆ¶. éœ€è¦æ³¨æ„çš„æ˜¯,mutableCopyçš„å¯¹è±¡æ˜¯ä¸€ä¸ªå¯å˜å¯¹è±¡,  æ•°ç»„å†…å…ƒç´ å…¨éƒ½æ˜¯æµ…å¤åˆ¶.</p>\n<hr>\n<p>å¯¹<code>NSMutableArray</code>è¿›è¡Œcopyå’ŒmutableCopyæ“ä½œ:</p>\n<pre><code class=\"objective-c\">NSMutableArray *originArray = [NSMutableArray arrayWithObjects:@&quot;a&quot;,@&quot;b&quot;,@&quot;c&quot;, nil];\nNSArray *originArrayCopy = [originArray copy];\nNSMutableArray *originArrayMutableCopy = [originArray mutableCopy];\nfor (NSInteger i = 0; i &lt; originArray.count; i++) {\n    NSLog(@&quot;originArray--%p&quot;, originArray[i]);\n    NSLog(@&quot;originArrayCopy--%p&quot;, originArrayCopy[i]);\n    NSLog(@&quot;originArrayMutableCopy--%p&quot;, originArrayMutableCopy[i]);\n}\n</code></pre>\n<p>æ‰“å°å†…å­˜åœ°å€å¦‚ä¸‹:</p>\n<pre><code class=\"objective-c\">(lldb) p originArray\n(__NSArrayM *) $0 = 0x000060800005eae0 @&quot;3 elements&quot;\n(lldb) p originArrayCopy\n(__NSArrayI *) $1 = 0x000060800005e9f0 @&quot;3 elements&quot;\n(lldb) p originArrayMutableCopy\n(__NSArrayM *) $2 = 0x000060800005e900 @&quot;3 elements&quot;\n</code></pre>\n<p>å¯ä»¥å‘ç°å¯ä»¥çœ‹å‡º, copyæ˜¯æµ…å¤åˆ¶, mutableCopyæ˜¯æ·±å¤åˆ¶. æ•°ç»„å†…å…ƒç´ éƒ½æ˜¯æµ…å¤åˆ¶.</p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯, mutableå¯¹è±¡copyçš„å¯¹è±¡æ˜¯imutableå¯¹è±¡, å¦‚æœå½“åšå¯å˜å¯¹è±¡æ¥ç”¨æ˜¯ä¼šå´©æºƒçš„.</p>\n<pre><code class=\"objective-c\">NSMutableArray *originArray = [NSMutableArray arrayWithObjects:@&quot;a&quot;,@&quot;b&quot;,@&quot;c&quot;, nil];\nNSMutableArray *originArrayCopy1 = [originArray copy];\n[originArrayCopy1 addObject:@&quot;d&quot;];//crash\n</code></pre>\n<p>ç»¼ä¸Š, å¯¹äºå®¹å™¨ç±»å¯¹è±¡:</p>\n<ul>\n<li><strong>å¦‚æœå¯¹ä¸€ä¸å¯å˜å¯¹è±¡å¤åˆ¶, copyæ˜¯æŒ‡é’ˆå¤åˆ¶(æµ…å¤åˆ¶), mutableCopyæ˜¯å†…å®¹å¤åˆ¶(æ·±å¤åˆ¶).</strong></li>\n<li><strong>å¦‚æœå¯¹ä¸€å¯å˜å¯¹è±¡å¤åˆ¶, éƒ½æ˜¯æ·±å¤åˆ¶, ä½†æ˜¯copyè¿”å›çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„.</strong></li>\n<li><strong>å…ƒç´ å¯¹è±¡æ˜¯æµ…å¤åˆ¶.</strong></li>\n</ul>\n<h3 id=\"ç³»ç»Ÿç±»å¯¹è±¡çš„å®Œå…¨æ·±å¤åˆ¶\"><a href=\"#ç³»ç»Ÿç±»å¯¹è±¡çš„å®Œå…¨æ·±å¤åˆ¶\" class=\"headerlink\" title=\"ç³»ç»Ÿç±»å¯¹è±¡çš„å®Œå…¨æ·±å¤åˆ¶\"></a>ç³»ç»Ÿç±»å¯¹è±¡çš„å®Œå…¨æ·±å¤åˆ¶</h3><p>å¯¹äºå®¹å™¨ç±»å¯¹è±¡è€Œè¨€, å…ƒç´ å¯¹è±¡å§‹ç»ˆæ˜¯æµ…å¤åˆ¶, è¦æƒ³æ·±å¤åˆ¶å¯é€šè¿‡å¦‚ä¸‹æ–¹æ³•:</p>\n<pre><code class=\"objective-c\">NSArray *array = [NSArray arrayWithObjects:[NSMutableString stringWithString:@&quot;a&quot;],[NSString stringWithString:@&quot;b&quot;],@&quot;c&quot;,nil];\nNSArray *deepCopyArray=[[NSArray alloc] initWithArray: array copyItems: YES];\nNSArray* trueDeepCopyArray = [NSKeyedUnarchiver unarchiveObjectWithData:[NSKeyedArchiver archivedDataWithRootObject: array]];\n</code></pre>\n<p>æ‰“å°å…ƒç´ å†…å­˜åœ°å€å¯ä»¥å‘ç°, trueDeepCopyArrayçš„å…ƒç´ éƒ½æ˜¯æ·±å¤åˆ¶, è€ŒdeepCopyArrayç”±äºç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å¯å˜å¯¹è±¡, æ‰€ä»¥æ˜¯æ·±å¤åˆ¶, å…¶ä»–çš„å…ƒç´ éƒ½æ˜¯æµ…å¤åˆ¶.</p>\n<p><strong>ç»¼ä¸Š, è¦æƒ³å®ç°å®¹å™¨å¯¹è±¡æ‰€æœ‰å…ƒç´ çš„æ·±å¤åˆ¶, åªèƒ½é€šè¿‡å½’æ¡£æ¥å®ç°.</strong></p>\n<blockquote>\n<p>If you need a true deep copy, such as when you have an array of arrays, you can archive and then unarchive the collection, provided the contents all conform to the <code>NSCoding</code> protocol</p>\n</blockquote>\n<pre><code class=\"objective-c\">@protocol NSCoding\n\n- (void)encodeWithCoder:(NSCoder *)aCoder;\n- (nullable instancetype)initWithCoder:(NSCoder *)aDecoder; // NS_DESIGNATED_INITIALIZER\n\n@end\n</code></pre>\n<h3 id=\"è‡ªå®šä¹‰å¯¹è±¡\"><a href=\"#è‡ªå®šä¹‰å¯¹è±¡\" class=\"headerlink\" title=\"è‡ªå®šä¹‰å¯¹è±¡\"></a>è‡ªå®šä¹‰å¯¹è±¡</h3><p>å¯¹äºè‡ªå®šä¹‰å¯¹è±¡, æˆ‘ä»¬è¦å®ç°<code>NSCopying</code>, <code>NSMutableCopying</code>åè®®, è¿™æ ·æˆ‘ä»¬å°±èƒ½è°ƒç”¨copyå’ŒmutableCopyäº†.å‡è®¾æœ‰ä¸€ä¸ª<code>Person</code>ç±», ç»§æ‰¿äº<code>NSObject</code>.</p>\n<p><code>person.h</code></p>\n<pre><code class=\"objective-c\">#import &lt;Foundation/Foundation.h&gt;\n@interface Person : NSobject\n\n@property (nonatomic, assign) NSInteger age;\n@end\n</code></pre>\n<p><code>person.m</code></p>\n<pre><code class=\"objective-c\">\n#import &quot;Person.h&quot;\n@interface Person()&lt;NSCopying&gt;\n@end\n\n@implementation Person\n\n- (id)copyWithZone:(NSZone *)zone {\n    Person *person = [[Person allocWithZone:zone] init];\n      person.age = self.age;\n    return person;\n}\n@end\n</code></pre>\n<p>è¿™æ ·å½“æˆ‘ä»¬åœ¨å¤–é¢è°ƒç”¨çš„æ—¶å€™:</p>\n<pre><code class=\"objective-c\">Person *p = [[Person alloc] init];\np.age = 20;\n\nPerson *copyP = [p copy];\nNSLog(@&quot;p = %p copyP = %p&quot;, p, copyP);\nNSLog(@&quot;age = %ld&quot;, copyP.age);\n</code></pre>\n<p>é€šè¿‡æ‰“å°åœ°å€:</p>\n<pre><code class=\"objective-c\">(lldb) p p\n(Person *) $0 = 0x000060800002a1e0\n(lldb) p copyP\n(Person *) $1 = 0x000060800002a2e0\n(lldb) p p.age\n(NSInteger) $2 = 20\n(lldb) p copyP.age\n(NSInteger) $4 = 20\n</code></pre>\n<p>æˆ‘ä»¬å¯ä»¥å‘ç°, è‡ªå®šä¹‰å¯¹è±¡å†…éƒ¨çš„å±æ€§éƒ½è¢«æµ…æ‹·è´, è‡ªå®šä¹‰å¯¹è±¡æœ¬èº«è¢«æ·±æ‹·è´.</p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯, å¦‚æœæˆ‘ä»¬çš„è‡ªå®šä¹‰å¯¹è±¡ä¸å®ç°<code>NSCopying</code>åè®®è€Œç›´æ¥copyæ—¶, æ˜¯ä¼šcrashçš„.</p>\n<h2 id=\"å±æ€§ä¿®é¥°ä¹‹copyä¸strong\"><a href=\"#å±æ€§ä¿®é¥°ä¹‹copyä¸strong\" class=\"headerlink\" title=\"å±æ€§ä¿®é¥°ä¹‹copyä¸strong\"></a>å±æ€§ä¿®é¥°ä¹‹copyä¸strong</h2><p>æˆ‘ä»¬æ–°å»ºä¸€ä¸ª<code>Person</code>ç±», æ·»åŠ å‡ ä¸ªå±æ€§æ¥çœ‹ä¸€ä¸‹copyå’Œstrongå¯¹å±æ€§ä½¿ç”¨çš„å½±å“.</p>\n<pre><code class=\"objective-c\">#import &lt;Foundation/Foundation.h&gt;\n\n@interface Person : NSObject\n\n@property (nonatomic, strong) NSString *strongName;\n@property (nonatomic, copy) NSString *copyName;\n\n@end\n</code></pre>\n<p>åœ¨å¤–é¢è°ƒç”¨<code>Person</code>ç±», ä»£ç å¦‚ä¸‹:</p>\n<pre><code class=\"objective-c\">Person *person = [[Person alloc] init];\nNSMutableString *testString = [NSMutableString stringWithString:@&quot;test&quot;];\nperson.nameCopy = testString;\nperson.nameStrong = testString;\n[testString appendString:@&quot;copy&amp;&amp;strong&quot;];\n</code></pre>\n<p>æ‰“å°<code>testString</code>æ”¹å˜å‰åå±æ€§</p>\n<pre><code class=\"objective-c\">//testStringæ”¹å˜å‰\n(lldb) p person.nameCopy\n(NSTaggedPointerString *) $1 = 0xa000000747365744 @&quot;test&quot;\n(lldb) p person.nameStrong\n(__NSCFString *) $2 = 0x0000600000260540 @&quot;test&quot;\n//testStringæ”¹å˜å\n(lldb) p person.nameCopy\n(NSTaggedPointerString *) $3 = 0xa000000747365744 @&quot;test&quot;\n(lldb) p person.nameStrong\n(__NSCFString *) $4 = 0x0000600000260540 @&quot;testcopy&amp;&amp;strong&quot;\n</code></pre>\n<p>ç”±ä»¥ä¸Šå¯ä»¥çœ‹å‡º:</p>\n<p>å¯¹æºå¤´æ˜¯<code>NSMutableString</code>çš„å­—ç¬¦ä¸²ï¼Œstrongä»…ä»…æ˜¯æŒ‡é’ˆå¼•ç”¨ï¼Œå¢åŠ äº†å¼•ç”¨è®¡æ•°å™¨ï¼Œè¿™æ ·æºå¤´æ”¹å˜çš„æ—¶å€™ï¼Œç”¨è¿™ç§strongæ–¹å¼å£°æ˜çš„å˜é‡ï¼ˆæ— è®ºè¢«èµ‹å€¼çš„å˜é‡æ˜¯å¯å˜çš„è¿˜æ˜¯ä¸å¯å˜çš„ï¼Œå®ƒä¹Ÿä¼šè·Ÿç€æ”¹å˜, ç›¸å½“äºæµ…æ‹·è´; è€Œcopyå±æ€§åˆ™æ˜¯å¯¹æºå­—ç¬¦ä¸²åšäº†æ¬¡æ·±æ‹·è´ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä¸”copyå±æ€§å¯¹è±¡æŒ‡å‘è¿™ä¸ªæ–°çš„å¯¹è±¡ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªcopyå±æ€§å¯¹è±¡çš„ç±»å‹å§‹ç»ˆæ˜¯<code>NSString</code>ï¼Œè€Œä¸æ˜¯<code>NSMutableString</code>ï¼Œå› æ­¤å…¶æ˜¯ä¸å¯å˜çš„ã€‚</p>\n<p>å½“æºå­—ç¬¦ä¸²æ˜¯<code>NSString</code>æ—¶ï¼Œç”±äºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥ï¼Œä¸ç®¡æ˜¯strongè¿˜æ˜¯copyå±æ€§çš„å¯¹è±¡ï¼Œéƒ½æ˜¯æŒ‡å‘æºå¯¹è±¡ï¼Œcopyæ“ä½œåªæ˜¯åšäº†æ¬¡æµ…æ‹·è´ã€‚</p>\n<p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæ€§èƒ½é—®é¢˜ï¼Œå³åœ¨æºå­—ç¬¦ä¸²æ˜¯<code>NSMutableString</code>ï¼Œstrongæ˜¯å•çº¯çš„å¢åŠ å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œè€Œcopyæ“ä½œæ˜¯æ‰§è¡Œäº†ä¸€æ¬¡æ·±æ‹·è´ï¼Œæ‰€ä»¥æ€§èƒ½ä¸Šä¼šæœ‰æ‰€å·®å¼‚ã€‚è€Œå¦‚æœæºå­—ç¬¦ä¸²æ˜¯<code>NSString</code>æ—¶ï¼Œåˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>ç»¼ä¸Šå¯ä»¥å‘ç°, å¦‚æœpropertyæ˜¯<code>NSString</code>æˆ–è€…<code>NSArray</code>åŠå…¶å­ç±»çš„æ—¶å€™ï¼Œæœ€å¥½é€‰æ‹©ä½¿ç”¨copyå±æ€§ä¿®é¥°ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™æ˜¯ä¸ºäº†é˜²æ­¢èµ‹å€¼ç»™å®ƒçš„æ˜¯å¯å˜çš„æ•°æ®ï¼Œå¦‚æœå¯å˜çš„æ•°æ®å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆè¯¥propertyä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>\n<p>å‚è€ƒæ–‡æ¡£:</p>\n<p>1.<a href=\"http://www.fanliugen.com/?p=278\" target=\"_blank\" rel=\"noopener\">copyä¸mutableCopy</a></p>\n<p>2.<a href=\"https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Collections/Articles/Copying.html#//apple_ref/doc/uid/TP40010162-SW3\" target=\"_blank\" rel=\"noopener\">Copying Collections</a></p>\n<p>3.<a href=\"http://www.jianshu.com/p/e6a7cdcc705d\" target=\"_blank\" rel=\"noopener\">iOSæµ…è°ˆ: æ·±.æµ…æ‹·è´ä¸copy.strong</a></p>\n<p>4.<a href=\"http://www.cocoachina.com/ios/20150512/11805.html\" target=\"_blank\" rel=\"noopener\">NSStringå±æ€§ä»€ä¹ˆæ—¶å€™ç”¨copyï¼Œä»€ä¹ˆæ—¶å€™ç”¨strong?</a></p>\n","categories":["åŸºç¡€çŸ¥è¯†"],"tags":["åŸºç¡€çŸ¥è¯†"]},{"title":"å†…å­˜åˆ†é…","url":"http://hchong.net/2016/09/18/å†…å­˜åˆ†é…/","content":"<h1 id=\"iOSå¼€å‘çš„å†…å­˜åˆ†é…\"><a href=\"#iOSå¼€å‘çš„å†…å­˜åˆ†é…\" class=\"headerlink\" title=\"iOSå¼€å‘çš„å†…å­˜åˆ†é…\"></a>iOSå¼€å‘çš„å†…å­˜åˆ†é…</h1><p>è®¡ç®—æœºç³»ç»Ÿä¸­, åº”ç”¨ç¨‹åºçš„æ•°æ®éƒ½ä¿å­˜åœ¨å†…å­˜ä¸­, ä¸åŒç±»å‹çš„æ•°æ®, ä¿å­˜çš„åŒºåŸŸä¸åŒ.</p>\n<h2 id=\"RAM-ROM\"><a href=\"#RAM-ROM\" class=\"headerlink\" title=\"RAM ROM\"></a>RAM ROM</h2><blockquote>\n<p>RAM: è¿è¡Œå†…å­˜, ä¸èƒ½æ‰ç”µå­˜å‚¨.ROM: å­˜å‚¨å‹å†…å­˜, å¯ä»¥æ‰ç”µå­˜å‚¨, ä¾‹å¦‚å†…å­˜å¡, FLash.<br>    ç”±äºRAMç±»å‹ä¸å…·å¤‡æ‰ç”µå­˜å‚¨çš„èƒ½åŠ›, æ‰€ä»¥Appç¨‹åºä¸€èˆ¬å­˜æ”¾åœ¨RMOä¸­. RAMçš„è®¿é—®é€Ÿåº¦å’Œä»·æ ¼éƒ½é«˜äºROM.</p>\n</blockquote>\n<h2 id=\"Appç¨‹åºå¯åŠ¨\"><a href=\"#Appç¨‹åºå¯åŠ¨\" class=\"headerlink\" title=\"Appç¨‹åºå¯åŠ¨\"></a>Appç¨‹åºå¯åŠ¨</h2><blockquote>\n<p>Appç¨‹åºå¯åŠ¨, ç³»ç»Ÿä¼šæŠŠå¼€å¯çš„é‚£ä¸ªAppç¨‹åºä»Flashæˆ–ROMé‡Œé¢æ‹·è´åˆ°å†…å­˜(RAM)ä¸­, ç„¶åä»å†…å­˜é‡Œé¢æ‰§è¡Œä»£ç .<br>    å¦å¤–ä¸€ä¸ªåŸå› æ˜¯CPUä¸èƒ½ç›´æ¥ä»å†…å­˜å¡é‡Œé¢è¯»å–æŒ‡ä»¤(éœ€è¦Flashé©±åŠ¨ç­‰ç­‰)</p>\n</blockquote>\n<h2 id=\"å†…å­˜åˆ†åŒº\"><a href=\"#å†…å­˜åˆ†åŒº\" class=\"headerlink\" title=\"å†…å­˜åˆ†åŒº\"></a>å†…å­˜åˆ†åŒº</h2><h3 id=\"æ ˆåŒº-stack\"><a href=\"#æ ˆåŒº-stack\" class=\"headerlink\" title=\"æ ˆåŒº(stack)\"></a>æ ˆåŒº(stack)</h3><p>æ ˆåŒºç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…å¹¶ä¸”é‡Šæ”¾, å­˜æ”¾å±€éƒ¨å˜é‡, å‡½æ•°çš„å‚æ•°å€¼, å‡½æ•°è·³è½¬åœ°å€, ç°åœºä¿æŠ¤ç­‰.æ ˆæ˜¯ç³»ç»Ÿæ•°æ®ç»“æ„, å¯¹åº”çº¿ç¨‹/è¿›ç¨‹æ˜¯å”¯ä¸€çš„.</p>\n<p>æ ˆç©ºé—´åˆ†é…åˆ†ä¸ºé™æ€åˆ†é…å’ŒåŠ¨æ€åˆ†é…ä¸¤ç§.</p>\n<ul>\n<li>é™æ€åˆ†é…æ˜¯ç”±ä¾¿ä¸€èµ·å®Œæˆ, æ¯”å¦‚è‡ªåŠ¨å˜é‡<code>auto</code>çš„åˆ†é…. åŠ¨æ€åˆ†é…ç”±<code>alloca</code>å‡½æ•°å®Œæˆ.</li>\n<li>æ ˆçš„åŠ¨æ€åˆ†é…æ— éœ€é‡Šæ”¾, ç³»ç»Ÿä¼šè‡ªåŠ¨é‡Šæ”¾, æ²¡æœ‰é‡Šæ”¾å‡½æ•°. ç³»ç»Ÿä¸é¼“åŠ±æ ˆçš„åŠ¨æ€åˆ†é….</li>\n</ul>\n<p>å…³äºæ ˆè¿˜éœ€è¦æ³¨æ„:</p>\n<ul>\n<li>ä¸éœ€è¦æˆ‘ä»¬ç®¡ç†æ ˆåŒºå˜é‡çš„å†…å­˜</li>\n<li>æ ˆåŒºåœ°å€ä»é«˜åˆ°ä½åˆ†é…</li>\n<li>å…ˆè¿›åå‡º</li>\n</ul>\n<h3 id=\"å †åŒº-heap\"><a href=\"#å †åŒº-heap\" class=\"headerlink\" title=\"å †åŒº(heap)\"></a>å †åŒº(heap)</h3><p>å †åŒºç”±æˆ‘ä»¬åˆ†é…(iOSä¸‹çš„<code>alloc</code>)å’Œé‡Šæ”¾, å¦‚æœä¸é‡Šæ”¾, åœ¨ç¨‹åºç»“æŸæ—¶, å¯èƒ½ä¼šç”±ç³»ç»Ÿå›æ”¶(iOSçš„ARCä¸‹). çµæ´»æ–¹ä¾¿, æ•°æ®é€‚åº”é¢å¹¿, ä½†æ˜¯å› ä¸ºé¡ºåºéšæ„, æ‰€ä»¥æ•ˆç‡æœ‰ä¸€å®šé™ä½.<br>å…³äºå †è¿˜éœ€è¦æ³¨æ„:</p>\n<ul>\n<li>å †åŒºçš„å†…å­˜åˆ†é…ä½¿ç”¨<code>alloc</code>.</li>\n<li>éœ€è¦ç¨‹åºçŒ¿ç®¡ç†.</li>\n<li>ARCä¸‹çš„å†…å­˜ç®¡ç†ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ·»åŠ <code>retain</code>, <code>release</code>, <code>autorelease</code>ç­‰å…³é”®å­—.</li>\n<li>å †åŒºçš„åœ°å€ç”±ä½åˆ°é«˜åˆ†é….</li>\n<li>ä¸åŒå †åˆ†é…çš„å†…å­˜æ— æ³•äº’ç›¸äº’æ“ä½œ(ä¸åŒAppä¹‹é—´å†…å­˜æ— æ³•ç›¸äº’ç®¡ç†).</li>\n<li>å †ç©ºé—´çš„åˆ†é…æ€»æ˜¯åŠ¨æ€çš„.</li>\n</ul>\n<h3 id=\"å…¨å±€åŒº-static\"><a href=\"#å…¨å±€åŒº-static\" class=\"headerlink\" title=\"å…¨å±€åŒº(static)\"></a>å…¨å±€åŒº(static)</h3><p>å…¨å±€åŒºä¹Ÿå«ä½œé™æ€åŒº. å…¨å±€å˜é‡å’Œé™æ€å˜é‡åœ¨å†…å­˜ä¸­æ˜¯æ”¾åœ¨ä¸€èµ·çš„, åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡æ”¾åœ¨ä¸€å—åŒºåŸŸ, æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡æ”¾åœ¨ç›¸é‚»çš„å¦ä¸€å—åŒºåŸŸ.</p>\n<pre><code>int a;//æœªåˆå§‹åŒ–çš„\nint b = 10;//åˆå§‹åŒ–çš„\n</code></pre><h3 id=\"å¸¸é‡åŒº\"><a href=\"#å¸¸é‡åŒº\" class=\"headerlink\" title=\"å¸¸é‡åŒº\"></a>å¸¸é‡åŒº</h3><p>å¸¸é‡å­—ç¬¦ä¸²å°±å­˜æ”¾åœ¨è¿™é‡Œ, ç¨‹åºç»“æŸåç”±ç³»ç»Ÿè‡ªå·±é‡Šæ”¾.</p>\n<h3 id=\"ä»£ç åŒº\"><a href=\"#ä»£ç åŒº\" class=\"headerlink\" title=\"ä»£ç åŒº\"></a>ä»£ç åŒº</h3><p>ä»£ç åŒºä¹Ÿå«ä½œå‡½æ•°åŒº, å­˜æ”¾å‡½æ•°çš„äºŒè¿›åˆ¶ä»£ç , Appçš„ä»£ç .</p>\n<h2 id=\"å†…å­˜ç”³è¯·åçš„ç³»ç»Ÿå“åº”\"><a href=\"#å†…å­˜ç”³è¯·åçš„ç³»ç»Ÿå“åº”\" class=\"headerlink\" title=\"å†…å­˜ç”³è¯·åçš„ç³»ç»Ÿå“åº”\"></a>å†…å­˜ç”³è¯·åçš„ç³»ç»Ÿå“åº”</h2><p>1.æ ˆ: å­˜å‚¨çš„å‡½æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šå‘æ“ä½œç³»ç»Ÿç´¢è¦èµ„æº, æ ˆåŒºå°±æ˜¯å‡½æ•°è¿è¡Œæ—¶çš„å†…è®­, æ ˆåŒºä¸­çš„å˜é‡ç”±ç¼–è¯‘å™¨è´Ÿè´£é‡Šæ”¾å’Œåˆ†é…, å†…å­˜éšç€å‡½æ•°çš„è¿è¡Œå’Œç»“æŸè€Œåˆ†é…å’Œé‡Šæ”¾, ç”±ç³»ç»Ÿå®Œæˆ. åªè¦å‰©ä½™çš„æ ˆç©ºé—´å¤§äºç”³è¯·ç©ºé—´, ç³»ç»Ÿå°†ä¼šä¸ºç¨‹åºæä¾›å†…å­˜, å¦åˆ™å°†æŠ¥å¼‚å¸¸æç¤ºæ ˆæº¢å‡º.<br>2.å †: æ“ä½œç³»ç»Ÿæœ‰ä¸€ä¸ªè®°å½•ç©ºé—²åœ°å€çš„é“¾è¡¨, å½“ç³»ç»Ÿæ”¶åˆ°ç¨‹åºç”³è¯·æ—¶, ä¼šéå†è¯¥é“¾è¡¨, å¯»æ‰¾ç¬¬ä¸€ä¸ªç©ºé—´å¤§äºæ‰€ç”³è¯·ç©ºé—´çš„å †èŠ‚ç‚¹, ç„¶åå°†è¯¥èŠ‚ç‚¹ä»ç©ºé—²èŠ‚ç‚¹é“¾è¡¨ä¸­åˆ é™¤, å¹¶å°†è¯¥èŠ‚ç‚¹çš„ç©ºé—´åˆ†é…ç»™ç¨‹åº. ç”±äºæ‰¾åˆ°çš„å †èŠ‚ç‚¹å¤§å°ä¸ä¸€å®šæ­£åˆé€‚, ç³»ç»Ÿä¼šå°†å¤šä½™çš„é‚£éƒ¨åˆ†é‡æ–°æ”¾å…¥ç©ºé—²é“¾è¡¨.</p>\n<h2 id=\"å†…å­˜å¤§å°çš„é™åˆ¶\"><a href=\"#å†…å­˜å¤§å°çš„é™åˆ¶\" class=\"headerlink\" title=\"å†…å­˜å¤§å°çš„é™åˆ¶\"></a>å†…å­˜å¤§å°çš„é™åˆ¶</h2><p>1.æ ˆ: æ ˆæ˜¯å‘ä½å†…å­˜æ‰©å±•çš„æ•°æ®ç»“æ„, æ˜¯ä¸€å—è¿ç»­çš„å†…å­˜, æ ˆé¡¶åœ°å€å’Œæ ˆçš„æœ€å¤§å®¹é‡æ˜¯äº‹å…ˆè§„å®šå¥½çš„, å¦‚æœç”³è¯·çš„ç©ºé—´è¶…è¿‡æ ˆçš„å‰©ä½™ç©ºé—´, å°†ä¼šæç¤ºoverflow.<br>2.å †: å †æ˜¯å‘é«˜åœ°å€æ‰©å±•çš„æ•°æ®ç»“æ„, æ˜¯ä¸è¿ç»­çš„å†…å­˜åŒºåŸŸ. è¿™æ˜¯ç”±äºç³»ç»Ÿæ˜¯ç”¨é“¾è¡¨æ¥å­˜å‚¨çš„ç©ºé—²å†…å­˜åœ°å€, è‡ªç„¶æ˜¯ä¸è¿ç»­çš„, è€Œé“¾è¡¨çš„éå†æ–¹å‘æ˜¯ç”±ä½åœ°å€å‘é«˜åœ°å€. å †çš„å¤§å°å—é™äºè®¡ç®—æœºç³»ç»Ÿä¸­æœ‰æ•ˆçš„è™šæ‹Ÿå†…å­˜.</p>\n<h2 id=\"æ³¨æ„äº‹é¡¹\"><a href=\"#æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"æ³¨æ„äº‹é¡¹\"></a>æ³¨æ„äº‹é¡¹</h2><p>å¦‚å›¾æ‰€ç¤º: ä»£ç åŒºçš„åœ°å€æœ€ä½, æ ˆåŒºæœ€é«˜. ä½†æ˜¯åŒºä¸åŒºä¹‹é—´çš„åœ°å€ä¸è¿ç»­.<br><img src=\"http://upload-images.jianshu.io/upload_images/1156719-1d0de5ca1edc35af?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"å†…å­˜åœ°å€ç¤ºæ„å›¾\"></p>\n<ul>\n<li>åœ¨iOSä¸­, å †åŒºçš„å†…å­˜æ˜¯ç¨‹åºé—´å…±äº«, å †åŒºçš„å†…å­˜åˆ†é…æ˜¯ç³»ç»Ÿè´Ÿè´£çš„.</li>\n<li>ç³»ç»Ÿä½¿ç”¨ä¸€ä¸ªé“¾è¡¨æ¥ç»´æŠ¤å·²åˆ†é…çš„å†…å­˜ç©ºé—´(ä»…ä»…è®°å½•, ä¸ç®¡ç†å…·ä½“çš„å†…å®¹).</li>\n<li>å˜é‡ä½¿ç”¨ç»“æŸå, éœ€è¦é‡Šæ”¾å†…å­˜, OCä¸­æ˜¯å½“å¼•ç”¨è®¡æ•°==0, å°±è¯´æ˜æ²¡æœ‰ä»»ä½•å˜é‡ä½¿ç”¨è¿™å—ç©ºé—´, ç³»ç»Ÿå°†ç›´æ¥æ”¶å›.</li>\n<li>å½“ä¸€ä¸ªappå¯åŠ¨æ—¶, ä»£ç åŒº, å¸¸é‡åŒº, å…¨å±€åŒºçš„å¤§å°å®é™…å·²ç»å›ºå®š, å› æ­¤æŒ‡å‘è¿™äº›åŒºåŸŸçš„å†…å­˜ä¸ä¼šäº§ç”Ÿå´©æºƒæ€§é”™è¯¯. å †åŒºå’Œæ ˆåŒºçš„å†…å­˜æ˜¯æ—¶åˆ»å˜åŒ–çš„, ä½¿ç”¨ä¸€ä¸ªå·²ç»è¢«é‡Šæ”¾çš„å†…å­˜, å¾ˆå®¹æ˜“äº§ç”Ÿé‡æŒ‡é’ˆå´©æºƒ.</li>\n<li>æ ˆç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…, é€Ÿåº¦å¿«, ä¸ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡, å…ˆè¿›åå‡º.</li>\n<li>å †ç”±<code>alloc</code>åˆ†é…å†…å­˜, é€Ÿåº¦æ…¢, è€Œä¸”å®¹æ˜“äº§ç”Ÿç¢ç‰‡, FIFO, ä¸è¿‡ä½¿ç”¨èµ·æ¥æ–¹ä¾¿.</li>\n</ul>\n<hr>\n<p>å‚è€ƒæ–‡çŒ®:<br>1.<a href=\"http://www.jianshu.com/p/f3c1b920e8eb\" target=\"_blank\" rel=\"noopener\">iOSç¨‹åºä¸­çš„å†…å­˜åˆ†é…</a><br>2.<a href=\"http://www.jianshu.com/p/7bbbe5d55440\" target=\"_blank\" rel=\"noopener\">æ·±å…¥æµ…å‡º-iOSå†…å­˜åˆ†é…</a></p>\n","categories":["åŸºç¡€çŸ¥è¯†"],"tags":["åŸºç¡€çŸ¥è¯†"]},{"title":"å±æ€§çš„ä¿®é¥°ç¬¦è§£æ","url":"http://hchong.net/2016/09/16/å±æ€§çš„ä¿®é¥°ç¬¦è§£æ/","content":"<h1 id=\"å±æ€§çš„ä¿®é¥°ç¬¦è§£æ\"><a href=\"#å±æ€§çš„ä¿®é¥°ç¬¦è§£æ\" class=\"headerlink\" title=\"å±æ€§çš„ä¿®é¥°ç¬¦è§£æ\"></a>å±æ€§çš„ä¿®é¥°ç¬¦è§£æ</h1><h2 id=\"å±æ€§çš„ä¿®é¥°ç¬¦\"><a href=\"#å±æ€§çš„ä¿®é¥°ç¬¦\" class=\"headerlink\" title=\"å±æ€§çš„ä¿®é¥°ç¬¦\"></a>å±æ€§çš„ä¿®é¥°ç¬¦</h2><ol>\n<li>çº¿ç¨‹å®‰å…¨çš„: atomic, nonatomic </li>\n<li>è®¿é—®æƒé™çš„: readonlyï¼Œ readwrite </li>\n<li>å†…å­˜ç®¡ç†ï¼ˆARCï¼‰: assignï¼Œstrongï¼Œweakï¼Œcopy </li>\n<li>å†…å­˜ç®¡ç†ï¼ˆMRCï¼‰:assignï¼Œ retainï¼Œcopy </li>\n<li>æŒ‡å®šæ–¹æ³•åç§°: setter= getter=</li>\n</ol>\n<hr>\n<p>é»˜è®¤çš„ä¿®é¥°ç¬¦æ˜¯:</p>\n<ul>\n<li>åŸºæœ¬æ•°æ®ç±»å‹ä½¿ç”¨<code>atomic</code>, <code>readwrite</code>, <code>assign</code>.</li>\n<li>å¯¹äºæ™®é€šçš„Objective-Cå¯¹è±¡ä½¿ç”¨<code>atomic</code>, <code>readwrite</code>, <code>strong</code>.</li>\n</ul>\n<h2 id=\"weak-amp-assign\"><a href=\"#weak-amp-assign\" class=\"headerlink\" title=\"weak &amp; assign\"></a>weak &amp; assign</h2><p>assignä¿®é¥°åŸºæœ¬æ•°æ®ç±»å‹å’Œç»“æ„ä½“, weakä¿®é¥°ä¸€ä¸ªå¯¹è±¡</p>\n<hr>\n<p>assignä¿®é¥°çš„å¯¹è±¡ç¼–è¯‘æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªè­¦å‘Š:Assigning retained object to unsafe_unretained variable; object will be released after assignment(Assignä¿®é¥°çš„å¯¹è±¡æ— æ³•è¢«ä¿ç•™). å¹¶ä¸”åœ¨é‡Šæ”¾ä¹‹åæŒ‡é’ˆçš„åœ°å€è¿˜æ˜¯å­˜åœ¨çš„, ä¹Ÿå°±æ˜¯è¯´æŒ‡é’ˆå¹¶æ²¡æœ‰è¢«ç½®ä¸ºnil, é€ æˆé‡æŒ‡é’ˆ. å¯¹è±¡åˆ†é…ä¸€èˆ¬åˆ†é…åœ¨å †ä¸Šçš„æŸå—å†…å­˜(è¯¦è§<a href=\"http://hchong.net/2016/09/18/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/\">å†…å­˜åˆ†é…</a>), å¦‚æœåœ¨åç»­çš„å†…å­˜åˆ†é…ä¸­, åˆšå¥½åˆ†åˆ°äº†è¿™å—åœ°å€, ç¨‹åºå°±ä¼šå¯¼è‡´EXC_BAD_ACCESS(è°ƒç”¨å·²é‡Šæ”¾çš„å†…å­˜ç©ºé—´)å´©æºƒæ‰.</p>\n<p>assignä¿®é¥°çš„åŸºæœ¬æ•°æ®ç±»å‹æˆ–è€…ç»“æ„ä½“å› ä¸ºæŠ€æœ¯æ•°æ®ç±»å‹å’Œç»“æ„ä½“ä¸€èˆ¬åˆ†é…åœ¨æ ˆä¸Š, æ ˆçš„å†…å­˜ä¼šç”±ç³»ç»Ÿè‡ªå·±è‡ªåŠ¨å¤„ç†, ä¸ä¼šé€ æˆé‡æŒ‡é’ˆ.</p>\n<hr>\n<p>weakä¿®é¥°çš„å¯¹è±¡åœ¨é‡Šæ”¾ä¹‹å, æŒ‡é’ˆä¼šè¢«ç½®ä¸ºnil, æ‰€ä»¥ä¸€èˆ¬å¼±å¼•ç”¨æŒ‡çš„å°±æ˜¯ç”¨weak.</p>\n<p>weakä¸»è¦ä½¿ç”¨åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢:</p>\n<ul>\n<li>åœ¨ARCä¸‹, æœ‰å¯èƒ½å‡ºç°å¾ªç¯å¼•ç”¨çš„åœ°æ–¹, æ¯”å¦‚delegate<br><code>@property (nonatomic, weak) id XXXDelegate;</code></li>\n<li>è‡ªèº«å·²ç»è¢«å¼ºå¼•ç”¨è¿‡ä¸€æ¬¡, æ¯”å¦‚xibæ–‡ä»¶æ±‡æ€»çš„å±æ€§<br><code>@property (nonatomic, weak) IBOutlet UIButton *button;</code></li>\n</ul>\n<hr>\n<h2 id=\"copyå…³é”®å­—çš„ä½¿ç”¨\"><a href=\"#copyå…³é”®å­—çš„ä½¿ç”¨\" class=\"headerlink\" title=\"copyå…³é”®å­—çš„ä½¿ç”¨\"></a>copyå…³é”®å­—çš„ä½¿ç”¨</h2><p>copyå’Œstrongä¸€æ ·éƒ½ä¼šä½¿å¼•ç”¨è®¡æ•°åŠ 1, ä½†æ˜¯strongæ˜¯ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå†…è®­åœ°å€, copyåˆ™ä¼šåœ¨å†…å­˜é‡Œæ‹·è´ä¸€ä»½å¯¹è±¡, ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸åŒçš„å†…å­˜åœ°å€.</p>\n<p>copyå…³é”®å­—ä¸»è¦æœ‰ä»¥ä¸‹ä½¿ç”¨åœºæ™¯:</p>\n<ul>\n<li>ä¸ç¡®å®šèµ‹å€¼è¿‡ç¨‹ä¸­ç”¨çš„æ˜¯å¯å˜è¿˜æ˜¯ä¸å¯å˜çš„å˜é‡. ä¾‹å¦‚NSString, NSArray, NSDictionaryç­‰ç­‰å¸¸ä½¿ç”¨å…³é”®å­—copy, å› ä¸ºä»–ä»¬æœ‰å¯¹åº”çš„å¯å˜ç±»å‹.<a href=\"http://hchong.net/2016/09/21/%E5%B1%9E%E6%80%A7%E4%BF%AE%E9%A5%B0%E7%AC%A6%E4%B9%8Bcopy%E5%92%8Cstrong/\">å…³äºcopyå’Œstrongçš„è¯¦è§£</a></li>\n<li>blockä¹Ÿç»å¸¸ä½¿ç”¨copyå…³é”®å­—. ç”¨copyä¿®é¥°blockæ—¶è¦çŸ¥é“æ˜¯åœ¨ARCè¿˜æ˜¯MRC.<ul>\n<li>ARCä¸‹åªè¦blockè®¿é—®äº†å¤–éƒ¨å±€éƒ¨å˜é‡, blockå°±ä¼šæ”¾åˆ°å †åŒºé‡Œé¢, ä½¿ç”¨strongæˆ–è€…copyéƒ½å¯ä»¥, ä½†æ˜¯strongçš„æ€§èƒ½å¯èƒ½ä¼šæ›´å¥½.</li>\n<li>MRCä¸‹, å¦‚æœblockè®¿é—®å¤–éƒ¨å±€éƒ¨å˜é‡, blockæ˜¯åœ¨æ ˆåŒºçš„. å¦‚æœblockè®¿é—®äº†ä¸€ä¸ªæ•´ä¸ªAPPç”Ÿå‘½å‘¨æœŸéƒ½å­˜åœ¨çš„å˜é‡, é‚£ä»–è‚¯å®šåœ¨å…¨å±€åŒº. åªæœ‰ä½¿ç”¨copyå±æ€§æ‰èƒ½æŠŠblockæ”¾åˆ°å †åŒº.</li>\n</ul>\n</li>\n</ul>\n<hr>\n<p>å‚è€ƒå†…å®¹:<br>1.<a href=\"http://www.jianshu.com/p/3e0f12e5faaa\" target=\"_blank\" rel=\"noopener\">@property å…³é”®å­—çš„åŒºåˆ«è¯¦è§£</a><br>2.<a href=\"http://bihongbo.com/2014/05/20/IOSassignandweak/\" target=\"_blank\" rel=\"noopener\">iOSå¼€å‘ä¸­ARCä¸‹çš„assignå’ŒweakåŒºåˆ«</a><br>3.<a href=\"http://www.jianshu.com/p/3aa1c650a967\" target=\"_blank\" rel=\"noopener\">æ•´ç†ä¸€ä¸‹OCä¸­çš„é‚£äº›å±æ€§ä¿®é¥°ç¬¦</a><br>4.<a href=\"http://blog.csdn.net/qq_32744055/article/details/53443805\" target=\"_blank\" rel=\"noopener\">@property åé¢å¯ä»¥æœ‰å“ªäº›ä¿®é¥°ç¬¦</a></p>\n","categories":["åŸºç¡€çŸ¥è¯†"],"tags":["åŸºç¡€çŸ¥è¯†"]},{"title":"Hello World","url":"http://hchong.net/2016/08/16/hello-world/","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><pre><code class=\"bash\">$ hexo new &quot;My New Post&quot;\n</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><pre><code class=\"bash\">$ hexo server\n</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><pre><code class=\"bash\">$ hexo generate\n</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><pre><code class=\"bash\">$ hexo deploy\n</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n","categories":[],"tags":[]},{"title":"Wiki","url":"http://hchong.net/Wiki/index.html","content":"","categories":[],"tags":[]},{"title":"about","url":"http://hchong.net/about/index.html","content":"","categories":[],"tags":[]},{"title":"category","url":"http://hchong.net/category/index.html","content":"","categories":[],"tags":[]},{"title":"link","url":"http://hchong.net/link/index.html","content":"","categories":[],"tags":[]},{"title":"project","url":"http://hchong.net/project/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"http://hchong.net/search/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"http://hchong.net/tag/index.html","content":"","categories":[],"tags":[]}]